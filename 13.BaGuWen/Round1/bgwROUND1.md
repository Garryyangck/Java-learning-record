# 1.Java ç³»åˆ—

## 1.Java åŸºç¡€

### 1.ä»‹ç»ä¸€ä¸‹ Object å¸¸è§æ–¹æ³•ï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==æˆ‘çš„å›žç­”==ï¼š

> 1. Object çš„å¸¸ç”¨æ–¹æ³•åŒ…æ‹¬ getClass(), equals(Object), hashCode(), toString(), notify(), notifyAll(), wait(æ— å‚/long/long, int), finalize()ï¼Œä¸‹é¢æˆ‘å°†ä¸€ä¸€è¿›è¡Œä»‹ç»ã€‚
>
> 2. getClass() æ–¹æ³•ç”¨äºŽè¿”å›žå¯¹è±¡==è¿è¡Œæ—¶çš„ç±»å¯¹è±¡(Classå¯¹è±¡)==ã€‚å¯è¿›ä¸€æ­¥èŽ·å–è¿è¡Œæ—¶å¯¹è±¡ã€‚
>
> 	```java
> 	/* Returns the runtime class of this {@code Object}.
> 	```
>
> 3. equals æ–¹æ³•==é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨ = = ï¼Œ æ¯”è¾ƒå¼•ç”¨ç±»åž‹æ˜¯å¦ç›¸ç­‰==ã€‚æ¯”å¦‚ String ç±»ä¸­å°±é‡å†™äº†æ­¤æ–¹æ³•ï¼Œä¼˜å…ˆæ¯”è¾ƒä¸¤å¯¹è±¡çš„åœ°å€å’Œè¿è¡Œæ—¶ç±»æ˜¯å¦ç›¸åŒï¼ŒéšåŽä»¥æ¯”è¾ƒå­—ç¬¦ä¸²çš„æ–¹å¼æ¯”è¾ƒä¸¤ä¸ª String å¯¹è±¡ã€‚
>
> 4. hashCode  æ–¹æ³•==åœ¨é»˜è®¤æƒ…å†µä¸‹æ ¹æ®å¯¹è±¡çš„å†…å­˜åœ°å€è¿”å›žä¸€ä¸ªintæ•´æ•°==ã€‚
>
> 	```java
> 	/* This is typically implemented by converting the internal address of the object into an integer
> 	```
>
> 	==å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šç”±äºŽ hashCode æ–¹æ³•å¯ä»¥è¢«é‡å†™ï¼Œå› æ­¤å…¶è¿”å›žå€¼ä¸èƒ½ç›´æŽ¥å’Œå¯¹è±¡çš„å†…å­˜åœ°å€æŒ‚é’©==ã€‚hashCode æ–¹æ³•å¯ä»¥ç”¨äºŽ==å¸®åŠ© HashMap å®žçŽ°å“ˆå¸Œæ˜ å°„==ï¼Œä½†æ˜¯ä¸€ä¸ªå¯¹è±¡åœ¨ HashMap ä¸­æ˜ å°„çš„ç»“æžœå¹¶ä¸ç­‰åŒäºŽå…¶ hashCodeï¼Œè€Œæ˜¯åŸºäºŽ hashCode åšäº†ä¸€å±‚å°è£…ã€‚
>
> 	```java
> 	static final int hash(Object key) {
> 	    int h;
> 	    return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);
> 	}
> 	```
>
> 	æ­¤å¤–è¿˜è§„å®šï¼š==å¦‚æžœä¸¤ä¸ªå¯¹è±¡ä½¿ç”¨ equals æ–¹æ³•å¾—åˆ° true çš„è¯ï¼Œé‚£ä¹ˆå®ƒä»¬çš„ hashCode å¿…é¡»ç›¸åŒ==ã€‚
>
> 	```java
> 	/* If two objects are equal according to the {@code equals(Object)} method, then calling the {@code hashCode} method on each of the two objects must produce the same integer result.
> 	```
>
> 	æ‰€ä»¥==ä¸€èˆ¬ä¸¤ä¸ªæ–¹æ³•ä¼šä¸€åŒè¢«é‡å†™==ã€‚
>
> 	```java
> 	@Override
> 	public boolean equals(Object o) {
> 	    if (this == o) return true; // å…ˆåˆ¤æ–­å†…å­˜åœ°å€æ˜¯å¦ä¸€è‡´ï¼Œç›¸åŒåˆ™å¿…ç„¶ç›¸ç­‰
> 	    if (o == null || getClass() != o.getClass()) return false; // ç„¶åŽåˆ¤æ–­ä¸¤å¯¹è±¡çš„è¿è¡Œ
> 	    // æ—¶ç±»åž‹ï¼ˆgetClass( )æ–¹æ³•ï¼‰æ˜¯å¦ä¸Žè¯¥å¯¹è±¡ä¸€è‡´ï¼Œä¸ä¸€è‡´å°±è‚¯å®šä¸ç›¸ç­‰
> 	    ThisClass that = (ThisClass) o;
> 	    return field1 == that.field1 && // åŸºæœ¬æ•°æ®ç±»åž‹å­—æ®µç›´æŽ¥åˆ¤æ–­å€¼æ˜¯å¦ç›¸ç­‰
> 	        field2.equals(that.field2) && // å¼•ç”¨ç±»åž‹åˆ™è°ƒç”¨å…¶å„è‡ªçš„ equals æ–¹æ³•
> 	        field3.equals(that.field3); // field1 ä¸ºåŸºæœ¬ç±»åž‹ï¼Œ2ã€3ä¸ºå¼•ç”¨ç±»åž‹
> 	}
> 	
> 	@Override
> 	public int hashCode() { // åŒæ—¶é‡å†™ hashCode æ–¹æ³•
> 	    return Objects.hash(field1, field2, field3);
> 	}
> 	```
>
> 5.  toString  æ–¹æ³•ç”¨äºŽç”Ÿæˆä¸€ä¸ª String å­—ç¬¦ä¸²ä»¥æè¿°ä¸€ä¸ªå¯¹è±¡ã€‚==é»˜è®¤æƒ…å†µä¸‹ä¸º==
>
> 	```java
> 	object.getClass().getName() + "@" + Integer.toHexString(object.hashCode())
> 	```
>
> 	==å»ºè®®æ‰€æœ‰çš„ç±»éƒ½è‡ªè¡Œå®žçŽ° toString æ–¹æ³•==ï¼Œä»¥æ›´å‹å¥½çš„æ–¹å¼å‘Šè¯‰ç¨‹åºå‘˜æŸä¸ªå¯¹è±¡ã€‚
>
> 6. wait(æ— å‚/long/long, int) æ–¹æ³•ç”¨äºŽ==å°†æ­¤å¯¹è±¡ä¸Šçš„çº¿ç¨‹ç½®äºŽç­‰å¾…çŠ¶æ€==ï¼Œç›´åˆ°å®ƒè¢«å¦ä¸€ä¸ªçº¿ç¨‹ä»¥è¯¥å¯¹è±¡çš„ notify æ–¹æ³•æˆ– notifyAll() æ–¹æ³•å”¤é†’ã€‚
>
> 7. notify(), notifyAll() ç”¨äºŽ==å”¤é†’æŸä¸€å¯¹è±¡ä¸Šå¤„äºŽç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹==ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ notify() éšæœºæŒ‘é€‰ä¸€ä¸ªçº¿ç¨‹å”¤é†’ï¼Œè€Œå¦ä¸€ä¸ªåˆ™å”¤é†’å…¨éƒ¨çº¿ç¨‹ã€‚
>
> 8. finalize() æ–¹æ³•ç”¨äºŽåœ¨JVMåžƒåœ¾å›žæ”¶é˜¶æ®µï¼Œ==å½“ä¸€ä¸ªå¯¹è±¡å°†è¢«å›žæ”¶æ—¶ï¼Œä¼šå…ˆè°ƒç”¨å…¶ finalize() æ–¹æ³•==ï¼Œç›®çš„æ˜¯==å°è¯•è®©è¯¥å¯¹è±¡èŽ·å¾— GC Roots çš„å¼•ç”¨ä»¥é€ƒè¿‡è¿™æ¬¡å›žæ”¶==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - Object ç±»å¸¸è§çš„æ–¹æ³•æœ‰ toString( )ï¼Œequals( ) å’Œ hashCode( )ï¼Œwait( ) å’Œ notify( ) ç­‰ç­‰ã€‚ä¸‹é¢åˆ†åˆ«è¯´ä¸€ä¸‹ï¼š
> - ==toString( ) è¿”å›žçš„æ˜¯å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤º==ï¼Œ==é»˜è®¤ä¸º ã€Œclass å + @ + hashCode çš„åå…­è¿›åˆ¶è¡¨ç¤ºã€==ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šåœ¨å­ç±»å°†å®ƒé‡å†™ä¸ºæ‰“å°å„ä¸ªå­—æ®µçš„å€¼ï¼Œ==åœ¨è°ƒè¯•å’Œæ‰“æ—¥å¿—ä¸­ç”¨çš„å¤š==ã€‚
> - ==equals( ) å’Œ hashCode( ) é€šå¸¸ç”¨äºŽå¯¹è±¡ä¹‹é—´çš„æ¯”è¾ƒ==ã€‚å…¶ä¸­ equals( ) ç”¨äºŽåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ï¼Œ==é»˜è®¤ä½¿ç”¨ â€œ= =â€ åˆ¤æ–­==ï¼ŒhashCode( ) ç”¨äºŽèŽ·å–å¯¹è±¡çš„å“ˆå¸Œç ï¼Œ==é»˜è®¤ä»¥å¯¹è±¡çš„å†…å­˜åœ°å€ä¸ºå‚è€ƒ==ã€‚åœ¨å®žè·µä¸­ï¼Œ==ä¸ºäº†ä¿è¯å…ƒç´ åœ¨ HashMap å’Œ HashSet ç­‰é›†åˆä¸­çš„æ­£ç¡®å­˜å‚¨ï¼Œé€šå¸¸éœ€è¦å°†å®ƒä¿©ä¸€èµ·é‡å†™==ã€‚
> - wait( )ï¼Œnotify( ) ä»¥åŠ notifyAll( ) é€šå¸¸ç”¨äºŽ==çº¿ç¨‹é—´çš„åä½œå’ŒåŒæ­¥==ã€‚å…¶ä¸­ ==wait( ) ä½¿å½“å‰çº¿ç¨‹é‡Šæ”¾é”å¹¶è¿›å…¥ç­‰å¾…çŠ¶æ€==ï¼Œç›´è‡³è¢«å…¶å®ƒçº¿ç¨‹çš„ notify æˆ– notifyAll å”¤é†’ã€‚
> - notify( ) ä¼šåœ¨å¯¹è¯¥å¯¹è±¡è°ƒç”¨äº† wait( ) çš„çº¿ç¨‹ä¸­ï¼Œ==éšæœºæŒ‘é€‰ä¸€ä¸ªå”¤é†’ï¼Œè§£é™¤å…¶é˜»å¡žçŠ¶æ€==ã€‚è€Œ notifyAll( ) ä¼šå”¤é†’==æ‰€æœ‰==åœ¨è¯¥å¯¹è±¡ä¸Šç­‰å¾…çš„çº¿ç¨‹ã€‚==wait( ) æ­é… notify( ) å¯ä»¥å®žçŽ°ä¸€ä¸ªç®€å•çš„â€œç”Ÿäº§-æ¶ˆè´¹æ¨¡åž‹â€ï¼šç”Ÿäº§è€…çº¿ç¨‹äº§ç”Ÿæ¶ˆæ¯åŽï¼Œè°ƒç”¨ notify( ) å”¤é†’æ¶ˆè´¹è€…ã€‚æ¶ˆè´¹è€…è¢«å”¤é†’åŽæ¶ˆè´¹æ¶ˆæ¯ï¼Œæ¶ˆè´¹å®ŒæˆåŽè°ƒç”¨ wait( ) ç­‰å¾…==ã€‚
>

> å‚è€ƒç­”æ¡ˆé‡Œä¸¾äº†æ›´å¤šçš„ä¾‹å­ï¼Œä½¿å¾—å›žç­”æ›´å½¢è±¡å…·ä½“ï¼Œè®©é¢è¯•å®˜æ„Ÿè§‰ä½ æ˜¯çœŸçš„æ‡‚å¹¶ä¸”èƒ½å¤Ÿæ­£ç¡®è¿ç”¨ï¼Œè€Œä¸æ˜¯åªä¼šå¹²å·´å·´åœ°èƒŒè¯µã€‚

---



### 2.Javaä¸ºä»€ä¹ˆè¢«ç§°ä¸ºå¹³å°æ— å…³æ€§è¯­è¨€ï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==æˆ‘çš„å›žç­”==ï¼š

> 1. é¦–å…ˆæˆ‘æƒ³è¯´è¯´==ä»€ä¹ˆæ˜¯å¹³å°æ— å…³æ€§è¯­è¨€==ã€‚å¹³å°æ— å…³æ€§è¯­è¨€æ˜¯æŒ‡â€œ==ä¸€æ¬¡ç¼–è¯‘ï¼Œå¤„å¤„è¿è¡Œ(Write once, run anywhere)==â€çš„è¯­è¨€ï¼Œå¹³å°æ— å…³æ€§æ˜¯javaçš„è®¾è®¡è€…åœ¨è®¾è®¡javaæ—¶çš„ç¾Žå¥½æ„¿æ™¯ã€‚
> 2. Javaå®žçŽ°â€œä¸€æ¬¡ç¼–è¯‘ï¼Œå¤„å¤„è¿è¡Œâ€çš„æ–¹æ³•æ˜¯é€šè¿‡==javacç¼–è¯‘å™¨å°†Javaæºä»£ç ç¼–è¯‘ä¸ºçš„å­—èŠ‚ç ==ï¼Œè€Œ==ä¸åŒçš„æ“ä½œç³»ç»Ÿæœ‰ä¸åŒçš„JVM==ï¼Œ==JVMå°†åŒä¸€ä»½å­—èŠ‚ç ç¿»è¯‘ä¸ºå¯¹åº”æ“ä½œç³»ç»Ÿçš„æŒ‡ä»¤é›†==ï¼Œè¿™æ ·å°±è®©åŽŸæœ¬ä¸èƒ½è·¨å¹³å°çš„Javaæºä»£ç å®žçŽ°äº†å¹³å°æ— å…³æ€§ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - å¹³å°æ— å…³æ€§æ˜¯è¯´ï¼Œ==ä¸€ç§è¯­è¨€åœ¨ä¸€å°è®¡ç®—æœºä¸Šçš„è¿è¡Œä¸å—å¹³å°çš„é™åˆ¶ï¼Œä¸€æ¬¡ç¼–è¯‘ï¼Œåˆ°å¤„è¿è¡Œ==ã€‚
> - Java è¯­è¨€å…·æœ‰å¹³å°æ— å…³æ€§çš„å…³é”®åœ¨äºŽ JVMã€‚è™½ç„¶==ä¸åŒçš„æ“ä½œç³»ç»Ÿä½¿ç”¨ä¸åŒçš„æœºå™¨æŒ‡ä»¤é›†æ¥æ‰§è¡Œä»»åŠ¡ï¼ŒåŒä¸€ä»½ä»£ç åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸Šå¯èƒ½æ— æ³•ç›´æŽ¥æ‰§è¡Œ==ï¼Œä½†æ˜¯ Java æºæ–‡ä»¶ç»è¿‡ ==javac ç¼–è¯‘å™¨ç¼–è¯‘åŽå½¢æˆçš„äºŒè¿›åˆ¶å­—èŠ‚ç ï¼Œå¯ä»¥è¢«å„ä¸ªæ“ä½œç³»ç»Ÿçš„ JVM ç¿»è¯‘æˆè¯¥æ“ä½œç³»ç»Ÿæ‰€éœ€çš„æŒ‡ä»¤é›†==ï¼Œè¿›è€Œæ‰§è¡Œã€‚è¿™å¯ä»¥æé«˜ Java ç¨‹åºçš„å¯ç§»æ¤æ€§ï¼Œå› ä¸º==åªéœ€é’ˆå¯¹ä¸åŒæ“ä½œç³»ç»Ÿæä¾›å¯¹åº”çš„ JVM å³å¯ï¼Œæ— éœ€ä¿®æ”¹æºä»£ç ==ã€‚
>

---



### 3.= =å’Œequalsæœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==æˆ‘çš„å›žç­”==ï¼š

> 1. === =æ˜¯ä¸€ä¸ªæ“ä½œç¬¦==ï¼Œå¯ä»¥æ¯”è¾ƒ==åŸºæœ¬æ•°æ®ç±»åž‹==ä¹‹é—´å’Œ==å¼•ç”¨æ•°æ®ç±»åž‹==ä¹‹é—´æ˜¯å¦ç›¸ç­‰ã€‚è€Œ ==equals æ˜¯ Object ç±»çš„ä¸€ä¸ªæ–¹æ³•==ï¼Œ==åªèƒ½æ¯”è¾ƒä¸¤ä¸ªå¼•ç”¨æ•°æ®ç±»åž‹==æ˜¯å¦ç›¸ç­‰ã€‚
>
> 2. å…·ä½“åœ°è¯´ï¼Œ==æ¯”è¾ƒåŸºæœ¬æ•°æ®ç±»åž‹æ—¶ï¼Œå°±ç›´æŽ¥æ¯”è¾ƒå€¼æ˜¯å¦ç›¸ç­‰==ã€‚æ¯”å¦‚intå°±æ¯”è¾ƒæ•´åž‹å€¼æ˜¯å¦ç›¸ç­‰ï¼Œbooleanå°±æ¯”è¾ƒå¸ƒå°”å€¼ã€‚è€Œ==æ¯”è¾ƒå¼•ç”¨æ•°æ®ç±»åž‹æ—¶ï¼Œåˆ™æ¯”è¾ƒå¯¹è±¡çš„å†…å­˜åœ°å€æ˜¯å¦ä¸€è‡´==ã€‚
>
> 3. è€Œ ==equals æ–¹æ³•åœ¨ Object æ–¹æ³•ä¸­å°±æ˜¯ä½¿ç”¨ == æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰==ï¼š
>
> 	```java
> 	public boolean equals(Object obj) {
> 	    return (this == obj);
> 	}
> 	```
>
> 	ä½†æ˜¯==æˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸åŒå¯¹è±¡çš„æ„ä¹‰é‡å†™æ­¤æ–¹æ³•==ï¼Œä»¥è‡ªå®šä¹‰çš„æ–¹å¼åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚æ¯”å¦‚ String ç±»å°±é‡å†™äº† equals æ–¹æ³•ï¼Œä¼˜å…ˆåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„å†…å­˜åœ°å€å’Œè¿è¡Œæ—¶ç±»åž‹æ˜¯å¦ä¸€è‡´ï¼Œç„¶åŽä»¥æ¯”è¾ƒå­—ç¬¦ä¸²çš„æ–¹æ³•åˆ¤æ–­ä¸¤ä¸ª String å¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚==ç”±äºŽè¦æ±‚ equals ä¸º true çš„ä¸¤ä¸ªå¯¹è±¡çš„ hashCode ä¹Ÿå¿…é¡»ç›¸åŒï¼Œå› æ­¤ä¸€èˆ¬è¯¥æ–¹æ³•çš„é‡å†™ä¼šä¼´éšç€ hashCode æ–¹æ³•çš„é‡å†™==ã€‚
>
> 	```java
> 	@Override
> 	public boolean equals(Object o) {
> 	    if (this == o) return true; // å…ˆåˆ¤æ–­å†…å­˜åœ°å€æ˜¯å¦ä¸€è‡´ï¼Œç›¸åŒåˆ™å¿…ç„¶ç›¸ç­‰
> 	    if (o == null || getClass() != o.getClass()) return false; // ç„¶åŽåˆ¤æ–­ä¸¤å¯¹è±¡çš„è¿è¡Œ
> 	    // æ—¶ç±»åž‹ï¼ˆgetClass( )æ–¹æ³•ï¼‰æ˜¯å¦ä¸Žè¯¥å¯¹è±¡ä¸€è‡´ï¼Œä¸ä¸€è‡´å°±è‚¯å®šä¸ç›¸ç­‰
> 	    ThisClass that = (ThisClass) o;
> 	    return field1 == that.field1 && // åŸºæœ¬æ•°æ®ç±»åž‹å­—æ®µç›´æŽ¥åˆ¤æ–­å€¼æ˜¯å¦ç›¸ç­‰
> 	        field2.equals(that.field2) && // å¼•ç”¨ç±»åž‹åˆ™è°ƒç”¨å…¶å„è‡ªçš„ equals æ–¹æ³•
> 	        field3.equals(that.field3); // field1 ä¸ºåŸºæœ¬ç±»åž‹ï¼Œ2ã€3ä¸ºå¼•ç”¨ç±»åž‹
> 	}
> 			
> 	@Override
> 	public int hashCode() { // åŒæ—¶é‡å†™ hashCode æ–¹æ³•
> 	    return Objects.hash(field1, field2, field3);
> 	}
> 	```
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - é¦–å…ˆ === = æ˜¯ä¸€ä¸ªæ“ä½œç¬¦== ï¼Œ==equals æ˜¯è¶…ç±» Object ä¸­çš„æ–¹æ³•==ï¼Œ==é»˜è®¤==æ˜¯ç”¨ = = æ¥æ¯”è¾ƒçš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºŽæ²¡æœ‰é‡å†™ equals æ–¹æ³•çš„å­ç±»ï¼Œequals å’Œ = = æ˜¯ä¸€æ ·çš„ã€‚
> - è€Œ = = åœ¨æ¯”è¾ƒæ—¶ï¼Œæ ¹æ®æ‰€æ¯”è¾ƒçš„ç±»çš„ç±»åž‹ä¸åŒï¼ŒåŠŸèƒ½ä¹Ÿæœ‰æ‰€ä¸åŒï¼šå¯¹äºŽ==åŸºç¡€æ•°æ®ç±»åž‹==ï¼Œå¦‚ int ç±»åž‹ç­‰ï¼Œ==æ¯”è¾ƒçš„æ˜¯å…·ä½“çš„å€¼==ï¼›è€Œå¯¹äºŽ==å¼•ç”¨æ•°æ®ç±»åž‹==ï¼Œæ¯”è¾ƒçš„æ˜¯==å¼•ç”¨çš„åœ°å€==æ˜¯å¦ç›¸åŒã€‚
> - å¯¹äºŽé‡å†™çš„ equals æ–¹æ³•ï¼Œæ¯”çš„å†…å®¹==å–å†³äºŽè¿™ä¸ªæ–¹æ³•çš„å®žçŽ°==ã€‚
>

---



### 4.è®²ä¸€ä¸‹equals()ä¸Žhashcode()ï¼Œä»€ä¹ˆæ—¶å€™é‡å†™ï¼Œä¸ºä»€ä¹ˆé‡å†™ï¼Œæ€Žä¹ˆé‡å†™ï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==æˆ‘çš„å›žç­”==ï¼š

> 1. é¦–å…ˆæˆ‘æƒ³è¯´è¯´ equals å’Œ hashCode æ–¹æ³•ã€‚å®ƒä»¬éƒ½æ˜¯ Object ç±»çš„æ–¹æ³•ã€‚åœ¨==é»˜è®¤æƒ…å†µä¸‹ï¼Œequals æ–¹æ³•é‡‡ç”¨ == æ“ä½œç¬¦æ¯”è¾ƒå¼•ç”¨ç±»åž‹çš„å†…å­˜åœ°å€==ï¼Œè€Œ ==hashCode æ–¹æ³•é»˜è®¤æƒ…å†µä¸‹æ ¹æ®å†…å­˜åœ°å€è¿”å›žå“ˆå¸Œå€¼==ã€‚
>
> 2. ç”±äºŽ equals æ–¹æ³•é»˜è®¤åªèƒ½æ¯”è¾ƒå¼•ç”¨ç±»åž‹çš„å†…å­˜åœ°å€ï¼Œè€Œ==åœ¨ä¸šåŠ¡ä¸­æˆ‘ä»¬å¸¸å¸¸æœ‰è‡ªå·±åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰çš„é€»è¾‘==ï¼Œæ¯”å¦‚ä¸€ä¸ª Person ç±»æœ‰ name å’Œ identity ä¸¤ä¸ªå­—æ®µï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºè¿™ä¸¤ä¸ªå­—æ®µéƒ½ç›¸åŒçš„ Person å®žä¾‹å¯¹è±¡ç›¸ç­‰ï¼ŒäºŽæ˜¯å°±å¯ä»¥é‡å†™ Person ç±»çš„ equals æ–¹æ³•ã€‚
>
> 3. ç”±äºŽæœ‰==è§„å®šï¼šå¦‚æžœä¸¤ä¸ªå¯¹è±¡ä½¿ç”¨ equals æ–¹æ³•ç›¸åŒï¼Œé‚£ä¹ˆå®ƒä»¬çš„ hashCode ä¹Ÿå¿…é¡»ç›¸åŒ==ã€‚å› æ­¤ ==equals æ–¹æ³•çš„é‡å†™ä¸€èˆ¬ä¹Ÿä¼´éšç€ hashCode æ–¹æ³•çš„é‡å†™==ã€‚
>
> 4. è‡³äºŽé‡å†™çš„æ–¹æ³•ï¼Œè¿˜æ˜¯ä»¥ä¸Šè¿°çš„ Person ç±»ä¸ºä¾‹ï¼Œé‡å†™ equals æ–¹æ³•æ—¶ï¼Œå¯ä»¥==å…ˆåˆ¤æ–­å†…å­˜åœ°å€æ˜¯å¦ä¸€è‡´==ï¼Œç›¸åŒåˆ™å¿…ç„¶ç›¸ç­‰ï¼Œç„¶åŽ==åˆ¤æ–­ä¸¤å¯¹è±¡çš„è¿è¡Œæ—¶ç±»åž‹ï¼ˆgetClass( )æ–¹æ³•ï¼‰æ˜¯å¦ä¸Žè¯¥å¯¹è±¡ä¸€è‡´==ï¼Œä¸ä¸€è‡´å°±è‚¯å®šä¸ç›¸ç­‰ï¼Œæœ€åŽå¯¹äºŽ==åŸºæœ¬æ•°æ®ç±»åž‹å­—æ®µç›´æŽ¥åˆ¤æ–­å€¼==æ˜¯å¦ç›¸ç­‰ï¼Œè€Œ==å¼•ç”¨ç±»åž‹åˆ™è°ƒç”¨å…¶å„è‡ªçš„ equals æ–¹æ³•==ã€‚
>
> 	```java
> 	@Override
> 	public boolean equals(Object o) {
> 	    if (this == o) return true; // å…ˆåˆ¤æ–­å†…å­˜åœ°å€æ˜¯å¦ä¸€è‡´ï¼Œç›¸åŒåˆ™å¿…ç„¶ç›¸ç­‰
> 	    if (o == null || getClass() != o.getClass()) return false; // ç„¶åŽåˆ¤æ–­ä¸¤å¯¹è±¡çš„è¿è¡Œ
> 	    // æ—¶ç±»åž‹ï¼ˆgetClass( )æ–¹æ³•ï¼‰æ˜¯å¦ä¸Žè¯¥å¯¹è±¡ä¸€è‡´ï¼Œä¸ä¸€è‡´å°±è‚¯å®šä¸ç›¸ç­‰
> 	    ThisClass that = (ThisClass) o;
> 	    return field1 == that.field1 && // åŸºæœ¬æ•°æ®ç±»åž‹å­—æ®µç›´æŽ¥åˆ¤æ–­å€¼æ˜¯å¦ç›¸ç­‰
> 	        field2.equals(that.field2) && // å¼•ç”¨ç±»åž‹åˆ™è°ƒç”¨å…¶å„è‡ªçš„ equals æ–¹æ³•
> 	        field3.equals(that.field3); // field1 ä¸ºåŸºæœ¬ç±»åž‹ï¼Œ2ã€3ä¸ºå¼•ç”¨ç±»åž‹
> 	}
> 	```
>
> 5. é‡å†™ hashCode æ–¹æ³•å¯ä»¥ä½¿ç”¨==å·¥å…·ç±» Objects çš„ hash æ–¹æ³•==æ ¹æ®æ‰€æœ‰æŒ‡å®šå­—æ®µè¿”å›žä¸€ä¸ªå“ˆå¸Œå€¼ã€‚
>
> 	```java
> 	@Override
> 	public int hashCode() { // åŒæ—¶é‡å†™ hashCode æ–¹æ³•
> 	    return Objects.hash(field1, field2, field3);
> 	}
> 	```
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - é¦–å…ˆ equals( ) æ˜¯ Object ä¸­çš„æ–¹æ³•ï¼Œé»˜è®¤æ˜¯ç”¨ = = æ¥æ¯”è¾ƒçš„ã€‚hashCode( ) ä¹Ÿæ˜¯ Object ç±»çš„æ–¹æ³•ï¼Œæ ¹æ®ä¸€å®šçš„è§„åˆ™å°†ä¸Žå¯¹è±¡ç›¸å…³çš„ä¿¡æ¯ï¼Œæ¯”å¦‚å¯¹è±¡çš„å†…å­˜åœ°å€ï¼Œæ˜ å°„æˆä¸€ä¸ªæ•°å€¼ï¼Œè¿™ä¸ªæ•°å€¼ç§°ä½œä¸ºå“ˆå¸Œå€¼ã€‚
> - æœ‰æ—¶å€™æˆ‘ä»¬æƒ³è¦==è‡ªå®šä¹‰ç±»çš„æ¯”è¾ƒè§„åˆ™æ—¶ï¼Œéœ€è¦é‡å†™ equals( )==ï¼Œä½†æ˜¯ä¸ºäº†==ä¿è¯ç±»åœ¨ HashSet å’Œ HashMap ç­‰é›†åˆä¸­çš„æ­£ç¡®å­˜å‚¨ï¼Œä¹Ÿè¦åŒæ—¶é‡å†™ hashCode( )== ã€‚
> - ä»¥ HashMap ä¸ºä¾‹ï¼Œ ==HashMapåº•å±‚åœ¨æ·»åŠ ç›¸åŒçš„å…ƒç´ æ—¶ï¼Œä¼šå…ˆè°ƒç”¨ä¸¤ä¸ªå¯¹è±¡çš„ hashCode( ) æ˜¯å¦ç›¸åŒï¼Œå¦‚æžœç›¸åŒè¿˜ä¼šå†ç”¨ equals( ) æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸åŒ==ã€‚
> - å‡è®¾æœ‰ä¸€ä¸ª Person ç±»ï¼Œæœ‰ name å’Œ age ä¸¤ä¸ªå­—æ®µï¼Œæˆ‘ä»¬çŽ°åœ¨é‡å†™ equals( ) è§„å®šåªæœ‰ä¸¤ä¸ª Person çš„ name å’Œ age éƒ½ç›¸åŒæ—¶ï¼Œæ‰è®¤ä¸ºä¸¤ä¸ª Person ç›¸ç­‰ã€‚çŽ°åœ¨ new å‡ºä¸¤ä¸ª name å’Œ age éƒ½ç›¸åŒçš„ Personï¼Œåˆ†åˆ«æ·»åŠ åˆ° HashMap ä¸­ã€‚
> - ==æˆ‘ä»¬æœŸæœ›æœ€åŽ HashMap ä¸­åªæœ‰ä¸€ä¸ª Personï¼Œä½†å…¶å®žæ˜¯æœ‰ä¸¤ä¸ª==ã€‚åŽŸå› åœ¨äºŽæ·»åŠ ç¬¬äºŒä¸ª Person æ—¶ï¼Œå…ˆæ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ª Person çš„ hashCode( )ï¼Œæ³¨æ„æ­¤æ—¶æˆ‘ä»¬==æ²¡æœ‰é‡å†™ hashCode( ) ==ï¼Œé‚£ä¹ˆåˆ†åˆ« new å‡ºæ¥çš„ Person çš„å“ˆå¸Œå€¼è‚¯å®šæ˜¯ä¸åŒçš„ï¼Œåˆ°è¿™é‡Œ HashMap å°±ä¼šå°†ä¸¤ä¸ª Person è®¤å®šä¸ºä¸åŒçš„å…ƒç´ æ·»åŠ è¿›åŽ»ã€‚
> - è§£å†³çš„åŠžæ³•å°±æ˜¯é‡å†™ hashCode( )ï¼Œæœ€ç®€å•çš„è¿”å›ž name å’Œ age çš„å“ˆå¸Œå€¼çš„ä¹˜ç§¯å³å¯ã€‚
>

---



### 5.è®²ä¸€ä¸‹é‡è½½å’Œé‡å†™çš„åŒºåˆ«ï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==é‡è½½==æ˜¯æŒ‡åœ¨ä¸€ä¸ªç±»ä¸­ï¼Œå¯ä»¥==å®šä¹‰å¤šä¸ªæ–¹æ³•åç›¸åŒçš„æ–¹æ³•==ï¼Œå®ƒä»¬çš„å‚æ•°ä¸ªæ•°æˆ–ç±»åž‹å¿…é¡»ä¸åŒï¼Œè€Œ==è¿”å›žç±»åž‹å¯¹æ–¹æ³•æ˜¯å¦æž„æˆé‡è½½æ²¡æœ‰å½±å“==ï¼Œæ¯”å¦‚ä¸€ä¸ªæ–¹æ³•å¦‚æžœåªæœ‰è¿”å›žç±»åž‹å’Œå¦ä¸€ä¸ªç±»ä¸­çš„æ–¹æ³•ä¸åŒï¼Œä¸æž„æˆé‡è½½ã€‚
> 2. ==é‡å†™==æ˜¯æŒ‡å­ç±»æŸä¸ªæ–¹æ³•==è¦†ç›–äº†==å…¶çˆ¶ç±»æˆ–å®žçŽ°çš„æŽ¥å£ä¸­çš„æŸä¸ªæ–¹æ³•ã€‚è¿™ä¸¤ä¸ªæ–¹æ³•å¿…é¡»æ–¹æ³•åï¼Œå‚æ•°å®Œå…¨ç›¸åŒï¼Œ==è¿”å›žç±»åž‹ç›¸åŒæˆ–å­ç±»è¿”å›žç±»åž‹ä¸ºçˆ¶ç±»è¿”å›žç±»åž‹çš„å­ç±»==ã€‚
> 3. åŒæ—¶ï¼Œ==å­ç±»é‡å†™çš„æ–¹æ³•ä¸èƒ½ç¼©å°çˆ¶ç±»æ–¹æ³•çš„è®¿é—®èŒƒå›´==ã€‚æ¯”å¦‚å¦‚æžœçˆ¶ç±»æ–¹æ³•æ˜¯ publicï¼Œé‚£ä¹ˆå­ç±»æ–¹æ³•å°±åªèƒ½æ˜¯ publicï¼Œè€Œä¸èƒ½æ˜¯ protected æˆ– privateï¼Œå› ä¸ºè¿™ä¼šç¼©å°çˆ¶ç±»æ–¹æ³•çš„è®¿é—®èŒƒå›´ï¼Œå¦‚æžœä¸åŒåŒ…ä¸‹çš„ä¸€ä¸ªç±»å¯ä»¥è°ƒç”¨çˆ¶ç±»æŽ¥å£ï¼Œä½†æ˜¯==å¦‚æžœçˆ¶ç±»çš„è¿è¡Œæ—¶ç±»åž‹æ˜¯å­ç±»ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºçŽ°æ²¡æœ‰å­ç±»è®¿é—®æƒé™çš„é—®é¢˜==ã€‚
> 4. æ­¤å¤–ï¼Œ==å­ç±»è¿˜ä¸èƒ½é‡å†™çˆ¶ç±»çš„ static å’Œ private æ–¹æ³•==ã€‚å¯¹äºŽ static æ–¹æ³•ï¼Œå› ä¸º==æ–¹æ³•è¦†ç›–æ˜¯åŸºäºŽè¿è¡Œæ—¶åŠ¨æ€ç»‘å®šçš„ï¼Œè€Œ static æ–¹æ³•æ˜¯ç¼–è¯‘æ—¶é™æ€ç»‘å®šçš„==ã€‚==static æ–¹æ³•è·Ÿç±»çš„ä»»ä½•å®žä¾‹éƒ½ä¸ç›¸å…³==ã€‚
> 5. è€Œè¢« ==private ä¿®é¥°çš„æ–¹æ³•åªèƒ½åœ¨æœ¬ç±»ä¸­è¢«è°ƒç”¨==ï¼Œå› æ­¤==å­ç±»æ— æ³•è®¿é—®çˆ¶ç±»çš„ private æ–¹æ³•==ï¼Œè‡ªç„¶ä¸èƒ½é‡å†™ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - é‡è½½æ˜¯æŒ‡åœ¨åŒä¸€ä¸ªç±»ä¸­å®šä¹‰å¤šä¸ªæ–¹æ³•ï¼Œå®ƒä»¬å…·æœ‰ç›¸åŒçš„å‡½æ•°åï¼Œä½†å‚æ•°çš„ç±»åž‹ï¼Œä¸ªæ•°å’Œé¡ºåºå¯èƒ½ä¸åŒã€‚å®ƒæä¾›äº†ä¸€ç§çµæ´»çš„æ–¹å¼æ¥å®žçŽ°ç›¸ä¼¼çš„åŠŸèƒ½ã€‚
> - é‡å†™æ˜¯æŒ‡åœ¨å­ç±»ä¸­é‡æ–°å®šä¹‰å¹¶è¦†ç›–çˆ¶ç±»ä¸­çš„æ–¹æ³•ã€‚å®ƒä½¿å­ç±»å¯ä»¥æ ¹æ®å…·ä½“çš„ç±»åž‹è°ƒç”¨ç›¸åº”çš„æ–¹æ³•å®žçŽ°ã€‚
> - åœ¨ JVM ä¸­ï¼Œ==æ–¹æ³•é‡è½½å¯¹åº” â€œé™æ€åˆ†é…â€ çš„è¿‡ç¨‹==ï¼Œä¹Ÿå°±æ˜¯ ==JVM åœ¨ç¼–è¯‘æœŸå°±æ ¹æ®å‚æ•°(é‡è½½æ–¹æ³•çš„å‚æ•°)çš„é™æ€ç±»åž‹ï¼Œå†³å®šäº†ä¼šä½¿ç”¨æ–¹æ³•çš„å“ªä¸ªé‡è½½ç‰ˆæœ¬==ã€‚è€Œ==æ–¹æ³•é‡å†™å¯¹åº” â€œåŠ¨æ€åˆ†é…â€ çš„è¿‡ç¨‹==ï¼Œå…·ä½“çš„ï¼Œé‡å†™æ–¹æ³•çš„è°ƒç”¨æ˜¯ç”±å­—èŠ‚ç ä¸­çš„ invokevirtual æŒ‡ä»¤å®žçŽ°çš„ï¼Œè€Œ ==invokevirtual æŒ‡ä»¤ä¼šåœ¨è¿è¡Œ(Runtime)æœŸé—´ï¼Œæ ¹æ®æ–¹æ³•æŽ¥å—è€…çš„å®žé™…ç±»åž‹æ¥é€‰æ‹©æ–¹æ³•çš„æ‰§è¡Œç‰ˆæœ¬==ã€‚
>

---



### 6.æŠ½è±¡å’ŒæŽ¥å£çš„åŒºåˆ«ï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==æˆ‘çš„å›žç­”==ï¼š

> 1. æŠ½è±¡å…³é”®å­— ==abstract å¯ä»¥ä½œç”¨äºŽç±»æˆ–æ–¹æ³•==ã€‚è¢« abstract ä¿®é¥°çš„æ–¹æ³•æ²¡æœ‰æ–¹æ³•ä½“ï¼Œå…¶æ–¹æ³•ä½“ç”±å­ç±»è‡ªè¡Œå®žçŽ°ï¼Œå› æ­¤==å¦‚æžœä¸€ä¸ªç±»å­˜åœ¨ abstract æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒä¹Ÿå¿…å®šæ˜¯æŠ½è±¡ç±»==ï¼Œä¸”==ä¸èƒ½ new åˆ›å»ºå®žä¾‹==ï¼ˆå› ä¸ºå…¶æŠ½è±¡æ–¹æ³•æ²¡æœ‰æ–¹æ³•ä½“ï¼‰ã€‚ä½†æ˜¯==æŠ½è±¡ç±»æœ¬è´¨ä¸Šè¿˜æ˜¯ä¸€ä¸ªç±»(Class)==ï¼Œå®ƒä¾ç„¶==å¯ä»¥æœ‰æˆå‘˜å˜é‡ï¼Œæž„é€ å™¨ï¼Œé™æ€ä»£ç å—ï¼Œå¹¶å¯ä»¥ç»§æ‰¿è‡ªæˆ–å®žçŽ°å…¶å®ƒç±»==ã€‚
> 2. æŽ¥å£å…³é”®å­— ==interface åªèƒ½ä½œç”¨äºŽç±»==ã€‚åœ¨ ==jdk7 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ï¼Œinterface ä¸‹çš„æ‰€æœ‰æ–¹æ³•éƒ½é»˜è®¤ä¸º public abstract== ç±»åž‹ã€‚è€Œåœ¨ ==jdk8 åŠä¹‹åŽçš„ç‰ˆæœ¬ä¸­==ï¼Œ==interface å…è®¸æ‹¥æœ‰è¢« static æˆ– default ä¿®é¥°çš„æ–¹æ³•==ã€‚å…¶ä¸­==æŽ¥å£ç±»ä¸­çš„ static æ–¹æ³•åªèƒ½è¢«æœ¬æŽ¥å£è°ƒç”¨==ã€‚è€Œ==è¢« default ä¿®é¥°çš„æ–¹æ³•å…è®¸åœ¨æŽ¥å£ç±»ä¸­å®šä¹‰é»˜è®¤çš„æ–¹æ³•ä½“ï¼Œå³å®ƒçš„å®žçŽ°ç±»å¯ä»¥é€‰æ‹©æ€§åœ°é‡å†™è¢« default ä¿®é¥°çš„æ–¹æ³•==ï¼Œè¿™ä¸€ç‚¹å’Œç»§æ‰¿å¾ˆç±»ä¼¼ï¼Œåœ¨æˆ‘çœ‹æ¥æŽ¥å£ä¸­ default æ–¹æ³•è®¾è®¡çš„åˆè¡·æ˜¯å¯¹ java å•ç»§æ‰¿æœºåˆ¶çš„ä¸€ä¸ªè¡¥å……ï¼Œå®žé™…ä¸Š==æŽ¥å£æœ¬èº«å°±æ˜¯å¯¹ java å•ç»§æ‰¿æœºåˆ¶çš„è¡¥å……==ï¼Œåªä¸è¿‡è¢« default ä¿®é¥°çš„æ–¹æ³•ä¸Žç»§æ‰¿å…³ç³»ä¸­å­ç±»é‡å†™çˆ¶ç±»æ–¹æ³•çš„è¡Œä¸ºé€»è¾‘æ›´ç›¸ä¼¼ã€‚==æŽ¥å£ç±»ä¸­å…è®¸å­˜åœ¨å­—æ®µï¼Œä½†æ˜¯æ‰€æœ‰çš„å­—æ®µéƒ½é»˜è®¤ä¸º public static final== ç±»åž‹ï¼Œå› æ­¤å¯¹äºŽä¸€ä¸ªé¡¹ç›®ä¸­çš„å¸¸é‡ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒä»¬æ”¾åˆ°ä¸€ä¸ªæŽ¥å£ç±»ä¸­ï¼Œç„¶åŽæ‰€æœ‰éœ€è¦ä½¿ç”¨è¿™äº›å¸¸é‡çš„å…¶å®ƒç±»åªéœ€å®žçŽ°è¿™ä¸ªæŽ¥å£å³å¯å®‰å…¨çš„ä½¿ç”¨è¿™äº›å¸¸é‡ã€‚æŽ¥å£ç±»åŒæ ·ä¸èƒ½åˆ›å»ºå®žä¾‹ï¼Œå’ŒæŠ½è±¡ç±»ä¸åŒçš„æ˜¯ï¼Œ==æŽ¥å£ç±»ä¸èƒ½æœ‰æž„é€ å™¨å’Œé™æ€ä»£ç å—==ï¼Œå¹¶ä¸”==åªèƒ½å®žçŽ°å…¶å®ƒæŽ¥å£è€Œä¸èƒ½ç»§æ‰¿å…¶å®ƒç±»==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - æŠ½è±¡åœ¨ Java ä¸­æ˜¯æŒ‡è¢« abstract ä¿®é¥°çš„ç±»æˆ–æ–¹æ³•ï¼ŒæŽ¥å£æ˜¯æŒ‡è¢« interface ä¿®é¥°çš„ç±»ã€‚æŽ¥å£ä¸­å£°æ˜Žçš„æ–¹æ³•ï¼Œé»˜è®¤ä¹Ÿè¢«å®šä¹‰ä¸º abstract ã€‚
> - ==æŠ½è±¡ä¸»è¦æ˜¯ä¸ºäº†ä»£ç å¤ç”¨==ã€‚æ¯”å¦‚ä¸€äº›ç±»æ‹¥æœ‰ä¸€äº›é€šç”¨çš„åŠŸèƒ½ï¼Œä¸ºäº†ä¸åœ¨æ¯ä¸€ç±»ä¸­é‡æ–°å†™ä¸€éè¿™ä¸ªæ–¹æ³•çš„ä»£ç ï¼Œå°±å¯ä»¥å®šä¹‰ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œè¿™æ ·ä¸€æ¥ï¼Œåªéœ€è®©æ¯ä¸€ä¸ªç±»ç»§æ‰¿æŠ½è±¡ç±»å°±å¯ä»¥äº†ï¼Œå¦‚æžœåŽæœŸéœ€è¦ä¿®æ”¹æ–¹æ³•ï¼Œåªéœ€è¦ä¿®æ”¹æŠ½è±¡ç±»ä¸­çš„æ–¹æ³•å°±è¡Œï¼Œå¦‚æžœå­ç±»æƒ³è¦è‡ªå·±å®žçŽ°ä¸ä¸€æ ·çš„è¡Œä¸ºï¼Œåªéœ€å­ç±»é‡å†™æŠ½è±¡ç±»çš„æ–¹æ³•ã€‚
> - è¿™æ ·ä¸€æ¥ï¼Œæ™®é€šç±»å°±å¯ä»¥å®Œæˆè¿™ä¸ªå·¥ä½œï¼Œä¸ºä»€ä¹ˆéœ€è¦æŠ½è±¡ç±»ï¼Œ==æŠ½è±¡ç±»è¿˜èµ·äº†ä¸€ä¸ªé™åˆ¶ä½œç”¨==ï¼Œæ¯”å¦‚è¦æ±‚æ¯ä¸€ä¸ªå­ç±»å¿…é¡»è‡ªå·±ç‹¬ç‰¹å®žçŽ°çš„ä¸€ä¸ªæ–¹æ³•ï¼Œä¹Ÿæ˜¯æŠ½è±¡ç±»å®šä¹‰çš„æŠ½è±¡æ–¹æ³•ã€‚
> - ç¼ºç‚¹ä¹Ÿå¾ˆæ˜Žæ˜¾ï¼Œå› ä¸ºJavaæ²¡æœ‰å¤šç»§æ‰¿ï¼Œå¯¼è‡´ä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»ã€‚åœ¨è¡¨ç¤ºæ˜¯ä»€ä¹ˆçš„å…³ç³»æ—¶ï¼Œä¸€èˆ¬ä½¿ç”¨æŠ½è±¡ç±»ã€‚
> - ==æŽ¥å£æ›´å¤šçš„æ˜¯ä¸ºäº†è§£è€¦==ã€‚æ¯”å¦‚==æˆ‘éœ€è¦åˆ¶å®šä¸€å¥—æ–¹æ³•çš„è§„èŒƒï¼Œå°±å¯ä»¥å°†è¿™å¥—æ–¹æ³•è§„èŒƒæŠ½è±¡ä¸ºä¸€ä¸ªæŽ¥å£==ã€‚æ¯ä¸€ä¸ªç»§æ‰¿è¿™ä¸ªæŽ¥å£çš„ç±»éƒ½å¿…é¡»å®žçŽ°æŽ¥å£ä¸­æ‰€æœ‰çš„æ–¹æ³•ã€‚åœ¨è¡¨ç¤ºæœ‰ä»€ä¹ˆçš„å…³ç³»æ—¶ï¼Œä½¿ç”¨æŽ¥å£ã€‚
>

---



### 7.è°ˆä¸€è°ˆä½ å¯¹ final å…³é”®å­—çš„ç†è§£ï¼Ÿä»€ä¹ˆéœ€è¦ç”¨è¿™ä¸ªå…³é”®å­—æ¥å®šä¹‰å‘¢ï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==æˆ‘çš„å›žç­”==ï¼š

> 1. final å…³é”®å­—å¯ä»¥ä¿®é¥°ç±»ï¼Œæ–¹æ³•ï¼Œæˆå‘˜å˜é‡ä»¥åŠå±€éƒ¨å˜é‡ã€‚
> 2. å½“ä¿®é¥°ç±»æ—¶ï¼Œè¯¥ç±»æ— æ³•è¢«ç»§æ‰¿ã€‚==æ¯”å¦‚åŸºæœ¬ç±»åž‹çš„åŒ…è£…ç±»ä»¥åŠ String éƒ½è¢« final ä¿®é¥°ï¼Œå®ƒä»¬ä¸èƒ½è¢«ç»§æ‰¿ï¼Œå› æ­¤åœ¨å®žé™…çš„ä¸šåŠ¡ä¸­æˆ‘ä»¬ä¸ç”¨æ‹…å¿ƒåœ¨è°ƒç”¨è¿™äº›ç±»çš„æ–¹æ³•æ—¶ä¼šåŠ¨æ€ç»‘å®šåˆ°å…¶å®ƒç±»==ï¼Œå› ä¸ºå®ƒä»¬ä¸èƒ½è¢«ç»§æ‰¿ï¼Œä¹Ÿå°±æ²¡æœ‰å­ç±»äº†ï¼Œå› æ­¤==æˆ‘ä»¬å¯ä»¥æŠŠä¸šåŠ¡ä¸­çš„æ ¸å¿ƒç±»è®¾ç½®ä¸º finalï¼Œä»¥æé«˜å®‰å…¨æ€§==ã€‚
> 3. å½“ä¿®é¥°æ–¹æ³•æ—¶ï¼Œè¡¨ç¤ºè¯¥æ–¹æ³•ä¸èƒ½è¢«å­ç±»é‡å†™ã€‚ç±»ä¼¼çš„ï¼Œ==æŠŠæ ¸å¿ƒ api è®¾ç½®ä¸º finalï¼Œé¿å…è¿è¡Œæ—¶åŠ¨æ€ç»‘å®š==ã€‚
> 4. ä¿®é¥°æˆå‘˜å˜é‡æ—¶ï¼Œè¯¥æˆå‘˜å˜é‡æ— æ³•è¢«ä¿®æ”¹ï¼Œå› æ­¤==å¿…é¡»èµ‹åˆå€¼==ã€‚å½“æˆå‘˜å˜é‡ä¸æ˜¯ static æ—¶ï¼Œå¯ä»¥åœ¨==åˆå§‹åŒ–ï¼Œæž„é€ å™¨æˆ–æ™®é€šä»£ç å—==ä¸­è¿›è¡Œèµ‹åˆå€¼ï¼›è€Œå¯¹äºŽ static æˆå‘˜å˜é‡ï¼Œåˆ™åªèƒ½åœ¨==åˆå§‹åŒ–å’Œé™æ€ä»£ç å—==ä¸­èµ‹åˆå€¼ã€‚
> 5. å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“æˆå‘˜å˜é‡ä¸ºå¼•ç”¨ç±»åž‹å˜é‡æ—¶ï¼Œåªæ˜¯==å¼•ç”¨å˜é‡çš„åœ°å€ä¸èƒ½æ”¹å˜ï¼Œä½†æ˜¯æ”¾çš„å†…å®¹å¯ä»¥æ”¹å˜==ã€‚
> 6. æ­¤å¤–ï¼Œ==final ä¸èƒ½ä¿®é¥°æž„é€ å™¨==ã€‚å½“ ==final static è¿žç”¨æ—¶ï¼ŒJVM åº•å±‚åšäº†ä¼˜åŒ–ï¼Œä¸ä¼šåŠ è½½ç±»==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - finalæ˜¯Javaä¸­çš„ä¸€ä¸ªå…³é”®å­—ï¼Œå¯ä»¥ç”¨æ¥ä¿®é¥°ç±»ã€æ–¹æ³•ã€å˜é‡ã€‚
> - å½“ç”¨finalæ¥ä¿®é¥°ç±»æ—¶ï¼Œè¡¨ç¤ºè¿™ä¸ªç±»ä¸å¯ä»¥è¢«ç»§æ‰¿ï¼Œ==å¯ä»¥ç¡®ä¿ä¸€äº›å®‰å…¨æ€§ï¼Œé˜²æ­¢ç±»è¢«çº‚æ”¹==ã€‚è€Œfinalç”¨æ¥ä¿®é¥°æ–¹æ³•ï¼Œè¡¨ç¤ºæ–¹æ³•ä¸å¯ä»¥è¢«é‡å†™ï¼Œfinalä¿®é¥°å˜é‡æ—¶ï¼Œå¦‚æžœæ˜¯åŸºæœ¬æ•°æ®ç±»åž‹ï¼Œå€¼ä¸å˜ã€‚
> - å¦‚æžœæ˜¯==å¼•ç”¨ç±»åž‹ï¼Œå¼•ç”¨æŒ‡å‘çš„åœ°å€å€¼ä¸å˜ï¼Œä½†åœ°å€çš„å†…å®¹å¯èƒ½ä¼šå˜==ã€‚==finalå¯ä»¥ç”¨æ¥è§£å†³ä¸€äº›å®‰å…¨æ€§é—®é¢˜ï¼ˆå¤šæ€ä¸­çš„å®‰å…¨ï¼‰ã€‚æ¯”å¦‚Javaçš„ä¸€äº›æ ¸å¿ƒç±»åº“çš„ç±»çš„APIæŽ¥å£ä¸æƒ³è¢«çº‚æ”¹å°±ä½¿ç”¨finalä¿®é¥°æ–¹æ³•==ã€‚
> - ==Javaå¸Œæœ›Stringç±»æ˜¯ä¸å¯å˜çš„ï¼Œå°±ä½¿ç”¨finalä¿®é¥°Stringç±»å¹¶ä¸”ä¿®é¥°æˆå‘˜å˜é‡char[]æ•°ç»„ï¼Œå¹¶ä¸”æ²¡æœ‰æä¾›setteræ–¹æ³•ï¼Œè¿™æ ·å°±å¯ä»¥ç¡®ä¿Stringç±»æ˜¯ä¸å¯å˜çš„ï¼ˆä¸¾ä¾‹è¯´æ˜Ž final çš„ä½¿ç”¨åœºæ™¯ï¼Œè§£å†³å®‰å…¨æ€§é—®é¢˜ï¼‰==ã€‚
> - å¦å¤–ï¼Œå¦‚æžœæœ‰å¤šä¸ªçº¿ç¨‹æ“ä½œåŒä¸€ä¸ªå˜é‡ï¼Œå¹¶ä¸”è¿™ä¸ªå˜é‡çš„å€¼ä¸ä¼šå˜åŒ–ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨finalä¿®é¥°è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚
>

---



### 8.å¼‚å¸¸è¿žå‡»ï¼ŒæŒ‰ç…§æé—®é€ä¸€å›žç­”ðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==é—®é¢˜ä¸€==ï¼š==è¯´ä¸€è¯´ä½ å¯¹å¼‚å¸¸çš„ç†è§£ï¼Ÿ==ï¼ˆæŒ‡å¯¼ï¼šå°±æ˜¯å›žç­”å¼‚å¸¸æœ‰å•¥ç”¨ä¹‹ç±»çš„ï¼‰

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==ç¨‹åºé‡åˆ°æœªç»å¤„ç†çš„å¼‚å¸¸æ—¶ä¼šç»ˆæ­¢ï¼Œè€Œæ•èŽ·å¼‚å¸¸å¹¶å¤„ç†åŽç¨‹åºå¯ä»¥ç»§ç»­è¿è¡Œ==ã€‚
> 2. æˆ‘ä»¬å¯ä»¥==å°†å¯èƒ½ä¼šå‡ºçŽ°é”™è¯¯çš„ä»£ç å•ç‹¬æå‡ºæ¥==ï¼Œå½“å‡ºçŽ°å¼‚å¸¸æ—¶è¿›è¡Œæ•èŽ·å¹¶å¤„ç†ï¼Œä¿éšœç¨‹åºçš„æ­£ç¡®è¿›è¡Œå¹¶ä¸ºåŽç»­ç»´æŠ¤æä¾›å¸®åŠ©ã€‚æ¯”å¦‚æˆ‘ä»¬åœ¨æ•èŽ·åˆ°å¼‚å¸¸åŽå¯ä»¥æŠŠå¼‚å¸¸å‘ç”Ÿçš„ä½ç½®å’Œè¯¦ç»†æƒ…å†µå†™åˆ°æ—¥å¿—ä¸­ï¼Œè¿™æ ·è¿ç»´äººå‘˜å¯ä»¥æ ¹æ®æ—¥å¿—å†…å®¹å¯¹ç¨‹åºè¿›è¡ŒæŽ’æŸ¥å’Œä¿®å¤ï¼Œä»¥é¿å…åŽç»­å‡ºçŽ°åŒæ ·çš„å¼‚å¸¸ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - å¼‚å¸¸æ˜¯ç¨‹åºåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½å‘ç”Ÿçš„ä¸€äº›é”™è¯¯ï¼Œ==å®ƒä¼šæš‚æ—¶ç»ˆæ­¢ç¨‹åºï¼Œå¹¶è½¬åˆ°å¼‚å¸¸å¤„ç†éƒ¨åˆ†å°è¯•æ¢å¤==ã€‚å¼‚å¸¸çš„å‡ºçŽ°å¯ä»¥ä½¿==æˆ‘ä»¬æŠŠç¨‹åºä¸­å¯èƒ½å‡ºçŽ°é”™è¯¯çš„ä»£ç ä»Žæ­£å¸¸ä»£ç ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œå•ç‹¬è¿›è¡Œå¤„ç†==ã€‚
>

---

==é—®é¢˜äºŒ==ï¼š==å¼‚å¸¸æœ‰å“ªäº›ç§ç±»ï¼Œå¯ä»¥ä¸¾å‡ ä¸ªä¾‹å­å—ï¼Ÿï¼ˆæŒ‡å¯¼ï¼šå…ˆå›žç­”åˆ†ç±»ï¼Œä¹‹åŽä¸¾å‡ ä¸ªè‡ªå·±ç»å¸¸çœ‹åˆ°çš„ä¾‹å­ï¼‰==

==æˆ‘çš„å›žç­”==ï¼š

> 1. å¼‚å¸¸ç±» Exception ç»§æ‰¿è‡ª Throwableï¼ŒåŒæ ·ç»§æ‰¿è‡ª Throwable çš„è¿˜æœ‰ Error ç±»ã€‚Error æ˜¯æŒ‡ç¨‹åºé‡åˆ°çš„æ— æ³•å¤„ç†çš„ä¸¥é‡é”™è¯¯ï¼Œæ¯”å¦‚ StackOverFlow Error ï¼ˆæ ˆæº¢å‡ºï¼‰ å’Œ OutOfMemoryï¼ˆOOMï¼Œå†…å­˜ä¸è¶³ï¼‰Errorã€‚è€Œ ==Exception å¯ä»¥é€šè¿‡ä»£ç è¿›è¡Œå¤„ç†==ã€‚
> 2. Exception ç±»ä¸‹çš„å¼‚å¸¸å¯ä»¥åˆ†ä¸ºæœ‰ RuntimeException å’Œ CheckedExceptionã€‚==CheckedException ä¸ºç¼–è¯‘æ—¶å¼‚å¸¸ï¼Œå…¶åœ¨ç¼–è¯‘æœŸå°±å¯ä»¥è¢« JVM æ£€æµ‹å‡ºæ¥==ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ CheckedException å¹¶ä¸æ˜¯ java.lang åŒ…ä¸‹çš„ç±»ï¼Œè€Œåªæ˜¯ä½œä¸ºä¸€ä¸ªåˆ†ç±»å­˜åœ¨ã€‚å¸¸è§çš„ç¼–è¯‘æ—¶å¼‚å¸¸æœ‰ FileNotFoundExceptionï¼ŒClassNotFoundExceptionï¼ŒIOException ç­‰ã€‚==CheckedException(ç¼–è¯‘æ—¶å¼‚å¸¸)å¿…é¡»å¤„ç†==ã€‚
> 3. è€Œ ==RuntimeException ä¸ºè¿è¡Œæ—¶å¼‚å¸¸ï¼Œåœ¨ç¼–è¯‘æœŸæ— æ³•è¢«å‘çŽ°ï¼Œåªæœ‰ç¨‹åºè¿è¡Œæ—¶æ‰ä¼šè¢«æ£€æµ‹åˆ°==ï¼Œæ¯”å¦‚æŒ‡é’ˆå¼‚å¸¸ï¼Œæ•°ç»„è¶Šç•Œå¼‚å¸¸ï¼Œç±»åž‹è½¬æ¢å¼‚å¸¸ç­‰ã€‚==RuntimeException(è¿è¡Œæ—¶å¼‚å¸¸)ä¸å¿…é¡»å¤„ç†ï¼Œå› æ­¤ä¸€èˆ¬æˆ‘ä»¬æ‰‹åŠ¨æŠ›å‡ºå¼‚å¸¸æ—¶éƒ½æŠ›å‡º RuntimeException==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ç±»ä¼¼äºŽ Object ç±»ï¼Œ==Throwable æ˜¯æ‰€æœ‰å¼‚å¸¸çš„çˆ¶ç±»==ã€‚ä¸‹ä¸€å±‚åˆ†ä¸º Error ç±»å’Œ Exception ç±»ã€‚
> - ==Error ç±»è¡¨ç¤ºä¸¥é‡çš„é”™è¯¯ï¼Œä¸€èˆ¬ç”± JVM å’Œåº•å±‚ç³»ç»Ÿå¼•å‘ï¼Œå¹¶ä¸”ä¸å¯æ¢å¤==ï¼Œä¾‹å¦‚å†…å­˜æº¢å‡ºï¼Œclass æ²¡æœ‰ä¸»æ–¹æ³•ç­‰ã€‚==Exception ç±»æ˜¯å¯ä»¥è¢«ç¨‹åºæ•èŽ·å’Œå¤„ç†çš„å¼‚å¸¸æƒ…å†µ==ã€‚
> - Exception å†å¾€ä¸‹ï¼ŒæŒ‰ç…§å¼‚å¸¸çš„æ€§è´¨åˆåˆ†ä¸º==ç¼–è¯‘å¼‚å¸¸ CheckedException å’Œè¿è¡Œæ—¶å¼‚å¸¸ RuntimeException==ã€‚å…¶ä¸­==ç¼–è¯‘å¼‚å¸¸åœ¨ç¼–è¯‘é˜¶æ®µå°±èƒ½è¢«æ£€æµ‹å‡º==ï¼Œä¾‹å¦‚ IO å¼‚å¸¸ IOExceptionï¼Œæ–‡ä»¶æ‰¾ä¸åˆ°å¼‚å¸¸ FileNotFoundExceptionç­‰ã€‚==è¿è¡Œæ—¶å¼‚å¸¸åªæœ‰åœ¨ç¨‹åºè¿è¡Œæ—¶æ‰èƒ½è¢«æ£€æµ‹å‡º==ï¼Œä¾‹å¦‚ç©ºæŒ‡é’ˆå¼‚å¸¸ NullPointerExceptionï¼Œæ•°ç»„ä¸‹æ ‡è¶Šç•Œ ArrayIndexOutOfBoundsException ç­‰ã€‚
>

---

==é—®é¢˜ä¸‰==ï¼š==throw å’Œ throws æœ‰å•¥åŒºåˆ«ï¼Ÿç›´æŽ¥ try catch ä¸å¥½å—ï¼Œä¸ºå•¥è¿˜è¦æŠ›å‘¢ï¼Ÿï¼ˆæŒ‡å¯¼ï¼šæœ‰æ—¶å€™è‡ªå·±æ— æ³•å¤„ç†ï¼Œå¿…é¡»å¾—è®©è°ƒç”¨è¯¥æ–¹æ³•çš„äººæ¥å¤„ç†ï¼ŒäºŽæ˜¯å¾—ç”¨æŠ›å‡ºï¼‰==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==throw æ˜¯ä¸€ä¸ªå…³é”®å­—==ï¼Œç”¨äºŽæ‰‹åŠ¨æŠ›å‡ºå¼‚å¸¸ï¼Œ==åŽé¢è·Ÿçš„æ˜¯å¼‚å¸¸å¯¹è±¡==ã€‚æ¯”å¦‚æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªå¼‚å¸¸ï¼Œç„¶åŽå½“ä¸šåŠ¡å‡ºçŽ°æŸä¸ªç‰¹å®šé”™è¯¯æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥äººä¸ºæŠ›å‡ºè¿™ä¸ªè‡ªå®šä¹‰å¼‚å¸¸ï¼Œä»¥ä¾¿å¯¹å…¶è¿›è¡Œç‰¹å®šå¤„ç†ã€‚
> 2. ==throws æ˜¯å¤„ç†å¼‚å¸¸çš„ä¸€ç§æ–¹å¼==ï¼Œå®ƒå­˜åœ¨äºŽæ–¹æ³•çš„å£°æ˜Žå¤„ï¼ŒåŽé¢è·Ÿçš„æ˜¯å¼‚å¸¸çš„ç±»åž‹ï¼Œè¿™äº›å¼‚å¸¸ä¸ä¼šåœ¨æœ¬æ–¹æ³•ä¸­è¿›è¡Œå¤„ç†ï¼Œè€Œæ˜¯==æŠ›ç»™å®ƒçš„è°ƒç”¨è€…ï¼Œç”±è°ƒç”¨è€…è¿›è¡Œå¤„ç†==ã€‚
> 3. try-catch åªèƒ½åœ¨æœ¬æ–¹æ³•ä¸­å¤„ç†å¼‚å¸¸ï¼Œè€Œ throws åˆ™æ˜¯å°†å¼‚å¸¸æŠ›ç»™è°ƒç”¨è€…è¿›è¡Œå¤„ç†ï¼Œ==å¦‚æžœå‡ºçŽ°æœ¬æ–¹æ³•ä¸­æ— æ³•å¤„ç†å¼‚å¸¸çš„æƒ…å†µï¼Œå°±éœ€è¦ç”¨ throws è®©æ–¹æ³•çš„è°ƒç”¨è€…å°è¯•å¤„ç†æ­¤å¼‚å¸¸==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ==throw ç”¨åœ¨æ–¹æ³•ä½“å†…==ï¼Œè¡¨ç¤ºæŸä¸ªåœ°æ–¹éœ€è¦æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œæ˜¯ä¸€ä¸ªå…·ä½“çš„åŠ¨ä½œã€‚è€Œ ==throws ç”¨åœ¨æ–¹æ³•å£°æ˜ŽåŽé¢==ï¼Œè¡¨ç¤ºè¿™ä¸ªæ–¹æ³•å¯èƒ½ä¼šæŠ›å‡ºå“ªäº›å¼‚å¸¸ï¼Œæ˜¯ä¸€ä¸ªå£°æ˜Žã€‚
> - è¿™ä¸ªéœ€è¦åˆ†æƒ…å†µå¯¹å¾…ã€‚é¦–å…ˆï¼Œå¯¹äºŽèƒ½åœ¨æ–¹æ³•å†…å¤„ç†çš„å¼‚å¸¸ï¼Œå¯ä»¥ç›´æŽ¥ç”¨ try catchï¼Œä½†å¯¹äºŽåœ¨==å½“å‰æ–¹æ³•å†…æ— æ³•å¤„ç†çš„å¼‚å¸¸ï¼Œæˆ‘ä»¬åªèƒ½é€‰æ‹©æŠ›å‡º==ï¼Œå°†å®ƒäº¤ç»™æ–¹æ³•è°ƒç”¨è€…åŽ»å¤„ç†ã€‚å…¶æ¬¡ï¼Œ==æœ‰æ—¶å¤šä¸ªæ–¹æ³•å¯èƒ½ä¼šæŠ›å‡ºç›¸åŒç±»åž‹çš„å¼‚å¸¸ï¼Œå¦‚æžœæ¯ä¸ªæ–¹æ³•éƒ½ç”¨ try catch ä¼šéžå¸¸å†—ä½™ï¼Œè¿™æ—¶å¯ä»¥åœ¨è¿™äº›æ–¹æ³•ä¸­åª throwï¼Œåœ¨è°ƒç”¨è¿™äº›æ–¹æ³•çš„åœ°æ–¹æ•´ä½“ try catchï¼Œç»Ÿä¸€è¿›è¡Œå¤„ç†==ã€‚
> - è¿˜æœ‰çš„è¯å°±æ˜¯ï¼Œæœ‰æ—¶å€™å¾—æŠŠå¼‚å¸¸äº¤ç»™ä¸Šå±‚è°ƒç”¨çš„äººæ¥å¤„ç†ã€‚
>

---

==é—®é¢˜å››==ï¼š==try catchä¼šå½±å“æ€§èƒ½å—ï¼Ÿä¸ºä»€ä¹ˆæŠ›å‡ºå¼‚å¸¸çš„æ—¶å€™ä¼šå½±å“æ€§èƒ½ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. å¦‚æžœç¨‹åº==æ²¡æœ‰äº§ç”Ÿå¼‚å¸¸ï¼Œåˆ™å¯¹æ€§èƒ½å‡ ä¹Žæ²¡æœ‰å½±å“==ã€‚åªæœ‰ç¨‹åº==æ•èŽ·å¼‚å¸¸æ—¶æ‰ä¼šå½±å“æ€§èƒ½==ã€‚
> 2. ç¨‹åºæ•èŽ·åˆ°å¼‚å¸¸çš„æ—¶å€™ï¼Œä¼š==è·³è½¬åˆ° catch ä»£ç å—ä¸­æ‰§è¡Œå¤„ç†å¼‚å¸¸çš„é€»è¾‘==ï¼Œå› æ­¤ä¼šå½±å“æ€§èƒ½ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - å‡ ä¹Žä¸ä¼šï¼Œä¹Ÿå°±æ˜¯==ç¨‹åºæ²¡æœ‰å¼‚å¸¸æ—¶ï¼Œtry catch åŠ å’Œä¸åŠ æ€§èƒ½å‡ ä¹Žä¸€æ ·==ï¼Œåªæœ‰åœ¨ç¨‹åº==æœ‰å¼‚å¸¸éœ€è¦æ•èŽ·æ—¶æ‰ä¼šå½±å“æ€§èƒ½==ã€‚
> - åŽŸå› åœ¨äºŽï¼Œ==å¤„ç†å¼‚å¸¸çš„ catch è¯­å¥åœ¨ class æ–‡ä»¶ä¸­æ˜¯ç”¨å¼‚å¸¸è¡¨å®žçŽ°çš„==ã€‚å¼‚å¸¸è¡¨æœ‰å››ä¸ªå­—æ®µï¼Œåˆ†åˆ«æ˜¯ From, To, Target å’Œ Typeã€‚From å’Œ To åˆ†åˆ«å¯¹åº” try å—å¯¹åº”çš„è¡Œå·ï¼Œå¦‚æžœå…¶ä¸­æœ‰å¼‚å¸¸æŠ›å‡ºï¼Œä¼šè·³è½¬åˆ° Target å¯¹åº”çš„è¡Œå·ï¼Œä¹Ÿå°±æ˜¯ catch è¯­å¥å¯¹åº”çš„ä½ç½®ï¼Œè€Œè¿™ä¸ªå¼‚å¸¸çš„ç±»åž‹è®°å½•åœ¨ Type ä¸­ã€‚å¦‚æžœç¨‹åºåœ¨ try ä¸­æ²¡æœ‰å¼‚å¸¸æŠ›å‡ºï¼Œæœ€ç»ˆä¼šé€šè¿‡ä¸€æ¡ goto æŒ‡ä»¤è·³è½¬åˆ° try catch å—åŽçš„è¯­å¥ç»§ç»­æ‰§è¡Œï¼Œè¿™ä¸€æ¡ goto æŒ‡ä»¤æ€§èƒ½çš„æ¶ˆè€—å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚==å¦‚æžœæœ‰å¼‚å¸¸ï¼Œæ‰ä¼šåŽ»æŸ¥å¼‚å¸¸è¡¨ï¼Œå†è·³è½¬åˆ°å¯¹åº”çš„ catch å—ä½ç½®åŽ»æ‰§è¡Œï¼Œè¿™ä¸ªè¿‡ç¨‹å¯èƒ½ä¼šå½±å“æ€§èƒ½==ã€‚
>

---

==é—®é¢˜äº”==ï¼š==try-catch-finally ä¸­ï¼Œå¦‚æžœ catch ä¸­ return äº†ï¼Œfinally è¿˜ä¼šæ‰§è¡Œå—ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==æ— è®ºæ˜¯åœ¨ try ä¸­ return è¿˜æ˜¯åœ¨ catch ä¸­ returnï¼Œfinally éƒ½ä¼šè¢«æ‰§è¡Œ==ã€‚åœ¨ catch ä¸­ return æ—¶ï¼Œ==ç¨‹åºä¼šå…ˆæŠŠå½“å‰çš„è¿”å›žå€¼å­˜åˆ°ä¸€ä¸ª temp ä¸­ï¼Œç„¶åŽæ‰§è¡Œ finally ä¸­çš„ä»£ç ==ã€‚
>
> 2. æ¯”å¦‚ catch ä¸­è¿”å›ž aï¼Œä¼š==å…ˆæŠŠæ­¤æ—¶ a çš„å€¼èµ‹ç»™ tempï¼Œç„¶åŽæ‰§è¡Œ finally==ï¼Œé‚£ä¹ˆè¿™æ—¶å€™==å°±ç®— finally ä¸­æ”¹å˜äº† a çš„å€¼ï¼Œcatch ä¸­è¿”å›žå€¼ä¹Ÿä¸ä¼šå˜åŒ–ï¼Œå› ä¸ºä¿®æ”¹ a æ— æ³•å½±å“ temp çš„å€¼==ã€‚
>
> 	```java
> 	public static void main(String[] args) {
> 	    System.out.println("the return value of f() is " + f()); // 2
> 	}
> 	
> 	static int f() {
> 	    int a = 1;
> 	    try {
> 	        throw new RuntimeException();
> 	    } catch (RuntimeException e) {
> 	        a = 2;
> 	        return a;
> 	    } finally {
> 	        a = 3;
> 	    }
> 	}
> 	```
>
> 3. ä½†æ˜¯ï¼Œ==å¦‚æžœåœ¨ finally ä¸­ä¹Ÿæœ‰ return çš„è¯ï¼Œå°±ç›´æŽ¥è¿”å›ž finally ä¸­çš„ return==ï¼Œå¦åˆ™å°±ä¼šè¿”å›ž tempã€‚
>
> 	```java
> 	public static void main(String[] args) {
> 	    System.out.println("the return value of f is " + f()); // 3
> 	}
> 		
> 	static int f() {
> 	    int a = 1;
> 	    try {
> 	        throw new RuntimeException();
> 	    } catch (RuntimeException e) {
> 	        a = 2;
> 	        return a;
> 	    } finally {
> 	        a = 3;
> 	        return a;
> 	    }
> 	}
> 	```
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ä¼šçš„ï¼Œ==æ— è®º catch å—ä¸­æœ‰å¼‚å¸¸è¿˜æ˜¯æœ‰è¿”å›žè¯­å¥ï¼Œæœ€ç»ˆä¸€å®šä¼šåœ¨æ–¹æ³•çœŸæ­£ç»“æŸä¹‹å‰æ‰§è¡Œ finally==ã€‚
> - ä½†æ˜¯éœ€è¦è€ƒè™‘ä¸€ç§==ç‰¹æ®Šæƒ…å†µ==ï¼Œå°±æ˜¯å¦‚æžœ ==try å—ä¸­æŠ›å‡ºäº†å¼‚å¸¸ä½†æ²¡æœ‰è¢« catch æ•èŽ·ï¼Œä¸”æ­¤æ—¶ finally ä¸­ä¹ŸæŠ›å‡ºäº†å¼‚å¸¸==ï¼Œé‚£ä¹ˆ ==finally ä¸­çš„å¼‚å¸¸ä¼šè¦†ç›–æŽ‰ try ä¸­çš„å¼‚å¸¸ï¼Œæˆä¸ºè¿™ä¸ªæ–¹æ³•æœ€ç»ˆæŠ›å‡ºçš„å¼‚å¸¸==ã€‚å®žè·µä¸­éœ€è¦æ³¨æ„ä¸€ä¸‹è¿™ä¸ªå¼‚å¸¸è¦†ç›–é—®é¢˜ã€‚
>

---



### 9.String äº”è¿žå‡»æŒ‰ç…§æé—®é€ä¸€å›žç­”ðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==é—®é¢˜ä¸€==ï¼š==String ä¸ºä»€ä¹ˆè¦è®¾è®¡ä¸ºä¸å¯å˜ç±»==ï¼Ÿï¼ˆæŒ‡å¯¼ï¼šå¯ä»¥ä»Žå®‰å…¨æ€§ï¼Œæ€§èƒ½ç­‰æ–¹é¢æ¥è€ƒè™‘ï¼‰

==æˆ‘çš„å›žç­”==ï¼š

1. > ==String è¢« final ä¿®é¥°ï¼ŒString çš„æœ¬è´¨æ˜¯ä¸€ä¸ª char[] å­—ç¬¦æ•°ç»„ï¼Œå®ƒä¹Ÿè¢« final ä¿®é¥°ï¼Œåœ¨å †ä¸­çš„åœ°å€ä¸èƒ½æ”¹å˜ï¼Œå¹¶ä¸” String æ²¡æœ‰å¯¹å¤–æä¾›æŽ¥å£æ”¹å˜ char[] çš„å†…å®¹çš„ api==ã€‚å› æ­¤å¯ä»¥ä¿è¯ä¸€ä¸ª String å®žä¾‹å¯¹è±¡åœ¨è¿è¡Œæ—¶æ— æ³•æ”¹å˜ï¼Œå› æ­¤åœ¨å¹¶å‘æ¡ä»¶ä¸‹ä¸ç”¨æ‹…å¿ƒ String å¯¹è±¡çš„åŒæ­¥é—®é¢˜ï¼Œå…·æœ‰çº¿ç¨‹å®‰å…¨æ€§ã€‚

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - è¿™ä¸ªä¸»è¦æ˜¯å‡ºäºŽ==çº¿ç¨‹å®‰å…¨==å’Œ==æ€§èƒ½æ–¹é¢==çš„è€ƒè™‘ã€‚
>
> - çº¿ç¨‹å®‰å…¨ä½“çŽ°åœ¨ï¼Œç”±äºŽ String æ˜¯ä¸å¯å˜çš„ï¼Œ==å¤šä¸ªçº¿ç¨‹å…±äº«ä¸€ä¸ª String æ—¶ä¸ç”¨æ‹…å¿ƒå®ƒçš„åŒæ­¥é—®é¢˜==ï¼›
>
> - ==æ€§èƒ½ä½“çŽ°åœ¨ç¼“å­˜å“ˆå¸Œå€¼å’Œè®¾è®¡å¸¸é‡æ± ä¸Š==ã€‚==String åœ¨è¢«åˆ›å»ºæ—¶å°±ç¼“å­˜äº†è‡ªå·±çš„å“ˆå¸Œå€¼ï¼Œ==
>
> 	```java
> 	/* * Cache the hash code for the string */
> 	private int hash; // Default to 0
> 	```
>
> 	==ä½¿ç”¨æ—¶ç›´æŽ¥æ‹¿å‡ºæ¥å°±è¡Œï¼Œä¸ç”¨é‡æ–°è®¡ç®—==ï¼Œ==è¿™ä½¿å¾— String é€‚åˆç”¨æ¥ä½œä¸º Map çš„ Keyï¼Œå¯ä»¥å¿«é€ŸèŽ·å¾— Key çš„å“ˆå¸Œå€¼==ï¼Œæé«˜æŸ¥æ‰¾å’Œæ¯”è¾ƒçš„æ•ˆçŽ‡ï¼›é™¤æ­¤ä¹‹å¤–ï¼ŒåŸºäºŽ String çš„ä¸å¯å˜ï¼Œ==Java ä½¿ç”¨å¸¸é‡æ± æ¥å°½å¯èƒ½çš„å…±äº«ç›¸åŒçš„å­—ç¬¦ä¸²ï¼Œæ¥èŠ‚çº¦ String çš„å­˜å‚¨ç©ºé—´==ã€‚å…·ä½“çš„ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨å­—é¢å€¼==åˆ›å»º String æ—¶ï¼Œä¼šå…ˆåŽ»æŸ¥å®ƒæ˜¯å¦å·²ç»å­˜åœ¨äºŽå¸¸é‡æ± ä¸­ï¼Œå¦‚æžœæ˜¯åˆ™ç›´æŽ¥è¿”å›žè¿™ä¸ªå·²å­˜åœ¨äºŽå¸¸é‡æ± ä¸­çš„å­—ç¬¦ä¸²çš„å¼•ç”¨ï¼Œè€Œä¸ä¼šåœ¨å †åŒºåˆ›å»ºæ–°çš„å¯¹è±¡==ã€‚
>

---

==é—®é¢˜äºŒ==ï¼š==String a = new String(â€œaaâ€) + â€œbbâ€ â€œè¿™å¥è¯åˆ›å»ºäº†å¤šå°‘ä¸ªå¯¹è±¡ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. åˆ›å»ºäº†4ä¸ªå¯¹è±¡ã€‚é¦–å…ˆåœ¨==å¸¸é‡æ± åˆ›å»º "aa" å­—ç¬¦ä¸²å¸¸é‡å¯¹è±¡==ã€‚ç„¶åŽ==åœ¨å †åŒºåˆ›å»º String å®žä¾‹å¯¹è±¡ï¼Œå¹¶ä½¿å…¶ value å­—æ®µæŒ‡å‘å¸¸é‡æ± ä¸­çš„ "aa" å­—ç¬¦ä¸²å¸¸é‡å¯¹è±¡==ã€‚éšåŽåœ¨==å¸¸é‡æ± åˆ›å»º "bb" å­—ç¬¦ä¸²å¸¸é‡å¯¹è±¡==ã€‚æœ€åŽï¼š
>
> 	```java
> 	StringBuilder builder = new StringBuilder;
> 	builder.append("aa");
> 	builder.append("bb");
> 	a = builder.toString(); // åœ¨æ­¤åˆåˆ›å»ºäº†ä¸€ä¸ª String å®žä¾‹å¯¹è±¡
> 	```
>
> 	å°†è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²å¸¸é‡è¿›è¡Œæ‹¼æŽ¥ï¼Œåˆ›å»ºå‡º a å¯¹è±¡ï¼Œå…±4ä¸ªå¯¹è±¡ã€‚

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - å…±åˆ›å»ºäº† 4 ä¸ª String å¯¹è±¡ï¼Œç¬¬ä¸€ä¸ªæ˜¯å¸¸é‡æ± ä¸­çš„å¯¹è±¡ â€œaaâ€ï¼Œå¦‚æžœå¸¸é‡æ± ä¸­æœ‰ â€œaaâ€ å°±ç›´æŽ¥è¿”å›žï¼Œæ²¡æœ‰å°±åˆ›å»ºå¹¶æ·»åŠ è¿›å¸¸é‡æ± ä¸­ã€‚ç¬¬äºŒä¸ªæ˜¯ new å‡ºæ¥çš„ä»¥ â€œaaâ€ ä¸ºåˆå§‹å€¼åˆ›å»ºçš„ String å¯¹è±¡ï¼Œç¬¬ä¸‰ä¸ª â€œbbâ€ åŒ â€œaaâ€ï¼Œç¬¬å››ä¸ªæ˜¯é€šè¿‡ â€œ+â€ æ‹¼æŽ¥å‰ä¸¤ä¸ªå¯¹è±¡ï¼Œåˆ›å»ºå‡ºçš„æ–° String å¯¹è±¡ã€‚
>

---

==é—®é¢˜ä¸‰==ï¼š==String å¯¹è±¡æœ€å¤šå¯ä»¥å­˜æ”¾å¤šå°‘ä¸ªå­—ç¬¦ï¼ˆé•¿åº¦ï¼‰ï¼Ÿï¼ˆæŒ‡å¯¼ï¼šå¯ä»¥ä»Žæºç è§’åº¦åˆ†æžå‹’ï¼‰==

==æˆ‘çš„å›žç­”==ï¼š

> 1. String çš„æœ¬è´¨æ˜¯ä¸€ä¸ª char[] å­—ç¬¦åž‹æ•°ç»„ï¼Œç”±äºŽ==æ•°ç»„çš„ length å­—æ®µçš„ç±»åž‹æ˜¯ intï¼Œå› æ­¤è¯¥å­—ç¬¦åž‹æ•°ç»„çš„é•¿åº¦æœ€å¤§ä¸º $2^{31}-1$==ã€‚
>
> 2. ä½†æ˜¯ ==JVM å­—èŠ‚ç çš„å¸¸é‡æ± éƒ¨åˆ†è§„å®š CONSTANT_Utf8_info çš„ length åªèƒ½ç”¨ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤º==ï¼š
>
> 	> ![image-20240429165532098](bgwROUND1.assets/image-20240429165532098.png)
>
> 	å› æ­¤ ==String çš„é•¿åº¦ä¸èƒ½è¶…è¿‡ $2^{16}-2$ï¼Œå¦åˆ™æ— æ³•é€šè¿‡ç¼–è¯‘==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - String åœ¨æºç ä¸­ä½¿ç”¨ char[] æ¥ç»´æŠ¤å­—ç¬¦åºåˆ—çš„ï¼Œè€Œ ==char[] çš„é•¿åº¦æ˜¯ int ç±»åž‹ï¼Œæ‰€ä»¥ç†è®ºä¸Š String çš„é•¿åº¦æœ€å¤§ä¸º 2^31âˆ’1== ï¼Œå ç”¨ç©ºé—´å¤§çº¦ä¸º 4 GBï¼Œä¸è¿‡æ ¹æ®å®žé™… ==JVM çš„å †å†…å­˜é™åˆ¶ï¼Œç¼–è¯‘æ—¶ï¼ŒStringé•¿åº¦æœ€å¤šå¯ä»¥æ˜¯2çš„16æ¬¡æ–¹å‡2==ï¼Œè¿è¡Œæ—¶é•¿åº¦æœ€å¤šå¯ä»¥æ˜¯2çš„31æ¬¡æ–¹å‡1ï¼Œæ„æ€æ˜¯==å¯ä»¥åœ¨ç¼–è¯‘æ—¶å®šä¹‰ä¸€äº›çŸ­çš„å­—ç¬¦ä¸²ï¼Œè¿è¡Œæ—¶å¯ä»¥è¿›è¡Œæ‹¼æŽ¥ï¼Œé•¿ä¸€ç‚¹ä¹Ÿå¯ä»¥==ã€‚
>

---

==é—®é¢˜å››==ï¼š==å­—ç¬¦ä¸²å¸¸é‡æ± æ˜¯æ”¾åœ¨å †ä¸­å—ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==å­—ç¬¦ä¸²å¸¸é‡ä¸æ˜¯æ”¾åœ¨å †ä¸­çš„ï¼Œè€Œæ˜¯æ”¾åœ¨æ–¹æ³•åŒºçš„å¸¸é‡æ± ä¸­==ï¼Œå¹¶ä¸”åœ¨ç¼–è¯‘æœŸç”Ÿæˆå­—èŠ‚ç çš„æ—¶å€™ä¾¿å·²å®Œæˆã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ä¸æ˜¯ï¼Œ==Java 8 ä»¥å‰è¢«æ”¾åœ¨æ°¸ä¹…ä»£ä¸­==ï¼Œ==Java 8 åŠä»¥åŽè¢«æ”¾åœ¨æ–¹æ³•åŒºçš„å…ƒæ•°æ® metadata ä¸­==ã€‚
>

---

==é—®é¢˜äº”==ï¼š==Stringä¸­ â€œ+â€ å’Œ StringBuffer ä¸­çš„ append ä¼šæœ‰æ€§èƒ½ä¸Šçš„å·®åˆ«å—ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. æœ‰å·®åˆ«ã€‚String ä¸­çš„ "+" ==æœ¬è´¨æ˜¯åˆ›å»º StringBuilder å®žä¾‹å¯¹è±¡ï¼Œè°ƒç”¨å…¶ append æ–¹æ³•ï¼Œç„¶åŽå† toString== ==åœ¨å †åŒºåˆ›å»ºæ‹¼æŽ¥åŽçš„æ–°çš„ String å®žä¾‹å¯¹è±¡ï¼Œæœ€åŽå°†å…¶èµ‹ç»™å˜é‡==ï¼Œè¿™æ ·åšæ˜¯å› ä¸º String æœ¬èº«æ˜¯ä¸å¯å˜çš„ï¼Œå…¶ value ä¸€æ—¦åˆå§‹åŒ–å®Œæˆä¾¿ä¸èƒ½æ”¹å˜ï¼ŒåŒæ—¶æ²¡æœ‰ setter æ–¹æ³•å› æ­¤å…¶å†…å®¹ä¹Ÿæ— æ³•æ”¹å˜ã€‚
> 2. è€Œ StringBuffer çš„ value æ²¡æœ‰è¢« final ä¿®é¥°ï¼Œå¹¶ä¸” ==StringBuffer çš„çˆ¶ç±» AbstractStringBuffer æä¾›äº†é½å…¨çš„å¯¹ value CRUD æ“ä½œçš„ api==ï¼Œå› æ­¤ StringBuffer çš„ append ä¸ç”¨åˆ›å»ºæ–°å¯¹è±¡ï¼Œè€Œæ˜¯==ç›´æŽ¥ä¿®æ”¹ value å­—æ®µ==ï¼Œå› æ­¤å…¶æ€§èƒ½å¤§äºŽ String ä¸­çš„ "+" æ“ä½œã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ==String çš„ â€œ+â€ æ•ˆçŽ‡ä½ŽäºŽ StringBuffer çš„ append( )==ã€‚åŽŸå› åœ¨äºŽ ==String æ˜¯ä¸å¯å˜ç±»ï¼Œä»»ä½•å¯¹ String çš„æ“ä½œéƒ½ä¼šåˆ›å»ºæ–°çš„ String å¯¹è±¡==ã€‚è€Œ â€œ+â€ çš„æ‰§è¡Œè¿‡ç¨‹å®žé™…ä¸Šæ˜¯==å…ˆåˆ›å»ºäº†ä¸€ä¸ª StringBufferï¼Œç„¶åŽè°ƒç”¨ append( )ï¼Œæœ€åŽåœ¨ toString( )==ã€‚æ•ˆçŽ‡ä¸Šè‚¯å®šæ˜¯ä¸å¦‚ StringBuffer ç›´æŽ¥ append( ) é«˜çš„ã€‚
>

---



### 10.èŠä¸€èŠä½ å¯¹å¤šæ€çš„ç†è§£ï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==å¤šæ€å…è®¸ä¸€ä¸ªå¯¹è±¡ç¼–è¯‘æ—¶çš„ç±»åž‹å’Œè¿è¡Œæ—¶çš„ç±»åž‹ä¸ä¸€è‡´ï¼Œå³çˆ¶ç±»çš„æŒ‡é’ˆå¯ä»¥æŒ‡å‘å­ç±»çš„å®žä¾‹==ã€‚==ç¼–è¯‘ç±»åž‹åœ¨å¯¹è±¡åˆ›å»ºæ—¶å°±å·²ç»ç¡®å®šï¼Œè€Œè¿è¡Œæ—¶ç±»åž‹å¯ä»¥åŠ¨æ€åœ°ç»‘å®šåœ¨å­ç±»çš„å®žä½“ä¸Š==ã€‚
> 2. å¤šæ€å…è®¸å¯¹è±¡åœ¨å…è®¸è¿‡ç¨‹ä¸­å‘ä¸Šè½¬åž‹å’Œå‘ä¸‹è½¬åž‹ã€‚==å‘ä¸Šè½¬åž‹æ˜¯æŒ‡çˆ¶ç±»çš„å¼•ç”¨æŒ‡å‘äº†å­ç±»çš„å®žä½“==ã€‚çˆ¶ç±»å¼•ç”¨å¯ä»¥è°ƒç”¨çˆ¶ç±»çš„æ‰€æœ‰æ–¹æ³•ï¼Œä½†æ˜¯==ä¸èƒ½è°ƒç”¨å­ç±»çš„æ–¹æ³•ï¼Œè¿™åœ¨ç¼–è¯‘é˜¶æ®µå°±å†³å®š==äº†ã€‚è€Œ==çˆ¶ç±»æ–¹æ³•çš„å…·ä½“å®žçŽ°åˆ™ä¼šåŠ¨æ€åœ°ç»‘å®šåˆ°å­ç±»ä¸Šï¼Œå–å†³äºŽå­ç±»çš„å…·ä½“å®žçŽ°==ã€‚
> 3. ==å‘ä¸‹è½¬åž‹åˆ™æ˜¯å°†çˆ¶ç±»çš„å¼•ç”¨å¼ºåˆ¶è½¬æ¢ä¸ºå­ç±»çš„å¼•ç”¨ï¼Œå‰ææ˜¯åœ¨è½¬æ¢å‰çˆ¶ç±»çš„å¼•ç”¨å¿…é¡»æŒ‡å‘å­ç±»çš„å®žä½“==ã€‚åœ¨å‘ä¸‹è½¬åž‹ä¹‹åŽï¼Œæ–°çš„å­ç±»å¼•ç”¨å°±å¯ä»¥è°ƒç”¨å­ç±»æ‰€æœ‰çš„æ–¹æ³•ã€‚
> 4. å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“==è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•æ—¶ï¼Œä¼šæ ¹æ®è¯¥å¯¹è±¡çš„å†…å­˜åœ°å€/è¿è¡Œæ—¶ç±»åž‹è¿›è¡ŒåŠ¨æ€ç»‘å®š==ï¼Œè€Œ==å¯¹è±¡çš„å­—æ®µåœ¨è°ƒç”¨æ—¶åˆ™æ²¡æœ‰åŠ¨æ€ç»‘å®šæœºåˆ¶ï¼Œå“ªé‡Œå£°æ˜Žï¼Œå°±åœ¨å“ªé‡Œè°ƒç”¨==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - å¤šæ€å¯ä»¥ç†è§£ä¸º â€œäº‹ç‰©è¿è¡Œæ—¶çš„ä¸åŒçŠ¶æ€â€ï¼Œåœ¨ Java ä¸­==å…·ä½“æŒ‡ï¼Œé€šè¿‡åŠ¨æ€ç»‘å®šï¼Œåœ¨è¿è¡Œæ—¶æ ¹æ®å¯¹è±¡çš„å®žé™…ç±»åž‹æ¥è°ƒç”¨å¯¹åº”çš„æ–¹æ³•==ã€‚å¤šæ€å¯ä»¥é€šè¿‡ç»§æ‰¿æˆ–è€…æŽ¥å£æ¥å®žçŽ°ã€‚æ‹¿ç»§æ‰¿æ¥è¯´ï¼Œå­ç±»å¿…é¡»é‡å†™çˆ¶ç±»çš„æ–¹æ³•ï¼Œé€šè¿‡å‘ä¸Šè½¬åž‹ï¼Œä½¿ç”¨çˆ¶ç±»ç±»åž‹æ¥è°ƒç”¨å­ç±»å¯¹è±¡çš„æ–¹æ³•ï¼Œç»“æžœæ˜¯åœ¨è¿è¡Œæ—¶æ‰§è¡Œå­ç±»ä¸­é‡å†™çš„æ–¹æ³•ã€‚
> - ==å®žè·µä¸­æˆ‘çš„é¡¹ç›®çš„æ”¯ä»˜æ¨¡å—å°±ç”¨åˆ°äº†å¤šæ€==ã€‚å…·ä½“æ¥è¯´ï¼Œæœ‰ä¸€ä¸ªåŸºç±» â€œæ”¯ä»˜æ–¹å¼ Paymentâ€ï¼Œå®ƒæœ‰ä¸€ä¸ª pay æ–¹æ³•ï¼Œä¹‹åŽåˆ†åˆ«åˆ›å»º â€œå¾®ä¿¡æ”¯ä»˜ WeChatPayâ€ å’Œ â€œæ”¯ä»˜å®æ”¯ä»˜ AliPayâ€ ä¸¤ä¸ªç±»ï¼Œå¹¶ä¸”éƒ½ç»§æ‰¿è‡ª Payment å¹¶é‡å†™ pay æ–¹æ³•ã€‚é‚£ä¹ˆåœ¨ä¹‹åŽçš„æ”¯ä»˜ä»£ç ä¸­ï¼Œæ— è®ºç”¨æˆ·é€‰æ‹©çš„å“ªç§æ”¯ä»˜æ–¹å¼ï¼Œéƒ½å¯ä»¥ç»Ÿä¸€ç”¨ Payment æ¥è¿›è¡Œå…·ä½“çš„ pay æ“ä½œã€‚åŽŸå› æ˜¯ ==Java çš„åŠ¨æ€ç»‘å®šä¼šç¡®ä¿è¿™ä¸ªæ–¹æ³•åœ¨çœŸæ­£æ‰§è¡Œæ—¶ï¼ŒåŽ»è°ƒç”¨å­ç±»ä¸­å¾®ä¿¡æˆ–è€…æ”¯ä»˜å®çš„ pay æ–¹æ³•==ã€‚å¦å¤–ï¼Œåœ¨ä¿®æ”¹å…·ä½“çš„æ”¯ä»˜é€»è¾‘æ—¶ï¼Œä¹Ÿåªéœ€å•ç‹¬åŽ»å¾®ä¿¡æˆ–è€…æ”¯ä»˜å®çš„ç±»é‡Œé¢åŽ»ä¿®æ”¹ï¼Œè€Œä¸ç”¨åŠ¨ä¸»é€»è¾‘é‡Œé¢çš„ä»£ç ï¼Œä½“çŽ°å‡ºå¤šæ€çš„çµæ´»å’Œå¯æ‰©å±•æ€§ã€‚
> - é™¤äº†ä»¥ä¸Šè¯´çš„è¿è¡Œæ—¶å¤šæ€ï¼Œ==æˆ‘è¿˜å¬è¯´è¿‡ä¸€ä¸ªæœ‰äº‰è®®çš„ç¼–è¯‘æ—¶å¤šæ€ï¼Œå®ƒå…·ä½“æŒ‡ Java ä¸­çš„æ–¹æ³•é‡è½½==ï¼Œåœ¨ç¼–è¯‘æœŸå°±æ ¹æ®å·²çŸ¥çš„å‚æ•°åˆ—è¡¨ï¼Œå†³å®šäº†éœ€è¦è°ƒç”¨çš„æ–¹æ³•ã€‚ä¸è¿‡ä¸€èˆ¬è¯´å¤šæ€éƒ½é»˜è®¤è¯´çš„æ˜¯è¿è¡Œæ—¶å¤šæ€ã€‚
>

---



### 11.StringBuilderã€StringBufferæœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==StringBuffer çš„åº•å±‚æ˜¯ä¸€ä¸ªå¯å˜çš„ char[] å­—ç¬¦åž‹æ•°ç»„==ã€‚å’Œ String ä¸åŒçš„æ˜¯ï¼Œ==StringBuffer çš„ char[] æ²¡æœ‰è¢« final ä¿®é¥°==ï¼Œå¹¶ä¸” StringBuffer çš„ç›´æŽ¥çˆ¶ç±» ==AbstractStringBuffer æä¾›äº†é’ˆå¯¹ char[] çš„ CRUD æ–¹æ³•==ï¼Œå®ƒä»¬==ä¸éœ€è¦åƒ String é‚£æ ·é‡åˆ°ä¿®æ”¹åªèƒ½é‡æ–°åˆ›å»ºå­—ç¬¦åž‹å¸¸é‡å’Œå˜é‡ï¼Œå¹¶æ›´æ”¹å¼•ç”¨==ï¼Œè€Œæ˜¯==ç›´æŽ¥ä¿®æ”¹ char[]==ï¼Œä»Žè€Œæ˜¾è‘—æå‡äº†ä¿®æ”¹çš„æ•ˆçŽ‡ã€‚
> 2. è€Œ StringBuilder ç›¸æ¯”äºŽ StringBufferï¼Œæœ€å¤§çš„ä¸åŒæ˜¯ ==StringBuilder æ²¡æœ‰åƒ StringBuffer é‚£æ ·å¯¹ä¼—å¤šæ¶‰åŠchar[] ä¿®æ”¹çš„æ–¹æ³•ä½¿ç”¨ synchronized å…³é”®å­—åŠ äº’æ–¥é”å®žçŽ°çº¿ç¨‹å®‰å…¨==ï¼Œæ¢è¨€ä¹‹ï¼Œ==StringBuilder æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„==ï¼Œä½†ä¹Ÿæ­£å› å¦‚æ­¤å…¶è¿è¡Œæ•ˆçŽ‡åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å¿«äºŽ StringBufferï¼Œè¿™ä½¿å¾—==åœ¨å•çº¿ç¨‹çš„çŽ¯å¢ƒä¸‹æˆ‘ä»¬å¯ä»¥ä¼˜å…ˆé€‰æ‹©ä½¿ç”¨ StringBuilder æ¥æž„å»º String å¯¹è±¡==ï¼Œä»¥è°‹æ±‚æ›´é«˜çš„æ•ˆçŽ‡ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ==StringBuilder å’Œ StringBuffer éƒ½æ˜¯å¯å˜ç±»ï¼Œä»»ä½•å¯¹å®ƒä»¬çš„æ“ä½œéƒ½ä¸ä¼šäº§ç”Ÿæ–°çš„å¯¹è±¡==ã€‚ä¸¤è€…çš„åŒºåˆ«åœ¨äºŽï¼š==StringBuilder æ²¡æœ‰åŠ é”ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œ StringBuffer å¤§å¤šæ•°æ–¹æ³•éƒ½åŠ äº† synchronizedï¼Œæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†æ‰§è¡Œæ•ˆçŽ‡ä¼šä½Žç‚¹==ã€‚
>
> - æºç ä¸­æœ‰ä¸€ä¸ªç»†èŠ‚ï¼Œå°±æ˜¯ ==StringBuffer çš„ append æ–¹æ³•åœ¨æ‰§è¡ŒçœŸæ­£çš„å­—ç¬¦ä¸²æ‹¼æŽ¥é€»è¾‘ä¹‹å‰ï¼Œä¼šå…ˆæ¸…é™¤ toStringCacheï¼Œå®ƒæ˜¯ç”¨æ¥ç¼“å­˜æœ€åŽä¸€æ¬¡ toString ç»“æžœçš„åœ°æ–¹ï¼Œä¸»è¦ç”¨æ¥åŠ å¿« toString çš„æ‰§è¡Œæ•ˆçŽ‡==ã€‚
>
> 	```java
> 	public synchronized StringBuffer append(StringBuffer sb) {
> 	    toStringCache = null; // æ¸…ç©º toString ç¼“å­˜
> 	    super.append(sb);
> 	    return this;
> 	}
> 	```
>

---



### 12.ä»€ä¹ˆæ˜¯åºåˆ—åŒ–ï¼Ÿä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦åºåˆ—å·ï¼Ÿåºåˆ—åŒ–åœ¨Javaä¸­æ˜¯æ€Žä¹ˆå®žçŽ°çš„ï¼ŸðŸŒŸðŸŒŸ

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==åºåˆ—åŒ–æ˜¯å°†javaå¯¹è±¡è½¬åŒ–ä¸ºäºŒè¿›åˆ¶å­—èŠ‚æµçš„æ–¹æ³•==ã€‚å¦‚æžœä¸€ä¸ªå¯¹è±¡æƒ³è¦è¿›è¡Œåºåˆ—åŒ–ï¼Œé‚£ä¹ˆå…¶ç±»==å¿…é¡»å®žçŽ° Serilizable æŽ¥å£æˆ– Externalizable æŽ¥å£==ã€‚
> 2. åºåˆ—åŒ–ä¸€èˆ¬ç”¨äºŽåœ¨==å‘æŒä¹…åž‹æ•°æ®åº“å†™å…¥æ•°æ®==ï¼Œ==ä½¿ç”¨ Redis ç­‰é”®å€¼å¯¹æ•°æ®åº“è¿›è¡Œæ•°æ®ç¼“å­˜==ï¼Œä»¥åŠ==ç½‘ç»œä¼ è¾“ä¸­éœ€è¦å°†å¯¹è±¡åºåˆ—åŒ–ä¸ºå­—èŠ‚æµæ‰èƒ½è¿›è¡Œä¼ è¾“==ã€‚
> 3. åœ¨Javaä¸­æˆ‘ä»¬ä½¿ç”¨ä½¿ç”¨==å¯¹è±¡IOæµè¿›è¡Œå¯¹è±¡çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–==ã€‚æ¯”å¦‚åœ¨ä¸€ä¸ªå¤šç”¨æˆ·å³æ—¶é€šè®¯é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸€ä¸ª==ç”¨æˆ·çš„ Message å¯¹è±¡é€šè¿‡ ObjectOutputStream.writeObject æ–¹æ³•è½¬æ¢ä¸ºäºŒè¿›åˆ¶æµè¿›è¡Œå¯¹è±¡çš„ç½‘ç»œä¼ è¾“==ã€‚è€ŒæœåŠ¡ç«¯åœ¨æŽ¥æ”¶åˆ°æ­¤äºŒè¿›åˆ¶æµåŽä¹Ÿå¯ä»¥==ä½¿ç”¨ ObjectInputStream.readObject æ–¹æ³•å°†æ”¶åˆ°çš„äºŒè¿›åˆ¶å­—èŠ‚æµååºåˆ—åŒ–ä¸º Object å¯¹è±¡ï¼Œå¹¶å‘ä¸‹è½¬åž‹ä¸ºæ‰€éœ€çš„ Message å¯¹è±¡==ï¼Œä»Žè€Œå®žçŽ°ç½‘ç»œé€šè®¯ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ==å‚è€ƒå›žç­”==1ï¼š
> - ==åºåˆ—åŒ–å°±æ˜¯æŒ‡å°† Java å¯¹è±¡è½¬æ¢æˆäºŒè¿›åˆ¶å­—èŠ‚æµçš„è¿‡ç¨‹==ã€‚
> - å½“æˆ‘ä»¬éœ€è¦å¯¹æŸäº›å¯¹è±¡è¿›è¡Œ==æŒä¹…åŒ–==æ—¶ï¼Œéœ€è¦å…ˆå¯¹å®ƒä»¬åºåˆ—åŒ–æˆäºŒè¿›åˆ¶å­—èŠ‚åºåˆ—ï¼Œç„¶åŽå­˜åˆ°æ•°æ®åº“æˆ–è€…å†…å­˜ä¸­ã€‚æˆ–è€…ä¸¤ä¸ª Java è¿›ç¨‹==è¿œç¨‹é€šä¿¡==æ—¶ï¼Œä¹Ÿéœ€è¦==å°† Java å¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—æ‰èƒ½åœ¨ç½‘ç»œä¸­ä¼ é€==ã€‚
> - é¦–å…ˆè¢«åºåˆ—åŒ–çš„å¯¹è±¡ä¸€å®šéœ€è¦==å®žçŽ° Serializable æˆ– Externalizable æŽ¥å£==ã€‚åºåˆ—åŒ–ä¸Žååºåˆ—åŒ–åˆ†åˆ«æ˜¯é€šè¿‡ Java io åŒ…ä¸‹çš„ ObjectOutputStream çš„ writeObject( ) å’Œ ObjectInputStream çš„ readObject( ) å®žçŽ°çš„ã€‚
> - ==writeObject( ) ä¼šå¯¹æŒ‡å®šçš„ obj å¯¹è±¡è¿›è¡Œåºåˆ—åŒ–ï¼Œå¹¶æŠŠå¾—åˆ°çš„å­—èŠ‚åºåˆ—å†™åˆ°ä¸€ä¸ªç›®æ ‡è¾“å‡ºæµä¸­==ã€‚è€Œ ==readObject( ) ä¼šä»Žä¸€ä¸ªè¾“å…¥æµä¸­è¯»å–å­—èŠ‚åºåˆ—ï¼Œå¹¶å°†å…¶ååºåˆ—åŒ–æˆä¸€ä¸ªå¯¹è±¡è¿”å›ž==ã€‚
> - ==å‚è€ƒå›žç­”==2ï¼š
> - åºåˆ—åŒ–å°±æ˜¯æŠŠjavaå¯¹è±¡ï¼Œè½¬æ¢ä¸ºå­—èŠ‚åºåˆ—ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå½“éœ€è¦æŒä¹…åŒ–æˆ–è€…ç½‘ç»œä¼ è¾“çš„æ—¶å€™ï¼Œä¼šç”¨åˆ°åºåˆ—åŒ–ã€‚ä¾‹å¦‚ï¼šå½“æˆ‘ä»¬éœ€è¦æŠŠä¸€ä¸ªå¯¹è±¡ä¿å­˜åˆ°æ–‡ä»¶é‡Œï¼Œæˆ–è€…é€šè¿‡ç½‘ç»œä¼ è¾“è¿™ä¸ªå¯¹è±¡ï¼Œéœ€è¦æŠŠè¿™ä¸ªå¯¹è±¡åºåˆ—åŒ–æˆå­—èŠ‚åºåˆ—ï¼Œå†æ“ä½œã€‚å½“ä»Žæ–‡ä»¶è¯»å–åˆ°å­—èŠ‚åºåˆ—æ—¶ï¼Œéœ€è¦å¯¹å­—èŠ‚åºåˆ—è¿›è¡Œååºåˆ—åŒ–ï¼ŒæŠŠå­—èŠ‚åºåˆ—å˜å›žjavaå¯¹è±¡ï¼Œæ‰èƒ½ç”¨javaç¨‹åºæ¥æ“ä½œè¿™ä¸ªå¯¹è±¡ã€‚==å‰åŽç«¯äº’ä¼ æ•°æ®çš„æ—¶å€™ï¼Œä¹Ÿä¸€èˆ¬ä¼šå°†å¯¹è±¡åºåˆ—åŒ–æˆjsonæ ¼å¼ã€‚è¿™æ ·å¯ä»¥ç»Ÿä¸€æ•°æ®çš„æ ¼å¼ï¼Œæ–¹ä¾¿å‰åŽç«¯çš„å¼€å‘äººå‘˜è¿›è¡Œè”è°ƒ==ã€‚ä½¿ç”¨åºåˆ—åŒ–å¯ä»¥å°†å¯¹è±¡è¿˜åŽŸæˆåŽŸæ¥çš„çŠ¶æ€ã€‚
> - å®žçŽ°åºåˆ—åŒ–ï¼Œéœ€è¦è®©å¯¹è±¡æ‰€å±žçš„ç±»å®žçŽ°SerializableæŽ¥å£ï¼Œ==è¿™ä¸ªæŽ¥å£ï¼Œæˆ‘ä»¬ä¸éœ€è¦å®žçŽ°ä»»ä½•æ–¹æ³•ï¼Œåªæ˜¯å‘Šè¯‰JVMï¼Œè¿™ä¸ªç±»çš„å¯¹è±¡å¯ä»¥è¢«åºåˆ—åŒ–==ï¼Œç„¶åŽæˆ‘ä»¬è¦==ç»™è¿™ä¸ªç±»å®šä¹‰ä¸ªlongç±»åž‹çš„å¸¸é‡serialVersionUIDä¸º1Lï¼Œè¿™ä¸ªå±žæ€§çš„æ„æ€æ˜¯å¯¹è±¡åºåˆ—åŒ–çš„ç‰ˆæœ¬å·ï¼Œç”¨æ¥åœ¨ååºåˆ—åŒ–çš„æ—¶å€™è¿›è¡Œç‰ˆæœ¬åŒ¹é…==ã€‚==å½“æˆ‘ä»¬ä¿®æ”¹è¿™ä¸ªç±»çš„ç»“æž„æ—¶ï¼Œè¦æ”¹ä¸€ä¸‹serialVersionUIDï¼Œæ”¹ä¸ºè·Ÿä¹‹å‰çš„ä¸ä¸€æ ·çš„å°±å¯ä»¥äº†ï¼Œå¦åˆ™ä¼šå¯¼è‡´ååºåˆ—åŒ–å¤±è´¥==ã€‚
>

---



### 13.Java ä¸­çš„åå°„æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿæœ‰å“ªäº›åº”ç”¨åœºæ™¯ï¼Ÿæœ‰å“ªäº›ä¼˜ç¼ºç‚¹ï¼ŸðŸŒŸðŸŒŸðŸŒŸ

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==åå°„æ˜¯ä¸€ç§åœ¨è¿è¡Œæ—¶åŠ¨æ€èŽ·å–ç±»çš„Classå¯¹è±¡ï¼Œç„¶åŽè°ƒç”¨Classå¯¹è±¡çš„æ–¹æ³•å®žçŽ°ä¸šåŠ¡é€»è¾‘çš„æŠ€æœ¯==ã€‚
> 1. æ¯”å¦‚ ==Spring æ¡†æž¶ä¸­å°±å¤§é‡ä½¿ç”¨äº†åå°„æŠ€æœ¯==ã€‚æˆ‘ä»¬åœ¨ ==Application.xml ä¸­é…ç½®ä¸€ä¸ª Bean çš„å…¨ç±»åï¼Œä¹‹åŽ Spring åœ¨é¡¹ç›®å¯åŠ¨æ—¶å°±æ ¹æ®è¿™ä¸ªå…¨ç±»åä½¿ç”¨åå°„èŽ·å– Bean å¯¹åº”çš„ Class å¯¹è±¡==ï¼Œå¹¶é€šè¿‡ Class.newInstance æ–¹æ³•åˆ›å»º Bean å®žä¾‹ã€‚å†æ¯”å¦‚æˆ‘ä»¬å¯ä»¥==é€šè¿‡åå°„èŽ·å–ä¸€ä¸ªæ–¹æ³•çš„ Method å¯¹è±¡ï¼Œç„¶åŽé€šè¿‡æ­¤ Method å¯¹è±¡æŸ¥çœ‹è¯¥æ–¹æ³•æ˜¯å¦æœ‰æŸä¸ªæ³¨è§£==ï¼Œå¹¶ç”±æ­¤è¿›ä¸€æ­¥å®žçŽ°ä¸šåŠ¡é€»è¾‘ã€‚
> 1. ==åå°„çš„ä¼˜ç‚¹æ˜¯å…·æœ‰é«˜çµæ´»æ€§å’Œå¯æ‰©å±•æ€§==ï¼Œæ¯”å¦‚åœ¨ä¸Šè¿°çš„ Spring æ¡†æž¶ä¸­æˆ‘ä»¬å¯ä»¥é€šè¿‡ Application.xml ç»Ÿä¸€ç®¡ç†æ‰€æœ‰çš„ Beanã€‚==ç¼ºç‚¹æ˜¯æ€§èƒ½ä¸å¦‚éžåå°„æ“ä½œï¼Œä¸”å­˜åœ¨å®‰å…¨é£Žé™©==ï¼Œæ¯”å¦‚==æˆ‘ä»¬å¯ä»¥é€šè¿‡åå°„è°ƒç”¨ä¸€ä¸ªç±»çš„ private æ–¹æ³•==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ==åå°„å°±æ˜¯åœ¨ Java ç¨‹åºè¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼ŒåŠ¨æ€èŽ·å¾—æŸä¸ªç±»çš„æ–¹æ³•å˜é‡ï¼Œå¹¶è°ƒç”¨çš„æŠ€æœ¯==ã€‚
> - ==Spring é‡Œé¢å°±å¤§é‡ç”¨åˆ°äº†åå°„ï¼Œæ¯”å¦‚é€šè¿‡ xml æ–‡ä»¶èŽ·å– bean çš„è¿‡ç¨‹==ã€‚å…·ä½“æ¥è¯´ï¼Œåœ¨é…ç½® bean æ—¶éœ€è¦æŒ‡å®šç±»çš„å®Œå…¨é™å®šåï¼Œä¹‹åŽ Spring å°±ä¼šä»Ž xml æ–‡ä»¶ä¸­è¯»å–åˆ°è¿™ä¸ªç±»åï¼Œå¹¶é€šè¿‡åå°„èŽ·å–åˆ°å¯¹åº”çš„ç±»ï¼Œè¿›è€Œè°ƒç”¨è¯¥ç±»çš„æž„é€ å‡½æ•°åˆ›å»ºå®žä¾‹å¯¹è±¡ã€‚
> - é™¤æ­¤ä¹‹å¤–ï¼Œ==Java çš„åŠ¨æ€ä»£ç†ï¼Œåºåˆ—åŒ–ä¸Žååºåˆ—åŒ–ä¸­ä¹Ÿç”¨åˆ°äº†åå°„==ã€‚åœ¨æˆ‘çš„é¡¹ç›®ä¸­ä¸ºäº†å®žçŽ°å¯¹æŸäº›æŽ¥å£é™é¢‘ï¼Œå…ˆæ˜¯å¯¹è¿™äº›æŽ¥å£åŠ ä¸Šè‡ªå®šä¹‰çš„é™é¢‘æ³¨è§£ï¼Œç„¶åŽåœ¨æ‹¦æˆªå™¨ä¸­åˆ©ç”¨åå°„ï¼Œåˆ¤æ–­å°†è¦æ‰§è¡Œçš„æŽ¥å£æ˜¯å¦å«æœ‰é™é¢‘çš„æ³¨è§£ã€‚
> - ==åå°„çš„ä¼˜ç‚¹å°±æ˜¯èƒ½æé«˜ç¨‹åºçš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§==ï¼Œæ¯”å¦‚åˆšè¯´çš„é€šè¿‡ Spring çš„ xml æ–‡ä»¶æ¥ç»Ÿä¸€ç®¡ç† bean ä¿¡æ¯ï¼ŒåŒæ—¶ä¹Ÿ==ç®€åŒ–äº†æŸäº›åŠŸèƒ½çš„å®žçŽ°==ã€‚==ç¼ºç‚¹ä¸»è¦æ˜¯æ€§èƒ½å’Œå®‰å…¨é—®é¢˜==ã€‚==åå°„æ¶‰åŠäº†åŠ¨æ€ç±»åž‹çš„è§£æžï¼Œä¼šæœ‰ä¸€å®šçš„æ€§èƒ½å¼€é”€ï¼Œæ‰€ä»¥åå°„æ“ä½œçš„æ•ˆçŽ‡è¦æ¯”é‚£äº›éžåå°„æ“ä½œä½Ž==ã€‚å…¶æ¬¡ï¼Œ==åå°„å¯ä»¥ç»•è¿‡è®¿é—®ä¿®é¥°ç¬¦çš„é™åˆ¶==ï¼Œå¯¹äºŽç§æœ‰æˆå‘˜ä¹Ÿå¯ä»¥è®¿é—®å’Œä¿®æ”¹ï¼Œå¯èƒ½ä¼šå¯¼è‡´å®‰å…¨é—®é¢˜ã€‚
>

---



### 14.ä»€ä¹ˆæ˜¯åŠ¨æ€ä»£ç†ï¼Ÿæœ‰ä»€ä¹ˆç”¨ï¼ŸJavaä¸­å¯ä»¥æ€Žä¹ˆæ ·å®žçŽ°åŠ¨æ€ä»£ç†ï¼ŸðŸŒŸðŸŒŸðŸŒŸ

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==åŠ¨æ€ä»£ç†æ˜¯åœ¨ä¸æ”¹å˜åŽŸæœ‰æ–¹æ³•çš„å‰æä¸‹ï¼Œå¯¹è¿™äº›æ–¹æ³•è¿›è¡ŒåŠŸèƒ½æ‰©å±•==ã€‚æ¯”å¦‚æˆ‘ä»¬æ‰“å°ä¸€ä¸ªæ–¹æ³•æ‰§è¡Œçš„ç”¨æ—¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡åˆ›å»ºä»£ç†å¯¹è±¡è¿›è¡Œå®žçŽ°ã€‚è€Œåœ¨ ==Spring æ¡†æž¶ä¸‹çš„ aop é¢å‘åˆ‡é¢ç¼–ç¨‹ä¹Ÿæ˜¯é€šè¿‡åŠ¨æ€ä»£ç†æ‰©å±•åŽŸæœ‰æ–¹æ³•==ï¼Œä»Žè€Œå®žçŽ°å‰ç½®é€šçŸ¥ï¼ŒåŽç½®é€šçŸ¥ï¼ŒçŽ¯ç»•é€šçŸ¥ç­‰ã€‚
> 2. å®žçŽ°åŠ¨æ€ä»£ç†çš„æ–¹æ³•ä¸€èˆ¬æœ‰ä¸¤ç§ï¼Œ==java.reflect åŒ…çš„ proxy ç±»ï¼Œå’Œ CGlib çš„ enhancer==ã€‚
> 3. ==java.reflect åŒ…çš„ proxy æ˜¯é¢å‘æŽ¥å£çš„åŠ¨æ€ä»£ç†ï¼Œå®ƒè¦æ±‚è¢«ä»£ç†çš„ç±»å¿…é¡»å®žçŽ°æŽ¥å£==ï¼Œè¿™ä¹Ÿæ˜¯è¯¥æ–¹æ³•çš„å±€é™æ€§ã€‚å…·ä½“æ“ä½œæ˜¯==åˆ›å»ºä¸€ä¸ªç±»å®žçŽ°è¿™äº›æŽ¥å£ï¼Œé€šè¿‡åå°„èŽ·å–åˆ°è¯¥å¯¹è±¡çš„ Method ç±»ï¼Œç„¶åŽåœ¨ method.invoke å‘¨å›´å®žçŽ°æ‰©å±•çš„åŠŸèƒ½==ã€‚
> 4. ==CGlib åˆ™ä¼šåˆ›å»ºä¸€ä¸ªç›®æ ‡ç±»çš„å­ç±»ï¼Œé€šè¿‡é‡å†™å…¶æ–¹æ³•å®žçŽ°å¯¹åŽŸæ–¹æ³•çš„åŠŸèƒ½æ‰©å±•==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - æˆ‘çš„ç†è§£æ˜¯==åŠ¨æ€ä»£ç†ï¼Œå®žé™…ä¸Šå°±æ˜¯åœ¨ä¸æ”¹å˜åŽŸæœ‰ä»£ç çš„æƒ…å†µä¸‹å¯¹åŽŸæœ‰çš„æ–¹æ³•å¢žå¼º==ã€‚å¯¹äºŽä¸€äº›æ–¹æ³•ï¼Œä»–ä»¬å¯èƒ½éœ€è¦ä¸€äº›ç»Ÿä¸€çš„å¤„ç†é€»è¾‘ï¼Œä¾‹å¦‚æ‰“å°æ—¥å¿—ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥==é€šè¿‡åˆ›å»ºä»£ç†å¯¹è±¡ï¼Œæ¥å¯¹åŽŸæœ‰æ–¹æ³•è¿›è¡ŒåŠŸèƒ½ä¸Šçš„åŠ å¼º==ã€‚å®žçŽ°åŠ¨æ€ä»£ç†æœ‰ä¸¤ç§æ–¹å¼ï¼Œ==ä¸€ç§æ˜¯é€šè¿‡jdk reflectåŒ…æä¾›çš„proxyç±»å®žçŽ°ï¼Œè¿˜æœ‰ä¸€ç§æ˜¯é€šè¿‡cglibçš„enhancerå®žçŽ°==ã€‚
> - å¯¹äºŽjdk proxyå®ƒæ˜¯é¢å‘æŽ¥å£çš„åŠ¨æ€ä»£ç†ï¼Œä¹Ÿå°±æ˜¯è¯´==åªæœ‰ä¸€ä¸ªç±»å®žçŽ°äº†æŽ¥å£ï¼Œæˆ‘ä»¬æ‰èƒ½å¯¹å®ƒè¿›è¡Œä»£ç†==ï¼Œæœ¬è´¨ä¸Šæ¥è¯´å°±æ˜¯è¿™ä¸ª==ä»£ç†å¯¹è±¡å®žçŽ°äº†è¢«ä»£ç†å¯¹è±¡çš„æŽ¥å£ï¼Œæ‰€ä»¥å®ƒåªèƒ½å¢žå¼ºæŽ¥å£ä¸­çš„æ–¹æ³•==ï¼Œå…·ä½“ä»£ç é€»è¾‘æ˜¯é€šè¿‡==é‡å†™invokationhandlerçš„invokeæ–¹æ³•ï¼Œé€šè¿‡åå°„çš„æ–¹å¼å¯¹åŽŸæœ‰æ–¹æ³•è¿›è¡Œå¢žå¼º==ã€‚
> - å¯¹äºŽ==cglibçš„enhancerå®ƒæ˜¯é¢å‘çˆ¶ç±»çš„åŠ¨æ€ä»£ç†==ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä»£ç†ä¸€ä¸ªå¯¹è±¡å°±æ˜¯==é€šè¿‡ç»§æ‰¿è¢«ä»£ç†å¯¹è±¡å¯¹åŽŸæœ‰æ–¹æ³•å¢žå¼º==ï¼Œè¿™å°±æ„å‘³ç€å®ƒå¯ä»¥å¢žå¼ºè¢«ä»£ç†å¯¹è±¡çš„æ‰€æœ‰æ–¹æ³•ï¼Œ==å¹¶ä¸”ç”±äºŽåå°„æœºåˆ¶çš„å­˜åœ¨ï¼Œå¯ä»¥èŽ·å–åˆ°çˆ¶ç±»æ–¹æ³•ä¸Šçš„æ‰€æœ‰æ³¨è§£==ã€‚
> - åŠ¨æ€ä»£ç†ç»å¸¸å‡ºçŽ°åœ¨æ¡†æž¶ä¸­ï¼Œä¾‹å¦‚mybatisé€šè¿‡é¢å‘æŽ¥å£çš„åŠ¨æ€ä»£ç†ï¼Œå¯¹æŽ¥å£è¿›è¡Œå®žçŽ°ã€‚==åœ¨spring aopæœºåˆ¶ä¸­ï¼Œé€šè¿‡åŠ¨æ€ä»£ç†æœºåˆ¶ï¼Œå¯¹æ–¹æ³•è¿›è¡Œå¢žå¼ºï¼Œaopä¸­çš„å‰ç½®é€šçŸ¥ï¼Œè¿”å›žé€šçŸ¥ï¼Œå¼‚å¸¸é€šçŸ¥ç­‰ï¼Œéƒ½æ˜¯é€šè¿‡åœ¨åŠ¨æ€ä»£ç†è¿‡ç¨‹ä¸­ï¼Œåœ¨ç›¸å¯¹åŽŸæ–¹æ³•çš„ä¸åŒä½ç½®æ‰§è¡Œå¯¹åº”é€»è¾‘è€Œå®žçŽ°çš„==ã€‚
>

---



## 2.Java é›†åˆ

### 1.ã€HashMapä¸“é¢˜ã€‘hashmap è¿žçŽ¯ç‚®ï¼Œçœ‹çœ‹ä½ èƒ½æŽ¥ä½å¤šå°‘æ‹›ðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==é—®é¢˜ä¸€==ï¼š==HashMap äº†è§£å—ï¼Ÿå¹³æ—¶åœ¨ä»€ä¹ˆåœ°æ–¹ä½¿ç”¨è¿‡å®ƒå‘¢==ï¼Ÿï¼ˆè¯´æ˜Žï¼šå‘çŽ°æ²¡æœ‰ï¼Œæˆ‘å–œæ¬¢é—®ä½¿ç”¨åœºæ™¯ï¼Œå¸Œæœ›å¤§å®¶ä¹Ÿæ˜¯èƒ½å¤Ÿæ€è€ƒä½¿ç”¨åœºæ™¯çš„ï¼Œå› ä¸ºæŽŒæ¡äº†è¿™ä¸ªï¼Œä½ è¯´è¯æ›´åŠ æœ‰è¯´æœåŠ›ï¼‰

==æˆ‘çš„å›žç­”==ï¼š

> 1. HashMap ä¹Ÿå¯ä»¥ç§°ä½œå“ˆå¸Œè¡¨ï¼Œå®ƒçš„==åº•å±‚æ•°æ®ç»“æž„æ˜¯ä¸€ä¸ªå¯å˜æ•°ç»„==ï¼Œå¹¶ä½¿ç”¨==é“¾åœ°å€æ³•å¤„ç†å“ˆå¸Œå†²çª==ï¼Œå…·ä½“çš„å®žçŽ°æ˜¯é‡åˆ°å“ˆå¸Œå†²çªæ—¶ä¼˜å…ˆä»¥==é“¾è¡¨==çš„å½¢å¼åŠ åˆ°å¯å˜æ•°ç»„å¯¹åº”ä½ç½®çš„èŠ‚ç‚¹åŽé¢ï¼Œä¸”==å½“å¯å˜æ•°ç»„è¾¾åˆ°ä¸€å®šé•¿åº¦ä¸”é“¾è¡¨é•¿åº¦ä¹Ÿè¾¾åˆ°ä¸€å®šé•¿åº¦åŽï¼Œä¼šå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘==ï¼Œä»¥æé«˜ CRUD çš„æ•ˆçŽ‡ï¼Œå¹¶ä¸”ç”±äºŽçº¢é»‘æ ‘æ˜¯ â€œé»‘èŠ‚ç‚¹å¹³è¡¡â€ çš„ï¼Œå› æ­¤æŸ¥è¯¢çš„æ—¶é—´ä¹Ÿæ¯”è¾ƒç¨³å®šã€‚
> 2. ==HashMap ä¸»è¦ç”¨äºŽå¯¹å‚¨å­˜çš„æ•°æ®è¿›è¡Œé«˜æ•ˆçš„éšæœºè¯»å†™==ï¼Œæ¯”å¦‚å¯æ ¹æ®ä¸€ä¸ªå¯¹è±¡çš„å”¯ä¸€å­—æ®µå¯¹è¿™ä¸ªå¯¹è±¡çš„é›†åˆè¿›è¡Œé«˜æ•ˆçš„éšæœºè¯»å†™ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - HashMap ä¹Ÿå°±æ˜¯å“ˆå¸Œè¡¨ï¼Œ==åº•å±‚åˆ©ç”¨æ•°ç»„æ”¯æŒä¸‹æ ‡éšæœºè®¿é—®æ•°æ®çš„ç‰¹æ€§ï¼Œå¿«é€Ÿçš„å¯¹é”®å€¼å¯¹è¿›è¡Œè¯»å†™æ“ä½œ==ã€‚
>

---

==é—®é¢˜äºŒ==ï¼š==HashMap åº•å±‚æ•°æ®ç»“æž„è¯´ä¸€ä¸‹ï¼Ÿï¼ˆæŒ‡å¯¼ï¼šç›´æŽ¥è¯´æœ€æ–°çš„å³å¯ï¼Œä¸éœ€è¦åŽ»å¯¹æ¯”ä»¥å‰çš„ç‰ˆæœ¬ï¼Œå› ä¸ºé¢è¯•å®˜ä¹Ÿå¬çƒ¦äº†ï¼Œå¦å¤–åœ¨è¯´çš„æ—¶å€™ï¼Œä¸ºäº†ä½ è¯­è¨€çš„ä¸¥è°¨ï¼Œä¸€å®šè¦å¼ºè°ƒä¸‹æ˜¯å“ªä¸ªJDKç‰ˆæœ¬çš„å“ˆï¼‰==

==æˆ‘çš„å›žç­”==ï¼š

> 1. åœ¨ jdk1.8 åŠä»¥åŽçš„ç‰ˆæœ¬ä¸­ï¼Œåº•å±‚æ•°æ®ç»“æž„æ˜¯ â€œ==å¯å˜æ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘==â€ã€‚é¦–å…ˆå¦‚æžœå¯å˜æ•°ç»„ä¸ºç©ºåˆ™==å…ˆåˆå§‹åŒ–å¤§å°ä¸º16==ï¼Œå°† key çš„ hashCode ç» hash ç®—æ³•å¾—åˆ° ==hash å€¼åŽï¼Œ`i = (n - 1) & hash` å’Œå½“å‰å¯å˜æ•°ç»„å¤§å° - 1ä½œæŒ‰ä½ä¸Žè¿ç®—ï¼Œç›®çš„æ˜¯è®©å¾—åˆ°çš„ç´¢å¼•ä½ç½®ä¸å‡ºç•Œ==ã€‚
> 2. å¦‚æžœç´¢å¼•ä½ç½®æ²¡æœ‰å…ƒç´ åˆ™å°† Node æ”¾åœ¨è¿™é‡Œï¼›å¦åˆ™ä¼š==å…ˆä»¥é“¾è¡¨çš„å½¢å¼åœ¨å…¶åŽåˆ›å»ºæ–°èŠ‚ç‚¹==ï¼Œç„¶åŽ==åˆ¤æ–­é“¾è¡¨æ€»é•¿æ˜¯å¦è¾¾åˆ°é»˜è®¤å€¼8ï¼Œè¾¾åˆ°åŽå³å°è¯•å°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘==ã€‚ä½†æ˜¯å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ==å°è¯•è½¬æ¢çº¢é»‘æ ‘æ—¶å¦‚æžœå¯å˜æ•°ç»„çš„é•¿åº¦å°äºŽé»˜è®¤å€¼64ï¼Œåˆ™è½¬åŒ–å¤±è´¥ï¼Œå¹¶å¯¹å¯å˜æ•°ç»„è¿›è¡Œæ‰©å®¹==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - åœ¨æœ€æ–°çš„ JDK 1.8 ä¸­ï¼ŒHashMap çš„åº•å±‚æ•°æ®ç»“æž„ä¸º â€œ==å“ˆå¸Œè¡¨ + é“¾è¡¨ + çº¢é»‘æ ‘==â€ã€‚å½“å“ˆå¸Œè¡¨ä¸­å‡ºçŽ°å“ˆå¸Œå†²çªæ—¶ï¼ŒHashMap é‡‡ç”¨ â€œ==é“¾åœ°å€æ³•==â€ æ¥è§£å†³ï¼Œä¹Ÿå°±æ˜¯==å“ˆå¸Œè¡¨ä¸­çš„æ¯ä¸ªæ§½ä½ï¼Œéƒ½ä¼šå¯¹åº”ä¸€ä¸ªé“¾è¡¨==ï¼Œæ‰€æœ‰å“ˆå¸Œå€¼ç›¸åŒçš„å…ƒç´ éƒ½ä¼šè¢«æ”¾åˆ°åŒä¸€ä¸ªæ§½ä½å¯¹åº”çš„é“¾è¡¨ä¸­ã€‚ä½†éšç€é“¾è¡¨é•¿åº¦çš„å¢žåŠ ï¼Œå…ƒç´ çš„è¯»å–æ•ˆçŽ‡ä¼šä¸‹é™ï¼Œ==ç›´åˆ°è¾¾åˆ°æŸä¸ªé˜ˆå€¼æ—¶ï¼ˆç›®å‰JDKæ˜¯8ï¼‰ï¼ŒHashMap ä¼šå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘==ï¼Œè¿›ä¸€æ­¥æå‡æ€§èƒ½ã€‚
>

---

==é—®é¢˜ä¸‰==ï¼š==ä¸ºä»€ä¹ˆç”¨çº¢é»‘æ ‘å‘¢ï¼Ÿç”¨å¹³è¡¡äºŒå‰æ ‘ä¸å¯ä»¥å—ï¼Ÿæˆ–è€…ä½ è®²ä¸€è®²ä»–ä»¬å„è‡ªçš„ä¼˜ç¼ºç‚¹å—ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==çº¢é»‘æ ‘æ˜¯å¼±å¹³è¡¡æ ‘==ï¼Œè€Œ==AVLæ ‘æ˜¯å¼ºå¹³è¡¡æ ‘ï¼Œå…¶æ’å…¥å’Œåˆ é™¤èŠ‚ç‚¹çš„é€Ÿåº¦æ¶‰åŠè¾ƒå¤šçš„å­æ ‘æ—‹è½¬æ“ä½œ==ï¼Œå› æ­¤==çº¢é»‘æ ‘çš„æ’å…¥å’Œåˆ é™¤èŠ‚ç‚¹çš„é€Ÿåº¦æ¯”AVLæ ‘æ›´å¿«==ã€‚ä½†æ˜¯==çº¢é»‘æ ‘éœ€è¦é¢å¤–çš„å­—æ®µå­˜å‚¨èŠ‚ç‚¹çš„é¢œè‰²ä¿¡æ¯==ï¼Œå› æ­¤åœ¨ç©ºé—´ä¸Šä¸å¦‚AVLæ ‘ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ==çº¢é»‘æ ‘æ˜¯å¼±å¹³è¡¡äºŒå‰æ ‘ï¼Œæ•´æ£µæ ‘å¯ä»¥æœ‰å±€éƒ¨çš„ä¸å¹³è¡¡==ã€‚==AVL æ ‘æ˜¯å¼ºå¹³è¡¡äºŒå‰æ ‘==ï¼Œå®ƒä¸¥æ ¼è¦æ±‚æ•´æ£µæ ‘çš„å¹³è¡¡æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè™½ç„¶ä¸¤è€…çš„æ’å…¥ï¼Œåˆ é™¤å¤æ‚åº¦éƒ½ä¸º O*(*logn)ï¼Œå®žé™…ä¸­ ==AVL æ ‘éœ€è¦æ‰§è¡Œæ›´å¤šçš„æ—‹è½¬æ“ä½œæ¥ä¿è¯å¼ºå¹³è¡¡æ€§ï¼Œæ•ˆçŽ‡è¦ä½ŽäºŽçº¢é»‘æ ‘==ã€‚ä½†çº¢é»‘æ ‘ä¹Ÿæœ‰ç¼ºç‚¹ï¼Œ==å®ƒéœ€è¦é¢å¤–çš„å­—æ®µæ¥è®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„é¢œè‰²==ï¼Œå› æ­¤ä¼šå ç”¨æ›´å¤šçš„å­˜å‚¨ç©ºé—´ã€‚
>

----

==é—®é¢˜å››==ï¼š==ä¸ºä»€ä¹ˆé€‰æ‹© 8 ä¹‹åŽè½¬ä¸ºçº¢é»‘æ ‘å‘¢ï¼Ÿå¦å¤–é“¾è¡¨è½¬ä¸ºçº¢é»‘æ ‘ä¹‹åŽï¼Œè¿˜ä¼šç»§ç»­è½¬ä¸ºé“¾è¡¨å—ï¼Ÿ==ï¼ˆæœ€å¥½çœ‹è¿‡æºç è¯´æ˜Žï¼‰

==æˆ‘çš„å›žç­”==ï¼š

> 1. å½“é“¾è¡¨çš„é•¿åº¦è¿‡é•¿æ—¶ï¼Œå“ˆå¸Œè¡¨å¯¹è¿™äº›å…ƒç´ è¯»å†™çš„æ•ˆçŽ‡ä¼šé™ä½Žï¼Œå°†å…¶==è½¬åŒ–ä¸ºçº¢é»‘æ ‘å¯ä»¥æå‡è¯»å†™çš„æ•ˆçŽ‡==ã€‚
> 2. ä¹‹æ‰€ä»¥é€‰æ‹©8åˆ™æ˜¯å› ä¸º==å‘ç”Ÿå“ˆå¸Œå†²çªå¯¼è‡´æŸä¸€é“¾è¡¨çš„é•¿åº¦è¾¾åˆ°8å¹¶ä¸å®¹æ˜“ï¼Œè¿™æ˜¯ä¸ºäº†é˜²æ­¢æžç«¯æƒ…å†µä¸‹å“ˆå¸Œè¡¨è¯»å†™æ•ˆçŽ‡é™ä½Žçš„é£Žé™©==ã€‚
> 3. å½“==çº¢é»‘æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°å°äºŽ6æ—¶ï¼Œä¼šå°†çº¢é»‘æ ‘è½¬å›žé“¾è¡¨==ã€‚è¿™æ˜¯ç”±äºŽå½“èŠ‚ç‚¹ä¸ªæ•°è¾ƒå°‘æ—¶ï¼Œä½¿ç”¨çº¢é»‘æ ‘åœ¨æ—¶é—´å’Œç©ºé—´ä¸Šéƒ½åè€Œä¸å¦‚é“¾è¡¨ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - è¿™ä¸ªåœ¨æºç çš„æ³¨é‡Šä¸­æœ‰è§£é‡Šï¼Œå¤§è‡´æ„æ€ä¸ºï¼šå¦‚æžœå…ƒç´ çš„å“ˆå¸Œå€¼è¶³å¤Ÿéšæœºï¼Œç†æƒ³æƒ…å†µä¸‹é“¾è¡¨çš„é•¿åº¦å¯¹åº”çš„æ¦‚çŽ‡ç¬¦åˆæ³Šæ¾åˆ†å¸ƒï¼Œ==è¾¾åˆ° 8 çš„æ¦‚çŽ‡å°äºŽåƒä¸‡åˆ†ä¹‹ä¸€==ã€‚
>
> 	```java
> 	     * Because /*TreeNodes are about twice the size of regular nodes*/, we
> 	     * use them only when bins contain enough nodes to warrant use
> 	     * (see TREEIFY_THRESHOLD). /*And when they become too small (due to
> 	     * removal or resizing) they are converted back to plain bins*/. In
> 	     * usages with well-distributed user hashCodes, tree bins are
> 	     * rarely used. The first values are:
> 	     *
> 	     * 0:    0.60653066
> 	     * 1:    0.30326533
> 	     * 2:    0.07581633
> 	     * 3:    0.01263606
> 	     * 4:    0.00157952
> 	     * 5:    0.00015795
> 	     * 6:    0.00001316
> 	     * 7:    0.00000094
> 	     * 8:    0.00000006
> 	     * more: less than 1 in ten million
> 	```
>
> 	ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å¹¶ä¸ä¼šå‘ç”Ÿé“¾è¡¨åˆ°çº¢é»‘æ ‘çš„è½¬åŒ–ï¼Œæ›´å¤šæ˜¯ä¸€ç§==é˜²æ­¢è‡ªå·±é€‰å–çš„å“ˆå¸Œç®—æ³•ä¸å¥½çš„ä¿åº•ç­–ç•¥==ï¼Œåœ¨æžç«¯æƒ…å†µä¸‹ä»ä¼šæœ‰è¾ƒå¥½çš„æ•ˆçŽ‡ã€‚
>
> - ä½†æ˜¯ï¼Œå½“==çº¢é»‘æ ‘çš„èŠ‚ç‚¹å°äºŽ 6 æ—¶ï¼Œçº¢é»‘æ ‘åˆä¼šè½¬å›žé“¾è¡¨==ï¼ŒåŽŸå› æ˜¯æ•°æ®é‡å¾ˆå°çš„æƒ…å†µä¸‹ï¼Œç©ºé—´å’Œæ—¶é—´ä¸Šé“¾è¡¨éƒ½è¦æ¯”çº¢é»‘æ ‘ä¼˜ç§€ã€‚==è‡³äºŽä¸ºä»€ä¹ˆè¦æŠŠè¿™ä¸ªé˜ˆå€¼å®šä¸º 6ï¼Œè€Œä¸åŒæ ·å®šä¸º 8ï¼Œä¸»è¦æ˜¯è€Œä¸ºäº†é˜²æ­¢å…ƒç´ æ•°é‡åœ¨ 8 é™„è¿‘å¯¼è‡´ä¸¤ç§æ•°æ®ç»“æž„çš„é¢‘ç¹è½¬æ¢==ã€‚
>

---

==é—®é¢˜äº”==ï¼š==ç®€å•æè¿°ä¸‹ put çš„æµç¨‹ï¼Ÿå¯ä»¥è¯´ä¸€ä¸‹JDKä¸ºäº†æ•ˆçŽ‡æ›´å¿«ï¼Œåœ¨ put çš„æ—¶å€™ï¼Œåšäº†å“ªäº›ä¼˜åŒ–ä¸ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. é¦–å…ˆä¼š==è°ƒç”¨ HashMap çš„ hash æ–¹æ³•æ ¹æ® key çš„ hashCode ç”Ÿæˆä¸€ä¸ª hash å€¼==ï¼Œå°†å…¶å’Œ KV ä¸€åŒä¼ å…¥ putVal æ–¹æ³•ã€‚
>
> 2. åœ¨ putVal æ–¹æ³•ä¸­ï¼Œ==é¦–å…ˆä¼šæ£€æŸ¥å¯å˜æ•°ç»„æ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºåˆ™åˆå§‹åŒ–è‡³16çš„å¤§å°==ã€‚ç„¶åŽé€šè¿‡
>
> 	```java
> 	i = (n - 1) & hash
> 	```
>
> 	==è®¡ç®—ç´¢å¼•å€¼==ï¼Œè¿›è¡ŒæŒ‰ä½ä¸Žè¿ç®—æ˜¯ä¸ºäº†é˜²æ­¢ç´¢å¼•å€¼å‡ºç•Œã€‚ç„¶åŽ==åˆ¤æ–­ç´¢å¼•å¤„èŠ‚ç‚¹æ˜¯å¦ä¸ºç©º==ï¼Œä¸ºç©ºå°±ç›´æŽ¥å°†æ–°çš„ Node æ”¾ç½®åœ¨è¿™é‡Œã€‚
>
> 3. å¦‚æžœä¸ä¸ºç©ºåˆ™==å…ˆéåŽ†æŸ¥çœ‹æ˜¯å¦å·²æ’å…¥è¯¥èŠ‚ç‚¹ï¼Œå·²æœ‰åˆ™æ›´æ–° value å€¼==ï¼Œå¦åˆ™==å°è¯•ä»¥é“¾è¡¨å½¢å¼æ·»åŠ èŠ‚ç‚¹==ï¼Œç„¶åŽ==åˆ¤æ–­é“¾è¡¨æ€»é•¿æ˜¯å¦è¾¾åˆ°é»˜è®¤å€¼8ï¼Œè¾¾åˆ°åŽå³å°è¯•å°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘==ã€‚ä½†æ˜¯å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ==å°è¯•è½¬æ¢çº¢é»‘æ ‘æ—¶å¦‚æžœå¯å˜æ•°ç»„çš„é•¿åº¦å°äºŽé»˜è®¤å€¼64ï¼Œåˆ™è½¬åŒ–å¤±è´¥ï¼Œå¹¶å¯¹å¯å˜æ•°ç»„è¿›è¡Œæ‰©å®¹==ã€‚
>
> 4. ==æœ€åŽåˆ¤æ–­æ·»åŠ å®ŒæˆåŽå¯å˜æ•°ç»„å·²ç”¨èŠ‚ç‚¹æ•°æ˜¯å¦è¾¾åˆ°æ€»å¤§å°çš„é»˜è®¤0.75å€==ï¼Œè¾¾åˆ°å°±è¿›è¡Œæ‰©å®¹ã€‚
>
> 5. ä¼˜åŒ–ä¹‹ä¸€æ˜¯åœ¨==è®¡ç®—ç´¢å¼•å€¼æ—¶ï¼Œä»¥æŒ‰ä½ä¸Žè¿ç®—ä»£æ›¿å–æ¨¡è¿ç®—æå‡äº†æ•ˆçŽ‡==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - é¦–å…ˆ put( ) ä¼šè®¡ç®—å‡ºè¦æ’å…¥ key çš„å“ˆå¸Œå€¼ï¼Œé€šè¿‡å“ˆå¸Œå€¼è®¡ç®—å‡ºå…¶åœ¨æ•°ç»„ä¸­çš„==ç´¢å¼•ä½ç½®==ï¼Œå¦‚æžœè¯¥ä½ç½®ä¸Šæ²¡æœ‰å…ƒç´ åˆ™ç›´æŽ¥æ’å…¥ï¼Œæœ‰å…ƒç´ åˆ™éœ€è¦éåŽ†è¿™ä¸ªä½ç½®ä¸Šçš„æ‰€æœ‰å…ƒç´ ã€‚==å¦‚æžœèƒ½æ‰¾åˆ°ä¸Žå½“å‰é”®ç›¸ç­‰çš„é”®å€¼å¯¹ï¼Œåˆ™å°†å…¶æ›´æ–°ä¸ºå½“å‰å€¼å¹¶è¿”å›žæ—§å€¼==ï¼Œå¦‚æžœæ‰¾ä¸åˆ°ä¸Žå½“å‰é”®ç›¸ç­‰çš„é”®å€¼å¯¹ï¼Œåˆ™éœ€è¦æ‰§è¡ŒçœŸæ­£çš„æ’å…¥æ“ä½œï¼Œå°†å…¶==æ’å…¥åˆ°é“¾è¡¨æˆ–è€…çº¢é»‘æ ‘ä¸­==ï¼Œæœ€åŽ==åˆ¤æ–­æ’å…¥åŽæ˜¯å¦éœ€è¦æ‰©==å®¹ã€‚
> - put( ) çš„ä¼˜åŒ–æˆ‘å°è±¡æ·±çš„æ˜¯è®¡ç®— key å“ˆå¸Œå€¼çš„ hash( )ï¼Œä¸»è¦æœ‰==ä¸¤ä¸ªä¼˜åŒ–çš„ç‚¹==ï¼š==ä½¿ç”¨ä½è¿ç®—ä»£æ›¿å–æ¨¡è¿ç®—==å’Œ==å¯¹ hashCode è¿›è¡Œæ…åŠ¨è®¡ç®—==ã€‚å…·ä½“æ¥è¯´ï¼Œå¯ä»¥ç”¨xè¿™ä¸ªå…¬å¼==å°†å–æ¨¡è½¬å˜ä¸ºä½è¿ç®—æ¥æå‡æ€§èƒ½==ï¼Œä½†æ˜¯åŒæ—¶ä¹Ÿéœ€è¦åº•å±‚æ•°ç»„çš„é•¿åº¦æ˜¯ 2 çš„å€æ•°ï¼Œè¿™ä¸ªåœ¨ HashMap çš„åˆå§‹åŒ–å’Œæ‰©å®¹æ–¹æ³•ä¸­åšäº†ä¿è¯ã€‚
> - é™¤æ­¤ä¹‹å¤–ï¼Œ==ä¸ºäº†è¿›ä¸€æ­¥é™ä½Žå“ˆå¸Œå†²çªçš„æ¦‚çŽ‡ï¼Œhash( ) åˆé€šè¿‡å¤šä¸ªä¸Žè¿ç®—å°†å“ˆå¸Œå€¼çš„é«˜ä½å’Œä½Žä½è¿›è¡Œæ…åŠ¨ï¼Œå°½å¯èƒ½çš„åšåˆ°åœ¨ä¸åŒ key ä¸­å“ªæ€•æœ‰ä¸€ä¸ªä½çš„ä¸åŒï¼Œéƒ½ä¼šå¯¹æœ€ç»ˆäº§ç”Ÿçš„å“ˆå¸Œå€¼é€ æˆå½±å“==ã€‚
>

---

==é—®é¢˜å…­==ï¼š==å¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼Œput æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿå¯ä»¥ç®€å•ä¸¾ä¸ªä¾‹å­ï¼Œè¯´ä¸€ä¸‹å“ªé‡Œä¸å®‰å…¨å—ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==put çº¿ç¨‹ä¸å®‰å…¨==ï¼Œå› ä¸º HashMap çš„ put å’Œ putVal æ–¹æ³•ä¸­å¹¶æ²¡æœ‰é‡‡å–å¹¶å‘æŽ§åˆ¶çš„æŽªæ–½ã€‚
> 2. æ¯”å¦‚æœ‰==å¤§é‡çº¿ç¨‹åŒæ—¶å‘åŒä¸€ä¸ª HashMap ä¸­ put åŒä¸€ä¸ª KV==ï¼Œå‡è®¾ç´¢å¼•ä½ç½®ä¸ä¸ºç©ºï¼Œå°±å¯èƒ½å‡ºçŽ°ä¹‹å‰çš„ KV è¿˜æ²¡æ”¾å…¥ HashMapï¼Œ==åŽç»­çº¿ç¨‹åœ¨éåŽ†é“¾è¡¨æ—¶å‘çŽ°è¯¥ KV è¿˜æ²¡å†™å…¥å“ˆå¸Œè¡¨ä¸­ï¼Œä¾¿å‘åŒä¸€ä¸ªé“¾è¡¨ä¸­æ’å…¥å¤§é‡ç›¸åŒçš„èŠ‚ç‚¹ï¼Œå¯¼è‡´é“¾è¡¨è¿‡é•¿==ï¼Œå¹¶æ²¡æœ‰è¢«åŒ–ä¸ºçº¢é»‘æ ‘ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ==ä¸æ˜¯==ï¼Œåœ¨ JDK 1.7 ä¸­==å¤šçº¿ç¨‹åŒæ—¶è¿›è¡Œ put( ) ä¼šå‡ºçŽ°æ•°æ®è¦†ç›–é—®é¢˜==ï¼Œåœ¨éœ€è¦æ‰©å®¹æ—¶ä¹Ÿå¯èƒ½ä¼šå‡ºçŽ°é“¾æ­»å¾ªçŽ¯é—®é¢˜ã€‚JDK 1.8 ä¿®å¤äº†é“¾æ­»å¾ªçŽ¯ï¼Œ==ä½†æ•°æ®è¦†ç›–é—®é¢˜ä¾ç„¶å­˜åœ¨==ã€‚
> - ==JDK 1.7== çš„ HashMap åº•å±‚ä¸ºæ•°ç»„ + é“¾è¡¨ï¼Œæ‰©å®¹çš„ transfer( ) ä¼šéåŽ†åŽŸé“¾è¡¨ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ï¼Œé‡‡ç”¨==å¤´æ’æ³•==å°†å…¶è½¬ç§»åˆ°æ–°å“ˆå¸Œè¡¨æ§½ä½çš„é“¾è¡¨ä¸­ï¼Œè¿™ä¸ªè¿‡ç¨‹åœ¨å¤šçº¿ç¨‹ä¸‹ä¼š==å¯¼è‡´æ–°é“¾è¡¨ä¸­å‡ºçŽ°çŽ¯è·¯==ï¼Œå¹¶é€ æˆæŸäº›å…ƒç´ ä¸¢å¤±ã€‚
> - JDK 1.8 é‡‡ç”¨çš„æ˜¯å°¾æ’æ³•ï¼Œä¿è¯äº†å…ƒç´ åœ¨æ‰©å®¹å‰åŽçš„é¡ºåºä¸€è‡´ï¼Œé¿å…äº†æ­»å¾ªçŽ¯é—®é¢˜ï¼Œä½†è¿˜ä¼šé€ æˆæ•°æ®è¦†ç›–ã€‚==å¦‚ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œ putï¼Œä¸”ä¸¤ä¸ªçº¿ç¨‹éƒ½åŒæ—¶åˆ¤æ–­æ§½ä½ä¸ºç©ºï¼Œåˆ™åŽæ’å…¥çš„æ•°æ®ä¼šè¦†ç›–å…ˆæ’å…¥çš„æ•°æ®==ã€‚
>

---

==é—®é¢˜ä¸ƒ==ï¼š==å¦‚æžœæˆ‘æƒ³è¦è®© hashmap å˜æˆçº¿ç¨‹å®‰å…¨çš„ï¼Œä½ è§‰å¾—å¯ä»¥æ€Žä¹ˆåšï¼Ÿï¼ˆæœ‰æ—¶å€™ä¼šæ‰¯åˆ° concurrentHashMapï¼Œä¸è¿‡å’±ä»¬è¿™é‡Œå…ˆä¸è¿½å‡»è¿™ä¸ªï¼‰==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==å¯ä»¥ä½¿ç”¨ HashTable ä»£æ›¿==ï¼ŒHashTable ç»™å¤§éƒ¨åˆ†æ–¹æ³•ç”¨ synchronized ä¿®é¥°ï¼Œä»¥åŠ äº’æ–¥é”çš„æ–¹å¼å®žçŽ°äº†çº¿ç¨‹å®‰å…¨ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - æƒ³è¦è§£å†³ HashMap çš„çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜ï¼Œé¦–å…ˆæˆ‘ä»¬ä¸èƒ½ä¿®æ”¹æºç ï¼Œé‚£å°±è¦ä¹ˆä½¿ç”¨ä¸€äº› â€œè¾…åŠ©â€ æ“ä½œï¼Œè®©å®ƒå˜å¾—å®‰å…¨ï¼Œè¦ä¹ˆå°±å¯»æ‰¾æ›¿ä»£å“ã€‚é¦–å…ˆè¯´çš„ â€œè¾…åŠ©â€ æ“ä½œæ˜¯æŒ‡ï¼Œ==ä½¿ç”¨ Collections ç±»çš„ synchronizedMap æ–¹æ³•åŒ…è£…ä¸€ä¸‹ï¼Œå®ƒè¿”å›žç”±æŒ‡å®šæ˜ å°„æ”¯æŒçš„åŒæ­¥æ˜ å°„ï¼Œæ˜¯çº¿ç¨‹å®‰å…¨çš„==ã€‚æ¢æ›¿ä»£å“çš„è¯ï¼Œå¯ä»¥è€ƒè™‘ HashTableï¼Œ==HashTable é€šè¿‡å°†æ•´ä¸ªè¡¨ä¸Šé”æ¥å®žçŽ°çº¿ç¨‹å®‰å…¨==ï¼ŒæŸäº›æƒ…å†µä¸‹æ•ˆçŽ‡å¾ˆä½Žã€‚è¿˜å¯ä»¥ä½¿ç”¨ ==ConcurrentHashMapï¼Œå®ƒä½¿ç”¨åˆ†æ®µé”æˆ–è€… CAS æ“ä½œæ¥ä¿è¯çº¿ç¨‹å®‰å…¨==ã€‚
>

---

==é—®é¢˜å…«==ï¼š==å¤´æ’æ³•ä¼šå¯¼è‡´æ­»å¾ªçŽ¯ï¼Œé‚£ä½ è§‰å¾—åœ¨ä»¥å‰çš„ç‰ˆæœ¬ä¸­ï¼Œä¸ºå•¥ä¼šä½¿ç”¨å¤´æ’æ³•å‘¢ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ä¹‹æ‰€ä»¥æŠŠæ–°å…ƒç´ æ’åˆ°é“¾è¡¨å¤´éƒ¨ï¼Œæ˜¯å› ä¸º==è®¤ä¸ºæ–°åŠ å…¥çš„å…ƒç´ åœ¨ä¹‹åŽæ›´æœ‰å¯èƒ½è¢«è®¿é—®åˆ°==ï¼Œå› æ­¤æ”¾åˆ°å¤´éƒ¨å¯ä»¥ç•¥å¾®æå‡æ€§èƒ½ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - é‡‡ç”¨å¤´æ’æ³•çš„è¯ï¼Œæœ€æ–°æ’å…¥çš„æ•°æ®å°±ä¼šåœ¨é“¾è¡¨çš„æœ€å‰è¾¹ï¼Œ==æ ¹æ®ç¨‹åºçš„å±€éƒ¨æ€§åŽŸç†ï¼Œæœ€è¿‘è¢«è®¿é—®çš„æ•°æ®å¾ˆå¯èƒ½ä¸ä¹…ä¹‹åŽä¼šå†æ¬¡è®¿é—®==ï¼Œé‚£ä¹ˆæ­¤æ—¶å¯ä»¥åœ¨ O(1) æ—¶é—´è¿”å›žã€‚
>

---

==é—®é¢˜ä¹==ï¼š==é‚£æˆ‘ä»¬å†è¯´ä¸€è¯´ HashMap çš„æ‰©å®¹å§ï¼Œä»€ä¹ˆæ—¶å€™ä¼šæ‰©å®¹å‘¢ï¼Ÿä½ è§‰å¾—ä¸ºå•¥è´Ÿè½½å› å­ä¸ºå•¥é€‰æ‹© 0.75 å‘¢ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. HashMap æ‰©å®¹çš„æ—¶æœºä¸€èˆ¬æœ‰ä¸¤ä¸ªï¼Œ==å¯å˜æ•°ç»„ä½¿ç”¨å…ƒç´ ä¸ªæ•°è¾¾åˆ°æ€»é‡ä¹˜è´Ÿè½½å› å­==å’Œ==é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘æ—¶å¯å˜æ•°ç»„å®¹é‡æ²¡æœ‰è¾¾åˆ°é»˜è®¤å€¼64==ã€‚
> 2. è´Ÿè½½å› å­é€‰æ‹©ä¸º0.75æ˜¯==ç©ºé—´åˆ©ç”¨çŽ‡å’Œå“ˆå¸Œå†²çªçŽ‡é—´çš„ä¸€ä¸ªå¹³è¡¡==ã€‚å¦‚æžœ==è´Ÿè½½å› å­è¿‡ä½Žï¼Œä¼šå¯¼è‡´é¢‘ç¹è§¦å‘æ‰©å®¹ï¼Œè€Œæµªè´¹è¾ƒå¤šç©ºé—´==ï¼›è€Œ==è´Ÿè½½å› å­è¿‡é«˜ï¼Œä¼šå¯¼è‡´è¿Ÿè¿Ÿä¸æ‰©å®¹ï¼Œæé«˜äº†å“ˆå¸Œå†²çªå‘ç”Ÿçš„é£Žé™©==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - HashMap éœ€è¦æ‰©å®¹æ—¶ï¼Œå¯ä»¥åˆ†ä¸ºå‡ ç§æƒ…å†µæ¥è€ƒè™‘ã€‚
> - é¦–å…ˆæ˜¯åœ¨æ— å‚çš„æž„é€ å‡½æ•°ä¸­ã€‚åœ¨ç¬¬ä¸€æ¬¡è¿›è¡Œ put æ“ä½œä¹‹å‰ï¼ŒHashMap å†…éƒ¨æ•°ç»„ä¸º nullï¼Œç¬¬ä¸€æ¬¡ put åŽæ‰ä¼šå¼€å§‹==ç¬¬ä¸€æ¬¡åˆå§‹åŒ–æ‰©å®¹ï¼Œé»˜è®¤ä¸º 16== ã€‚
> - å…¶æ¬¡æ˜¯æŒ‡å®šäº†åˆå§‹å®¹é‡çš„æž„é€ å‚æ•°ï¼Œä¹Ÿæ˜¯åœ¨ç¬¬ä¸€æ¬¡ put æ“ä½œä¹‹åŽæ‰å¼€å§‹åˆå§‹åŒ–æ‰©å®¹ï¼Œä½†æ­¤æ—¶çš„==å®¹é‡æ˜¯ç¬¬ä¸€ä¸ªä¸å°äºŽæŒ‡å®šå®¹é‡çš„ 2 çš„å¹‚æ•°==ï¼Œé˜ˆå€¼ä¸ºè®¡ç®—åŽå®¹é‡ä¹˜è´Ÿè½½å› å­ã€‚
> - å…¶å®ƒæƒ…å†µå°±æ˜¯ï¼Œéžé¦–æ¬¡ putï¼Œå¯¼è‡´å®¹é‡å¤§äºŽé˜ˆå€¼ï¼Œéœ€è¦æ‰©å®¹ã€‚==å®¹é‡å’Œé˜ˆå€¼éƒ½å˜ä¸ºåŽŸæ¥çš„ 2 å€ï¼Œè´Ÿè½½å› å­ä¸å˜==ã€‚
> - è´Ÿè½½å› å­ä¸º 0,75 çš„åŽŸå› ï¼Œç®€å•æ¥è¯´æ˜¯ â€œ==å“ˆå¸Œå†²çªâ€ å’Œ â€œç©ºé—´åˆ©ç”¨çŽ‡â€œ çŸ›ç›¾çš„ä¸€ä¸ªæŠ˜ä¸­==ã€‚åŽŸå› æ˜¯ï¼Œæ‰©å®¹å› å­æ˜¯ç”¨æ¥è®¡ç®—é˜ˆå€¼çš„ï¼Œé˜ˆå€¼ä¸ºåº•å±‚ table é•¿åº¦ä¹˜è´Ÿè½½å› å­ï¼Œå½“ HashMap å®¹é‡å¤§äºŽé˜ˆå€¼æ—¶ä¼šè§¦å‘æ‰©å®¹ã€‚æ‰€ä»¥å¦‚æžœè´Ÿè½½å› å­è¿‡å°ï¼Œtable ä¸­è¿˜æ²¡å¡«å‡ ä¸ªå…ƒç´ å°±è¦æ‰©å®¹ï¼Œè™½ç„¶å“ˆå¸Œå†²çªæ¦‚çŽ‡å¾ˆå°ï¼Œä½†ç©ºé—´æµªè´¹å¤ªå¤šã€‚ç›¸åï¼Œå¦‚æžœè´Ÿè½½å› å­è¿‡å¤§ï¼Œç©ºé—´åˆ©ç”¨çŽ‡æ˜¯é«˜ï¼Œä½†å“ˆå¸Œå†²çªçš„æ¦‚çŽ‡ä¹Ÿå¤§å¤§å¢žåŠ ã€‚é‚£å°±å–ä¸ªæŠ˜ä¸­å§ï¼Œä¸º 0.75ã€‚
>

----

==é—®é¢˜å==ï¼š==é¢‘ç¹æ‰©å®¹ä¼šå¯¼è‡´æ•ˆçŽ‡æ¯”è¾ƒä½Žä¸‹ï¼Œé‚£ä½ è§‰å¾—åœ¨å¹³æ—¶ï¼Œåœ¨å®žé™…çš„å¼€å‘åœºæ™¯ä¸­ï¼Œå¯ä»¥æ€Žä¹ˆä¼˜åŒ–æ¥é¿å…é¢‘ç¹æ‰©å®¹å‘¢ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. åœ¨åˆ›å»ºå“ˆå¸Œè¡¨ä¹‹å‰åˆç†ä¼°ç®—ä¸šåŠ¡çš„è§„æ¨¡ï¼Œåœ¨==å“ˆå¸Œè¡¨åˆå§‹åŒ–æ—¶æ˜¾ç¤ºåœ°å°†å“ˆå¸Œè¡¨çš„åˆå§‹å®¹é‡è®¾ç½®ä¸ºå¤§äºŽä¸šåŠ¡è§„æ¨¡çš„æœ€å°2çš„å¹‚æ¬¡==ã€‚
> 2. ==ä¼˜åŒ–å“ˆå¸Œå‡½æ•°==ï¼Œæå‡ä¸åŒ key å€¼å¾—åˆ°çš„ hash å€¼çš„åŒºåˆ†åº¦ï¼Œé™ä½Žå†²çªçš„æ¦‚çŽ‡ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - å®¹æ˜“æƒ³åˆ°çš„å°±æ˜¯ï¼Œæå‰é¢„ä¼°ä¸šåŠ¡çš„å­˜å‚¨é‡ï¼Œè®¾ç½®ä¸€ä¸ªè¾ƒå¤§çš„åˆå§‹å®¹é‡ã€‚==è¿™æ—¶ä¸ç”¨è€ƒè™‘å®ƒæ˜¯å¦æ˜¯ 2 çš„æ¬¡å¹‚ï¼ŒHashMap è‡ªå·±ä¼šè®¡ç®—å‡ºç¬¬ä¸€ä¸ªå¤§äºŽç­‰äºŽç»™å®šå®¹é‡çš„ 2 æ¬¡å¹‚æ¥ä½œä¸ºåˆå§‹å®¹é‡==ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå¯ä»¥==è‡ªå®šä¹‰è´Ÿè½½å› å­çš„å¤§å°ï¼Œå¯¹å“ˆå¸Œå‡½æ•°ä¼˜åŒ–==ç­‰ç­‰ã€‚
>

---

==é—®é¢˜åä¸€==ï¼š==ä¸€ä¸ªåœºæ™¯é¢˜ï¼šåªå­˜60ä¸ªé”®å€¼å¯¹ï¼Œéœ€è¦è®¾ç½®åˆå§‹åŒ–å®¹é‡å—ï¼Ÿè®¾ç½®çš„è¯è®¾ç½®å¤šå°‘åˆå§‹åŒ–å®¹é‡æ¯”è¾ƒå¥½å‘¢ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. å¦‚æžœä¸è®¾ç½®åˆå§‹åŒ–å®¹é‡çš„è¯ï¼Œ==60ä¸ªé”®å€¼å¯¹å¯èƒ½ä¼š16->32->64->128ç»è¿‡æœ€å¤šä¸‰æ¬¡æ‰©å®¹ï¼Œè¾ƒä¸ºé¢‘ç¹==ã€‚
> 2. ç¬¬ä¸€ä¸ªå¤§äºŽ60çš„2çš„å¹‚æ¬¡æ˜¯64ï¼Œ==ä½†æ˜¯64*0.75=48<60ï¼Œä¾ç„¶å¾ˆæœ‰å¯èƒ½ä¼šè§¦å‘ä¸€æ¬¡æ‰©å®¹==ï¼Œè€Œ64/0.75=85ï¼Œ==è€ƒè™‘åˆ°HashMap è‡ªå·±ä¼šè®¡ç®—å‡ºç¬¬ä¸€ä¸ªå¤§äºŽç­‰äºŽç»™å®šå®¹é‡çš„ 2 æ¬¡å¹‚æ¥ä½œä¸ºåˆå§‹å®¹é‡ï¼Œæ‰€ä»¥éšæœºé€‰ä¸€ä¸ª 65 â€“ 128 ä¹‹é—´çš„æ•°ä½œä¸ºåˆå§‹å®¹é‡å³å¯==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - HashMap é»˜è®¤çš„åˆå§‹å®¹é‡å¤§å°ä¸º 16ã€‚å¦‚æžœä¸è®¾ç½®åˆå§‹å®¹é‡çš„è¯ï¼Œæ ¹æ®è§„åˆ™ size > threshold æ—¶ä¼šè§¦å‘æ‰©å®¹ï¼Œä¸” threshold = loadFactor *capacitryï¼Œ==æœ€ç»ˆ capacity ä¼šç»åŽ† 16 â€“ 32 â€“ 64 â€“ 128 ä¸‰æ¬¡æ‰©å®¹æ“ä½œ==ã€‚==è€ƒè™‘åˆ°HashMap è‡ªå·±ä¼šè®¡ç®—å‡ºç¬¬ä¸€ä¸ªå¤§äºŽç­‰äºŽç»™å®šå®¹é‡çš„ 2 æ¬¡å¹‚æ¥ä½œä¸ºåˆå§‹å®¹é‡ï¼Œæ‰€ä»¥éšæœºé€‰ä¸€ä¸ª 65 â€“ 128 ä¹‹é—´çš„æ•°ä½œä¸ºåˆå§‹å®¹é‡å³å¯==ã€‚
>

---



### 2.ã€ArrayListä¸ŽLinkedListä¸“é¢˜ã€‘è¿žçŽ¯ç‚®ï¼Œçœ‹çœ‹ä½ èƒ½æŽ¥ä½å¤šå°‘æ‹›ï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==é—®é¢˜ä¸€==ï¼š==è¯·ä½ è¯´ä¸€è¯´ ArrayList å’Œ LinkedList åŒºåˆ«ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==ArrayList åº•å±‚å®žçŽ°æ˜¯å¯å˜æ•°ç»„==ï¼Œå¯ä»¥é€šè¿‡ä¸‹æ ‡ä»¥O(1)çš„æ—¶é—´å¤æ‚åº¦è¿›è¡Œè¯»å–å’Œä¿®æ”¹çš„æ“ä½œï¼Œä½†æ˜¯æ·»åŠ å’Œåˆ é™¤å…ƒç´ æ¶‰åŠåˆ°æ•°ç»„å…ƒç´ çš„è¿ç§»ï¼Œå¤æ‚åº¦ä¸ºO(n)ã€‚
> 2. è€Œ ==LinkedList åº•å±‚å®žçŽ°æ˜¯åŒå‘é“¾è¡¨==ï¼Œå¯ä»¥ä»¥O(1)å¤æ‚åº¦è¿›è¡Œå¢žåˆ æ“ä½œï¼Œä½†æ˜¯æŸ¥æ‰¾é€Ÿåº¦ä¸ºO(n)è¾ƒæ…¢ã€‚
> 3. å› æ­¤æ¶‰åŠè¾ƒå¤šè¯»å–æ“ä½œçš„ä¸šåŠ¡å»ºè®®é‡‡ç”¨ ArrayListï¼Œè€Œæ•°æ®å¢žåˆ æ“ä½œè¾ƒå¤šçš„ä¸šåŠ¡å»ºè®®ä½¿ç”¨ LinkedListï¼Œ==æ¯”å¦‚ LRU å’Œ LFU ç¼“å­˜å°±å¯ä»¥ä½¿ç”¨åŒå‘é“¾è¡¨å®žçŽ°==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ==ArrayList åº•å±‚æ˜¯ç”¨æ•°ç»„å®žçŽ°çš„==ï¼Œæ ¹æ®ç´¢å¼•è®¿é—®å…ƒç´ ï¼Œä½¿å¾—æŸ¥è¯¢çš„å¤æ‚åº¦ä»…ä¸º O(1)ã€‚ä½†åœ¨æ’å…¥å’Œåˆ é™¤æ—¶æœ‰æ•°ç»„çš„å¤åˆ¶å’Œç§»åŠ¨ï¼Œå¤æ‚åº¦ä¸º O*(*n)ï¼›
> - ==LinkedList åº•å±‚ä½¿ç”¨åŒå‘é“¾è¡¨å®žçŽ°çš„==ï¼Œç”±äºŽæ¯ä¸ªèŠ‚ç‚¹éƒ½å«æœ‰å‰é©±å’ŒåŽç»§èŠ‚ç‚¹çš„å¼•ç”¨ï¼Œæ‰€ä»¥å®ƒæ’å…¥åˆ é™¤æ—¶åªéœ€ä¿®æ”¹è¿™äº›å¼•ç”¨ï¼Œæ•ˆçŽ‡è¦æ¯” ArrayList é«˜ ã€‚ä½†åœ¨æŸ¥è¯¢å…ƒç´ æ—¶éœ€è¦ä»Žå¤´èŠ‚ç‚¹å¼€å§‹ä¾æ¬¡éåŽ†æ•´ä¸ªé“¾è¡¨ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O*(*n)
>

---

==é—®é¢˜äºŒ==ï¼š==å¦‚æžœæˆ‘è¦åˆ é™¤ç¬¬ k ä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯ä¼šæ‰§è¡Œ remove(k)ï¼Œé‚£ä¹ˆè¿™ä¸ª remove çš„æ“ä½œï¼Œå®ƒä»¬çš„æ—¶é—´å¤æ‚åº¦å„è‡ªæ˜¯å¤šå°‘ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ArrayList å¯ä»¥ä½¿ç”¨ä¸‹æ ‡O(1)å®šä½åˆ°ç¬¬kä¸ªå…ƒç´ ï¼Œä»¥O(n)å¤æ‚åº¦åˆ é™¤ï¼Œæ•´ä½“å¤æ‚åº¦ä¸ºO(n)ã€‚
> 2. LinkedList éœ€è¦ä»¥O(n)å¤æ‚åº¦å®šä½åˆ°ç¬¬kä¸ªå…ƒç´ ï¼Œä½†åªéœ€O(1)æ—¶é—´å®Œæˆåˆ é™¤ï¼Œæ•´ä½“å¤æ‚åº¦ä¹Ÿä¸ºO(1)ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - éƒ½æ˜¯ O*(*n) ã€‚
> - ArrayList é¦–å…ˆä¼šä»¥ O(1) æ—¶é—´å®šä½åˆ°ç¬¬ k ä¸ªå…ƒç´ ï¼Œç„¶åŽå°†è¢«è¿™ä¸ªå…ƒç´ åˆ†å‰²çš„ä¸¤éƒ¨åˆ†å¤åˆ¶æ‹¼æŽ¥åˆ°ä¸€ä¸ªæ–°æ•°ç»„ä¸Šï¼Œæ€»ä½“ä¸º O*(*n) ã€‚
> - LinkedList é¦–å…ˆä»¥ O(*n*) æ—¶é—´å®šä½åˆ°ç¬¬ k ä¸ªå…ƒç´ ï¼Œç„¶åŽ O(1) æ—¶é—´å¤„ç†è¿™ä¸ªå…ƒç´ å‰åŽèŠ‚ç‚¹çš„å¼•ç”¨ï¼Œæ€»ä½“ä¹Ÿä¸º O*(*n) ã€‚
>

---

==é—®é¢˜ä¸‰==ï¼š==å¯ä»¥è¯´ä¸€è¯´å®ƒä»¬çš„ä½¿ç”¨åœºæ™¯å—ï¼Ÿæˆ–è€…è¯´ä¸€è¯´ä½ å¹³æ—¶åœ¨å¤„ç†ä»€ä¹ˆäº‹æƒ…çš„æ—¶å€™ï¼Œç”¨è¿‡å®ƒä»¬ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. å¯¹äºŽ ArrayListï¼Œæˆ‘ä¸€èˆ¬åœ¨==ä»Žæ•°æ®åº“ä¸­è¯»å–ä¸€ä¸ªé›†åˆçš„æ•°æ®æ—¶ä½¿ç”¨ ArrayList==ï¼Œå› ä¸º==åŽç»­çš„ä¸šåŠ¡ä¸€èˆ¬æ¶‰åŠè¾ƒå¤šæ•°æ®åº“æ•°æ®çš„è¯»å–æ“ä½œ==ï¼Œè€Œå¾ˆå°‘æ¶‰åŠå¢žåˆ ï¼Œå¹¶ä¸” ArrayList çš„å†…å­˜å ç”¨ç›¸æ¯”äºŽ LinkedList ä¹Ÿæ›´å°ã€‚
> 2. è€Œ LinkedList åˆ™åœ¨==è®¾è®¡ LRU å’Œ LFU ç¼“å­˜æ›´æ–°ç®—æ³•æ—¶å¯ä»¥ä½¿ç”¨==ã€‚å› ä¸º==æ¯è¿›è¡Œä¸€ä¸ªæ“ä½œï¼Œå°±æ¶‰åŠå°†å…ƒç´ è¿ç§»åˆ°è¡¨å¤´çš„æ“ä½œï¼Œè€ŒåŒå‘é“¾è¡¨åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­çš„å¢žåˆ ç”¨æ—¶å‡ä¸ºO(1)==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - æš‚æ— ã€‚
>

---

==é—®é¢˜å››==ï¼š==ArrayList åº•å±‚å®žçŽ°æ˜¯æ•°ç»„ï¼Œæ•°ç»„å°±ä¼šæœ‰å®¹é‡é™åˆ¶ï¼Œå¯ä»¥ç®€å•è¯´ä¸€ä¸‹ ArrayList çš„æ‰©å®¹æœºåˆ¶å—ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==æ— å‚æž„é€ çš„æƒ…å†µä¸‹å¯å˜æ•°ç»„åˆå§‹é•¿åº¦ä¸º0ï¼Œç¬¬ä¸€æ¬¡æ‰©å®¹ä¼šæ‹¬å®¹åˆ°10==ã€‚ä¹‹åŽæŒ‰ç…§==1.5å€æ‰©å®¹==ã€‚
> 2. è€Œæœ‰å‚æž„é€ åˆ™ç¬¬ä¸€æ¬¡æ‰©å®¹åˆ°æŒ‡å®šå‚æ•°ï¼Œä¹‹åŽä¸€ç›´æŒ‰ç…§==1.5å€è¿›è¡Œæ‰©å®¹==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ArrayList çš„é»˜è®¤å®¹é‡ä¸º 10ï¼Œå½“éœ€è¦æ‰©å®¹æ—¶ï¼Œä¼š==å…ˆç”³è¯·ä¸€ä¸ªå®¹é‡ä¸ºæ—§å®¹é‡ 1.5 å€çš„æ–°æ•°ç»„ï¼Œç„¶åŽæŠŠæ—§æ•°ç»„å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­==ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ==JDK 1.8 ä¸­ ArrayList åº•å±‚æ•°ç»„çš„æœ€å¤§å®¹é‡ä¸º Integer.MAX_VALUE â€“ 8 ï¼Œç›®çš„æ˜¯é˜²æ­¢æŸäº›è™šæ‹Ÿæœºä¼šåœ¨æ•°ç»„ä¸­å­˜ä¸€äº›é¢å¤–çš„ä¿¡æ¯å¯¼è‡´å†…å­˜æº¢å‡º==ã€‚
>

---



### 3.ã€counrrenthashmapã€‘çœ‹çœ‹ä½ äº†è§£å¤šå°‘ï¼ŸðŸŒŸðŸŒŸðŸŒŸ

==é—®é¢˜ä¸€==ï¼š==counrrenthashmap æ˜¯å¦‚ä½•å®žçŽ°çº¿ç¨‹å®‰å…¨çš„ï¼Ÿå¯ä»¥ç®€å•è¯´ä¸€ä¸‹ä¸ºäº†æ•ˆçŽ‡æ›´å¿«ï¼Œæ¯”èµ· HashTableï¼Œcounrrenthashmap ä½œäº†å“ªäº›ä¼˜åŒ–å—ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ä¸äº†è§£ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - JDK 1.7 ä¸­ ConcurrentHashMap ä½¿ç”¨äº†åˆ†æ®µé”æ¥å®žçŽ°çº¿ç¨‹å®‰å…¨ã€‚å®ƒçš„åº•å±‚æ˜¯ä¸€ä¸ª Segment æ•°ç»„ï¼Œæ¯ä¸ª Segment é€šè¿‡ç»§æ‰¿ ReetrantLock æ¥æŽ§åˆ¶è‡ªå·±è¿™éƒ¨åˆ†çš„åŠ é”ã€‚å…¶ä¸­æ¯ä¸ª Segment å°±ç±»ä¼¼ä¸€ä¸ª HashTableï¼Œè¿™æ ·åªè¦ä¿è¯æ¯ä¸ª Segment æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå°±èƒ½ç¡®ä¿æ•´ä¸ªå“ˆå¸Œè¡¨ä¹Ÿæ˜¯å®‰å…¨çš„äº†ã€‚
>
> - JDK 1.8 ä¸ºäº†æ‘†è„±å“ˆå¸Œè¡¨ä¸­ Segment ä¸ªæ•°å¯¹å¹¶å‘åº¦çš„é™åˆ¶ï¼Œ==åº•å±‚é‡‡ç”¨å’Œ HashMap ç±»ä¼¼çš„å®žçŽ°ï¼šæ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘==ï¼Œ==åŠ é”ç”¨ CAS å’Œ synchronized å®žçŽ°==ã€‚
>
> - å…·ä½“æ¥è¯´ï¼Œåœ¨==è¿›è¡Œ putVal æ“ä½œæ—¶ï¼Œå¦‚æžœæ§½ä½ä¸ºç©ºï¼Œåˆ™ä½¿ç”¨ CAS æ’å…¥æ–°èŠ‚ç‚¹==ã€‚
>
> 	```java
> 	else if ((f = tabAt(tab, i = (n - 1) & hash)) == null) {
> 	    if (casTabAt(tab, i, null,
> 	                 new Node<K,V>(hash, key, value, null)))
> 	        break;                   // no lock when adding to empty bin
> 	}
> 	```
>
> - å¦‚æžœæ§½ä½ä¸ä¸ºç©ºï¼Œåˆ™éœ€è¦==è¿›ä¸€æ­¥åˆ¤æ–­å…¶å®ƒçº¿ç¨‹æ˜¯å¦åœ¨å¯¹å…¶æ‰©å®¹ï¼Œæ˜¯åˆ™ååŠ©æ‰©å®¹==ï¼Œ
>
> 	```java
> 	else if ((fh = f.hash) == MOVED)
> 	    tab = helpTransfer(tab, f);
> 	```
>
> - ==ä¸æ˜¯åˆ™ä½¿ç”¨ synchronized é”ä½å½“å‰æ§½ä½==ï¼Œå†è¿›è¡Œæ’å…¥èŠ‚ç‚¹æ“ä½œã€‚
>
> 	```java
> 	else {
> 	    V oldVal = null;
> 	    synchronized (f) { // ä½¿ç”¨ synchronized é”ä½å½“å‰æ§½ä½
> 	        if (tabAt(tab, i) == f) {
> 	            if (fh >= 0) {
> 	                binCount = 1;
> 	                for (Node<K,V> e = f;; ++binCount) {
> 	                    K ek;
> 	                    if (e.hash == hash &&
> 	                        ((ek = e.key) == key ||
> 	                         (ek != null && key.equals(ek)))) {
> 	                        oldVal = e.val;
> 	                        if (!onlyIfAbsent)
> 	                            e.val = value;
> 	                        break;
> 	                    }
> 	                    Node<K,V> pred = e;
> 	                    if ((e = e.next) == null) {
> 	                        pred.next = new Node<K,V>(hash, key,
> 	                                                  value, null);
> 	                        break;
> 	                    }
> 	                }
> 	            }
> 	            else if (f instanceof TreeBin) {
> 	                Node<K,V> p;
> 	                binCount = 2;
> 	                if ((p = ((TreeBin<K,V>)f).putTreeVal(hash, key,
> 	                                               value)) != null) {
> 	                    oldVal = p.val;
> 	                    if (!onlyIfAbsent)
> 	                        p.val = value;
> 	                }
> 	            }
> 	        }
> 	    }
> 	    if (binCount != 0) {
> 	        if (binCount >= TREEIFY_THRESHOLD)
> 	            treeifyBin(tab, i);
> 	        if (oldVal != null)
> 	            return oldVal;
> 	        break;
> 	    }
> 	}
> 	```
>

---

==é—®é¢˜äºŒ==ï¼š==å¹³æ—¶æˆ‘ä»¬ä¼šç»å¸¸ä½¿ç”¨ HashMapï¼Œä½†æ˜¯ counrrenthashmap å¾ˆå°‘ä½¿ç”¨åˆ°ï¼Œä½ å¯ä»¥ç®€å•è¯´ä¸€ä¸‹ä»€ä¹ˆæ ·çš„åœºæ™¯ä¸‹ä½¿ç”¨ counrrenthashmap å—==ï¼Ÿï¼ˆæŒ‡å¯¼ï¼šè¿™ä¸ªæ˜¯ä¸ªå¼€æ”¾æ€§é—®é¢˜ï¼Œå¤§å®¶æ€è€ƒä¸€ä¸‹å§ï¼Œåƒä¸‡ä¸è¦åªè¯´ å¤šçº¿ç¨‹ æƒ…å†µä¸‹ä½¿ç”¨ counrrenthashmap å“ˆï¼Œé‚£æ ·æ²¡æœ‰æ„ä¹‰ï¼Œå› ä¸ºæœ‰æ—¶å€™ï¼Œçº¿ç¨‹çš„å®‰å…¨ï¼Œå¯ä»¥ç”±æˆ‘ä»¬ç¨‹åºå‘˜æ¥æŽ§åˆ¶ï¼Œä¸ä¸€å®šè¦ä½¿ç”¨ counrrenthashmapï¼Œæ‰€ä»¥éœ€è¦å¤§å®¶æ€è€ƒä¸€ä¸‹ï¼‰

==æˆ‘çš„å›žç­”==ï¼š

> 1. ä¸äº†è§£ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - æ¯”å¦‚==åœ¨æ—¥å¿—åˆ†æžæ—¶ï¼Œå¯ä»¥å°†æ—¥å¿—åˆ†æˆå¤šä¸ªæ•°æ®å—ï¼ŒåŒæ—¶å¼€å¯å¤šä¸ªçº¿ç¨‹è¿›è¡Œå¯¹æ—¥å¿—è¿›è¡Œå¹¶å‘å¤„ç†ï¼Œæœ€ç»ˆå°†ç»“æžœæ±‡æ€»åˆ° ConcurrentHashMap ä¸­==ï¼›å†æ¯”å¦‚==ä¸€ä¸ªå¹¶å‘æ‰§è¡Œçš„å¤šä»»åŠ¡åˆ—è¡¨ï¼Œå¯ä»¥ç”¨ ConcurrentHashMap æ¥ä½œä¸ºä»»åŠ¡ç®¡ç†çš„æ•°æ®ç»“æž„ã€‚ä»»åŠ¡ä¸º Keyï¼Œä»»åŠ¡çš„æ‰§è¡ŒçŠ¶æ€ä¸º Valueï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶æŸ¥æ‰¾å’Œæ›´æ–°ä»»åŠ¡çš„çŠ¶æ€ï¼Œå®žçŽ°å¯¹å¤šä»»åŠ¡çš„æŽ§åˆ¶==ã€‚
>

---



### 4.ã€å…¶ä»–é›†åˆé—®é¢˜ã€‘ç®€å•è¯´ä¸€ä¸‹ list å’Œ set çš„åŒºåˆ«ï¼Ÿä»¥åŠä½¿ç”¨åœºæ™¯ï¼Ÿ

==æˆ‘çš„å›žç­”==ï¼š

> 1. List å’Œ Set å‡å®žçŽ°äº† Collection æŽ¥å£ï¼Œè€Œ Collection æŽ¥å£ä¹Ÿå®žçŽ°äº† Iterable æŽ¥å£ï¼Œå› æ­¤ List å’Œ Set å‡å¯ä½¿ç”¨è¿­ä»£å™¨è¿›è¡ŒéåŽ†ã€‚
> 2. List å¯ä»¥é¡ºåºå­˜å‚¨ï¼Œå…è®¸ç›¸åŒçš„å…ƒç´ ã€‚
> 3. è€Œ Set åªèƒ½æ ¹æ® hash() å€¼åœ¨åº•å±‚å¯å˜æ•°ç»„ç´¢å¼•çš„æ˜ å°„è¿›è¡Œéšæœºä½ç½®çš„å­˜å‚¨ï¼Œå¹¶ä¸”ä¸èƒ½å­˜å‚¨ç›¸åŒçš„å…ƒç´ ã€‚
> 4. List çš„å¸¸è§å®žçŽ°ç±»ä¸º ArrayList å’Œ LinkedListã€‚å‰è€…å¯ä»¥æ ¹æ®ä¸‹æ ‡å¿«é€Ÿå¯¹æ•°æ®è¿›è¡Œè¯»å†™æ“ä½œï¼›åŽè€…å¯å®žçŽ°åŽŸåœ°å¢žåˆ èŠ‚ç‚¹ã€‚
> 5. Set çš„å¸¸è§å®žçŽ°ç±»ä¸º HashSet å’Œ TreeSetã€‚å…¶ä¸­åŽè€…åœ¨æž„é€ å™¨ä¸­éœ€è¦ä¼ å…¥ä¸€ä¸ª Comparator å®žçŽ°ç±»ä»¥ç¡®å®šæŽ’åºçš„æ–¹å¼ï¼Œè€Œå…¶åº•å±‚ TreeMap çš„ table æ•°ç»„ä¸­æ¯ä¸ªèŠ‚ç‚¹å‡ä¸ºä¸€ä¸ªçº¢é»‘æ ‘ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ä¸¤è€…éƒ½ç»§æ‰¿è‡ª Collectionï¼Œéƒ½æ˜¯ç”¨æ¥å­˜å‚¨æ•°æ®çš„é›†åˆã€‚å…¶ä¸­ ==List æŽ¥å£ä¼šç»´æŠ¤å…ƒç´ çš„æ’å…¥é¡ºåºï¼Œå¹¶ä¸”å…è®¸æ ¹æ®ç´¢å¼•è¿›è¡Œæ•°æ®æŸ¥è¯¢å’Œæ“ä½œ==ã€‚è€Œ ==Set æŽ¥å£åªå¼ºè°ƒå…ƒç´ çš„ä¸å¯é‡å¤æ€§ï¼Œä¸ä¿è¯å…ƒç´ çš„ç‰¹å®šé¡ºåºï¼Œä¹Ÿä¸æ”¯æŒç´¢å¼•æŸ¥è¯¢==ã€‚
> - List æŽ¥å£å¸¸è§çš„å®žçŽ°ç±»æœ‰ ArrayListï¼ŒLinkedList ç­‰ï¼Œå‰è€…åº•å±‚ä¸ºæ•°ç»„ï¼Œé€‚åˆéšæœºè®¿é—®å¤šçš„åœºæ™¯ã€‚åŽè€…åº•å±‚ä¸ºåŒå‘é“¾è¡¨ï¼Œé€‚åˆæ’å…¥åˆ é™¤æ“ä½œå¤šçš„åœºæ™¯ã€‚
> - Set æŽ¥å£å¸¸è§çš„å®žçŽ°ç±»æœ‰ HashSetï¼ŒTreeSet ç­‰ï¼Œå‰è€…åº•å±‚ä¸ºå“ˆå¸Œè¡¨ï¼Œæä¾›å¿«é€Ÿçš„æ’å…¥ï¼Œåˆ é™¤å’ŒæŸ¥æ‰¾æ€§èƒ½ï¼Œä½†ä¸ä¿è¯å…ƒç´ çš„é¡ºåºã€‚==åŽè€…åº•å±‚ä¸ºçº¢é»‘æ ‘ï¼Œå…ƒç´ é—´å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰æ¯”è¾ƒå™¨è¿›è¡ŒæŽ’åº==ã€‚
>

---



## 3.JVM

### 1.ã€JVMä¸“é¢˜ã€‘åžƒåœ¾å›žæ”¶åŸºæœ¬é—®é¢˜ðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==é—®é¢˜ä¸€==ï¼š==ä¸ºä»€ä¹ˆè¦æœ‰åžƒåœ¾å›žæ”¶==ï¼Ÿ

==æˆ‘çš„å›žç­”==ï¼š

> 1. å¯¹äºŽ C/C++ è¯­è¨€è€Œè¨€ï¼Œç¨‹åºå‘˜åœ¨åˆ›å»ºäº†å¯¹è±¡å®žä¾‹ï¼Œåœ¨ä¸éœ€è¦æ­¤å¯¹è±¡åŽéœ€è¦æ‰‹åŠ¨é‡Šæ”¾å†…å­˜ã€‚ä½†æ˜¯ ==java ä¸­å¹¶ä¸è¦æ±‚ç¨‹åºå‘˜æ‰‹åŠ¨é‡Šæ”¾åˆ›å»ºå¯¹è±¡çš„å†…å­˜==ï¼Œè€Œæ˜¯==åœ¨ JVM è¿›ç¨‹å¼€å§‹æ—¶ï¼Œåœ¨åŽå°è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªåžƒåœ¾å›žæ”¶çº¿ç¨‹ç”¨äºŽå›žæ”¶ä¸éœ€è¦çš„å¯¹è±¡==ï¼Œé‡Šæ”¾å®ƒä»¬çš„å†…å­˜ï¼Œä»¥==æé«˜èµ„æºåˆ©ç”¨çŽ‡==å’Œ==ç¨‹åºæ‰§è¡Œæ•ˆçŽ‡==ï¼Œå¹¶==é™ä½Žå†…å­˜æ³„éœ²çš„é£Žé™©==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - åœ¨ä¼ ç»Ÿçš„ C/C++ è¯­è¨€ä¸­ï¼Œå¼€å‘äººå‘˜éœ€è¦æ‰‹åŠ¨åˆ†é…å’Œé‡Šæ”¾å†…å­˜ï¼Œè¿™æ ·å°±==å®¹æ˜“å¯¼è‡´äººä¸ºçš„å¿˜è®°é‡Šæ”¾å†…å­˜çš„æƒ…å†µ==ï¼Œé€ æˆå†…å­˜æ³„æ¼ã€‚Java çš„åžƒåœ¾å›žæ”¶æœºåˆ¶å¯ä»¥æŠŠå¸®å¿™è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®ƒå¯ä»¥==è‡ªåŠ¨æ£€æµ‹å¹¶å›žæ”¶ä¸å†ä½¿ç”¨çš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯åžƒåœ¾ï¼Œå¯ä»¥å‡å°‘å†…å­˜æ³„æ¼çš„é£Žé™©==ã€‚
>

---

==é—®é¢˜äºŒ==ï¼š==Java åžƒåœ¾å›žæ”¶ä¸­æ˜¯å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ­»äº¡çš„ï¼Ÿè¯·ç®€å•ä»‹ç»ä¸€ä¸‹==

==æˆ‘çš„å›žç­”==ï¼š

> 1. å¦‚æžœä¸€ä¸ªå¯¹è±¡==æ²¡æœ‰è¢« GC Roots ç›´æŽ¥æˆ–é—´æŽ¥åœ°å¼•ç”¨==ï¼Œé‚£ä¹ˆåžƒåœ¾å›žæ”¶ç³»ç»Ÿå°±è®¤ä¸ºè¯¥å¯¹è±¡æ­»äº¡äº†ã€‚
> 2. GC Roots æ˜¯æŒ‡==ç±»çš„é™æ€æˆå‘˜å˜é‡==å’Œ ==java è™šæ‹Ÿæœºæ ˆä¸­çš„å±€éƒ¨å˜é‡==ã€‚
> 3. æ­¤å¤–ï¼Œå¦‚æžœå°†è¦è¢«å›žæ”¶çš„å¯¹è±¡==é‡å†™äº† Object ç±»çš„ finalize æ–¹æ³•==ï¼Œåˆ™åžƒåœ¾å›žæ”¶ç³»ç»Ÿä¼šè°ƒç”¨æ­¤æ–¹æ³•ã€‚==å¦‚æžœåœ¨é‡å†™çš„ finalize æ–¹æ³•ä¸­å¯¹è±¡é‡æ–°èŽ·å¾—äº† GC Roots çš„å¼•ç”¨ï¼Œåˆ™å¯é€ƒç¦»æœ¬æ¬¡å›žæ”¶==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - å¸¸ç”¨çš„ç®—æ³•æœ‰ä¸¤ä¸ªï¼Œä¹Ÿå°±æ˜¯ â€œ==å¼•ç”¨è®¡æ•°ç®—æ³•==â€ å’Œ â€œ==å¯è¾¾æ€§åˆ†æžæ³•==â€ã€‚
> - å¼•ç”¨è®¡æ•°æ³•çš„æ€è·¯å¾ˆç®€å•ï¼Œå½“å¯¹è±¡è¢«å¼•ç”¨æ—¶ç»™è®¡æ•°å™¨ + 1ï¼Œå½“å¯¹è±¡å¼•ç”¨å¤±æ•ˆæ—¶è®¡æ•°å™¨å€¼ â€“ 1ã€‚å½“è®¡æ•°å™¨ä¸ºé›¶æ—¶ï¼Œè¯´æ˜Žå¯¹è±¡ä¸å†è¢«ä½¿ç”¨ï¼Œå¯ä»¥å›žæ”¶ã€‚ï¼ˆ==ç”±äºŽå¼•ç”¨è®¡æ•°æ³•å­˜åœ¨å¯¹è±¡é—´å¾ªçŽ¯å¼•ç”¨å¯¼è‡´æ— æ³•å›žæ”¶çš„é£Žé™©ï¼Œå› æ­¤å½“ä¸‹ä¸»æµçš„è™šæ‹Ÿæœºéƒ½ä¸é‡‡ç”¨æ­¤æ–¹æ³•==ï¼‰
> - å¯è¾¾æ€§åˆ†æžæ³•çš„æ€è·¯å°±æ˜¯==ä»Ž GC Roots å¼€å§‹å‘ä¸‹æœç´¢ï¼Œå½“å¯¹è±¡åˆ° GC Roots éƒ½æ²¡æœ‰ä»»ä½•å¼•ç”¨ç›¸è¿žæ—¶ï¼Œè¯´æ˜Žå¯¹è±¡æ˜¯ä¸å¯ç”¨çš„==ï¼Œå¯ä»¥è¢«å›žæ”¶ã€‚å…¶ä¸­ GC Roots æ˜¯ä¸€ç»„å¿…é¡»æ´»è·ƒçš„å¼•ç”¨ï¼Œ==ä»Ž GC Roots å‡ºå‘ï¼Œç¨‹åºé€šè¿‡ç›´æŽ¥å¼•ç”¨æˆ–é—´æŽ¥å¼•ç”¨ï¼Œèƒ½å¤Ÿæ‰¾åˆ°å¯èƒ½æ­£åœ¨è¢«ä½¿ç”¨çš„å¯¹è±¡==ã€‚
>

---

==é—®é¢˜ä¸‰==ï¼š==åˆšæ‰è¯´åˆ°äº†å¼•ç”¨è®¡æ•°æ³•ï¼Œå¼•ç”¨è®¡æ•°æ³•å­˜åœ¨ä»€ä¹ˆé—®é¢˜ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==å¼•ç”¨è®¡æ•°æ³•æ— æ³•è§£å†³å¯¹è±¡é—´å¾ªçŽ¯å¼•ç”¨çš„é—®é¢˜==ã€‚æ¯”å¦‚ A å¯¹è±¡å¼•ç”¨ Bï¼ŒB å¯¹è±¡å¼•ç”¨ Aï¼Œè€Œå®ƒä»¬åˆæ²¡æœ‰è¢«å…¶å®ƒå¯¹è±¡æ‰€å¼•ç”¨ï¼Œæ­¤æ—¶å¼•ç”¨è®¡æ•°æ³•æ— æ³•å°†å®ƒä»¬åˆ¤æ–­ä¸ºæ­»äº¡å¯¹è±¡ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ==å¼•ç”¨è®¡æ•°æ³•çš„ç¼ºç‚¹æ˜¯ï¼Œå¦‚æžœå¯¹è±¡å­˜åœ¨å¾ªçŽ¯ä¾èµ–ï¼Œé‚£å°±æ— æ³•å®šä½è¯¥å¯¹è±¡æ˜¯å¦æ”¹è¢«å›žæ”¶==ï¼Œæ¯”å¦‚ A å¼•ç”¨ Bï¼ŒB å¼•ç”¨ A è¿™ç§æƒ…å†µã€‚
>

---

==é—®é¢˜å››==ï¼š==åˆšæ‰è¯´åˆ°äº†å¯è¾¾æ€§åˆ†æžï¼ŒçŸ¥é“å“ªäº›å¯ä»¥ä½œä¸º GC ROOT å—ï¼Ÿ==ï¼ˆéœ€è¦è®°ä½å‡ ä¸ªï¼‰

==æˆ‘çš„å›žç­”==ï¼š

> 1. å¸¸è§çš„ GC Roots æœ‰ï¼š==ç±»çš„é™æ€æˆå‘˜å˜é‡==ï¼Œ==java è™šæ‹Ÿæœºæ ˆçš„å±€éƒ¨å˜é‡==ï¼Œ==æ–¹æ³•åŒºå¸¸é‡æ± ä¸­çš„å¸¸é‡==ï¼Œä»¥åŠæœ¬åœ°æ–¹æ³•æ ˆä¸­ Native æ–¹æ³•æ‰€å¼•ç”¨çš„å¯¹è±¡ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - æ¯”æ–¹è¯´ JVM å†…å­˜ç»“æž„ä¸­çš„è™šæ‹Ÿæœºæ ˆï¼Œè™šæ‹Ÿæœºæ ˆä¸­æœ‰æ ˆå¸§ï¼Œæ ˆå¸§é‡Œé¢å­˜å‚¨ç€æœ‰æŒ‡å‘å †çš„å¯¹è±¡å¼•ç”¨ï¼Œé‚£ä¹ˆ==ä½äºŽè™šæ‹Ÿæœºæ ˆé¡¶çš„æ ˆå¸§å°±å¯ä»¥ç§°ä½œæ˜¯ â€œæ´»è·ƒâ€ çš„æ ˆå¸§ï¼Œå› ä¸ºæ­¤åˆ»å®ƒæ­£åœ¨è¢«çº¿ç¨‹è°ƒç”¨==ã€‚æ‰€ä»¥ï¼Œ==å½“å‰æ´»è·ƒçš„æ ˆå¸§æŒ‡å‘å †é‡Œçš„å¯¹è±¡å¼•ç”¨å°±å¯ä»¥æ˜¯ GC Rootsã€‚é™¤æ­¤ä¹‹å¤–ï¼Œç±»çš„é™æ€å˜é‡ï¼ŒJava æœ¬åœ°æ–¹æ³•æ‰€å¼•ç”¨çš„å¯¹è±¡éƒ½å¯ä»¥æ˜¯ GC Roots==ã€‚
>

---

==é—®é¢˜äº”==ï¼š==åžƒåœ¾å›žæ”¶ç®—æ³•ä»‹ç»ä¸€ä¸‹==

==æˆ‘çš„å›žç­”==ï¼š

> 1. å¸¸è§çš„åžƒåœ¾å›žæ”¶ç®—æ³•æœ‰ â€œ==å¤åˆ¶ç®—æ³•==â€ å’Œ â€œ==æ ‡è®°-æ•´ç†æ³•==â€ã€‚
> 2. ==å¤åˆ¶ç®—æ³•ä¸€èˆ¬ç”¨äºŽå¯¹æ–°ç”Ÿä»£è¿›è¡Œåžƒåœ¾å›žæ”¶==ã€‚å®ƒé¦–å…ˆæ ‡è®° Eden åŒºå’Œå½“å‰å­˜æœ‰å¯¹è±¡çš„ Survivor åŒºä¸­æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡ï¼Œå°†å®ƒä»¬==è½¬ç§»è‡³å¦ä¸€ä¸ª Survivor åŒºä¸­ï¼Œæ•´é½ç´§å¯†çš„æŽ’åˆ—ï¼Œé¿å…å‡ºçŽ°å†…å­˜ç¢Žç‰‡æµªè´¹å†…å­˜èµ„æº==ã€‚éšåŽå°† Eden åŒºå’Œå‰ä¸€ä¸ª Survivor åŒºä¸­å‰©ä½™çš„éœ€è¦è¢«å›žæ”¶çš„å¯¹è±¡ä¸€æ¬¡æ€§å…¨éƒ¨å›žæ”¶å®Œã€‚
> 3. ==æ ‡è®°-æ•´ç†æ³•ä¸€èˆ¬ç”¨äºŽå¯¹è€å¹´ä»£è¿›è¡Œåžƒåœ¾å›žæ”¶==ã€‚å®ƒé¦–å…ˆ==æ ‡è®°è€å¹´ä»£ä¸­çš„å­˜æ´»å¯¹è±¡ï¼Œå°†å…¶ç§»åŠ¨å¹¶æ•´é½ç´§å¯†çš„æŽ’åˆ—==ï¼Œé¿å…å†…å­˜ç¢Žç‰‡æµªè´¹å†…å­˜ç©ºé—´ï¼Œç„¶åŽä¸€æ¬¡æ€§æ¸…ç†åžƒåœ¾å¯¹è±¡ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - åžƒåœ¾å›žæ”¶çš„ç¬¬ä¸€æ­¥æ˜¯ â€œæ ‡è®°â€ï¼Œæ ‡è®°é‚£äº›æ²¡æœ‰è¢« GC Roots å¼•ç”¨çš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯åžƒåœ¾ã€‚æ ‡è®°å®Œä¹‹åŽï¼ŒJVM å°±å¯ä»¥é€‰æ‹©ç›´æŽ¥æ¸…é™¤é‚£äº›åžƒåœ¾ï¼Œè¿™ä¸ªç®—æ³•å«åš â€œ==æ ‡è®°æ¸…é™¤ç®—æ³•==â€ã€‚
> - è¿™ä¸ªè¿‡ç¨‹ç®€å•ç²—æš´ï¼Œä½†ä¹Ÿå­˜åœ¨==å†…å­˜ç¢Žç‰‡é—®é¢˜ï¼Œå¯¼è‡´å¯èƒ½æˆ‘æœ‰ 10M çš„å†…å­˜ï¼Œä½†ç¨‹åºç”³è¯· 9M çš„ç©ºé—´å´ä¼šå¤±è´¥ï¼Œä¹Ÿå°±æ˜¯è¯´æ•´ä¸ªå†…å­˜ç©ºé—´çš„ 10M æ˜¯ä¸è¿žç»­çš„==ã€‚è§£å†³çš„åŠžæ³•å°±æ˜¯åœ¨æ ‡è®°å®Œåžƒåœ¾åŽï¼Œä¸ç›´æŽ¥æ¸…é™¤ï¼Œè€Œæ˜¯å…ˆ==æŠŠå­˜æ´»çš„å¯¹è±¡éƒ½å¤åˆ¶åˆ°å¦ä¸€å—ç©ºé—´ï¼Œå¤åˆ¶å®Œäº†ä¹‹åŽï¼Œå†æŠŠæ•´ä¸ªåŽŸç©ºé—´ç»™æ¸…é™¤æŽ‰==ã€‚è¿™ä¸ªè¿‡ç¨‹å«åš â€œ==æ ‡è®°å¤åˆ¶ç®—æ³•==â€ã€‚
> - è¿™ç§ç®—æ³•ä¹Ÿæœ‰ç¼ºç‚¹ï¼šå†…å­˜åˆ©ç”¨çŽ‡å¾ˆä½Žï¼Œå¾—æœ‰ä¸€å—æ–°çš„å†…å­˜ç•™ä½œå¤åˆ¶ã€‚é‚£å°±ä¸å¦‚æŠ˜ä¸­ä¸€ä¸‹ï¼Œå¯ä»¥åœ¨æ ‡è®°ä¹‹åŽï¼Œ==æŠŠå­˜æ´»çš„å¯¹è±¡ç§»åˆ°å½“å‰ç©ºé—´çš„ä¸€è¾¹ï¼ŒæŠŠåžƒåœ¾ç§»åˆ°å¦ä¸€è¾¹ï¼Œç„¶åŽå†æ¸…é™¤==ï¼Œå°±æ²¡æœ‰å†…å­˜ç¢Žç‰‡çš„é—®é¢˜ï¼ŒåŒæ—¶å†…å­˜åˆ©ç”¨çŽ‡ä¹Ÿä¸ä¼šé™ä½Žã€‚è¿™ä¸ªè¿‡ç¨‹å«åš â€œ==æ ‡è®°æ•´ç†ç®—æ³•==â€ã€‚
>

---

==é—®é¢˜å…­==ï¼š==åžƒåœ¾å›žæ”¶ä¼šå‘ç”Ÿåœ¨å“ªå‡ ä¸ªåŒºåŸŸï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. åžƒåœ¾å›žæ”¶ä¼šå‘ç”Ÿåœ¨å †åŒºçš„==æ–°ç”Ÿä»£å’Œè€å¹´ä»£==ã€‚
> 2. æ­¤å¤–ï¼Œåžƒåœ¾å›žæ”¶ç³»ç»Ÿä¹Ÿä¼šå›žæ”¶==æ–¹æ³•åŒºä¸­çš„ Class å¯¹è±¡==ã€‚å›žæ”¶çš„æ—¶æœºä¸ºå½“æ­¤ç±»==æ‰€æœ‰å®žä¾‹å‡è¢«å›žæ”¶==ï¼Œ==ClassLoader è¢«å›žæ”¶==ï¼Œå¹¶ä¸”==è¯¥ Class ç±»æ²¡æœ‰è¢« GC Roots å¼•ç”¨==æ—¶ã€‚==å¸¸é‡æ± ä¸­çš„å¸¸é‡==åœ¨æ²¡æœ‰è¢«å¼•ç”¨æ—¶ä¹Ÿä¼šè¢«å›žæ”¶ï¼Œåªä¸è¿‡æ–¹æ³•åŒºä¸­å¯¹è±¡è¢«==å›žæ”¶çš„ç©ºé—´è¾ƒå°‘==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - åžƒåœ¾å›žæ”¶ä¸»è¦æ˜¯å‘ç”Ÿåœ¨==å †==ä¸Šï¼Œå°¤å…¶æ˜¯åœ¨==æ–°ç”Ÿä»£==ä¸­ï¼Œä¸€æ¬¡åžƒåœ¾å›žæ”¶é€šå¸¸å¯ä»¥å›žæ”¶ 70% åˆ° 99% çš„å†…å­˜ç©ºé—´ã€‚ä½†å…¶å®ž==ä¹Ÿä¼šå¯¹æ–¹æ³•åŒºè¿›è¡Œåžƒåœ¾å›žæ”¶==ã€‚==å¯¹æ–¹æ³•åŒºä¸»è¦å›žæ”¶çš„æ˜¯åºŸå¼ƒçš„å¸¸é‡å’Œä¸å†ä½¿ç”¨çš„ç±»==ï¼Œä¸€èˆ¬å›žæ”¶çš„ç©ºé—´æ¯”è¾ƒå°‘ã€‚
>

---



### 2.ã€JVMä¸“é¢˜ã€‘å¹´è½»ä»£ä¸Žè€å¹´ä»£è¿žçŽ¯ç‚®ðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==é—®é¢˜ä¸€==ï¼š==ä¸ºä»€ä¹ˆè¦åŒºåˆ†å¹´è½»ä»£å’Œè€å¹´ä»£ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ä¹‹æ‰€ä»¥åŒºåˆ†æ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œæ˜¯å› ä¸º==ä¸åŒçš„å¯¹è±¡åœ¨å †åŒºå­˜æ´»çš„æ—¶é—´ä¸åŒ==ã€‚å¤§å¤šæ•°å¯¹è±¡åœ¨åˆ›å»ºåŽä¸ä¹…å°±ä¸å†è¢«å¼•ç”¨æˆä¸ºäº†åžƒåœ¾ï¼Œå°‘éƒ¨åˆ†å¯¹è±¡åˆ™é•¿ä¹…å­˜æ´»ã€‚å› æ­¤å°†æ–°ç”Ÿä»£å’Œè€å¹´ä»£åŒºåˆ†åŽï¼Œæˆ‘ä»¬å¯ä»¥==å¯¹å®ƒä»¬é‡‡ç”¨ä¸åŒçš„åžƒåœ¾å›žæ”¶ç­–ç•¥==ï¼Œè¿™æ ·å¯ä»¥==å‡å°‘åžƒåœ¾å›žæ”¶çš„ STW æœºåˆ¶å¯¹ä¸šåŠ¡çš„å½±å“==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ä¸»è¦æ˜¯æœ‰ä¸¤ä¸ªåŽŸå› ï¼Œ==ä¸€ä¸ªæ˜¯å¤§éƒ¨åˆ†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸéƒ½å¾ˆçŸ­ï¼Œåªæœ‰å°‘éƒ¨åˆ†å¯¹è±¡å¯èƒ½ä¼šå­˜æ´»å¾ˆé•¿æ—¶é—´==ã€‚å¦ä¸€ä¸ªæ˜¯==åžƒåœ¾å›žæ”¶ä¼šå¯¼è‡´ `stop the world`ï¼Œä¹Ÿå°±æ˜¯åº”ç”¨ä¼šæš‚æ—¶åœæ­¢è®¿é—®==ã€‚ä¸ºäº†==ä½¿ `stop the world` æŒç»­çš„æ—¶é—´å°½å¯èƒ½çŸ­ä»¥æé«˜å¹¶å‘å¼ GC æ‰€èƒ½åº”ä»˜çš„å†…å­˜åˆ†é…é€ŸçŽ‡==ï¼Œæœ‰äº›åžƒåœ¾æ”¶é›†å™¨å°±å°†å¯¹è±¡åˆ†æˆä¸¤ç±»ï¼Œå­˜æ´»æ—¶é—´çŸ­çš„å¯¹è±¡æ‰€å¤„çš„åŒºåŸŸå«å¹´è½»ä»£ï¼Œå­˜æ´»æ—¶é—´é•¿çš„å¯¹è±¡å«è€å¹´ä»£ã€‚JDK 8 åŠä»¥å‰çš„åžƒåœ¾æ”¶é›†å™¨éƒ½æ˜¯æœ‰è¿™ä¸ªåˆ†ä»£æ¦‚å¿µçš„ã€‚
>

---

==é—®é¢˜äºŒ==ï¼š==å“ªäº›å¯¹åƒä¼šè¿›å…¥è€å¹´ä»£ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. å¯¹è±¡è¿›å…¥è€å¹´ä»£çš„æ—¶æœºä¸»è¦æœ‰4ä¸ªã€‚
> 2. å¯¹è±¡åœ¨æ–°ç”Ÿä»£==é€ƒè¿‡ä¸€å®šæ¬¡æ•°é»˜è®¤15æ¬¡åžƒåœ¾å›žæ”¶==ã€‚
> 3. ==åŠ¨æ€å¹´é¾„åˆ¤æ–­==ã€‚æ¯”å¦‚æ–°ç”Ÿä»£å¹´é¾„nä»¥ä¸‹çš„å¯¹è±¡è¶…è¿‡äº†é»˜è®¤50%çš„ Survivor åŒºæ€»å¤§å°ï¼Œå°±æŠŠå¹´é¾„nåŠä»¥ä¸Šçš„å¯¹è±¡ç›´æŽ¥å­˜å…¥è€å¹´ä»£ã€‚
> 4. ==ä¸€æ¬¡åŠ å…¥ Survivor åŒºçš„å¯¹è±¡å¤§äºŽ Survivor åŒºçš„æ€»å¤§å°==ï¼Œåˆ™ä¼šç›´æŽ¥åŠ å…¥è€å¹´ä»£ã€‚æ¯”å¦‚ JVM é…ç½®ä¸­ Survivor åŒºçš„å¤§å°è®¾ç½®è¿‡å°ï¼Œåˆ™å¯¼è‡´å¤§é‡å¯¹è±¡è¢«æ”¾å…¥è€å¹´ä»£ï¼Œå¯¼è‡´è€å¹´ä»£é¢‘ç¹ GCï¼Œä¸¥é‡å½±å“ä¸šåŠ¡æ€§èƒ½ã€‚
> 5. ==å¤§å¯¹è±¡==ä¼šç›´æŽ¥è¿›å…¥è€å¹´ä»£ã€‚
> 6. ==è€å¹´ä»£çš„ç©ºé—´åˆ†é…æ‹…ä¿è§„åˆ™==ã€‚å…·ä½“ä¸ºå¦‚æžœè€å¹´ä»£å‰©ä½™æ€»ç©ºé—´å°äºŽæ–°ç”Ÿä»£æ€»å¤§å°ï¼Œåˆ™åˆ¤æ–­æ˜¯å¦è®¾ç½® HandlePromotionFailure å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°é»˜è®¤å°±æ˜¯è®¾ç½®äº†çš„ï¼Œç„¶åŽåˆ¤æ–­è€å¹´ä»£å‰©ä½™ç©ºé—´æ˜¯å¦å¤§äºŽä¹‹å‰è¿›å…¥è€å¹´ä»£çš„å¹³å‡å¤§å°ï¼Œå°äºŽåˆ™ç›´æŽ¥æ•´ä½“ Full GCã€‚å¦åˆ™ä¼šå†’é™©å°è¯• Young GCï¼Œå¦‚æžœè€å¹´ä»£ç©ºé—´ä¸è¶³å°±ä¼š Full GCï¼Œæ¸…ç†åŽä»»ç„¶ä¸è¶³å°±ä¼š OOM æŠ¥é”™ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ä¸€èˆ¬æœ‰ä¸¤ç§æƒ…å†µï¼Œç¬¬ä¸€ç§æ˜¯å…ˆåˆ›å»ºçš„å¯¹è±¡å¤ªå¤§äº†ï¼Œå°±ä¼šç›´æŽ¥è¿›å…¥è€å¹´ä»£ï¼Œå¦ä¸€ç§æ˜¯å¯¹è±¡çš„å¹´é¾„å¤ªè€äº†ï¼Œæ¯å‘ç”Ÿä¸€æ¬¡ Minor GCï¼Œå­˜æ´»çš„å¹´é¾„å°± +1ï¼Œè¾¾åˆ°é»˜è®¤å€¼ 15 å°±ä¼šè‡ªåŠ¨æ™‹å‡æˆè€å¹´ä»£ã€‚
>

---

==é—®é¢˜ä¸‰==ï¼š==ä»€ä¹ˆæ—¶å€™ä¼šè¿›è¡Œå¹´è½»ä»£GCï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==Eden åŒºç©ºé—´ä¸è¶³==æ—¶ä¼šè¿›è¡Œ Young GCã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ä¸€èˆ¬åœ¨å¹´è½»ä»£çš„ ==Eden åŒºç©ºé—´ä¸è¶³æ—¶==ï¼Œå°±ä¼šè§¦å‘å¹´è½»ä»£ GCï¼Œä¹Ÿå°±æ˜¯ Minor GCã€‚
>

---

==é—®é¢˜å››==ï¼š==ä»€ä¹ˆæ—¶å€™ä¼šè¿›è¡Œè€å¹´ä»£GCï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. æ ¹æ®==è€å¹´ä»£çš„ç©ºé—´åˆ†é…æ‹…ä¿è§„åˆ™==ï¼Œåœ¨ä¸€æ¬¡ Young GC ä¹‹å‰ï¼Œå¦‚æžœ==è€å¹´ä»£å‰©ä½™æ€»ç©ºé—´å°äºŽæ–°ç”Ÿä»£æ€»å¤§å°==ï¼Œåˆ™åˆ¤æ–­æ˜¯å¦è®¾ç½® HandlePromotionFailure å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°é»˜è®¤å°±æ˜¯è®¾ç½®äº†çš„ï¼Œç„¶åŽ==åˆ¤æ–­è€å¹´ä»£å‰©ä½™ç©ºé—´æ˜¯å¦å¤§äºŽä¹‹å‰è¿›å…¥è€å¹´ä»£çš„å¹³å‡å¤§å°ï¼Œå°äºŽåˆ™ Old GC==ã€‚
> 2. å¦åˆ™ä¼š==å†’é™©å°è¯• Young GCï¼Œå¦‚æžœè€å¹´ä»£ç©ºé—´ä¸è¶³å°±ä¼š Full GC==ï¼Œæ¸…ç†åŽä»»ç„¶ä¸è¶³å°±ä¼š OOM æŠ¥é”™ã€‚
> 3. ==è€å¹´ä»£çš„ç©ºé—´å ç”¨è¶…è¿‡é»˜è®¤ 92%==ï¼Œå³å‰©ä½™çš„ç©ºé—´å¯èƒ½ä¸è¶³ä»¥å­˜æ”¾å…¶åœ¨ ==CMS å¹¶å‘æ¸…ç†é˜¶æ®µæ–°åŠ å…¥è€å¹´ä»£çš„åžƒåœ¾æ—¶ä¹Ÿä¼šè¿›è¡Œ Old GC==ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æžœè€å¹´ä»£æ²¡æœ‰è¾¾åˆ° 92% çš„å ç”¨çŽ‡ï¼Œä½†æ˜¯==å¹¶å‘æ¸…ç†é˜¶æ®µæ–°åŠ å…¥è€å¹´ä»£çš„åžƒåœ¾ä»ç„¶æ”¾ä¸ä¸‹æ—¶==ï¼Œåˆ™ä¼šä½¿ç”¨ ==Serial Old å›žæ”¶æœŸå•çº¿ç¨‹åœ°å¯¹è€å¹´ä»£è¿›è¡Œåžƒåœ¾å›žæ”¶==ï¼Œæžå¤§åœ°é™ä½Žäº†ä¸šåŠ¡çš„æ€§èƒ½ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - å¤§çº¦æœ‰ä¸‰ç§æƒ…å†µï¼Œç¬¬ä¸€æ¬¡æ˜¯ Young GC å‘ç”Ÿä¹‹å‰ï¼Œå¦‚æžœ==è€å¹´ä»£çš„å¯ç”¨å†…å­˜å°äºŽä»¥å¾€ Young GC åŽå‡å…¥è€å¹´ä»£çš„å¯¹è±¡çš„å¹³å‡å¤§å°==ï¼Œæ­¤æ—¶å°±å¸¦å…ˆè§¦å‘ä¸€æ¬¡ Old GCï¼Œè…¾å‡ºæ›´å¤šç©ºé—´ï¼›ç¬¬äºŒæ¬¡æ˜¯ ==Young GC è§¦å‘ä¹‹åŽï¼Œå¦‚æžœéœ€è¦æ™‹å‡è€å¹´ä»£çš„å¯¹è±¡åœ¨è€å¹´ä»£ä¸­ç©ºé—´ä¸è¶³==ï¼Œæ­¤æ—¶è¿˜å¸¦è¿›è¡Œä¸€æ¬¡ Old GCï¼›ç¬¬ä¸‰æ¬¡æ˜¯å¦‚æžœ==è€å¹´ä»£çš„å†…å­˜ä½¿ç”¨çŽ‡è¶…è¿‡äº† 92%==ï¼Œä¹Ÿä¼šç›´æŽ¥è§¦å‘ Old GCã€‚
> - æ€»ä¹‹å°±æ˜¯å¦‚æžœè€å¹´ä»£ç©ºé—´ä¸è¶³ä»¥æ”¾ä¸‹æ›´å¤šå¯¹è±¡äº†ï¼Œé‚£å°±å¸¦è¿›è¡Œ Old GC è…¾ç©ºé—´äº†ã€‚
>

---



### 3.ã€JVMä¸“é¢˜ã€‘åžƒåœ¾å›žæ”¶å™¨å¸¸è§é—®é¢˜ðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==é—®é¢˜ä¸€==ï¼š==å¸¸ç”¨çš„åžƒåœ¾å›žæ”¶å™¨æœ‰å“ªäº›ï¼Ÿï¼ˆç›´æŽ¥ç»™å‡ºç­”æ¡ˆå°±è¡Œï¼Œç­‰æé—®å…·ä½“çš„å›žæ”¶å™¨ï¼‰==

==æˆ‘çš„å›žç­”==ï¼š

> 1. å•çº¿ç¨‹çš„ Serial å’Œ Serial Oldï¼Œåˆ†åˆ«å›žæ”¶æ–°ç”Ÿä»£å’Œè€å¹´ä»£ã€‚
> 2. ParNew å’Œ CMSï¼Œè¿™ä¿©é€šå¸¸ä¸€èµ·ä½¿ç”¨ï¼Œåˆ†åˆ«å›žæ”¶æ–°ç”Ÿä»£å’Œè€å¹´ä»£ã€‚
> 3. G1ï¼Œå¯ä»¥åŒæ—¶å›žæ”¶æ–°ç”Ÿä»£å’Œè€å¹´ä»£ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - å¸¸ç”¨çš„åžƒåœ¾å›žæ”¶å™¨æœ‰ CMSï¼ŒG1ï¼Œè¿˜æœ‰æ¯”è¾ƒæ—©çš„ Serialï¼ŒSerial Oldï¼ŒParallel Newï¼ŒParallel Old ç­‰ç­‰ã€‚
>

---

==é—®é¢˜äºŒ==ï¼š==CMSåžƒåœ¾å›žæ”¶å™¨ä»‹ç»ä¸€ä¸‹==

==æˆ‘çš„å›žç­”==ï¼š

> 1. CMS æ˜¯å›žæ”¶è€å¹´ä»£çš„åžƒåœ¾å›žæ”¶å™¨ï¼Œå®ƒçš„å›žæ”¶è¿‡ç¨‹åˆ†4ä¸ªé˜¶æ®µï¼š==åˆå§‹æ ‡è®°ï¼Œå¹¶å‘æ ‡è®°ï¼Œé‡æ–°æ ‡è®°å’Œå¹¶å‘æ•´ç†ï¼Œæœ€åŽè¿˜ä¼šå¯¹å­˜æ´»å¯¹è±¡è¿›è¡Œæ•´ç†==ã€‚
> 2. ==åˆå§‹æ ‡è®°åªæ ‡è®° GC Roots çš„ç›´æŽ¥å¼•ç”¨==ï¼Œè™½ç„¶ä¼š STW ï¼Œä½†æ˜¯æ—¶é—´å¾ˆçŸ­ã€‚
> 3. å¹¶å‘æ ‡è®°ä¼šæ ‡è®° GC Roots çš„==ç›´æŽ¥å’Œé—´æŽ¥å¼•ç”¨==ï¼Œè¿™ä¸ªé˜¶æ®µ==æ¯”è¾ƒè€—æ—¶==ï¼Œä½†æ˜¯å’Œå…¶å®ƒçº¿ç¨‹å¹¶å‘è¿›è¡Œï¼Œæ‰€ä»¥å¹¶ä¸ä¼šæ˜¾è‘—å½±å“ä¸šåŠ¡çš„æ€§èƒ½ã€‚
> 4. é‡æ–°æ ‡è®°é˜¶æ®µæ˜¯==å°†å¹¶å‘æ ‡è®°é˜¶æ®µå…¶å®ƒçº¿ç¨‹æ–°æ·»åŠ çš„å¯¹è±¡è¿›è¡Œå­˜æ´»æ ‡è®°==ï¼Œè™½ç„¶è¿™ä¸ªé˜¶æ®µä¹Ÿä¼š STWï¼Œä½†æ˜¯ç”±äºŽæ–°åŠ å…¥çš„å¯¹è±¡å¹¶ä¸å¤šæ‰€ä»¥é€Ÿåº¦è¿˜æ˜¯å¾ˆå¿«ã€‚
> 5. å¹¶å‘æ•´ç†é˜¶æ®µï¼Œåžƒåœ¾å›žæ”¶å™¨å…¨åŠ›å°†æ²¡æœ‰æ ‡è®°å­˜æ´»çš„å¯¹è±¡è¿›è¡Œæ¸…ç†ï¼Œ==å¹¶åœ¨æ¸…ç†å®Œæˆä¹‹åŽå°†å­˜æ´»å¯¹è±¡è¿›è¡Œæ•´ç†==ï¼Œå‡å°‘å†…å­˜ç¢Žç‰‡èŠ‚çœå†…å­˜ã€‚è¿™ä¸ªé˜¶æ®µåŒæ ·æ˜¯å¹¶å‘è¿›è¡Œçš„ï¼Œ==å…¶å®ƒçº¿ç¨‹å¯ä»¥åœ¨æ­¤é˜¶æ®µå‘è€å¹´ä»£é€å…¥å¯¹è±¡ï¼Œå› æ­¤é»˜è®¤æƒ…å†µä¸‹è€å¹´ä»£ä¼šè‡³å°‘é¢„ç•™8%çš„å†…å­˜æ¥å­˜æ”¾è¿™ä¸€é˜¶æ®µæ–°åŠ å…¥è€å¹´ä»£çš„å¯¹è±¡==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ==CMS åœ¨ JDK 8 æ˜¯æ¯”è¾ƒæ–°çš„åžƒåœ¾å›žæ”¶å™¨ï¼Œå®ƒæœ€å¤§çš„ç‰¹ç‚¹æ˜¯å¹¶å‘ï¼Œä¹Ÿå°±æ˜¯èƒ½å°½é‡å‡å°‘ STW çš„æ—¶é—´==ï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹è®©ç”¨æˆ·çº¿ç¨‹å’Œ GC çº¿ç¨‹å¹¶å‘æ‰§è¡Œã€‚
> - CMS çš„å·¥ä½œæµç¨‹ç®€å•æ¥è¯´åˆ†ä¸ºäº”ä¸ªæ­¥éª¤ï¼šåˆå§‹æ ‡è®°ï¼Œå¹¶å‘æ ‡è®°ï¼Œå¹¶å‘é¢„æ¸…ç†ï¼Œé‡æ–°æ ‡è®°ä»¥åŠå¹¶å‘æ¸…é™¤ã€‚
> - ==åˆå§‹æ ‡è®°ä¼šæ ‡è®° GC Roots ç›´æŽ¥å…³è”çš„å¯¹è±¡==ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šå‘ç”ŸçŸ­æš‚çš„ STWã€‚åˆå§‹æ ‡è®°å®Œä¹‹åŽä¼šè¿›å…¥å¹¶å‘æ ‡è®°ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¸ä¼šå‘ç”Ÿ STWï¼Œç”¨æˆ·çº¿ç¨‹ä¸Ž GC çº¿ç¨‹å¯ä»¥åŒæ—¶å·¥ä½œï¼Œè¿™ä¸ªé˜¶æ®µä¸»è¦æ˜¯==ä»Ž GC Roots å‘ä¸‹è¿½æº¯ï¼Œæ ‡è®°æ‰€æœ‰å¯è¾¾çš„å¯¹è±¡==ã€‚ä¹‹åŽä¼šè¿›å…¥å¹¶å‘é¢„å¤„ç†é˜¶æ®µï¼Œè¿™ä¸ªé˜¶æ®µä¸»è¦ç›®æ ‡æ˜¯å‡å°‘ä¸‹ä¸€ä¸ªä¼šå‘ç”Ÿ STW çš„é˜¶æ®µçš„æ‰§è¡Œæ—¶é—´ï¼Œé€šè¿‡æ‰«æå¡è¡¨æˆ–è€…éåŽ†æ–°ç”Ÿä»£æ¥ç¡®è®¤åœ¨å¹¶å‘æ ‡è®°ä¸­å‘ç”Ÿæ”¹å˜çš„å¯¹è±¡ã€‚æŽ¥ç€å°±æ˜¯é‡æ–°æ ‡è®°ï¼Œ==è¿™ä¸ªé˜¶æ®µ STW åœé¡¿çš„æ—¶é—´ä¸»è¦å–å†³äºŽä¸Šä¸ªé˜¶æ®µï¼ŒæŽ¥ç€æ ‡è®°è¿˜å­˜æ´»çš„è€å¹´ä»£å¯¹è±¡==ã€‚æœ€åŽå°±æ˜¯å¹¶å‘æ¸…é™¤é˜¶æ®µï¼Œè¿™ä¸ªé˜¶æ®µä¸ä¼š STWï¼Œ==ç”¨æˆ·çº¿ç¨‹ä¸€è¾¹æ‰§è¡Œï¼ŒGC çº¿ç¨‹ä¸€è¾¹å›žæ”¶åˆšæ ‡è®°è¿‡çš„åžƒåœ¾==ã€‚
> - ä¸è¿‡ CMS ä¹Ÿæœ‰ç¼ºç‚¹ï¼Œä¸»è¦æ˜¯å­˜åœ¨==å†…å­˜ç¢Žç‰‡é—®é¢˜==ï¼Œå› ä¸ºå®ƒæœ¬è´¨ä¸Šè¿˜æ˜¯æŒ‰ç…§ â€æ ‡è®°-æ¸…é™¤â€œ ç®—æ³• åŽ»å®žçŽ°çš„ã€‚å¦‚æžœå†…å­˜ç¢Žç‰‡å¤ªå¤šçš„è¯ä¼šè§¦å‘ Full GCï¼ŒCMS ä¸€èˆ¬åœ¨ Full GC è¿™ä¸ªè¿‡ç¨‹ä¸­å¯¹ç¢Žç‰‡è¿›è¡Œæ•´ç†ã€‚==æ•´ç†çš„è¿‡ç¨‹åˆåŒ…æ‹¬ â€ç§»åŠ¨â€œï¼Œâ€æ ‡è®°â€œï¼Œä¹Ÿæ˜¯ä¼šå‘ç”Ÿ STW çš„==ï¼›è¿˜æœ‰å°±æ˜¯ CMS å›žæ”¶è¿‡ç¨‹ä¸­ä¼šäº§ç”Ÿ==æµ®åŠ¨åžƒåœ¾ï¼Œä¸»è¦æ˜¯åœ¨å¹¶å‘æ¸…é™¤é˜¶æ®µï¼Œç”±äºŽ GC çš„è¿‡ç¨‹ä¸­ç”¨æˆ·çº¿ç¨‹ä¹Ÿä¸€ç›´åœ¨æ‰§è¡Œï¼Œé‚£å°±ä¼šä¸€ç›´äº§ç”Ÿåžƒåœ¾==ï¼Œè¿™äº›åžƒåœ¾åªèƒ½åˆ°ä¸‹ä¸€æ¬¡ GC æ—¶æ‰èƒ½æ¸…ç†ã€‚
>

---

==é—®é¢˜ä¸‰==ï¼š==G1å›žæ”¶å™¨äº†è§£å—ï¼Ÿä»‹ç»ä¸€ä¸‹==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==G1 å›žæ”¶å™¨ä¸å†æ˜Žç¡®åˆ’åˆ†æ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œè€Œæ˜¯åˆ’åˆ†ä¼—å¤šå°åŒºåŸŸ Region==ï¼Œæ¯ä¸€ä¸ª ==Region æ—¢å¯ä»¥å±žäºŽæ–°ç”Ÿä»£ä¹Ÿå¯ä»¥å±žäºŽè€å¹´ä»£==ï¼Œå…¶ç›®çš„æ˜¯å¯ä»¥==è¿½è¸ªæ¯ä¸€ä¸ª Region å¯å›žæ”¶å¯¹è±¡çš„å¤§å°å¹¶é¢„ä¼°å›žæ”¶æ—¶é—´==ï¼Œä»Žè€Œä½¿å¾—==æˆ‘ä»¬å¯ä»¥æŒ‡å®šä¸€ä¸ªå¤§è‡´çš„ STW æ—¶é—´==ã€‚
> 2. G1 é‡‡å–çš„å›žæ”¶ç®—æ³•æ˜¯==å¤åˆ¶ç®—æ³•==ï¼Œå½“==è€å¹´ä»£çš„å ç”¨çŽ‡è¾¾åˆ°æ€»å †å†…å­˜çš„45%æ—¶==ï¼Œä¼šè§¦å‘æ–°ç”Ÿä»£å’Œè€å¹´ä»£çš„æ··åˆGCã€‚å…¶æ­¥éª¤åˆ†ä¸º==åˆå§‹æ ‡è®°ï¼Œå¹¶å‘æ ‡è®°ï¼Œæœ€ç»ˆæ ‡è®°å’Œæ··åˆå›žæ”¶==ã€‚
> 3. åˆå§‹æ ‡è®°ä¹Ÿæ˜¯åªæ ‡è®° GC Roots ç›´æŽ¥å¼•ç”¨çš„å¯¹è±¡ã€‚å¹¶å‘æ ‡è®°åˆ™æ ‡è®°ç›´æŽ¥å’Œé—´æŽ¥å¼•ç”¨ã€‚æœ€ç»ˆæ ‡è®°åŒæ ·æ˜¯æ ‡è®°å¹¶å‘æ ‡è®°é˜¶æ®µæ–°åŠ å…¥çš„å¯¹è±¡å­˜è´§çŠ¶æ€ã€‚
> 4. ==æ··åˆå›žæ”¶åˆ™æ˜¯ STW çš„==ï¼Œå®ƒä¼šæ ¹æ®è·Ÿè¸ª Region çš„æ•°æ®==ä¼˜å…ˆå›žæ”¶æ€§ä»·æ¯”é«˜çš„ Region==ï¼Œå¹¶==æŠŠæ€» STW æ—¶é—´æŽ§åˆ¶åœ¨æˆ‘ä»¬è®¾å®šçš„æ—¶é—´å·¦å³==ã€‚è¿™ä¸ªé˜¶æ®µ==æ—¢ä¼šå›žæ”¶æ–°ç”Ÿä»£ï¼Œä¹Ÿä¼šå›žæ”¶è€å¹´ä»£å’Œå¤§å¯¹è±¡çš„åžƒåœ¾==ï¼ŒåŒæ—¶å¯¹äºŽå¤§å¯¹è±¡ï¼ŒG1 ä¸“é—¨ä¸ºä»–ä»¬åˆ†é…ç‰¹å®šç©ºé—´è¿›è¡Œå­˜å‚¨ã€‚
> 5. å¹¶ä¸”==åœ¨æ··åˆå›žæ”¶çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹è±¡ä¼šè¿›è¡Œå¤šæ¬¡å›žæ”¶ï¼Œé»˜è®¤8æ¬¡==ï¼Œå…¶ç›®çš„æ˜¯==è¿›ä¸€æ­¥é™ä½Žæ¯æ¬¡å›žæ”¶ STW çš„æ—¶é—´==ã€‚
> 6. ==ä¸€æ—¦å›žæ”¶æ—¶ç©ºé—²çš„ Region è¾¾åˆ°æ€»æ•°çš„5%ï¼Œå°±ä¼šç«‹å³åœæ­¢æ··åˆå›žæ”¶==ã€‚ä¸”å¯¹äºŽ==å­˜æ´»å¯¹è±¡å¤§äºŽ85%çš„ Region ä¸ä¼šè¿›è¡Œå›žæ”¶==ï¼Œå› ä¸ºå¤åˆ¶ç®—æ³•æ¶‰åŠåˆ°å¯¹è±¡è¿ç§»ï¼Œè¿ç§»è¿™ä¹ˆå¤šå­˜æ´»å¯¹è±¡æœ‰æŸæ•ˆçŽ‡ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ä½¿ç”¨ G1 å›žæ”¶å™¨æ—¶ï¼ŒJVM å †çš„åˆ’åˆ†ä¸å†æ˜¯ç‰©ç†çš„å½¢å¼ï¼Œè€Œæ˜¯ä»¥é€»è¾‘çš„å½¢å¼==å°†æ•´ä¸ªå †åˆ’åˆ†æˆå¤šä¸ªå°çš„ Regionï¼Œè¿™æ ·åœ¨åžƒåœ¾å›žæ”¶æ—¶èƒ½æ¯”è¾ƒå®¹æ˜“çš„æŽ§åˆ¶åžƒåœ¾å›žæ”¶çš„æ—¶é—´ï¼Œå‡å°‘ STW==ã€‚
>
> - G1 åžƒåœ¾å›žæ”¶çš„è¿‡ç¨‹ä¸»è¦åˆ†ä¸º Minor GC å’Œ Mixed GCï¼ŒæŸäº›ç‰¹æ®Šçš„åœºæ™¯ä¼šå‘ç”Ÿ Full GCã€‚ å¯¹äºŽ ==Minor GC æ¥è¯´ä¹Ÿæ˜¯ Eden åŒºæ»¡äº†å°±è§¦å‘ Minor GC==ã€‚å½“==æ•´ä¸ªå †ç©ºé—´çš„å ç”¨çŽ‡åˆ°è¾¾ä¸€å®šé˜ˆå€¼æ—¶æ‰ä¼šè§¦å‘ Mixed GC==ã€‚
>
> - Minor GC çš„è¿‡ç¨‹å¯ä»¥ç®€å•åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼šæ ¹æ‰«æï¼Œæ›´æ–°å’Œå¤„ç† RSetï¼Œå¤åˆ¶å¯¹è±¡ã€‚æ ¹æ‰«æçš„è¿‡ç¨‹å°±å’Œ CMS çš„åˆå§‹æ ‡è®°è¿‡ç¨‹å·®ä¸å¤šï¼Œæ‰«æä¸Ž GC Roots ç›´æŽ¥å…³è”çš„å¯¹è±¡ã€‚ç¬¬äºŒæ­¥å°±æ˜¯æ›´æ–°å’Œå¤„ç† RSetï¼Œå°†è€å¹´ä»£å¯¹è±¡æŒæœ‰å¹´è½»ä»£å¯¹è±¡çš„å¼•ç”¨éƒ½åŠ å…¥åˆ° GC Roots ä¸‹ï¼Œé¿å…è¢«å›žæ”¶ã€‚æœ€åŽæ˜¯å¤åˆ¶å¯¹è±¡ï¼ŒæŠŠæ‰«æä¹‹åŽå­˜æ´»çš„å¯¹è±¡å¾€ â€ç©ºçš„ Survivor åŒºâ€œ æˆ– â€è€å¹´ä»£â€œ å­˜æ”¾ï¼Œå…¶å®ƒçš„ Eden åŒºæ¸…é™¤ã€‚
>
> 	> RSet æ˜¯ G1 å›žæ”¶å™¨ä¸­ç”¨æ¥è§£å†³åž®ä»£å¼•ç”¨é—®é¢˜çš„ä¸€å—å­˜å‚¨ç©ºé—´ã€‚==æ¯ä¸ª Region éƒ½ä¼šæœ‰ä¸€å°å—åŒºåŸŸä½œä¸º Rsetï¼Œè®°å½•ç€å…¶å®ƒ Region å¼•ç”¨äº†å½“å‰ Region çš„å¯¹è±¡å…³ç³»==ã€‚å¯¹äºŽå¹´è½»ä»£çš„ Regionï¼Œå®ƒçš„ RSet åªä¿å­˜äº†æ¥è‡ªè€å¹´ä»£çš„å¼•ç”¨ã€‚å¯¹äºŽè€å¹´ä»£çš„ Regionï¼Œå®ƒçš„ RSet ä¹Ÿåªä¼šä¿å­˜è€å¹´ä»£å¯¹å®ƒçš„å¼•ç”¨ã€‚
> 	>
> 	> é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªåè¯æ˜¯ CSetï¼Œå®ƒä¿å­˜äº†ä¸€æ¬¡ GC ä¸­ï¼Œå°†æ‰§è¡Œåžƒåœ¾å›žæ”¶çš„ Regionã€‚CSet ä¸­çš„æ‰€æœ‰å­˜æ´»å¯¹è±¡éƒ½ä¼šè¢«è½¬ç§»åˆ°åˆ«çš„å¯ç”¨ Regin ä¸Šã€‚åœ¨ Minor GC çš„æœ€åŽï¼Œä¼šå¤„ç†è½¯å¼•ç”¨ï¼Œå¼±å¼•ç”¨ç­‰ç­‰ï¼Œç»“æŸæ”¶é›†ã€‚
>
> - ==Mixed GC æ˜¯ä¸€ä¸ªæ··åˆçš„ GCï¼Œå®ƒä¸ä»…ä¼šå›žæ”¶å¹´è½»ä»£ï¼Œè§¦å‘ Minor GCï¼Œä¹Ÿä¼šå›žæ”¶éƒ¨åˆ†è€å¹´ä»£çš„ Region==ã€‚å›žæ”¶è¿‡ç¨‹å¤§æ¦‚æ˜¯åˆå§‹æ ‡è®°ï¼Œå¹¶å‘æ ‡è®°ï¼Œé‡æ–°æ ‡è®°ï¼Œæ¸…ç†ã€‚
>
> - é¦–å…ˆåˆå§‹æ ‡è®°çš„è¿‡ç¨‹å¤ç”¨äº† Minor GC æ‰«æ GC Roots çš„æ“ä½œï¼Œé€Ÿåº¦å¾ˆå¿«ã€‚ç„¶åŽè¿›è¡Œå¹¶å‘æ ‡è®°ï¼ŒGC çº¿ç¨‹ä¸Žç”¨æˆ·çº¿ç¨‹ä¸€èµ·æ‰§è¡Œï¼ŒGC çº¿ç¨‹è´Ÿè´£æ”¶é›†å„ä¸ª Region çš„å­˜æ´»å¯¹è±¡ä¿¡æ¯ï¼Œä»Ž GC Roots å¾€ä¸‹è¿½éšï¼ŒæŸ¥æ‰¾æ•´ä¸ªå †å­˜æ´»çš„å¯¹è±¡ã€‚ç„¶åŽæ˜¯é‡æ–°æ ‡è®°ï¼Œç”¨ STAB ç®—æ³•æ ‡è®°é‚£äº›åœ¨å¹¶å‘æ ‡è®°é˜¶æ®µå‘ç”Ÿå˜åŒ–çš„å¯¹è±¡ï¼Œå¸¦æœ‰ STWã€‚æœ€åŽæ˜¯æ¸…ç†ï¼Œä¹Ÿä¼šå‘ç”Ÿ STWï¼Œ==ä¸»è¦å›žæ”¶æ‰€æœ‰çš„å¹´è½»ä»£ Regionï¼Œéƒ¨åˆ†å›žæ”¶ä»·å€¼é«˜çš„è€å¹´ä»£ Region==ã€‚
>
> - æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚æžœ Mixed GC ä¸­å›žæ”¶é€Ÿåº¦è·Ÿä¸ä¸Šç”¨æˆ·çº¿ç¨‹åˆ†é…å†…å­˜çš„é€Ÿåº¦ï¼Œå¯¼è‡´==è€å¹´ä»£å¡«æ»¡æ— æ³•ç»§ç»­è¿›è¡Œ Mixed GCï¼Œå°±ä¼šé™çº§åˆ° Serial Old GC å¯¹æ•´ä¸ªå †è¿›è¡Œ GC==ã€‚
>

---

==é—®é¢˜å››==ï¼š==G1å’ŒCMSæœ‰å•¥åŒºåˆ«ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. G1 å¯ç”¨äºŽæ–°ç”Ÿä»£å’Œè€å¹´ä»£çš„åžƒåœ¾å›žæ”¶ï¼Œè€Œ CMS åªèƒ½ç”¨äºŽè€å¹´ä»£ã€‚G1 ä¸å†æ˜Žç¡®åˆ’åˆ†æ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œè€Œæ˜¯åˆ’åˆ†ä¼—å¤šå°åŒºåŸŸ Regionï¼Œè€Œ CMS ä¸­æ˜Žç¡®åˆ’åˆ†äº†æ–°ç”Ÿä»£å’Œè€å¹´ä»£ã€‚G1 ä½¿ç”¨å¤åˆ¶ç®—æ³•è¿›è¡Œå›žæ”¶ï¼Œè€Œ CMS ä½¿ç”¨æ ‡è®°-æ•´ç†æ³•ã€‚G1 å¯ä»¥äººä¸ºè®¾ç½®æ¯æ¬¡ STW çš„æ—¶é—´ï¼Œç›¸æ¯”äºŽ CMS å¯ä»¥æœ‰æ•ˆæŽ§åˆ¶ STWã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - é¦–å…ˆæ˜¯ G1 å›žæ”¶å™¨çš„å†…å­˜ç»“æž„å®Œå…¨åŒºåˆ«äºŽ CMSã€‚G1 æ•´ä½“ä¸Šæ˜¯åŸºäºŽ â€æ ‡è®°-æ•´ç†â€œ ç®—æ³•çš„å®žçŽ°ï¼Œ==ä¸ä¼šå‡ºçŽ°å†…å­˜ç¢Žç‰‡==ï¼Œè€Œ CMS æœ¬è´¨ä¸Šæ˜¯åŸºäºŽ â€æ ‡è®°-æ¸…é™¤â€œ ç®—æ³•å®žçŽ°ï¼Œä¼šæœ‰==å†…å­˜ç¢Žç‰‡é—®é¢˜==ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œ==G1 å›žæ”¶å™¨å¯ä»¥æ ¹æ®è‡ªå®šä¹‰åœé¡¿æ—¶é—´æ¨¡åž‹ï¼Œæ¥å†³å®šæœ¬æ¬¡å›žæ”¶å¤šå°‘ Region==ã€‚
>

---

==é—®é¢˜äº”==ï¼š==STWäº†è§£å—ï¼ŸCMSä»€ä¹ˆæ—¶å€™ä¼šSTWï¼Ÿä¸ºä»€ä¹ˆè¦STWï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. STW ä¸º Stop the World çš„ç¼©å†™ï¼Œè¡¨ç¤ºåžƒåœ¾å›žæ”¶è¿‡ç¨‹ä¸­ä¸ºé¿å…å…¶å®ƒçº¿ç¨‹å¯¹åžƒåœ¾å›žæ”¶çº¿ç¨‹çš„å½±å“è€Œ==æš‚æ—¶é˜»å¡žå…¶å®ƒçº¿ç¨‹ï¼Œå…¨åŠ›å›žæ”¶åžƒåœ¾çš„æœºåˆ¶==ã€‚å¦‚æžœ JVM å†…å­˜è®¾å®šä¸åˆç†ï¼Œå¯èƒ½å¯¼è‡´é¢‘ç¹è¿›è¡Œåžƒåœ¾å›žæ”¶è€Œé¢‘ç¹å¯¼è‡´ä¸šåŠ¡ä¸­å…¶å®ƒçº¿ç¨‹è¢«é˜»å¡žï¼Œæ¯”å¦‚åœ¨ç½‘é¡µè®¿é—®æ—¶ç”¨æˆ·ä¼šç»å¸¸æ„Ÿåˆ°å¡é¡¿ï¼Œå½±å“ç”¨æˆ·ä½“éªŒã€‚
> 2. CMS ä¸­==åˆå§‹æ ‡è®°å’Œé‡æ–°æ ‡è®°ä¼š STW==ï¼Œä½†æ˜¯å®ƒä»¬è€—æ—¶éƒ½æ¯”è¾ƒçŸ­ã€‚
> 3. å¦‚æžœä¸è¿›è¡Œ STW çš„è¯ï¼Œ==å…¶å®ƒçº¿ç¨‹ä¼šåœ¨åžƒåœ¾çº¿ç¨‹å›žæ”¶çš„è¿‡ç¨‹ä¸­ç»§ç»­å‘å †åŒºåˆ›å»ºå¯¹è±¡ï¼Œå½±å“åžƒåœ¾å›žæ”¶çº¿ç¨‹çš„æ­£å¸¸æ‰§è¡Œ==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - STW å°±æ˜¯ Stop the Worldï¼Œåœ¨åžƒåœ¾å›žæ”¶æ—¶é™¤ GC çº¿ç¨‹å¤–ï¼Œå…¶å®ƒçº¿ç¨‹éƒ½è¦åœæ­¢å·¥ä½œï¼Œå¯¼è‡´åº”ç”¨æš‚æ—¶åœæ­¢è®¿é—®ã€‚
> - CMS ä¼šåœ¨åˆå§‹æ ‡è®°å’Œé‡æ–°æ ‡è®°é˜¶æ®µå‘ç”Ÿ STWï¼Œåœ¨åˆå§‹é˜¶æ®µä¼šæ ‡è®°ä¸Ž GC Roots ç›¸å…³çš„å¯¹è±¡ï¼Œè¿™æ—¶æ˜¯éœ€è¦ç”¨æˆ·çº¿ç¨‹åœæ­¢å·¥ä½œçš„ã€‚ä¹‹åŽåœ¨é‡æ–°æ ‡è®°é˜¶æ®µä¹Ÿä¸€æ ·ï¼Œéœ€è¦æ ‡è®°è¿˜å­˜æ´»ç€çš„è€å¹´ä»£å¯¹è±¡ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿè¦ STWã€‚
>

---

==é—®é¢˜å…­==ï¼š==è¯´ä¸€ä¸‹åžƒåœ¾å›žæ”¶ï¼Ÿå¦‚æžœGCçªç„¶å¾ˆæ…¢æ€Žä¹ˆæŽ’æŸ¥ï¼Œæ¯”å¦‚åŽŸæ¥GCå®Œæˆåªéœ€è¦1ç§’ï¼ŒçŽ°åœ¨è¦5ç§’ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. çªç„¶å˜æ…¢å¯èƒ½æ˜¯å› ä¸º ==JVM å‚æ•°è®¾ç½®ä¸åˆç†==ï¼Œæˆ–è€…å¯¹ä¸šåŠ¡äº§ç”Ÿå’Œå¤„ç†åžƒåœ¾çš„é€Ÿåº¦è¯„ä¼°å‡ºé”™å¯¼è‡´æœºå™¨çš„æ•°é‡æˆ–é…ç½®é€‰æ‹©æœ‰è¯¯å¯¼è‡´è€å¹´ä»£ GC æˆ–ä½¿ç”¨ Serial è¿›è¡Œå•çº¿ç¨‹åžƒåœ¾å›žæ”¶ã€‚
> 2. è¿™é‡Œå¯ä»¥==æŸ¥çœ‹ GC æ—¥å¿—ï¼Œæ ¹æ®ä¸šåŠ¡æ–°å¢žå’Œå¤„ç†åžƒåœ¾çš„é€Ÿåº¦åˆç†åˆ†é…èµ„æº==ï¼Œé¿å…å¤§é‡å¯¹è±¡è¯¯å…¥è€å¹´ä»£è€Œé¢‘ç¹è§¦å‘è€å¹´ä»£ GCã€‚
> 3. è¿˜æœ‰å¯¹äºŽ==å†…å­˜è¿‡å¤§çš„æœºå™¨ï¼Œç”±äºŽä¸€æ¬¡å›žæ”¶çš„åžƒåœ¾æ•°é‡è¿‡å¤§å¯èƒ½ STW æ—¶é—´è¿‡é•¿ï¼Œå¯ä»¥ä½¿ç”¨ G1 å›žæ”¶å™¨==æŒ‡å®šåžƒåœ¾å›žæ”¶æ—¶é—´ï¼ŒæŽ§åˆ¶ STW çš„æ—¶é•¿ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - å‡ºçŽ°è¿™ç§æƒ…å†µå¯ä»¥==å…ˆåŽ»çœ‹ä¸‹ GC æ—¥å¿—==ï¼Œ==çœ‹æ˜¯å“ªä¸ªçŽ¯èŠ‚çš„æ—¶é—´å¾ˆé•¿==ï¼Œæ¯”å¦‚ ==root scraningï¼Œobject copy å•¥çš„==ã€‚æœ€å¥½æ˜¯ç”¨ ==gceasy å·¥å…·ä½¿ GC æ—¥å¿—å¯è§†åŒ–çœ‹çœ‹å †ä¿¡æ¯ï¼Œäº¤äº’å¼å›¾è¡¨==ç­‰ç­‰ã€‚
> - é™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥ ==dump çº¿ç¨‹è¿›è¡Œåˆ†æž==ã€‚
>

---



### 4.ã€JVMä¸“é¢˜ã€‘å†…å­˜æ¨¡åž‹ç›¸å…³ðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==é—®é¢˜ä¸€==ï¼š==èƒ½è¯´ä¸€ä¸‹JVMè¿è¡Œæ—¶çš„å†…å­˜åŒºåŸŸåˆ’åˆ†å—==ï¼Ÿï¼ˆå¤§å®¶éœ€è¦æŠŠè¿™ä¸ªå’ŒJVMæ¨¡åž‹æžä¹±ï¼Œæœ€å¥½é—®æ¸…æ¥šç‚¹ï¼Œæœ‰æ—¶å€™æ¨¡åž‹æ˜¯æŒ‡è¿›ç¨‹/çº¿ç¨‹æ¨¡åž‹ï¼‰

==æˆ‘çš„å›žç­”==ï¼š

> 1. JVM è¿è¡Œæ—¶å†…å­˜åŒºåŸŸåˆ†ä¸º==ç¨‹åºè®¡æ•°å™¨ï¼ŒJava è™šæ‹Ÿæœºæ ˆï¼Œæœ¬åœ°æ–¹æ³•æ ˆï¼Œå †åŒºå’Œæ–¹æ³•åŒº5ä¸ªéƒ¨åˆ†==ã€‚
> 2. ç¨‹åºè®¡æ•°å™¨ç»Ÿè®¡å¯¹åº”çº¿ç¨‹å­—èŠ‚ç æ‰§è¡Œçš„ä½ç½®ã€‚ä¸»è¦ç”¨äºŽ==åˆ†æ”¯ã€å¾ªçŽ¯ã€å¼‚å¸¸å¤„ç†å’Œçº¿ç¨‹è·³è½¬åŽçš„æ¢å¤==ã€‚å€¼å¾—ä¸€æçš„æ˜¯==æ¯ä¸€ä¸ªå†…æ ¸è½®æµæ‰§è¡Œå¤šä¸ªçº¿ç¨‹ä¸­çš„æŒ‡ä»¤==ï¼Œå› æ­¤ä¸ºäº†åœ¨==çº¿ç¨‹åˆ‡æ¢åŽèƒ½æ¢å¤åˆ°æ­£ç¡®çš„æ‰§è¡Œä½ç½®==ï¼Œ==æ¯æ¡çº¿ç¨‹éƒ½åº”è¯¥æœ‰ä¸€ä¸ªç¨‹åºè®¡æ•°å™¨==ã€‚
> 3. æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ª ==Java è™šæ‹Ÿæœºæ ˆï¼Œç”¨äºŽå­˜å‚¨å½“å‰çº¿ç¨‹è°ƒç”¨çš„æ–¹æ³•çš„æ ˆå¸§==ï¼Œ==æ ˆå¸§ä¸­åŒ…å«å½“å‰æ–¹æ³•æ‰€éœ€å‚æ•°ï¼Œå±€éƒ¨å˜é‡å’Œæ–¹æ³•å‡ºå£==ç­‰ã€‚
> 4. ==æœ¬åœ°æ–¹æ³•æ ˆä¸­å­˜æ”¾è™šæ‹Ÿæœºä¸­æ‰€éœ€çš„ Native æ–¹æ³•==ã€‚æœ¬åœ°æ–¹æ³•æ ˆä¸­æ‰€ä½¿ç”¨çš„è¯­è¨€æ²¡æœ‰é™åˆ¶ï¼Œè™šæ‹Ÿæœºå¯ä»¥é‡‡ç”¨åˆé€‚çš„è¯­è¨€è‡ªè¡Œå®žçŽ°è¿™äº› Native æ–¹æ³•ã€‚==å³ Native æ–¹æ³•å­˜æ”¾åœ¨æœ¬åœ°æ–¹æ³•æ ˆä¸­ï¼Œå…¶å…·ä½“å®žçŽ°å–å†³äºŽ JVMï¼Œå¹¶ä¸”æ²¡æœ‰è¯­è¨€çš„é™åˆ¶==ã€‚
> 5. ==å †åŒºä¸­ä¸»è¦å­˜æ”¾è¿è¡Œæ—¶äº§ç”Ÿçš„å¯¹è±¡å®žä¾‹==ï¼Œåœ¨åžƒåœ¾å›žæ”¶ä¸­éƒ¨åˆ†åžƒåœ¾å›žæ”¶å™¨å¦‚ ParNew å’Œ CMS è¿˜å°†å…¶åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ä»¥æé«˜å›žæ”¶æ•ˆçŽ‡ã€‚
> 6. ==æ–¹æ³•åŒºåˆ™å­˜æ”¾åŠ è½½åŽçš„ç±»ä¿¡æ¯ Class å¯¹è±¡ï¼Œé™æ€å˜é‡å’Œå¸¸é‡ï¼Œä»¥åŠç¼–è¯‘åŽçš„ä»£ç ==ã€‚æ–¹æ³•åŒºä¸­æœ‰ä¸€ä¸ª==å¸¸é‡æ± ï¼Œé‡Œé¢å­˜æ”¾åŸºæœ¬æ•°æ®ç±»åž‹çš„å¸¸é‡ä»¥åŠ String ç±»åž‹å¸¸é‡==ï¼Œå€¼å¾—ä¸€æçš„æ˜¯==ç±»åï¼Œå­—æ®µåä»¥åŠæ–¹æ³•åå’Œå®ƒä»¬çš„é™åˆ¶ç¬¦åéƒ½ä»¥ CONSTANT_utf8_info çš„ç±»åž‹å­˜å‚¨åœ¨å¸¸é‡æ± ==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ç®€å•æ¥è¯´ JVM è¿è¡Œæ—¶çš„å†…å­˜åŒºåŸŸåˆ†ä¸ºäº†äº”å¤§å—ï¼š==ç¨‹åºè®¡æ•°å™¨ï¼Œè™šæ‹Ÿæœºæ ˆï¼Œæœ¬åœ°æ–¹æ³•æ ˆï¼Œå †ï¼Œæ–¹æ³•åŒº==ã€‚
> - å…¶ä¸­==ç¨‹åºè®¡æ•°å™¨ç”¨æ¥è®°å½•å„ä¸ªçº¿ç¨‹æ‰§è¡Œçš„å­—èŠ‚ç åœ°å€==ï¼Œé€šå¸¸åœ¨==çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢==æ—¶ç”¨æ¥==ä¿å­˜å½“å‰çº¿ç¨‹çš„æ‰§è¡Œä¿¡æ¯==ã€‚
> - ==è™šæ‹Ÿæœºæ ˆç”¨äºŽä¿å­˜æ–¹æ³•çš„å±€éƒ¨å˜é‡ï¼Œæ“ä½œæ ‘å¹¶å‚ä¸Žæ–¹æ³•çš„è°ƒç”¨å’Œè¿”å›ž==ã€‚==æ¯ä¸ªçº¿ç¨‹åœ¨åˆ›å»ºæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿæœºæ ˆï¼Œæ¯æ¬¡æ–¹æ³•è°ƒç”¨éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§å¹¶åŽ‹å…¥è™šæ‹Ÿæœºæ ˆä¸­ã€‚æ ˆå¸§ä¸­ä¿å­˜çš„å°±æ˜¯æ–¹æ³•ä¿¡æ¯ï¼Œå¦‚æ“ä½œæ•°æ ˆï¼Œå±€éƒ¨å˜é‡è¡¨ç­‰ç­‰==ã€‚
> - ==æœ¬åœ°æ–¹æ³•æ ˆå°±æ˜¯ç”¨äºŽç®¡ç† native æ–¹æ³•çš„è°ƒç”¨ï¼Œä¸€èˆ¬æ˜¯ç”± C è¯­è¨€å®žçŽ°çš„==ã€‚
> - ==å †æ˜¯çº¿ç¨‹å…±äº«çš„åŒºåŸŸï¼Œå‡ ä¹Žç±»çš„å®žä¾‹å’Œæ•°ç»„åˆ†é…çš„å†…å­˜éƒ½æ¥è‡ªäºŽå®ƒ==ã€‚å †è¢«åˆ’åˆ†ä¸º â€œæ–°ç”Ÿä»£â€ å’Œ â€œè€å¹´ä»£â€ï¼Œæ–°ç”Ÿä»£åˆè¢«è¿›ä¸€æ­¥åˆ’åˆ†ä¸º Eden å’Œ Survivor åŒºï¼Œè¿™äº›éƒ½ä¸»è¦è·Ÿåžƒåœ¾å›žæ”¶æœºåˆ¶æœ‰å…³ã€‚
> - é¦–å…ˆ==æ–¹æ³•åŒºåªæ˜¯ JVM çš„è§„èŒƒï¼Œå…·ä½“çš„å®žçŽ°å¯èƒ½å„ä¸ªåŽ‚å•†ä¸ä¸€æ ·==ï¼Œåœ¨ HotSpot è™šæ‹Ÿæœºä¸­ï¼ŒJDK 8 ä»¥å‰æ˜¯ç”¨ â€œæ°¸ä¹…ä»£â€ å®žçŽ°çš„ â€œæ–¹æ³•åŒºâ€ï¼Œ==åœ¨ JDK 8 ä¸­ç”¨ â€œå…ƒç©ºé—´â€ ä»£æ›¿äº† â€œæ°¸ä¹…ä»£â€ ä½œä¸ºæ–¹æ³•åŒºçš„å®žçŽ°==ã€‚é‚£ä¹ˆ==æ–¹æ³•åŒºä¸»è¦æ˜¯ç”¨æ¥å­˜æ”¾è™šæ‹ŸæœºåŠ è½½çš„ â€œç±»ç›¸å…³ä¿¡æ¯â€ï¼Œæ¯”å¦‚ç±»ä¿¡æ¯ï¼Œå¸¸é‡æ± ç­‰ç­‰==ã€‚å…¶ä¸­ç±»ä¿¡æ¯åŒ…æ‹¬ç±»ä¸­çš„å­—æ®µï¼Œæ–¹æ³•ï¼Œçˆ¶ç±»ç­‰ç­‰ã€‚==å¸¸é‡æ± åˆåŒ…æ‹¬é™æ€å¸¸é‡æ± å’ŒåŠ¨æ€å¸¸é‡æ± ï¼Œé™æ€å¸¸é‡æ± ç”¨æ¥ä¿å­˜å­—é¢é‡ä»¥åŠç¬¦å·å¼•ç”¨ç­‰ä¿¡æ¯==ï¼Œ==åŠ¨æ€å¸¸é‡æ± ç”¨æ¥å­˜å‚¨ç±»åŠ è½½æ—¶ç”Ÿæˆçš„ â€œç›´æŽ¥å¼•ç”¨â€ ç­‰ä¿¡æ¯==ã€‚
>

---

==é—®é¢˜äºŒ==ï¼š==é‚£ JVM è¿›ç¨‹ä¸Žçº¿ç¨‹æ¨¡åž‹å‘¢ï¼Ÿä»‹ç»ä¸€ä¸‹==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ä¸€ä¸ªè¿è¡Œçš„ JVMï¼Œåœ¨æ“ä½œç³»ç»Ÿå±‚é¢ï¼Œå°±æ˜¯ä¸€ä¸ªè¿›ç¨‹ã€‚åœ¨æ¯ä¸€ä¸ªè¿›ç¨‹å†…éƒ¨å¯ä»¥æ‰§è¡Œå¤šä¸ªçº¿ç¨‹ä»¥è¿è¡Œå¤šä¸ª java åº”ç”¨ç¨‹åºã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - åœ¨æ“ä½œç³»ç»Ÿå±‚é¢ï¼Œ==ä¸€ä¸ª JVM å®žä¾‹è¢«è§†ä¸ºä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹==ï¼Œè¿™ä¸ªè¿›ç¨‹æ‹¥æœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´å’Œæ‰§è¡ŒçŽ¯å¢ƒã€‚==åœ¨å•ä¸ª JVM è¿›ç¨‹å†…ï¼Œå¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ª Java åº”ç”¨ç¨‹åºï¼Œå®ƒä»¬ä¹‹é—´ç›¸äº’ç‹¬ç«‹==ã€‚
>
> - JVM çš„çº¿ç¨‹æ¨¡åž‹åœ¨ Java è§„èŒƒä¸­å¹¶æ²¡æœ‰è¦æ±‚ç”¨å“ªç§æ–¹æ³•å®žçŽ°ï¼Œåœ¨ JDK 1.2 ä»¥å‰ï¼Œæ˜¯ä½¿ç”¨ä¸€ç§å« â€œç»¿è‰²çº¿ç¨‹â€ çš„ç”¨æˆ·çº¿ç¨‹å®žçŽ°çš„ã€‚ç»¿è‰²çº¿ç¨‹æ˜¯æŒ‡ç”±è™šæ‹Ÿæœºè°ƒåº¦ï¼Œè€Œä¸æ˜¯æœ¬åœ°çš„æ“ä½œç³»ç»Ÿè°ƒåº¦çš„çº¿ç¨‹ï¼Œå®ƒå¯ä»¥åœ¨æœ¬æ¥ä¸æ”¯æŒå¤šçº¿ç¨‹çš„æ“ä½œç³»ç»Ÿä¸Šå®žçŽ°å¤šçº¿ç¨‹ã€‚==åœ¨ JDK 1.2 ä»¥åŽï¼Œé‡‡ç”¨çš„æ˜¯å†…æ ¸çº¿ç¨‹æ¥å®žçŽ° Java çº¿ç¨‹==ã€‚==å†…æ ¸çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿå†…æ ¸ç›´æŽ¥æ”¯æŒçš„çº¿ç¨‹ï¼Œå®ƒç”±å†…æ ¸çš„çº¿ç¨‹è°ƒåº¦å™¨å¯¹å†…æ ¸çº¿ç¨‹è¿›è¡ŒæŽ§åˆ¶å’Œåˆ†é…==ï¼Œ==ç¨‹åºä¸€èˆ¬ä¸ç›´æŽ¥ä½¿ç”¨å†…æ ¸çº¿ç¨‹ï¼Œè€Œæ˜¯ä½¿ç”¨å®ƒçš„é«˜çº§æŽ¥å£ï¼šè½»é‡çº§çº¿ç¨‹ã€‚æ¯ä¸ªè½»é‡çº§çº¿ç¨‹éƒ½ç”±ä¸€ä¸ªå†…æ ¸çº¿ç¨‹ä¸Žå…¶å¯¹åº”==ï¼Œæ‰€ä»¥ä¹Ÿå«åš 1:1 çš„çº¿ç¨‹æ¨¡åž‹ã€‚
>
> 	> <img src="bgwROUND1.assets/image-20240502134925934.png" alt="image-20240502134925934" style="zoom:50%;" />
>

---

==é—®é¢˜ä¸‰==ï¼š==å †å’Œæ ˆæœ‰å•¥åŒºåˆ«ï¼Ÿä»‹ç»ä¸€ä¸‹==

==æˆ‘çš„å›žç­”==ï¼š

> 1. åœ¨==å­˜å‚¨çš„å†…å®¹==ä¸Šï¼Œå †ä¸»è¦å­˜å‚¨ç¨‹åºè¿è¡Œæ—¶åˆ›å»ºçš„å¯¹è±¡ã€‚è€Œ ==java è™šæ‹Ÿæœºæ ˆåˆ™å­˜å‚¨å½“å‰çº¿ç¨‹ä¸‹æ–¹æ³•è°ƒç”¨æ‰€äº§ç”Ÿçš„æ ˆå¸§ï¼Œæ ˆå¸§ä¸­åŒ…å«å±€éƒ¨å˜é‡è¡¨ï¼Œæ“ä½œæ ‘ä»¥åŠè¿”å›žä¿¡æ¯==ç­‰ã€‚
> 2. åœ¨==ç”Ÿå‘½å‘¨æœŸ==ä¸Šï¼Œ==å †åŒºçš„å¯¹è±¡åœ¨å¤±åŽ» GC Roots çš„å¼•ç”¨åŽä¸ä¼šåˆ«ç«‹å³æ¸…é™¤==ï¼Œè€Œæ˜¯åœ¨è§¦å‘åžƒåœ¾å›žæ”¶æ—¶æ‰ä¼šä¸€å¹¶è¢«æ¸…ç†ã€‚è€Œ ==java è™šæ‹Ÿæœºæ ˆçš„æ ˆå¸§ä¸€æ—¦æ–¹æ³•è°ƒç”¨ç»“æŸå°±ä¼šå‡ºæ ˆï¼Œå¹¶æ¸…é™¤å…¶å‚æ•°å’Œå±€éƒ¨å˜é‡çš„å¼•ç”¨==ã€‚
> 3. åœ¨==å†…å­˜åˆ†é…==ä¸Šï¼Œå †åŒºçš„å¯¹è±¡ä¸»è¦é€šè¿‡ ==new å…³é”®å­—åŠ¨æ€åˆ†é…å†…å­˜ç©ºé—´==ã€‚è€Œ java è™šæ‹Ÿæœºæ ˆä¸­çš„==æ ˆå¸§åˆ™æ˜¯åœ¨æ–¹æ³•è°ƒç”¨æ—¶åˆ›å»ºæ ˆå¸§ï¼ŒåŽ‹å…¥è™šæ‹Ÿæœºæ ˆä¸­==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ä¸»è¦æœ‰==å­˜å‚¨å†…å®¹ï¼Œå†…å­˜åˆ†é…å’Œç”Ÿå‘½å‘¨æœŸ==ä¸‰ä¸ªæ–¹é¢çš„ä¸åŒã€‚
> - å­˜å‚¨å†…å®¹æ–¹é¢ï¼Œ==Java å †ä¸»è¦ç”¨äºŽå­˜å‚¨å¯¹è±¡å®žä¾‹å’Œæ•°ç»„==ç­‰åŠ¨æ€åˆ†é…çš„å†…å®¹ã€‚åŒæ—¶å †ä¸­åˆ†é…çš„å†…å­˜==ç”±åžƒåœ¾å›žæ”¶å™¨è‡ªåŠ¨å›žæ”¶==ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ï¼›==è™šæ‹Ÿæœºä¸»è¦ç”¨äºŽå­˜å‚¨æ–¹æ³•è°ƒç”¨æ—¶çš„æ–¹æ³•ä¿¡æ¯ï¼Œæ–¹æ³•è°ƒç”¨ä¸Šä¸‹æ–‡ç­‰ç­‰ã€‚è¿™å—å†…å­˜çš„ç®¡ç†æ˜¯è‡ªåŠ¨è¿›è¡Œçš„ï¼Œå½“æ–¹æ³•è°ƒç”¨ç»“æŸæ—¶ï¼Œè™šæ‹Ÿæœºæ ˆä¸Šæœ‰å…³æ–¹æ³•çš„å†…å­˜ä¼šè¢«è‡ªåŠ¨æ¸…é™¤==ã€‚
> - å†…å­˜åˆ†é…æ–¹é¢ï¼ŒJava å †ä¸»è¦ç”± JVM åŠ¨æ€åˆ†é…å’Œç®¡ç†ï¼Œ==å¯¹è±¡å®žä¾‹ä¸€èˆ¬é€šè¿‡ new å…³é”®å­—==æ¥åœ¨å †ä¸­åˆ†é…å†…å­˜ã€‚==è™šæ‹Ÿæœºæ ˆåˆ™æ˜¯åœ¨æ–¹æ³•è°ƒç”¨æ—¶åŠ¨æ€åˆ›å»ºæ ˆå¸§ï¼ŒåŽ‹å…¥æ ˆä¸­==ã€‚
> - ç”Ÿå‘½å‘¨æœŸæ–¹é¢ï¼Œå¯¹è±¡åœ¨ Java å †ä¸Šåˆ†é…å†…å­˜åŽï¼Œå…¶ç”Ÿå‘½å‘¨æœŸå¯ä»¥è´¯ç©¿æ•´ä¸ª Java ç¨‹åºçš„è¿è¡Œï¼Œè€Œ==è™šæ‹Ÿæœºæ ˆä¸­çš„æ ˆå¸§åˆ™å–å†³äºŽæ–¹æ³•ä½•æ—¶è°ƒç”¨å’Œè¿”å›ž==ã€‚
>

---

==é—®é¢˜å››==ï¼š==ä»€ä¹ˆæ—¶å€™ä¼šå‡ºçŽ°å †æ ˆæº¢å‡ºå‘¢ï¼Ÿå¦‚ä½•æŽ’æŸ¥ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==æ‰€è°“å †æ ˆæº¢å‡ºæŒ‡çš„æ˜¯ OOM å†…å­˜ç©ºé—´ä¸è¶³==ã€‚å‘ç”Ÿæ—¶æœºæ˜¯æ–°ç”Ÿä»£å°†å¯¹è±¡è½¬ç§»åˆ°è€å¹´ä»£æ—¶ï¼Œè€å¹´ä»£å³ä½¿é€šè¿‡ Serial è¿›è¡Œå…¨ç›˜æ¸…ç†ä¹‹åŽä¾ç„¶æ”¾ä¸ä¸‹è¿™ä¸€éƒ¨åˆ†å¯¹è±¡æ—¶ï¼Œåˆ™ä¼šè§¦å‘ OOM é”™è¯¯ã€‚
> 2. ==å¯¼è‡´å †æ ˆæº¢å‡ºçš„åŽŸå› ä¸»è¦æ˜¯çŸ­æ—¶é—´åˆ›å»ºå¤§é‡å¯¹è±¡å®žä¾‹å¯¼è‡´å †ç©ºé—´ä¸è¶³==ã€‚å¦‚æžœæ˜¯==ç¨‹åºä¸Šæ­»å¾ªçŽ¯åˆ›å»ºå¤§é‡å¯¹è±¡==ï¼Œåˆ™å¯ä»¥==æ ¹æ®æŽ§åˆ¶å°çš„å †æ ˆä¿¡æ¯å®šä½åˆ°ç›¸åº”ç¨‹åºä½ç½®==ã€‚å¦‚æžœæ˜¯ ==JVM å‚æ•°ä¸åˆç†==å¯¼è‡´å¯¹è±¡ä¸èƒ½è¢«æœ‰æ•ˆå›žæ”¶ï¼Œåˆ™å¯ä»¥==æ‰©å¤§è€å¹´ä»£å’Œ Survivor åŒºå¤§å°ï¼Œé‡‡ç”¨å†…å­˜æ›´å¤§çš„æœºå™¨ï¼Œæˆ–é›†ç¾¤éƒ¨ç½²å¤šå°æœºå™¨è´Ÿè½½å‡è¡¡==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ==å †æº¢å‡ºä¹Ÿå°±æ˜¯å†…å­˜æº¢å‡º OOM==ï¼Œä¸€èˆ¬æ˜¯ç”±äºŽ==åˆ›å»ºçš„å¯¹è±¡å¤ªå¤šï¼Œå¯¼è‡´è¶…è¿‡äº†å †çš„æœ€å¤§å®¹é‡==ã€‚æŽ’æŸ¥æ—¶å¯ä»¥é€šè¿‡==æ€§èƒ½æ£€æµ‹å·¥å…·å¦‚ jconsoleï¼ŒèŽ·å–å †å†…å­˜å¿«ç…§ï¼Œç„¶åŽè§‚å¯Ÿæº¢å‡ºçš„å¯¹è±¡æ˜¯å¦æ˜¯å¿…è¦çš„==ï¼Œ==æ˜¯çš„è¯å°±éœ€è¦æ£€æŸ¥ä»£ç ä¸­å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸæ˜¯å¦è¿‡é•¿ï¼Œæˆ–è€…ä¼˜åŒ–ç®—æ³•==ï¼Œå®žåœ¨ä¸è¡Œå¯ä»¥==è°ƒæ•´ JVM çš„å †å‚æ•°==è®¾ç½® -Xmx å’Œ -Xmsï¼Œå¢žåŠ  JVM æœ€å¤§å†…å­˜å’Œå¯åŠ¨åˆå§‹å†…å­˜ï¼›å¦‚æžœæº¢å‡ºçš„==å¯¹è±¡ä¸æ˜¯å¿…è¦çš„ï¼Œå°±è¡¨æ˜Žå‘ç”Ÿäº†å†…å­˜æ³„æ¼ï¼Œè¿™æ—¶å¯ä»¥æŸ¥çœ‹æ³„æ¼å¯¹è±¡çš„ GC Roots å¼•ç”¨é“¾ï¼Œæ‰¾åˆ°å…·ä½“æ³„æ¼çš„ä½ç½®==ã€‚
> - å¦‚æžœæ˜¯==è™šæ‹Ÿæœºæ ˆæº¢å‡ºï¼Œå¾ˆå¯èƒ½å°±æ˜¯å­˜åœ¨æ­»å¾ªçŽ¯ï¼Œè¿‡å¤šçš„é€’å½’è°ƒç”¨å¯¼è‡´æŠŠæ ˆæ’‘æ»¡äº†==ï¼Œæ­¤æ—¶å¯ä»¥ç›´æŽ¥==çœ‹æŽ§åˆ¶å°çš„å †æ ˆä¿¡æ¯ï¼Œæ¯”è¾ƒå®¹æ˜“å®šä½==ã€‚
>

---

==é—®é¢˜äº”==ï¼š==å¯¹è±¡ä¸€å®šæ˜¯åœ¨å †åœ¨åˆ†é…çš„å—ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ä¸ä¸€å®šã€‚==JVM åœ¨è¿›è¡Œç¼–è¯‘æœŸä¼˜åŒ–æ—¶å¯èƒ½å¯¹ java è™šæ‹Ÿæœºæ ˆå¸§ä¸Šçš„å±€éƒ¨å˜é‡å¼•ç”¨è¿›è¡Œé€ƒé€¸åˆ†æž==ã€‚å¦‚æžœè¯¥==å¯¹è±¡ä¸ä¼šè¢«å…¶å®ƒæ–¹æ³•æˆ–å…¶å®ƒçº¿ç¨‹è°ƒç”¨çš„è¯ï¼Œåˆ™ä¼šç›´æŽ¥åœ¨æ ˆä¸Šåˆ†é…==ï¼Œå³å°†æ­¤å¯¹è±¡å®žä¾‹åˆ›å»ºåœ¨æ ˆåŒºè€Œä¸æ˜¯å †åŒºï¼Œè¿™æ ·åœ¨==æ–¹æ³•è°ƒç”¨ç»“æŸæ—¶ï¼Œæ­¤å¯¹è±¡ä¼šéšç€æ ˆå¸§å‡ºæ ˆè€Œè¢«è‡ªåŠ¨é”€æ¯==ï¼Œå‡è½»äº†åžƒåœ¾å›žæ”¶çº¿ç¨‹çš„åŽ‹åŠ›ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ä¸ä¸€å®šï¼Œ==JVM ä¼šé€šè¿‡ â€œé€ƒé€¸åˆ†æžâ€ æŠ€æœ¯ï¼Œå¯¹äºŽé€ƒä¸å‡ºæ–¹æ³•çš„å¯¹è±¡ï¼Œä¼šç›´æŽ¥åœ¨æ ˆç©ºé—´ä¸Šåˆ†é…å†…å­˜==ã€‚è¿™æ ·å¯ä»¥ç›´æŽ¥åœ¨æ ˆä¸Šå¿«é€Ÿåˆ›å»ºå’Œé”€æ¯å¯¹è±¡ï¼Œä¸ç”¨å†å°†å¯¹è±¡åˆ†é…åˆ°å †ä¸­ï¼Œå‡è½» JVM åžƒåœ¾å›žæ”¶çš„åŽ‹åŠ›ã€‚
> - é€ƒé€¸åˆ†æžæŠ€æœ¯å°±æ˜¯ç”¨æ¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦é€ƒé€¸çš„æŠ€æœ¯ã€‚==å¯¹è±¡é€ƒé€¸åˆ†ä¸ºæ–¹æ³•é€ƒé€¸å’Œçº¿ç¨‹é€ƒé€¸==ã€‚æ–¹æ³•é€ƒé€¸å°±æ˜¯æŒ‡ï¼Œå½“ä¸€ä¸ªå¯¹è±¡åœ¨æ–¹æ³•ä¸­è¢«å®šä¹‰åŽï¼Œå®ƒè¢«å¤–éƒ¨æ–¹æ³•å¼•ç”¨äº†ï¼Œä¾‹å¦‚ä½œä¸ºè°ƒç”¨å‚æ•°ä¼ é€’åˆ°å…¶ä»–æ–¹æ³•ä¸­ã€‚çº¿ç¨‹é€ƒé€¸æ˜¯æŒ‡ä¸€ä¸ªå¯¹è±¡è¢«å¤–éƒ¨çº¿ç¨‹è®¿é—®åˆ°äº†ï¼Œæ¯”å¦‚èµ‹å€¼ç»™å¯ä»¥åœ¨å…¶ä»–çº¿ç¨‹ä¸­è®¿é—®çš„å®žä¾‹å˜é‡ã€‚
>

---

==é—®é¢˜å…­==ï¼š==å¸¸é‡æ± äº†è§£å—ï¼Œæœ‰å•¥ç”¨ï¼Ÿä»‹ç»ä¸€ä¸‹==

==æˆ‘çš„å›žç­”==ï¼š

> 1. åœ¨ jdk8 åŠä»¥åŽçš„ç‰ˆæœ¬ä¸­ï¼Œ==å¸¸é‡æ± ä¸ºæ–¹æ³•åŒºä¸­çš„ä¸€éƒ¨åˆ†==ã€‚å…¶ä¸»è¦å­˜å‚¨åŸºæœ¬æ•°æ®ç±»åž‹å¸¸é‡ï¼Œä»¥åŠ String ç±»åž‹å¸¸é‡ã€‚==å…¶ä¸­ String ç±»åž‹å¸¸é‡è¿˜åŒ…æ‹¬ç±»åã€å¯¹è±¡åã€æ–¹æ³•åã€å­—æ®µåå’Œå®ƒä»¬çš„ä¿®é¥°ç¬¦åï¼ˆç¬¦å·å¼•ç”¨==ï¼‰ã€‚
> 2. String ç±»åž‹å¸¸é‡åœ¨å¸¸é‡æ± ä¸­çš„å¸¸é‡ç±»åž‹ä¸º ==CONSTANT_utf8_infoï¼Œè§„å®šå…¶åœ¨å­—èŠ‚ç ä¸­é•¿åº¦ç”¨ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤º==ï¼Œå› æ­¤ç†è®ºä¸Š String ç±»åž‹åœ¨ç¼–è¯‘æœŸé•¿åº¦ä¸èƒ½è¶…è¿‡ $2^{16}-2$ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - Java 8 ä»¥å‰å¸¸é‡æ± å­˜åœ¨äºŽ JVM æ–¹æ³•åŒºçš„æ°¸ä¹…ä»£ä¸­ï¼Œ==Java 8 åŠä»¥åŽå­˜åœ¨äºŽå…ƒç©ºé—´ä¸­==ï¼Œå®ƒä¸»è¦ç”¨æ¥å­˜å‚¨ç¼–è¯‘æœŸç”Ÿæˆçš„å„ç§å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ç­‰ç­‰ã€‚è€Œ==è¿™äº›å­—é¢é‡å¯ä»¥åœ¨ç¨‹åºè¿è¡Œæ—¶ç›´æŽ¥ä½¿ç”¨ï¼Œä¸éœ€è¦å†åˆ›å»º==ï¼Œæé«˜è¿è¡Œæ•ˆçŽ‡ã€‚å¯¹äºŽ==ç¬¦å·å¼•ç”¨ï¼Œå…¶ä¸­åŒ…æ‹¬ç±»çš„å…¨é™å®šåï¼Œæ–¹æ³•åç­‰ç­‰==ï¼Œä¸»è¦ç”¨==åœ¨ç±»åŠ è½½ï¼ŒåŠ¨æ€ç»‘å®šç­‰é˜¶æ®µï¼Œæ¥å®šä½å…·ä½“çš„ç±»ï¼Œæ–¹æ³•==ç­‰ç­‰ã€‚
>

---



### 5.ã€JVMä¸“é¢˜ã€‘ç±»åŠ è½½ç›¸å…³ðŸŒŸðŸŒŸðŸŒŸ

==é—®é¢˜ä¸€==ï¼š==JAVAç±»åŠ è½½è¿‡ç¨‹ä»‹ç»ä¸€ä¸‹ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. Java ç±»åŠ è½½åˆ†ä¸º5ä¸ªé˜¶æ®µï¼šåŠ è½½ï¼ŒéªŒè¯ï¼Œå‡†å¤‡ï¼Œè§£æžï¼Œåˆå§‹åŒ–ã€‚
> 2. åŠ è½½é˜¶æ®µ==èŽ·å–å­—èŠ‚ç ä¸Žæ­¤ç±»å¯¹åº”çš„äºŒè¿›åˆ¶å­—èŠ‚æµ==ï¼Œå¹¶åœ¨æ–¹æ³•åŒºç”Ÿæˆä¸€ä¸ª Class å¯¹è±¡ï¼Œä½œä¸ºè®¿é—®è¯¥ç±»ç›¸å…³ä¿¡æ¯çš„å…¥å£ã€‚
> 3. éªŒè¯é˜¶æ®µ==æ£€éªŒèŽ·å–çš„å­—èŠ‚æµæ˜¯å¦ç¬¦åˆ JVM è§„èŒƒï¼Œé˜²æ­¢å…¶å¯¹ç¨‹åºé€ æˆå±å®³==ã€‚
> 4. å‡†å¤‡é˜¶æ®µ==ä¸ºç±»çš„é™æ€æˆå‘˜å˜é‡åœ¨æ–¹æ³•åŒºåˆ†é…å†…å­˜ç©ºé—´ï¼Œå¹¶å¯¹å…¶è¿›è¡Œé»˜è®¤åˆå§‹åŒ–==ã€‚
> 5. è§£æžé˜¶æ®µ==å°†ç¬¦å·å¼•ç”¨è½¬åŒ–ä¸ºç›´æŽ¥å¼•ç”¨==ã€‚
> 6. åˆå§‹åŒ–é˜¶æ®µ==æ‰§è¡Œç±»æž„é€ å™¨ \<clinit>== å¯¹ç±»è¿›è¡Œåˆå§‹åŒ–ï¼Œ==ç±»æž„é€ å™¨ç”±ç±»å˜é‡çš„æ˜¾å¼åˆå§‹åŒ–å’Œé™æ€ä»£ç å—æ‹¼æŽ¥è€Œæˆ==ã€‚å› æ­¤==é™æ€ä»£ç å—åªèƒ½è®¿é—®å®šä¹‰åœ¨å®ƒä¹‹å‰çš„ç±»å˜é‡==ã€‚==çˆ¶ç±»çš„ç±»æž„é€ å™¨æ€»æ˜¯åœ¨å­ç±»çš„ç±»æž„é€ å™¨ä¹‹å‰è°ƒç”¨==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

- > Java ç±»åŠ è½½åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼Œç¬¬ä¸€ä¸ªé˜¶æ®µæ˜¯ â€œåŠ è½½â€ï¼Œæ˜¯ç±»åŠ è½½è¿‡ç¨‹çš„èµ·å§‹ç‚¹ï¼Œåœ¨è¿™ä¸ªé˜¶æ®µï¼Œ==è™šæ‹Ÿæœºé€šè¿‡ç±»çš„å…¨é™å®šåæ‰¾åˆ°å¯¹åº”çš„äºŒè¿›åˆ¶å­—èŠ‚ç ==ã€‚è¿™ä¸ªè¿‡ç¨‹==ä¸»è¦æ˜¯ç”±ç±»åŠ è½½å™¨æ¥å®Œæˆ==çš„ï¼›ç¬¬äºŒä¸ªé˜¶æ®µæ˜¯ â€œè¿žæŽ¥â€œï¼Œå®ƒåˆåŒ…æ‹¬ä¸‰ä¸ªå­é˜¶æ®µï¼š==éªŒè¯ï¼Œå‡†å¤‡å’Œè§£æž==ã€‚éªŒè¯é˜¶æ®µï¼Œè™šæ‹Ÿæœºä¸»è¦ä¼šéªŒè¯åŠ è½½çš„å­—èŠ‚ç ==æ˜¯å¦ç¬¦åˆ JVM è§„èŒƒï¼ŒåŒ…æ‹¬ç±»çš„ç»“æž„ï¼Œè¯­ä¹‰ç­‰æ–¹é¢==ã€‚å‡†å¤‡é˜¶æ®µï¼Œè™šæ‹Ÿæœºä¼š==ä¸ºç±»çš„é™æ€å­—æ®µåˆ†é…å†…å­˜å¹¶è®¾ç½®é»˜è®¤å€¼==ã€‚è§£æžé˜¶æ®µï¼Œè™šæ‹Ÿæœºä¼š==å°†ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æŽ¥å¼•ç”¨ï¼Œè¿™æ ·è™šæ‹Ÿæœºå¯ä»¥ç›´æŽ¥å®šä½åˆ°ç›®æ ‡ç±»ï¼Œæ–¹æ³•==ç­‰ç­‰ï¼›ç¬¬ä¸‰ä¸ªé˜¶æ®µæ˜¯ â€åˆå§‹åŒ–â€œï¼Œè¿™ä¸ªé˜¶æ®µè™šæ‹Ÿæœºä¸»è¦ä¼š==æ‰§è¡Œç±»çš„åˆå§‹åŒ–ä»£ç ==ï¼Œä¹‹åŽå°±å®Œæˆäº†ç±»åŠ è½½è¿‡ç¨‹ã€‚

---

==é—®é¢˜äºŒ==ï¼š==åŒäº²å§”æ´¾åŽŸåˆ™äº†è§£å—ï¼Ÿä»‹ç»ä¸€ä¸‹==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ç±»åŠ è½½å™¨æ˜¯åˆ†å±‚çº§çš„ï¼Œè‡ªé¡¶å‘ä¸‹ä¾æ¬¡æ˜¯==å¯åŠ¨ç±»åŠ è½½å™¨ï¼Œç”¨äºŽåŠ è½½ java lib ç›®å½•ä¸‹çš„æ‰€æœ‰ç±»==ï¼›==æ‰©å±•ç±»åŠ è½½å™¨ï¼Œç”¨äºŽåŠ è½½ lib/txt ä¸‹çš„ç±»==ï¼›==åº”ç”¨ç¨‹åºåŠ è½½å™¨ï¼Œç”¨äºŽåŠ è½½æˆ‘ä»¬å†™çš„ java ä»£ç ä¸­çš„ç±»==ã€‚è€Œåœ¨==åº”ç”¨ç¨‹åºåŠ è½½å™¨ä¹‹ä¸‹ï¼Œè¿˜æœ‰è‡ªå®šä¹‰ç±»åŠ è½½å™¨==ã€‚
> 2. åŒäº²å§”æ´¾æœºåˆ¶åˆ™ä¸ºä¸‹å±‚çš„ç±»åŠ è½½å™¨éœ€è¦åŠ è½½æŸä¸ªç±»æ—¶ï¼Œ==å…ˆå°†è¯¥åŠ è½½è¯·æ±‚å‘ç»™å…¶çˆ¶ç±»åŠ è½½å™¨ï¼Œä»¥æ­¤ç±»æŽ¨ï¼Œç›´åˆ°é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨==ã€‚å¦‚æžœçˆ¶ç±»åŠ è½½å™¨å¯ä»¥åŠ è½½ï¼Œåˆ™ç”±çˆ¶ç±»è¿›è¡ŒåŠ è½½ï¼Œ==å¦åˆ™çˆ¶ç±»å‘ŠçŸ¥å­ç±»è‡ªå·±åŠ è½½ä¸äº†ï¼Œè¿™æ—¶æ‰ç”±å­ç±»è¿›è¡ŒåŠ è½½==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - åŒäº²å§”æ´¾æ¨¡åž‹æ˜¯ä¸€ç§å±‚æ¬¡åŒ–çš„ç±»åŠ è½½ç»“æž„ï¼Œä»Žä¸Šå¾€ä¸‹ä¾æ¬¡ç”± BootStrapClassLoaderï¼ŒExtClassLoaderï¼ŒAppClassLoader å’Œ è‡ªå®šä¹‰çš„ ClassLoader æž„æˆã€‚å…¶ä¸­ ==BootStrapClassLoaderï¼Œç”± C++ ç¼–å†™ï¼Œç”¨æ¥åŠ è½½æ ¸å¿ƒåº“ Java==.ï¼›==ExtClassLoader ç”¨æ¥åŠ è½½æ‰©å±•åº“ javax==.ï¼›==AppClassLoader ç”¨æ¥åŠ è½½ç”¨æˆ·ç±»è·¯å¾„ä¸Šçš„æ‰€æœ‰åº“==ï¼›æœ€åŽ==è‡ªå®šä¹‰çš„ ClassLoader ç”¨æ¥å®žçŽ°å®šåˆ¶åŒ–åŠ è½½==ã€‚
> - å®ƒçš„å·¥ä½œåŽŸç†ä¸ºï¼š==å½“ä¸€ä¸ªç±»åŠ è½½å™¨æŽ¥æ”¶åˆ°ç±»åŠ è½½çš„è¯·æ±‚æ—¶ï¼Œå®ƒé¦–å…ˆå°†è¿™ä¸ªè¯·æ±‚å§”æ‰˜ç»™å®ƒçš„çˆ¶åŠ è½½å™¨è¿›è¡Œå¤„ç†ï¼Œç›´åˆ°é¡¶å±‚çš„ BootStrapClassLoader è¢«å§”æ‰˜ä¸ºæ­¢==ã€‚å¦‚æžœçˆ¶åŠ è½½å™¨å¯ä»¥æ‰¾åˆ°å¹¶åŠ è½½è¿™ä¸ªç±»ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»åŠ è½½çš„è¯·æ±‚å°±ç»“æŸäº†ï¼Œ==å¦åˆ™ï¼Œå­åŠ è½½å™¨æ‰ä¼šå°è¯•åŠ è½½è¯¥ç±»ï¼Œä»¥æ­¤ç±»æŽ¨==ã€‚
>

---

==é—®é¢˜ä¸‰==ï¼š==ä¸ºä»€ä¹ˆéœ€è¦åŒäº²å§”æ´¾ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. åŒäº²å§”æ´¾æœºåˆ¶å¯ä»¥==ä¿è¯æ¯ä¸€ä¸ªç±»åªä¼šåŠ è½½ä¸€æ¬¡==ã€‚å¦‚æžœæ²¡æœ‰åŒäº²å§”æ´¾æœºåˆ¶çš„è¯ï¼Œ==å‡è®¾åŒä¸€ä¸ªç±»å¯ä»¥è¢«ä¸¤ä¸ªç±»åŠ è½½å™¨åŠ è½½ï¼Œè€Œè¿™ä¸¤ä¸ªç±»åŠ è½½å™¨ä¹‹é—´æ²¡æœ‰æ²Ÿé€šï¼Œå› æ­¤å¯èƒ½ä¼šæŠŠè¿™ä¸ªç±»åŠ è½½ä¸¤æ¬¡==ã€‚è€Œ==å¦‚æžœè¿™ä¸ªç±»æ˜¯ java çš„æ ¸å¿ƒç±»ï¼Œå…¶ä¸­ç”¨æˆ·è‡ªå·±å®žçŽ°äº†ä¸€ä¸ªå’Œæ ¸å¿ƒç±»åŒåçš„ç±»ï¼Œå¯èƒ½å¯¼è‡´åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ç”¨æˆ‘ä»¬è‡ªå·±å†™çš„ç±»æŠŠå¯åŠ¨ç±»åŠ è½½å™¨ä¸­çš„åŠ è½½åˆ°çš„æ ¸å¿ƒç±»è¦†ç›–ï¼Œè‡´ä½¿æ•´ä¸ªç³»ç»Ÿæ— æ³•æ­£å¸¸è¿è¡Œ==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - è¿™ç§å§”æ´¾æœºåˆ¶å¯ä»¥==ç¡®ä¿ Java ç±»çš„å”¯ä¸€æ€§==ï¼Œ==é¿å…ç±»çš„é‡å¤åŠ è½½==ã€‚åŒæ—¶è¿˜==ä¿è¯äº† Java æ ¸å¿ƒåº“çš„å®‰å…¨æ€§å’Œç¨³å®šæ€§==ã€‚==å› ä¸ºJavaæ ¸å¿ƒåº“éƒ½æ˜¯ç”± BootStrapClassLoader åŠ è½½çš„ï¼Œä»»ä½•ç”¨æˆ·è‡ªå®šä¹‰çš„ç±»éƒ½æ— æ³•è¦†ç›–æ ¸å¿ƒç±»åº“ä¸­çš„ç±»==ã€‚
>

---

==é—®é¢˜å››==ï¼š==æ€Žä¹ˆæ‰“ç ´åŒäº²å§”æ´¾æ¨¡åž‹ï¼Ÿäº†è§£è¿‡å—ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. å¯ä»¥å®šä¹‰ä¸€ä¸ªç±»ç»§æ‰¿ java.lang.ClassLoader ç±»å¹¶é‡å†™å…¶ findClass æ–¹æ³•ã€‚è¿™æ ·å°±å½¢æˆäº†ä¸€ä¸ªè‡ªå®šä¹‰ç±»åŠ è½½å™¨ã€‚==åœ¨ loadClass æ–¹æ³•ä¸­ï¼Œå¦‚æžœè¯·æ±‚çˆ¶ç±»åŠ è½½å™¨åŠ è½½å¤±è´¥ï¼Œåˆ™ä¼šæˆ‘ä»¬è‡ªå·±çš„è°ƒç”¨ findClass æ–¹æ³•==ã€‚
>
> 	```java
> 	protected Class<?> loadClass(String name, boolean resolve)
> 	    throws ClassNotFoundException
> 	{
> 	    synchronized (getClassLoadingLock(name)) {
> 	        // First, check if the class has already been loaded
> 	        Class<?> c = findLoadedClass(name);
> 	        if (c == null) {
> 	            long t0 = System.nanoTime();
> 	            try {
> 	                if (parent != null) {
> 	                    c = parent.loadClass(name, false); // å…ˆå§”æ‰˜çˆ¶ç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½
> 	                } else {
> 	                    c = findBootstrapClassOrNull(name);
> 	                }
> 	            } catch (ClassNotFoundException e) {
> 	                // ClassNotFoundException thrown if class not found
> 	                // from the non-null parent class loader
> 	            }
> 		
> 	            if (c == null) {
> 	                // If still not found, then invoke findClass in order
> 	                // to find the class.
> 	                long t1 = System.nanoTime();
> 	                c = findClass(name); // è°ƒç”¨è‡ªå·±çš„ findClass æ–¹æ³•
> 		
> 	                // this is the defining class loader; record the stats
> 	                sun.misc.PerfCounter.getParentDelegationTime().addTime(t1 - t0);
> 	                sun.misc.PerfCounter.getFindClassTime().addElapsedTimeFrom(t1);
> 	                sun.misc.PerfCounter.getFindClasses().increment();
> 	            }
> 	        }
> 	        if (resolve) {
> 	            resolveClass(c);
> 	        }
> 	        return c;
> 	    }
> 	}
> 		
> 	protected Class<?> findClass(String name) throws ClassNotFoundException {
> 	    throw new ClassNotFoundException(name); // ä¸é‡å†™ä¼šç›´æŽ¥æŠ›å¼‚å¸¸ï¼Œå› æ­¤è‡ªå®šä¹‰æ—¶å¿…é¡»é‡å†™è¯¥æ–¹æ³•ï¼Œå¦åˆ™åœ¨çˆ¶ç±»åŠ è½½å™¨æ‰¾ä¸åˆ°è°ƒç”¨ findClass æ–¹æ³•æ—¶ä¸€å®šä¼šæŠ¥é”™
> 	}
> 	```

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - æ‰“ç ´åŒäº²å§”æ´¾æ¨¡åž‹çš„æ€è·¯å°±æ˜¯åœ¨åŠ è½½ç±»æ—¶ï¼Œä¸æŒ‰ç…§ä¾æ¬¡å¾€ä¸ŠåŒ¹é…ç±»åŠ è½½å™¨çš„æ–¹å¼åŠ è½½ã€‚é‚£ä¹ˆåªéœ€è¦==è‡ªå®šä¹‰ä¸€ä¸ª ClassLoaderï¼Œç„¶åŽé‡å†™ loadClass æ–¹æ³•ï¼Œè‡ªå·±å®šä¹‰ä¸€ä¸ªå…¶ä»–çš„åŠ è½½æ–¹å¼å°±è¡Œ==ã€‚
> - å®žé™…çš„åº”ç”¨ä¸­ï¼Œ==Tomcat å°±ç ´åäº†åŒäº²å§”æ´¾æ¨¡åž‹==ã€‚é€šå¸¸åœ¨ç”¨ Tomcat éƒ¨ç½² web åº”ç”¨æ—¶ï¼Œéœ€è¦å°† war åŒ…æ”¾åœ¨ webapp ç›®å½•ä¸‹ï¼Œç„¶åŽ Tomcat å°±èƒ½è¿è¡Œè¿™ä¸ª web åº”ç”¨äº†ã€‚çŽ°åœ¨==å‡è®¾æœ‰ä¸¤ä¸ª web åº”ç”¨ç±»ï¼Œå¹¶ä¸”å®ƒä»¬åˆšå¥½éƒ½æœ‰ä¸€ä¸ªå…¨é™å®šåéƒ½ç›¸åŒçš„ user ç±»ï¼Œä½†å…·ä½“çš„å®žçŽ°ä¸ä¸€æ ·ã€‚å¦‚æžœæŒ‰ç…§åŒäº²å§”æ´¾æ¨¡åž‹çš„æ€è·¯ï¼Œæœ€ç»ˆåªæœ‰ä¸€ä¸ª user èƒ½è¢«åŠ è½½ï¼Œä¹Ÿå°±åªæœ‰ä¸€ä¸ª web åº”ç”¨èƒ½éƒ¨ç½²æˆåŠŸ==ã€‚Tomcat ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®ƒ==ç»™æ¯ä¸ª Web åº”ç”¨éƒ½åˆ›å»ºäº†ä¸€ä¸ª WebAppClassLoaderï¼Œè¯¥ç±»åŠ è½½å™¨é‡å†™äº† loadClass æ–¹æ³•ï¼Œä¼˜å…ˆåŠ è½½å½“å‰åº”ç”¨ç›®å½•ä¸‹çš„ç±»==ï¼Œå¦‚æžœå½“å‰ç›®å½•æ‰¾ä¸åˆ°ï¼Œæ‰ä¼šä¸€å±‚ä¸€å±‚å¾€ä¸Šæ‰¾ã€‚è¿™æ ·çš„è¯ï¼Œ==Tomcat å°±åšåˆ°äº† Web åº”ç”¨å±‚çº§åˆ«çš„éš”ç¦»==ã€‚
> - è¿˜æœ‰æ¯”å¦‚ JDBC ä¹Ÿç®—æ˜¯ç ´åäº†åŒäº²å§”æ´¾æ¨¡åž‹ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨ JDBC æ—¶ï¼Œæ˜¯ç”¨ DriverManager.getConnection( ) æ¥èŽ·å–è¿žæŽ¥çš„ï¼Œä½†ç”±äºŽ DriverManager æœ¬èº«æ˜¯å±žäºŽ Java åŒ…ä¸‹çš„ï¼Œæ˜¯ç”± BootStrapClassLoader åŠ è½½çš„ï¼Œè€Œé€šè¿‡ getConnection å¾—åˆ°çš„æ˜¯å…¶å®ƒåŽ‚å•†çš„å®žçŽ°ç±»ï¼Œæ˜¾ç„¶æ˜¯ä¸èƒ½ç”± BootStrapClassLoader åŠ è½½ã€‚é‚£ä¹ˆåœ¨è¿™é‡Œå°±ç”¨åˆ°äº† â€œçº¿ç¨‹ä¸Šä¸‹æ–‡åŠ è½½å™¨â€ï¼ŒDriverManager åœ¨åˆå§‹åŒ–æ—¶å°±ä¼šåŽ»å¾—åˆ°çº¿ç¨‹ä¸Šä¸‹æ–‡åŠ è½½å™¨ï¼Œç„¶åŽç”±å®ƒä»£æ›¿ BootStrapClassLoader æ¥åŠ è½½å…·ä½“çš„ Connection ç±»ã€‚
>

---



## 4.å¤šçº¿ç¨‹å’Œ Java å¹¶å‘

### 1.ã€å¤šçº¿ç¨‹åŸºç¡€ä¸“é¢˜ã€‘å…³äºŽçº¿ç¨‹å®‰å…¨ + é”çš„ä¸€äº›æ¦‚å¿µæ€§é—®é¢˜ï¼ˆé‡è¦ï¼‰ðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==é—®é¢˜ä¸€==ï¼š==ä½ æ˜¯æ€Žä¹ˆç†è§£çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Ÿçº¿ç¨‹ä¸å®‰å…¨ä¼šå¸¦æ¥å“ªäº›é—®é¢˜ï¼Ÿ==ï¼ˆå›žç­”æŒ‡å¯¼ï¼šé‡‡ç”¨ç»å…¸çš„ i++ æ¥å›žç­”ä¸å®‰å…¨ï¼Œè‡³äºŽå¸¦æ¥ä»€ä¹ˆé—®é¢˜ï¼Œå¦‚æžœå¯ä»¥è·ç¦»å®žé™…é¡¹ç›®é‚£æœ€å¥½äº†ï¼‰

==æˆ‘çš„å›žç­”==ï¼š

> 1. çº¿ç¨‹å®‰å…¨é—®é¢˜æŒ‡çš„æ˜¯åœ¨==å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®å’Œæ“ä½œå…±äº«æ•°æ®==æ—¶é€ æˆæ•°æ®ç»“æžœå‡ºé”™å’Œå‰åŽä¸ä¸€è‡´çš„æƒ…å†µã€‚å°±æ‹¿åœ¨ç”µå•†ç³»ç»Ÿä¸­ç”¨æˆ·è´­ä¹°å•†å“å‡å°‘åº“å­˜æ¥ä¸¾ä¾‹ï¼Œè¿™ä¸ªè¿‡ç¨‹æ¶‰åŠçš„æ“ä½œæœ‰ï¼šæŸ¥è¯¢å½“å‰çš„åº“å­˜ï¼Œå°†è¯¥æ•°æ®å‡å°‘ï¼Œå°†å‡å°‘åŽçš„æ•°æ®å†™å›žåˆ°æ•°æ®åº“ä¸­ã€‚å‡è®¾æœ‰ä¸¤ä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œå‡åº“å­˜è¿™ä¸€æ“ä½œï¼Œå¯èƒ½å‰ä¸€ä¸ªçº¿ç¨‹è¿˜æ²¡æ¥å¾—åŠå†™å›žæ•°æ®åº“ï¼ŒåŽä¸€ä¸ªçº¿ç¨‹è¯»å–åº“å­˜æ—¶å‘çŽ°è¿˜æœ‰åº“å­˜ï¼Œä¹Ÿæ‰§è¡Œå‡åº“å­˜çš„æ“ä½œï¼Œå°±å¯èƒ½é€ æˆè¶…å–é—®é¢˜ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - çº¿ç¨‹ä¸å®‰å…¨å°±æ˜¯æŒ‡åœ¨å¤šçº¿ç¨‹çŽ¯å¢ƒä¸‹ï¼Œ==å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®å’Œä¿®æ”¹å…±äº«æ•°æ®==æ—¶ï¼Œå¯èƒ½ä¼šæ•°æ®å‡ºçŽ°é”™è¯¯æˆ–è€…ä¸ä¸€è‡´çš„æƒ…å†µã€‚æ¯”å¦‚å¤šä¸ªçº¿ç¨‹åŒæ—¶å¯¹ä¸€ä¸ª int i å˜é‡è¿›è¡Œ i++ æ—¶ï¼Œä¼šå‡ºçŽ°ä¸¢å¤±æ›´æ–°ã€‚å…·ä½“æ¥è¯´ï¼Œi++ å¯ä»¥åˆ†è§£ä¸ºä¸‰ä¸ªåŠ¨ä½œï¼šè¯»å–å½“å‰å€¼ã€å¯¹è¯¥å€¼åŠ 1ã€å°†è¯¥å€¼å†™å›žã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»åˆ°ç›¸åŒçš„å€¼å¹¶å¯¹å…¶åŠ  1ï¼Œå¯¼è‡´æœ€ç»ˆç»“æžœä¸€å…±åªå¢žåŠ  1ï¼Œè€Œä¸æ˜¯æ¯ä¸ªçº¿ç¨‹éƒ½åŠ  1ã€‚åŒæ—¶ç”±äºŽçº¿ç¨‹ä¹‹é—´çš„æ‰§è¡Œé¡ºåºæ˜¯ä¸ç¡®å®šçš„ï¼Œæ¯æ¬¡è¿è¡Œæ—¶éƒ½å¯èƒ½ä¼šå¾—åˆ°ä¸åŒçš„ç»“æžœï¼Œä½¿ç¨‹åºå…·æœ‰ä¸ç¡®å®šæ€§ã€‚
> - é¡¹ç›®ä¸­æœ‰ä¸€ä¸ªç”¨æˆ·å¯ä»¥å¯¹æŸä¸ªä¸“æ ç‚¹èµžçš„åŠŸèƒ½ï¼Œå¤šä¸ªç”¨æˆ·åŒæ—¶è¿›è¡Œç‚¹èµžçš„è¿‡ç¨‹å°±ç±»ä¼¼==ç‚¹èµžæ•°é‡++ çš„è¿‡ç¨‹ï¼Œå¯èƒ½ä¼šå‡ºçŽ° â€œç‚¹èµžè¢«åžâ€ çš„æƒ…å†µ==ã€‚è¿™æ—¶å¯ä»¥å¯¹ â€œç‚¹èµžâ€ çš„æ“ä½œåŠ é”ï¼Œä¹Ÿå¯ä»¥ç›´æŽ¥==ä½¿ç”¨ Java å¹¶å‘åŒ…æä¾›çš„åŽŸå­æ›´æ–°ç±» atomicInteger ç±»ï¼Œåº•å±‚ä½¿ç”¨ CAS å®Œæˆè‡ªå¢žæ“ä½œ==ï¼Œæ•ˆçŽ‡é«˜ã€‚
>

---

==é—®é¢˜äºŒ==ï¼š==å¤šçº¿ç¨‹çŽ¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æ€Žä¹ˆè§£å†³çº¿ç¨‹ä¸å®‰å…¨çš„é—®é¢˜ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. é¦–å…ˆæ¥è¯´ä¸€ä¸‹äº§ç”Ÿçº¿ç¨‹å®‰å…¨é—®é¢˜çš„å‡ ä¸ªåŽŸå› ï¼š
> 2. ==ç¼“å­˜å¸¦æ¥çš„ä¸å¯è§é—®é¢˜==ã€‚æ¯”å¦‚çº¿ç¨‹ A å’Œçº¿ç¨‹ B éƒ½ä»Žå…±äº«æ•°æ®ä¸­è¯»å–ï¼Œç„¶åŽæŠŠå…¶å‚¨å­˜åˆ°è‡ªå·±çš„ CPU ç¼“å­˜ä¸­ï¼Œç„¶åŽéƒ½å¯¹å…¶æ‰§è¡Œ++æ“ä½œï¼Œç”±äºŽä¸å¯è§å…¶å®ƒ CPU çš„ç¼“å­˜æ•°æ®ï¼Œæœ€åŽå†™å›žæ—¶æœ¬æ¥åº”è¯¥+2ï¼Œç»“æžœåªåŠ 1ã€‚==å¯ä»¥ä½¿ç”¨ volatile å…³é”®å­—ï¼Œä½¿å¾—è¢«ä¿®é¥°çš„å¯¹è±¡æ— æ³•åœ¨ CPU ç¼“å­˜ä¸­è¢«ä½¿ç”¨==ã€‚
> 3. ==çº¿ç¨‹åˆ‡æ¢å¸¦æ¥çš„åŽŸå­æ€§é—®é¢˜==ã€‚è¿˜æ˜¯ä¸Šé¢å“ªä¸ªä¾‹å­ï¼Œæœ¬æ¥æ•´ä¸ªè¯»å–ï¼Œå€¼+1ï¼Œå†™å›žæ“ä½œåº”è¯¥æ—¶å…·æœ‰åŽŸå­æ€§çš„ï¼Œä½†æ˜¯ç”±äºŽçº¿ç¨‹åˆ‡æ¢çš„ç¼˜æ•…ï¼Œå¯èƒ½åœ¨ä»»æ„ä¸€æ¡æŒ‡ä»¤ç»“æŸåŽåˆ‡æ¢åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œä»Žè€Œå¯¼è‡´å¦ä¸€ä¸ªçº¿ç¨‹è¯»åˆ°çš„ä¹Ÿæ˜¯æ—§æ•°æ®ï¼Œé€ æˆä¸€è‡´æ€§é—®é¢˜ã€‚==å¯ä»¥ä½¿ç”¨ synchronized ç»™æ•°æ®åŠ é”ï¼Œä»Žè€Œèµ‹äºˆå¢žå€¼æ“ä½œåŽŸå­æ€§==ã€‚
> 4. ==ç¼–è¯‘ä¼˜åŒ–å¸¦æ¥çš„æœ‰åºæ€§é—®é¢˜==ã€‚ç¼–è¯‘å™¨ä¸ºäº†ä¼˜åŒ–æ€§èƒ½ï¼Œå¯èƒ½ä¼šæ”¹å˜æŸäº›è¯­å¥çš„é¡ºåºã€‚æ¯”å¦‚åˆ›å»ºå¯¹è±¡çš„newæ“ä½œä¸­ï¼Œåº”è¯¥å…ˆåˆå§‹åŒ–å¯¹è±¡ï¼Œå†æŠŠåœ°å€èµ‹ç»™å®žä¾‹å¯¹è±¡ï¼›ä½†æ˜¯å¦‚æžœåè¿‡æ¥ï¼Œå°±å¯èƒ½å‡ºçŽ°å®žä¾‹å¯¹è±¡å·²ç»æœ‰åœ°å€ï¼Œä½†æ˜¯å¯¹è±¡æ²¡æœ‰åˆ›å»ºï¼Œä»Žè€Œå¯¼è‡´ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚å¯ä»¥==ä½¿ç”¨ final å…³é”®å­—ä¿®é¥°ï¼Œè¡¨ç¤ºæ­¤å˜é‡ä¸å˜ï¼Œå¯éšæ„ä¼˜åŒ–==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - æœ€å…ˆæƒ³åˆ°çš„æ˜¯å¯ä»¥ç”¨ ==synchronized å…³é”®å­—==ä¸ºæ–¹æ³•æˆ–è€…ä»£ç å—åŠ é”ï¼Œä¿è¯åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è®¿é—®å…±äº«èµ„æºã€‚è¿˜å¯ä½¿ç”¨==volatileï¼Œå®ƒæ˜¯è½»é‡çº§çš„ synchronizedï¼Œèƒ½å¤Ÿä¿è¯æ‰€ä¿®é¥°å˜é‡çš„å¯è§æ€§å’Œæœ‰åºæ€§==ã€‚
> - é™¤äº†è¿™ä¸¤ä¸ªå…³é”®å­—ï¼ŒJDK è¿˜æä¾›äº†ä¸€äº›çº¿ç¨‹å®‰å…¨çš„æ•°æ®ç»“æž„ï¼Œå¦‚ ==ConcurrentHashMapï¼ŒConcurrentLinkedQueue== ç­‰ç­‰ï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨ã€‚è¿˜æœ‰å¹¶å‘åŒ…ä¸‹çš„åŽŸå­æ“ä½œç±» ==atomicInteger ç±»ç­‰ï¼Œå¹¶å‘å·¥å…·ç±» CountDownLatchï¼ŒSemaphore ç±»==ç­‰ç­‰ï¼Œéƒ½å¯ä»¥è¾…åŠ©æˆ‘ä»¬å®žçŽ°çº¿ç¨‹å®‰å…¨ã€‚
>

---

==é—®é¢˜ä¸‰==ï¼š==åˆšæ‰è¯´åˆ°äº†é”ï¼Œé‚£ä½ è§‰å¾—é”æ€Žæ˜¯ä¹ˆå®žçŽ°çº¿ç¨‹å®‰å…¨ï¼Ÿï¼ˆå›žç­”æŒ‡å¯¼ï¼šè¿™ä¸ªå¾—ä»Žæ“ä½œç³»ç»Ÿè§’åº¦å›žç­”äº†ï¼‰==

==æˆ‘çš„å›žç­”==ï¼š

> 1. åœ¨çº¿ç¨‹å°è¯•è®¿é—®å¹¶æ“ä½œå…±äº«æ•°æ®å‰ï¼Œå¿…é¡»å…ˆå°è¯•èŽ·å–é”ï¼ŒèŽ·å–åˆ°é”ä¹‹åŽè¿›å…¥ä¸´ç•ŒåŒºï¼Œå¹¶åœ¨å®Œæˆæ“ä½œä¹‹åŽé‡Šæ”¾è¯¥å…±äº«æ•°æ®çš„é”ï¼Œé€€å‡ºä¸´ç•ŒåŒºã€‚
> 2. åœ¨ Java ä¸­ synchronized å…³é”®å­—å’Œä¸Šè¿°çš„é€»è¾‘å¾ˆç±»ä¼¼ã€‚==è¢« synchronized ä¿®é¥°çš„ä»£ç å—ä¼šåœ¨ç¼–è¯‘çš„ä»£ç å‰åŽåˆ†åˆ«æ·»åŠ  monitorenter å’Œ monitorexit æŒ‡ä»¤==ã€‚JVM ç¡®ä¿è¢« synchronized é”å®šçš„å¯¹è±¡éƒ½ä¼šå¯¹åº”ä¸€ä¸ª monitorï¼Œå½“çº¿ç¨‹æ‰§è¡Œåˆ° monitorenter æ—¶ä¼šå°è¯•èŽ·å–å½“å‰çš„ monitor å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯åŠ é”æ“ä½œã€‚åŒæ ·çš„ï¼Œæ‰§è¡Œåˆ° monitorexit æŒ‡ä»¤æ—¶ä¼šé‡Šæ”¾è¿™ä¸ª monitorï¼Œä¹Ÿå°±æ˜¯è§£é”æ“ä½œã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ä¸€ä¸ªç®€å•çš„é”æ¨¡åž‹æ˜¯ï¼Œ==åœ¨ä¸´ç•ŒåŒºä»£ç å‰åŽåˆ†åˆ«åŠ ä¸ŠåŠ é”å’Œè§£é”çš„æ“ä½œ==ã€‚çº¿ç¨‹åœ¨è¿›å…¥ä¸´ç•ŒåŒºä¹‹å‰ä¼šå…ˆå°è¯•åŠ é”ï¼Œå¦‚æžœæˆåŠŸåˆ™è¿›å…¥ä¸´ç•ŒåŒºï¼Œæ­¤æ—¶è¿™ä¸ªçº¿ç¨‹æŒæœ‰é”ã€‚å¦åˆ™å½“å‰çº¿ç¨‹ç­‰å¾…ï¼ŒæŒ‡å¯¼æŒæœ‰é”çš„çº¿ç¨‹æ‰§è¡Œå®Œä¸´ç•ŒåŒºçš„ä»£ç åŽè§£é”ã€‚
> - Java ä¸­çš„ synchronized å®žçŽ°å°±è·Ÿè¿™ä¸ªæ€è·¯ç±»ä¼¼ï¼Œå®ƒæ˜¯==åœ¨ç¼–è¯‘åŽçš„ä»£ç å‰åŽåˆ†åˆ«æ·»åŠ  monitorenter å’Œ monitorexit æŒ‡ä»¤==ï¼ŒJVM ç¡®ä¿æŸä¸ªå¯¹è±¡éƒ½ä¼šå¯¹åº”ä¸€ä¸ª monitorï¼Œå½“çº¿ç¨‹æ‰§è¡Œåˆ° monitorenter æ—¶ä¼šå°è¯•èŽ·å–å½“å‰çš„ monitor å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯åŠ é”æ“ä½œã€‚åŒæ ·çš„ï¼Œæ‰§è¡Œåˆ° monitorexit æŒ‡ä»¤æ—¶ä¼šé‡Šæ”¾è¿™ä¸ª monitorï¼Œä¹Ÿå°±æ˜¯è§£é”æ“ä½œã€‚
>

---

==é—®é¢˜å››==ï¼š==åˆšæ‰æˆ‘ä»¬è¯´åˆ°äº†é”ï¼Œä¹è§‚é”å’Œæ‚²è§‚é”äº†è§£å—ï¼Ÿå¯ä»¥è¯´ä¸€è¯´ä»–ä»¬çš„åŒºåˆ«å—ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==æ‚²è§‚é”è®¤ä¸ºåªè¦è¿›è¡Œå¹¶å‘æ“ä½œå°±ä¸€å®šä¼šäº§ç”Ÿå¹¶å‘é—®é¢˜==ï¼Œå› æ­¤ä¸¥æ ¼é™åˆ¶å¤šçº¿ç¨‹å¯¹äºŽå…±äº«æ•°æ®çš„è®¿é—®ã€‚åœ¨çº¿ç¨‹å°è¯•è®¿é—®æˆ–æ“ä½œå…±äº«æ•°æ®å‰éƒ½å¿…é¡»è¦èŽ·å–é”ï¼Œå¹¶åœ¨æ“ä½œç»“æŸåŽé‡Šæ”¾é”ã€‚è¿™å…¶å®žæ˜¯ä¸€ç§å°†å¹¶å‘æ“ä½œé™ä¸ºä¸²è¡Œæ“ä½œçš„æ–¹æ³•ï¼Œè™½ç„¶å®‰å…¨æ€§é«˜ï¼Œä½†æ˜¯æ€§èƒ½æŸè€—è¾ƒå¤§ã€‚synchronized å…³é”®å­—å°±æ˜¯ä¸€ç§æ‚²è§‚é”ã€‚
> 2. ==ä¹è§‚é”åˆ™è®¤ä¸ºè¿›è¡Œå¹¶å‘æ“ä½œä¹Ÿä¸ä¸€å®šä¼šäº§ç”Ÿå¹¶å‘é—®é¢˜==ï¼Œå› æ­¤æ— éœ€å¯¹å…±äº«æ•°æ®åŠ é”ï¼Œåªéœ€è¦åœ¨æäº¤æ•°æ®çš„æ›´æ–°å‰åˆ¤æ–­æ˜¯å¦æœ‰å…¶å®ƒçº¿ç¨‹çº¿ç¨‹æ­£åœ¨ä¿®æ”¹æ•°æ®ã€‚å¦‚æžœæ˜¯åˆ™å¯ä»¥å›žæ»šé‡è¯•ï¼Œå¹¶å¯ä»¥è®¾ç½®æœ€å¤§é‡è¯•æ¬¡æ•°é˜²æ­¢çº¿ç¨‹å¤§é‡æ¶ˆè€— CPU èµ„æºï¼Œå¦åˆ™å°±ç›´æŽ¥æäº¤ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ä¹è§‚é”åœ¨==è¯»å–æ•°æ®æ—¶å¹¶ä¸ä¼šå¯¹æ•°æ®è¿›è¡ŒåŠ é”==ï¼Œè€Œæ˜¯åœ¨==æäº¤æ›´æ–°æ—¶æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–çº¿ç¨‹å¯¹æ•°æ®è¿›è¡Œäº†ä¿®æ”¹==ã€‚å¦‚æžœæ²¡æœ‰å‘ç”Ÿå†²çªï¼Œé‚£ä¹ˆæ›´æ–°æˆåŠŸï¼Œå¦åˆ™å°±è¦é‡‡å–ä¸€äº›å†²çªè§£å†³ç­–ç•¥ï¼Œæ¯”å¦‚==å›žæ»šæˆ–æˆ–è€…é‡è¯•==ã€‚
> - æ‚²è§‚é”åˆ™æ˜¯ä¸€ç§æ¯”è¾ƒä¿å®ˆçš„ç­–ç•¥ï¼Œå®ƒåœ¨è®¿é—®æ•°æ®ä¹‹å‰ï¼Œä¼šå…ˆå¯¹èµ„æºè¿›è¡ŒåŠ é”ï¼Œ==ç¡®ä¿å…¶ä»–çº¿ç¨‹æ— æ³•åŒæ—¶è®¿é—®==ï¼Œå¿…é¡»ç­‰å¾…é”é‡Šæ”¾åŽæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚
>

---

==é—®é¢˜äº”==ï¼š==Java ä¸­æœ‰äº›æ˜¯åŸºäºŽä¹è§‚é”å®žçŽ°çš„ï¼Œæœ‰äº›æ˜¯åŸºäºŽæ‚²è§‚é”å®žçŽ°çš„ï¼Œä½ äº†è§£åˆ°çš„æœ‰å“ªäº›å‘¢ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. æ‚²è§‚é”æœ‰ ==synchronized== å…³é”®å­—ï¼Œå®ƒå¯ä»¥å¯¹æŸä¸€ä¸ªå¯¹è±¡ä¸Šé”ï¼Œçº¿ç¨‹åœ¨è®¿é—®å…¶ä¿®é¥°çš„ä»£ç å—ä¹‹å‰å¿…é¡»å°è¯•èŽ·å–è¯¥å¯¹è±¡ä¸Šçš„é”ã€‚æ­¤å¤–è¿˜æœ‰ ==ReetrantLock å¯¹è±¡==ï¼Œå®ƒç›¸æ¯” synchronized æ›´åŠ çµæ´»ï¼Œå¯ä»¥==æ‰‹åŠ¨åœ° lock å’Œ unlock==ã€‚
> 2. ä¹è§‚é”ä¸€èˆ¬ä½¿ç”¨ ==CAS æœºåˆ¶==å®žçŽ°ï¼Œä»£è¡¨æœ‰ AtomicInteger ç±»ï¼Œå…¶åº•å±‚ä½¿ç”¨ CAS æœºåˆ¶å®žçŽ°å¹¶å‘æŽ§åˆ¶ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - å¹¶å‘åŒ…ä¸‹çš„åŽŸå­æ›´æ–°ç±»æ¯”å¦‚ ==AtomicInteger ç±»å°±æ˜¯å…¸åž‹çš„ä¹è§‚é”ï¼Œåº•å±‚ä½¿ç”¨ CAS æ“ä½œå®žçŽ°==ã€‚
> - æ‚²è§‚é”æœ‰ synchronizedï¼Œæ•´ä¸ªæ–¹æ³•æˆ–ä»£ç å—åŠ é”ï¼›==ReetrantLockï¼Œæ¯” synchronized æ›´åŠ çµæ´»ï¼Œå¯æ‰‹åŠ¨æŽ§åˆ¶åŠ é”å’Œè§£é”çš„è¿‡ç¨‹==ï¼›==ReetrantReadWriteLockï¼Œå…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»ï¼Œä½†åªå…è®¸ä¸€ä¸ªçº¿ç¨‹å†™==ã€‚
>

---

==é—®é¢˜å…­==ï¼š==æ­»é”äº†è§£å—ï¼Ÿå¯ä»¥ç®€å•è¯´ä¸‹æ­»é”ä»¥åŠæ€Žä¹ˆè§£å†³æ­»é”é—®é¢˜çš„ä¸ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==ä¸¤ä¸ªçº¿ç¨‹æŒæœ‰å¯¹æ–¹æƒ³è¦èŽ·å–çš„é”ï¼Œåˆå°è¯•èŽ·å–å¯¹æ–¹è¯·æ±‚çš„é”ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´è¿™ä¸¤ä¸ªçº¿ç¨‹éƒ½ä¸€ç›´å¤„äºŽèŽ·å–ä¸åˆ°é”çš„é˜»å¡žçŠ¶æ€==ï¼Œè¿™å°±å‡ºçŽ°äº†æ­»é”ã€‚
> 2. ç ´åæ­»é”äº§ç”Ÿçš„â€œ==å æœ‰ä¸”ç­‰å¾…==æ¡ä»¶â€ï¼Œä½¿ç”¨==ä¸€æ¬¡èŽ·å–æ‰€æœ‰èµ„æºçš„æ–¹æ³•==ã€‚åªè¦ä¸€ä¸ªçº¿ç¨‹ä¸€æ¬¡æ€§èŽ·å–æ‰€æœ‰æ‰€éœ€çš„å…±äº«èµ„æºçš„é”ï¼Œå°±ä¸è¦æ‹…å¿ƒè‡ªå·±ä¼šè¢«å…¶å®ƒçº¿ç¨‹æŒæœ‰çš„é”é˜»å¡žã€‚
> 3. ç ´åæ­»é”äº§ç”Ÿçš„â€œ==ä¸å¯æŠ¢å ==æ¡ä»¶â€ã€‚==å¦‚æžœä¸€ä¸ªçº¿ç¨‹é•¿æ—¶é—´èŽ·å–ä¸åˆ°æ‰€éœ€çš„é”èµ„æºï¼Œå°±é‡Šæ”¾è‡ªå·±çš„é”èµ„æº==ã€‚
> 4. ç ´åæ­»é”äº§ç”Ÿçš„â€œ==å¾ªçŽ¯ç­‰å¾…==æ¡ä»¶â€ï¼Œ==æŠŠå¤šä¸ªçº¿ç¨‹æ‰€éœ€èŽ·å–çš„å¤šä¸ªé”èµ„æºæŽ’åºï¼Œè¦æ±‚è¿™äº›çº¿ç¨‹å¿…é¡»é¡ºåºèŽ·å–è¿™äº›é”èµ„æº==ã€‚è¿™æ ·å°±é¿å…å‡ºçŽ°çº¿ç¨‹ T1 ç­‰å¾…çº¿ç¨‹ T2 å æœ‰çš„èµ„æºï¼Œçº¿ç¨‹ T2 ç­‰å¾…çº¿ç¨‹ T1 å æœ‰çš„èµ„æºçš„æƒ…å†µã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - æ­»é”å°±æ˜¯ï¼š==ä¸€ç»„äº’ç›¸ç«žäº‰èµ„æºçš„çº¿ç¨‹å› äº’ç›¸ç­‰å¾…ï¼Œå¯¼è‡´æ°¸ä¹…é˜»å¡žçš„çŽ°è±¡==ã€‚
> - æ­»é”å‡ºçŽ°æ—¶ä¸€å®šä¼šæ»¡è¶³==å››ä¸ªæ¡ä»¶==ï¼šç¬¬ä¸€ä¸ªæ˜¯==äº’æ–¥==ï¼Œå³å…±äº«èµ„æºåªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹å ç”¨ï¼›ç¬¬äºŒä¸ªæ˜¯==å æœ‰ä¸”ç­‰å¾…==ï¼Œå³==çº¿ç¨‹åœ¨æŒæœ‰ä¸€ä¸ªå…±äº«èµ„æºï¼Œå¹¶ç­‰å¾…å¦ä¸€ä¸ªå…±äº«èµ„æºæ—¶ï¼Œä¸ä¼šé‡Šæ”¾å½“å‰çš„å…±äº«èµ„æº==ï¼›ç¬¬ä¸‰ä¸ªæ˜¯==ä¸å¯æŠ¢å ==ï¼Œå³ä»»ä½•çº¿ç¨‹ä¸èƒ½æŠ¢å å…¶ä»–çº¿ç¨‹çš„å…±äº«èµ„æºï¼›ç¬¬å››ä¸ªæ˜¯==çŽ¯è·¯ç­‰å¾…==ï¼Œæœ€ç»ˆå½¢æˆæ­»é”æ—¶ï¼Œå„ä¸ªçº¿ç¨‹ä¼šå½¢æˆä¸€ä¸ªè¿›ç¨‹åˆ°èµ„æºçš„çŽ¯å½¢é“¾ã€‚
> - å› ä¸ºé”ä¸€å®šæ˜¯äº’æ–¥çš„ï¼Œæ‰€ä»¥è§£å†³æ­»é”åªéœ€ç ´åä»¥ä¸ŠåŽä¸‰ä¸ªæ¡ä»¶ä»»æ„ä¸€ä¸ªå³å¯ã€‚å¯¹äºŽ==å æœ‰ä¸”ç­‰å¾…ï¼Œå¯ä»¥è®©çº¿ç¨‹åŠ é”æ—¶ä¸€æ¬¡æ€§ç”³è¯·æ‰€æœ‰çš„èµ„æº==ï¼Œè¿™æ ·å°±ä¸å­˜åœ¨çº¿ç¨‹ç­‰å¾…äº†ã€‚å¯¹äºŽ==ä¸å¯æŠ¢å ï¼Œå¯ä»¥è®©çº¿ç¨‹èŽ·å–ä¸åˆ°èµ„æºæ—¶ï¼Œä¸»åŠ¨é‡Šæ”¾å½“å‰å·²ç»å æœ‰çš„èµ„æº==ã€‚å¯¹äºŽ==çŽ¯è·¯ç­‰å¾…ï¼Œå¯ä»¥å¯¹èµ„æºè¿›è¡ŒæŒ‰åºç”³è¯·==ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œçº¿ç¨‹åœ¨ç”³è¯·èµ„æºæ—¶ä¼˜å…ˆç”³è¯·åºå·å°çš„ï¼Œå†ç”³è¯·åºå·å¤§çš„ï¼Œè¿™æ ·å°±ä¸ä¼šå­˜åœ¨ç­‰å¾…çŽ¯è·¯äº†ã€‚
>

---

==é—®é¢˜ä¸ƒ==ï¼š==Javaé‡Œé¢çš„çº¿ç¨‹å’Œæ“ä½œç³»ç»Ÿçš„çº¿ç¨‹ä¸€æ ·å—ï¼Ÿæ¯”å¦‚æˆ‘åœ¨Javaä¸­åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹ï¼Œé‚£ä¹ˆæ“ä½œç³»ç»Ÿä¹Ÿä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹å—ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==Java çš„çº¿ç¨‹å’Œæ“ä½œç³»ç»Ÿçš„çº¿ç¨‹æ˜¯åŒä¸€ä¸ªå«ä¹‰==ã€‚è¿›ç¨‹æ˜¯å­˜å‚¨åº”ç”¨ç¨‹åºçš„ä¸€ä¸ªå®¹å™¨ï¼Œè€Œå…¶ä¸­çš„ä¼—å¤šçº¿ç¨‹æ‰æ˜¯æ‰§è¡Œåº”ç”¨ç¨‹åºçš„å•ä½ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - JDK 1.2 ä»¥å‰é‡‡ç”¨çš„æ˜¯ç»¿è‰²çº¿ç¨‹ï¼Œç”± JVM ç®¡ç†å’Œè°ƒåº¦ï¼Œå‘ç”Ÿåœ¨æ“ä½œç³»ç»Ÿçš„ç”¨æˆ·ç©ºé—´ã€‚è¿™å¯¹æ“ä½œç³»ç»Ÿæ˜¯é€æ˜Žçš„ï¼Œæ“ä½œç³»ç»Ÿåªèƒ½çœ‹åˆ°è¿›ç¨‹ï¼Œè€Œä¸èƒ½çœ‹åˆ°å…¶ä¸­çš„çº¿ç¨‹ã€‚
> - è¿™ç§æ¨¡å¼çš„ç¼ºç‚¹ä¸ºï¼Œå› ä¸ºæ“ä½œç³»ç»Ÿä¸çŸ¥é“çº¿ç¨‹çš„å­˜åœ¨ï¼ŒCPU çš„æ—¶é—´ç‰‡æ˜¯ä»¥è¿›ç¨‹ä¸ºè°ƒåº¦çš„ï¼Œå¦‚æžœè¿›ç¨‹ä¸­çš„æŸä¸ªçº¿ç¨‹é˜»å¡žï¼Œåˆ™ä¼šå¯¼è‡´æ•´ä¸ªè¿›ç¨‹æŠ˜å°„ã€‚ä¼˜ç‚¹ä¹Ÿå¾ˆæ˜Žæ˜¾ï¼Œå¯ä»¥åœ¨ä¸æ”¯æŒå¤šçº¿ç¨‹çš„æ“ä½œç³»ç»Ÿä¸Šå®žçŽ°å¤šçº¿ç¨‹ï¼Œå¹¶ä¸”çº¿ç¨‹åˆ‡æ¢åªéœ€åœ¨ç”¨æˆ·æ€å°±å¯ä»¥å®žçŽ°ï¼Œå…åŽ»äº†ç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„æ¥å›žåˆ‡æ¢ã€‚
> - JDK 1.2 ä»¥åŽ Java çº¿ç¨‹å°±æ˜¯ç›´æŽ¥ä¾èµ–æ“ä½œç³»ç»Ÿå®žçŽ°çš„ï¼Œæ˜¯ 1:1 çš„å…³ç³»ã€‚ä¹Ÿå°±æ˜¯è¯´ Java ä¸­çš„çº¿ç¨‹ï¼Œå®žè´¨ä¸Šå°±æ˜¯æ“ä½œç³»ç»Ÿä¸­çš„çº¿ç¨‹ã€‚
> - å› æ­¤ï¼Œå°±ç›®å‰æ¥çœ‹ï¼Œ==åœ¨ Java ä¸­åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹ï¼Œæ“ä½œç³»ç»Ÿä¹Ÿä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œæ˜¯å¯¹çš„==ã€‚
>

---



### 2.ã€å¤šçº¿ç¨‹åŸºç¡€ä¸“é¢˜ã€‘å…³äºŽJavaçº¿ç¨‹çš„ä¸€äº›å…³é”®å­—é—®é¢˜ðŸŒŸðŸŒŸðŸŒŸ

==é—®é¢˜ä¸€==ï¼š==åœ¨ Java ä¸­ï¼Œä¸€ä¸ªçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸæœ‰å“ªäº›ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. é¦–å…ˆçº¿ç¨‹==åˆšåˆšè¢«åˆ›å»ºï¼Œè€Œæ²¡æœ‰åˆ†é… CPU èµ„æº==çš„æ—¶å€™ï¼Œå¤„äºŽ==åˆå§‹çŠ¶æ€ï¼ˆNewï¼‰==ã€‚è¿™æ—¶åªæ˜¯åœ¨ç¼–ç¨‹è¯­è¨€å±‚é¢è¢«åˆ›å»ºï¼Œå¹¶æ²¡æœ‰åœ¨æ“ä½œç³»ç»Ÿå±‚é¢åˆ›å»ºæ–°çº¿ç¨‹ã€‚
> 2. éšåŽæ“ä½œç³»ç»Ÿä¸ºåˆšåˆšåˆ›å»ºçš„çº¿ç¨‹==åˆ†é… CPU èµ„æº==åŽè¿›å…¥==å¯è¿è¡ŒçŠ¶æ€ï¼ˆRunnableï¼‰==ï¼Œå¹¶å¼€å§‹è¿è¡Œã€‚
> 3. å¦‚æžœçº¿ç¨‹åœ¨==ç­‰å¾… synchronized çš„éšå¼é”==ï¼Œé‚£ä¹ˆå°±ä¼šè¿›å…¥==é˜»å¡žçŠ¶æ€ï¼ˆBlockedï¼‰==ï¼Œè€ŒèŽ·å–åˆ° synchronized çš„éšå¼é”åŽå°±ä¼šé‡æ–°å›žåˆ° Runnable çŠ¶æ€ã€‚
> 4. ==èŽ·å–åˆ° synchronized éšå¼é”çš„çº¿ç¨‹è°ƒç”¨ Object.wait== æ–¹æ³•ï¼Œæˆ–è€…çº¿ç¨‹==è°ƒç”¨å…¶å®ƒçº¿ç¨‹çš„ Thread.join æ–¹æ³•==ï¼Œè®©å…¶å®ƒçº¿ç¨‹æ’é˜Ÿæ—¶ï¼Œéƒ½ä¼šè¿›å…¥==æ— æ—¶é™ç­‰å¾…çŠ¶æ€ï¼ˆWAITINGï¼‰==ï¼Œè¢«å…¶å®ƒçº¿ç¨‹ notify å”¤é†’åŽæ‰ä¼šé‡å›ž Runnable çŠ¶æ€ã€‚
> 5. è°ƒç”¨å¸¦å‚æ•°çš„ wait æˆ– join æˆ– sleep æ–¹æ³•åˆ™ä¼šè¿›å…¥==æœ‰æ—¶é™ç­‰å¾…çŠ¶æ€ï¼ˆTIMED_WAITINGï¼‰==ã€‚
> 6. æœ€åŽ==ç»ˆæ­¢çŠ¶æ€ï¼ˆTerminatedï¼‰==ï¼Œå½“ run æ–¹æ³•æ‰§è¡Œå®Œæ¯•ï¼Œæˆ–è€…ä½¿ç”¨ ==iterrupted æ–¹æ³•==æé†’çº¿ç¨‹éœ€è¦ç»ˆæ­¢ï¼Œç”±çº¿ç¨‹ä½¿ç”¨å¼‚å¸¸æœºåˆ¶æˆ–è€…è‡ªè¡Œæ£€æµ‹è‡ªèº«æ˜¯å¦è¢« iterrupted åŽæ‰§è¡Œè‡ªå®šçš„ä»£ç åŽç»“æŸçº¿ç¨‹ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - å¤§è‡´æœ‰å…­ç§ï¼Œæˆ‘ä¸²èµ·æ¥è¯´ä¸€ä¸‹ï¼šå½“ä¸€ä¸ª==çº¿ç¨‹å¯¹è±¡è¢«åˆ›å»ºæ—¶ï¼Œå®ƒä¼šå¤„äºŽåˆ›å»ºçŠ¶æ€==ã€‚å½“è°ƒç”¨çº¿ç¨‹çš„ ==start( ) åŽï¼Œçº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€==ï¼Œæ­¤æ—¶çº¿ç¨‹è¿˜æ²¡æœ‰çœŸæ­£çš„æ‰§è¡Œï¼Œéœ€è¦==ç­‰å¾…åˆ†é… CPU æ—¶é—´ç‰‡==ï¼ŒåªåŽæ‰ä¼šè¿›å…¥çœŸæ­£çš„è¿è¡ŒçŠ¶æ€ï¼Œå¼€å§‹æ‰§è¡Œ run( ) ä¸­çš„ä»£ç ã€‚
> - åœ¨çº¿ç¨‹è¿è¡Œæ—¶ï¼Œå¯èƒ½ä¼šå› ä¸ºéœ€è¦==ç­‰å¾…é”çš„é‡Šæ”¾ç­‰è€Œè¿›å…¥é˜»å¡žçŠ¶æ€==ã€‚æˆ–è€…ä¼š==è°ƒç”¨è‡ªèº«çš„ wait( ) å’Œå…¶å®ƒçº¿ç¨‹çš„ join( ) è¿›å…¥ç­‰å¾…çŠ¶æ€==ã€‚
> - æœ€åŽçº¿ç¨‹æ­£å¸¸æ‰§è¡Œå®Œï¼Œæˆ–è€…==å‘ç”Ÿäº†æœªæ•èŽ·çš„å¼‚å¸¸ï¼Œä¼šè¿›å…¥ç»ˆæ­¢çŠ¶æ€==ï¼Œç»“æŸã€‚
>

---

==é—®é¢˜äºŒ==ï¼š==åœ¨ Java çš„ä¸­ï¼Œåˆ›å»ºçº¿ç¨‹çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ==ï¼ˆä¸€å®šè¦è‡ªå·±ä¼šåˆ›å»ºï¼Œå› ä¸ºæœ‰æ—¶å€™ä¼šé‡åˆ°é¢è¯•å®˜è®©ä½ åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼‰

==æˆ‘çš„å›žç­”==ï¼š

> 1. åˆ›å»ºä¸€ä¸ªç±»ç»§æ‰¿ Thread ç±»ï¼Œé‡å†™å…¶ run æ–¹æ³•ã€‚
> 2. æˆ–è€…å®žçŽ° Runnable æŽ¥å£ï¼Œå®žçŽ°å…¶ run æ–¹æ³•ã€‚
> 3. å®žçŽ° Callable æŽ¥å£ï¼Œå’Œ Runnable æŽ¥å£ä¸åŒçš„æ˜¯ï¼Œ==Callable çš„ call æ–¹æ³•æ˜¯æœ‰è¿”å›žå‚æ•°çš„==ï¼Œå¯ä»¥é€šè¿‡==å°† Callable ä¼ å…¥ `FutureTask(Callable)`==ï¼Œ==`new Thread(FutureTask).start`å¼€å¯çº¿ç¨‹==ï¼Œå¹¶==æ ¹æ® `futureTask.isDone`åˆ¤æ–­çº¿ç¨‹æ˜¯å¦æ‰§è¡Œå®Œæ¯•==ï¼Œä»¥åŠ==`futureTask.get`èŽ·å– Callable çš„è¿”å›žå€¼==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - Java ä¸­ä¸€å…±æœ‰ä¸‰ç§æ–¹å¼åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼š
> - ç¬¬ä¸€ç§ä¹Ÿæ˜¯æœ€å¸¸è§çš„ä¸€ç§å°±æ˜¯é€šè¿‡å®žçŽ° Runnable æŽ¥å£ï¼Œè¦†å†™å…¶ä¸­çš„ run( )ã€‚
> - ç¬¬äºŒç§æ˜¯ç»§æ‰¿ Thread ç±»ï¼ŒThread ç±»æœ¬èº«å°±å®žçŽ°äº† Runnable æŽ¥å£ï¼Œæ‰€ä»¥ä¹Ÿåªéœ€è¦†å†™ run æ–¹æ³•å³å¯ã€‚
> - ç¬¬ä¸‰ç§æ˜¯å®žçŽ° Callable æŽ¥å£ï¼Œå®ƒä¸Ž Runnale çš„åŒºåˆ«åœ¨äºŽ ==Callable ä¸ºçº¿ç¨‹çš„æ‰§è¡Œæä¾›äº†ä¸€ä¸ªè¿”å›žå€¼ FutureTask ç±»==ï¼Œå¯ä»¥==ä½¿ç”¨è¿™ä¸ª FutureTask ç±»çš„ get ç­‰æ–¹æ³•æŸ¥è¯¢è¿™ä¸ªçº¿ç¨‹æ˜¯å¦æ‰§è¡Œå®Œæ¯•==ã€‚
>

---

==é—®é¢˜ä¸‰==ï¼š==ä½ è§‰å¾—Threadç±»å’ŒRunableæŽ¥å£çš„æœ€å¤§åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. Thread ç±»æ˜¯ä¸€ä¸ªç±»ï¼Œè€Œ Runnable æ˜¯ä¸€ä¸ªæŽ¥å£ã€‚åœ¨ Java ä¸­åªèƒ½è¿›è¡Œå•ç»§æ‰¿ï¼Œä½†æ˜¯å¯ä»¥åŒæ—¶å®žçŽ°å¤šä¸ªæŽ¥å£ã€‚å¦‚æžœé€‰æ‹©ç»§æ‰¿ Thread ç±»çš„è¯ï¼Œè™½ç„¶åªé‡å†™äº† run æ–¹æ³•ï¼Œä½†æ˜¯ä¹Ÿæ— æ³•åœ¨ç»§æ‰¿å…¶å®ƒç±»ï¼Œè¿™é™ä½Žäº†ä»£ç çš„çµæ´»æ€§ï¼Œå› æ­¤åˆ›å»ºçº¿ç¨‹ä¸€èˆ¬é€‰æ‹©å®žçŽ° Runnable æŽ¥å£ï¼Œç„¶åŽä¼ ç»™ Thread ç±»ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - Runnable æ˜¯ä¸€ä¸ªæŽ¥å£ï¼ŒThread æ˜¯ä¸€ä¸ªå®žçŽ°äº† Runnable æŽ¥å£çš„ç±»ã€‚æŒ‰ç…§ Java ä¸­çš„å•ç»§æ‰¿ã€å¤šå®žçŽ°çš„ç‰¹æ€§ï¼Œ==å¦‚æžœä½¿ç”¨ç»§æ‰¿ Thread ç±»æ¥åˆ›å»ºè¿›ç¨‹ï¼Œåˆ™æ— æ³•å†ç»§æ‰¿å…¶ä»–ç±»ï¼Œä¼šé™ä½Žä»£ç çš„çµæ´»æ€§==ã€‚è¿™æ—¶ç”¨å®žçŽ° Runnable æŽ¥å£æ¯”è¾ƒå¥½ã€‚
>

---

==é—®é¢˜å››==ï¼š==è¯´ä¸€è¯´run() æ–¹æ³•å’Œ start() çš„åŒºåˆ«ï¼Ÿ==ï¼ˆPSï¼šæœ€å¥½è‡ªå·±ç‚¹è¿›åŽ»æºç ï¼Œçœ‹çœ‹ä»–ä»¬çš„åŒºåˆ«ï¼‰

==æˆ‘çš„å›žç­”==ï¼š

> 1. run æ–¹æ³•åªæ˜¯ Runnable æŽ¥å£å’Œ Thread ç±»ä¸­çš„ä¸€ä¸ªæ™®é€šçš„æ–¹æ³•ï¼Œå¦‚æžœç›´æŽ¥è°ƒç”¨ run æ–¹æ³•å¹¶ä¸ä¼šåˆ›å»ºçº¿ç¨‹ï¼Œè€Œæ˜¯åœ¨å½“å‰çš„çº¿ç¨‹ä¸­æ‰§è¡Œè¿™ä¸ª run æ–¹æ³•ã€‚è€Œåªæœ‰è°ƒç”¨ start æ–¹æ³•ï¼Œæ‰ä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œåœ¨æ–°åˆ›å»ºçš„çº¿ç¨‹ä¸­æ‰§è¡Œ run æ–¹æ³•ã€‚ä»Žæºç æ¥çœ‹ï¼Œæ˜¯ start æ–¹æ³•ä¸­çš„ start0 æ–¹æ³•æ‰§è¡Œåˆ›å»ºæ–°çº¿ç¨‹çš„ä»»åŠ¡ï¼Œstart0 æ˜¯ä¸€ä¸ª native æ–¹æ³•ï¼Œç”¨äºŽåˆ›å»ºçº¿ç¨‹ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - Thread çš„ run( ) åªæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­çš„ä¸€ä¸ª==æ™®é€šæ–¹æ³•è°ƒç”¨==ï¼Œè€Œ start( ) åˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å­çº¿ç¨‹æ¥æ‰§è¡Œï¼Œå®ƒåº•å±‚ä½¿ç”¨ native æ–¹æ³•å®žçŽ°çš„ï¼Œç”¨æ¥å¼€å¯ä¸€ä¸ªæ–°çº¿ç¨‹å¹¶æ‰§è¡Œè‡ªå·±å®šä¹‰çš„ run æ–¹æ³•ã€‚
>

---

==é—®é¢˜äº”==ï¼š==è¯´ä¸€è¯´ waitå’Œsleepçš„åŒºåˆ«ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==sleep æ˜¯ Thread ç±»çš„æ–¹æ³•==ï¼Œå¯ä»¥åœ¨==ä»»æ„ä½ç½®ä½¿ç”¨==ï¼Œä½¿ç”¨åŽçº¿ç¨‹è¿›å…¥ ==WAITING== çŠ¶æ€ï¼Œæ­¤æ—¶çº¿ç¨‹å¹¶==ä¸ä¼šé‡Šæ”¾è‡ªå·±çš„åŒæ­¥èµ„æºé”==ï¼ˆæ¯”å¦‚ synchronized å¯¹å…±äº«èµ„æºçš„é”ï¼‰åœ¨ ==sleep ç»“æŸåŽçº¿ç¨‹ä¼šç»§ç»­æ‰§è¡Œ==ã€‚
> 2. è€Œ ==wait æ˜¯ Object ç±»çš„æ–¹æ³•==ï¼Œ==åªèƒ½åœ¨åŒæ­¥å—ä¸­è¿›è¡Œè°ƒç”¨==ï¼Œè°ƒç”¨åŽçº¿ç¨‹è¿›å…¥ ==BLOCKED== çŠ¶æ€ï¼Œæ­¤æ—¶çº¿ç¨‹==ä¼šé‡Šæ”¾è‡ªå·±çš„åŒæ­¥èµ„æºé”==ï¼Œå¹¶åŠ å…¥ç­‰å¾…é˜Ÿåˆ—ï¼Œ==è¢« notify å”¤é†’åŽä¼šé‡æ–°å°è¯•èŽ·å–åŒæ­¥èµ„æºé”==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - sleep( ) æ˜¯ Thread ç±»çš„æ–¹æ³•ï¼Œwait( ) æ˜¯ Object ç±»çš„æ–¹æ³•ã€‚
> - ==sleep( ) å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨ï¼Œwait( ) åˆ™åªèƒ½åœ¨åŒæ­¥æ–¹æ³•æˆ–åŒæ­¥å—ä¸­ä½¿ç”¨==ï¼Œå¹¶ä¸” ==sleep( ) åªæ˜¯è®©å‡ºäº† CPUï¼Œå¹¶æ²¡æœ‰é‡Šæ”¾åŒæ­¥èµ„æºé”==ï¼Œsleep ç»“æŸä¹‹åŽä¼šç»§ç»­æ‰§è¡Œã€‚
> - è€Œ ==wait( ) åˆ™æ˜¯è®©å½“å‰çº¿ç¨‹é€€å‡ºåŒæ­¥èµ„æºé”==ï¼Œ==è¿›å…¥ç­‰å¾…é˜Ÿåˆ—==ï¼Œè®©å…¶ä»–æ­£åœ¨ç­‰å¾…è¿™ä¸ªé”çš„çº¿ç¨‹äº‰å¤ºèµ„æºå¹¶è¿è¡Œã€‚åœ¨è¿™ä¹‹åŽï¼Œåªæœ‰è°ƒç”¨äº† notify( ) / notifyAll( ) å”¤é†’è¿™ä¸ªçº¿ç¨‹ï¼Œå®ƒæ‰ä¼šè¿›å…¥é”æ± ï¼Œå¹¶åŠ å…¥åˆ°==äº‰å¤ºèµ„æº==çš„è¿‡ç¨‹ä¸­ã€‚
>

---

==é—®é¢˜å…­==ï¼š==è¯´ä¸€è¯´ notify å’Œ notifyAll çš„åŒºåˆ«ä»¥åŠä½¿ç”¨åœºæ™¯ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. notify ä¼šéšæœºå”¤é†’ä¸€ä¸ªå¤„äºŽç­‰å¾…é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹ï¼Œè€Œ notifyAll åˆ™æ˜¯å”¤é†’æ‰€æœ‰ç­‰å¾…é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹ï¼Œè®©å®ƒä»¬è‡ªè¡Œäº‰å¤ºæ¡ä»¶å˜é‡èµ„æºã€‚
> 2. notify å­˜åœ¨çš„é—®é¢˜æ˜¯ï¼Œç”±äºŽ==å”¤é†’çš„çº¿ç¨‹æ˜¯éšæœºçš„ï¼Œå› æ­¤æœ‰äº›çº¿ç¨‹å¯èƒ½æ°¸è¿œä¸ä¼šè¢«å”¤é†’==ã€‚
> 3. notify è¿˜æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯å¯èƒ½==éšæœºå”¤é†’çš„çº¿ç¨‹ä¾ç„¶å¾—ä¸åˆ°æ‰€éœ€çš„æ¡ä»¶å˜é‡==ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬çš„é€»è¾‘æ˜¯åªè¦æŸä¸€ä¸ªæ¡ä»¶å˜é‡è¢«é‡Šæ”¾ï¼Œåˆ™è°ƒç”¨ notify éšæœºå”¤é†’ä¸€ä¸ªçº¿ç¨‹ï¼Œä½†æ˜¯==è¿™ä¸ªçº¿ç¨‹æ‰€éœ€è¦çš„èµ„æºå¯èƒ½ä¸å¯¹å£ï¼Œå°±å¯¼è‡´çœŸæ­£éœ€è¦è¿™ä¸ªèµ„æºçš„çº¿ç¨‹æ²¡æœ‰è¢«å”¤é†’==ï¼Œé€ æˆèµ„æºçš„æµªè´¹ï¼Œæ€§èƒ½çš„æŸè€—ã€‚
> 4. å› æ­¤==ä¸€èˆ¬æ¡ä»¶ä¸‹å°½é‡ notifyAll==ï¼Œé™¤éžæ‰€æœ‰åœ¨ç­‰å¾…é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹æ‰€éœ€è¦çš„æ¡ä»¶å˜é‡èµ„æºç›¸åŒï¼Œå¹¶ä¸”åŽåºçš„æ“ä½œä¹Ÿç›¸åŒæ‰è€ƒè™‘å¯ä»¥ä½¿ç”¨ notifyã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - notify( ) ä¼šéšæœºå”¤é†’ä¸€ä¸ªå¤„äºŽç­‰å¾…æ± ä¸­çš„çº¿ç¨‹ï¼Œè¿›å…¥é”æ± åŽ»ç«žäº‰èŽ·å–é”çš„æœºä¼šã€‚
> - notifyAll( ) ä¼šå”¤é†’æ‰€æœ‰å¤„äºŽç­‰å¾…æ± ä¸­çš„çº¿ç¨‹ï¼Œä¸€èµ·è¿›å…¥é”æ± åŽ»ç«žäº‰èŽ·å–é”çš„æœºä¼šã€‚
> - åœ¨ç”Ÿäº§-æ¶ˆè´¹æ¨¡åž‹ä¸­ï¼Œ==ç”Ÿäº§è€…ç”Ÿäº§å‡ºæ¶ˆæ¯æ—¶ï¼Œå¯ä»¥è°ƒç”¨ notify( ) é€šçŸ¥æ¶ˆè´¹è€…æ¶ˆè´¹==ã€‚å½“==å¤šä¸ªçº¿ç¨‹éœ€è¦éƒ½æ»¡è¶³æŸä¸ªæ¡ä»¶æ‰èƒ½å…±åŒè¿è¡Œæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ notifyAll( )== å”¤é†’æ‰€æœ‰ç­‰å¾…çº¿ç¨‹ï¼ŒåŒæ—¶æ‰§è¡Œä»»åŠ¡ã€‚
>

---



### 3.ã€å¹¶å‘ä¸“é¢˜ã€‘CAS è¿žçŽ¯ç‚®ðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==é—®é¢˜ä¸€==ï¼š==ç®€å•ä»‹ç»ä¸€ä¸‹ CASï¼Œä»€ä¹ˆæ˜¯ CAS ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. CAS æ˜¯å®žçŽ°ä¹è§‚é”è¿›è¡Œå¹¶å‘æŽ§åˆ¶çš„ä¸€ç§ç®—æ³•ï¼Œæ˜¯ ==compareAndSwap== çš„ç¼©å†™ã€‚
>
> 2. è¯¥ç®—æ³•åŒ…æ‹¬ä¸‰ä¸ªå˜é‡ï¼Œåˆ†åˆ«æ˜¯ valueï¼ŒexpectedValueï¼ŒnewValueï¼Œå…¶ä¸­ value æ˜¯éœ€è¦è¿›è¡Œå¹¶å‘æŽ§åˆ¶çš„å˜é‡ï¼Œè€Œ expectedValue è¡¨ç¤ºè¿›è¡Œ swap æ“ä½œï¼ˆæ›´æ–° value çš„å€¼ï¼‰å‰æ‰€æœŸæœ› value çš„å€¼ã€‚
>
> 3. ==å¦‚æžœ `value == expectedValue`ï¼Œåˆ™å¯ä»¥è¿›è¡Œ swap æ“ä½œ==ï¼Œå¦åˆ™è¯´æ˜Žæœ‰å…¶å®ƒçº¿ç¨‹æ­£åœ¨å¹¶å‘æ“ä½œ value å˜é‡ï¼Œå› æ­¤å½“å‰çº¿ç¨‹æ“ä½œå¤±è´¥ï¼Œå¯ä»¥è‡ªè¡Œå†³å®šåŽç»­æ“ä½œï¼ˆè‡ªæ—‹ OR é˜»å¡žï¼‰ã€‚
>
> 4. ```java
> 	public volatile int value;
> 		
> 	public static void increment() {
> 	    do {
> 	        int expectedValue = this.value;
> 	        int newValue = expectedValue + 1;
> 	    } while (!compareAndSwap(expectedValue, newValue)) 
> 	        // å¦‚æžœæœ‰å…¶å®ƒçº¿ç¨‹ï¼Œåˆ™ value åœ¨åˆ›å»º expectedValue å’Œ newValue çš„è¿™æ®µ
> 	        // æ—¶é—´å†…è¢«å…¶å®ƒçº¿ç¨‹ä¿®æ”¹ï¼Œå¯¼è‡´ value å’Œ expectedValue ä¸ä¸€æ ·
> 	        // éœ€è¦é‡æ–°è¿›è¡Œ value++ æ“ä½œ
> 	        // å¦åˆ™å°† value è®¾ç½®ä¸º newValue
> 	}
> 		
> 	public boolean compareAndSwap(int expectedValue, int newValue) {
> 	    if (this.value == expectedValue) { // compare æ“ä½œ
> 	        this.value = newValue; // swap æ“ä½œ
> 	        return true;
> 	    }
> 	    return false;
> 	}
> 	```
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - CAS æ˜¯==æ¯”è¾ƒå¹¶äº¤æ¢==çš„ç¼©å†™ï¼Œæ˜¯==å¹¶å‘ç¼–ç¨‹ä¸­çš„ä¸€ä¸ªåŽŸå­æ“ä½œ==ã€‚å®ƒåŒ…å«ä¸‰ä¸ªæ“ä½œæ•°ï¼šå†…å­˜ä½ç½®ã€é¢„æœŸåŽŸå€¼å’Œæ–°å€¼ã€‚åœ¨æ“ä½œæœŸé—´ä¼š==å…ˆæ¯”è¾ƒã€Œå†…å­˜ä½ç½®ä¸Šçš„å€¼ã€å’Œã€Œé¢„æœŸåŽŸå€¼ã€æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æžœç›¸ç­‰åˆ™äº¤æ¢æˆæ–°å€¼ï¼Œå¦‚æžœä¸ç›¸ç­‰åˆ™ä¸äº¤æ¢==ã€‚
>

---

==é—®é¢˜äºŒ==ï¼š==CAS åŒ…å«äº† Compare å’Œ Swap ä¸¤ä¸ªæ“ä½œï¼Œå®ƒåˆå¦‚ä½•ä¿è¯åŽŸå­æ€§å‘¢ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. compareAndSet æ–¹æ³•çš„==åº•å±‚æ˜¯è°ƒç”¨äº† unsafe.compareAndSwapInt==ï¼š
>
>   ```java
>   public final boolean compareAndSet(int expect, int update) {
>       return unsafe.compareAndSwapInt(this, valueOffset, expect, update);
>   }
>   ```
>
> 2. è¿™é‡Œçš„ unsafe æ˜¯ JVM ä¸ºæˆ‘ä»¬æä¾›çš„ä¸€ä¸ª==ç›´æŽ¥è®¿é—®æ“ä½œç³»ç»Ÿçš„æŽ¥å£==ï¼Œä¸ºæˆ‘ä»¬æä¾›äº†å¯ä»¥è¿›è¡Œ==æ“ä½œç³»ç»Ÿåº•å±‚ç¡¬ä»¶çº§åˆ«çš„åŽŸå­æ“ä½œçš„ api==ã€‚
>
> 3. è€Œè‡³äºŽ `unsafe.compareAndSwapInt` çš„å‚æ•° ==valueOffsetï¼Œåˆ™æ˜¯ value å±žæ€§åœ¨å†…å­˜ä¸­çš„åç§»é‡ï¼Œå…¶ç±»åž‹ä¸º long ç±»åž‹ï¼Œå› æ­¤å¯ä»¥å°†å…¶ç†è§£ä¸º value çš„åœ°å€==ï¼Œä»¥ä¾¿è¿›è¡Œ swap æ“ä½œã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - è¿™ä¸ªä¸»è¦æ˜¯é€šè¿‡==æ“ä½œç³»ç»Ÿåº•å±‚ç¡¬ä»¶çº§åˆ«çš„æ”¯æŒ==ï¼Œæ¥å®žçŽ° CAS æ“ä½œçš„åŽŸå­æ€§çš„ã€‚æ¯”å¦‚çŽ°ä»£ x86 æž¶æž„çš„å¤„ç†å™¨ï¼Œæ˜¯ç”¨ cmpxchg æŒ‡ä»¤å°† CAS çš„å¤šä¸ªæ“ä½œé€šè¿‡ä¸€æ¡å¤„ç†å™¨æŒ‡ä»¤å®žçŽ°ã€‚
> - å†å¾€ä¸‹è¯´ï¼Œå¤„ç†å™¨æŒ‡ä»¤çš„åŽŸå­æ€§é€šå¸¸ç”±å¤„ç†å™¨æä¾›ã€Œæ€»çº¿é”å®šã€å’Œã€Œç¼“å­˜é”å®šã€ä¸¤ä¸ªæœºåˆ¶æ¥ä¿è¯ã€‚
> - æ€»çº¿é”å®šæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª LOCK# ä¿¡å·ï¼Œå½“ä¸€ä¸ªå¤„ç†å™¨åœ¨æ€»çº¿ä¸Šå‘å‡ºè¿™ä¸ªä¿¡å·æ—¶ï¼Œå…¶å®ƒå¤„ç†å™¨çš„è¯·æ±‚å°†è¢«é˜»å¡žï¼Œé‚£ä¹ˆæ­¤æ—¶è¿™ä¸ªå¤„ç†å™¨å°±å¯ä»¥ç‹¬å å…±äº«å†…å­˜ã€‚è¿™ç§é”å®šæ–¹å¼çš„å¼€é”€å¾ˆå¤§ï¼Œç›´æŽ¥æŠŠ CPU å’Œå†…å­˜ä¹‹é—´çš„é€šä¿¡ç»™é”ä½äº†ï¼Œå¯¼è‡´åœ¨é”å®šæœŸé—´å…¶ä»–å¤„ç†å™¨ä¹Ÿä¸èƒ½æ“ä½œå…¶å®ƒå†…å­˜åœ°å€çš„æ•°æ®ã€‚
> - ç¼“å­˜é”å®šä¸»è¦æ˜¯åˆ©ç”¨äº† MESI ï¼Œä¹Ÿå°±æ˜¯ç¼“å­˜ä¸€è‡´æ€§åè®®ï¼Œé€šè¿‡è·Ÿè¸ªå’Œç»´æŠ¤å„å¤„ç†å™¨ç¼“å­˜è¡Œçš„çŠ¶æ€ï¼Œç¡®ä¿å¤šå¤„ç†å™¨å¯¹åŒä¸€å†…å­˜åœ°å€è¯»å†™çš„ä¸€è‡´æ€§ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯å¤„ç†å™¨ç›´æŽ¥æ“ä½œæ•°æ®çš„å†…å­˜åœ°å€ï¼Œä¸ä¼šå½±å“å…¶å®ƒå¤„ç†å™¨å¯¹å…¶å®ƒå†…å­˜åœ°å€çš„æ“ä½œã€‚
>

---

==é—®é¢˜ä¸‰==ï¼š==CASæ˜¯å¦‚ä½•è§£å†³ ABA é—®é¢˜çš„ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ABA é—®é¢˜æ˜¯æŒ‡åœ¨è¿›è¡Œ compare å‰ï¼Œ==å…¶å®ƒçš„çº¿ç¨‹å°† value çš„å€¼è¿›è¡Œä¿®æ”¹åŽï¼Œåˆæ”¹å›žäº† oldValue çš„å€¼==ï¼Œè¿™å¯¹äºŽ compare æ¥è¯´ä¾ç„¶ä¼šè®¤ä¸ºæ­¤æ—¶æ²¡æœ‰å‡ºçŽ°å¹¶å‘è®¿é—®çš„é—®é¢˜ã€‚
> 2. è§£å†³ ABA é—®é¢˜çš„æ–¹æ³•æ˜¯==ç»™ value åŠ ä¸Šç‰ˆæœ¬å·==ï¼Œä»»ä½•ä¸€ä¸ªçº¿ç¨‹åœ¨ä¿®æ”¹ value æ—¶éƒ½ä¼šæ›´æ–°ç‰ˆæœ¬å·ï¼Œè¿™æ ·æŠŠ compare çš„å†…å®¹ä»Ž value çš„å€¼æ”¹ä¸ºç‰ˆæœ¬å·çš„å€¼å³å¯ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - å¯ä»¥åœ¨==æ¯æ¬¡ä¿®æ”¹å€¼æ—¶å¸¦ä¸Šç‰ˆæœ¬å·==å°±è¡Œã€‚
>
> - æ¯”å¦‚ JUC atomic åŒ…ä¸‹çš„ ==AtomicStampedReference== ç±»ï¼Œé€šè¿‡==å¼•å…¥ä¸€ä¸ªæ•´æ•°æˆ³ï¼ˆstampï¼‰==ï¼Œåœ¨å¯¹å¯¹è±¡çš„å¼•ç”¨ä¿®æ”¹æ—¶ï¼Œä¹Ÿä¼šæ”¹å¯¹åº”çš„æ•´æ•°æˆ³ï¼Œé¿å…äº† ABA é—®é¢˜ã€‚
>
> 	```java
> 	public boolean compareAndSet(V   expectedReference,
> 	                             V   newReference,
> 	                             int expectedStamp,
> 	                             int newStamp) {
> 	    Pair<V> current = pair;
> 	    return
> 	        expectedReference == current.reference &&
> 	        expectedStamp == current.stamp && // åŒæ—¶æ¯”è¾ƒæ•´æ•°æˆ³æ˜¯å¦ç›¸åŒ
> 	        ((newReference == current.reference &&
> 	          newStamp == current.stamp) ||
> 	         casPair(current, Pair.of(newReference, newStamp)));
> 	}
> 	```
>

---

==é—®é¢˜å››==ï¼š==æ¯”èµ·å…¶ä»–é”ï¼ŒCAS è¿™ç§é”æœ‰å“ªäº›ä¼˜ç¼ºç‚¹å‘¢ï¼ŸCAS é€‚ç”¨äºŽå“ªäº›åº”ç”¨åœºæ™¯å‘¢ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ä¼˜ç‚¹æ˜¯å¯ä»¥==é¿å…==ä½¿ç”¨æ‚²è§‚é”æ—¶æ¶‰åŠåˆ°çš„å¤§é‡==æ“ä½œç³»ç»Ÿå†…æ ¸æ€å’Œç”¨æˆ·æ€ä¹‹é—´çš„è½¬æ¢ï¼ŒèŠ‚çº¦æ—¶é—´==ã€‚
> 2. ç¼ºç‚¹æœ‰ä¼šäº§ç”Ÿ ==ABA é—®é¢˜==ï¼Œè¿™å¯ä»¥ç”¨åŠ ç‰ˆæœ¬å·è§£å†³ï¼›åœ¨é«˜å¹¶å‘ä¸‹ï¼Œå¦‚æžœ CAS æ“ä½œåå¤ä¸æˆåŠŸï¼Œä¼šå¯¼è‡´==å ç”¨å¤§é‡ CPU èµ„æº==ï¼›==åªèƒ½å¹¶å‘æŽ§åˆ¶ä¸€ä¸ªå…±äº«å˜é‡==ï¼Œå¦‚æžœæ¶‰åŠåˆ°å¤šä¸ªå…±äº«å¯¹è±¡æˆ–ä»£ç å—çš„æ—¶å€™ï¼Œè¿˜æ˜¯éœ€è¦ä½¿ç”¨æ‚²è§‚é”ã€‚
> 3. CAS æœºåˆ¶å¯ä»¥ç”¨äºŽå®žçŽ°ä¹è§‚é”ï¼Œæ¯”å¦‚ AtomicInteger ä¸­å°±æ˜¯ç”¨ CAS æœºåˆ¶æ¥å®žçŽ°å¯¹ Integer çš„å¹¶å‘æŽ§åˆ¶ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - CAS æ˜¯ä¹è§‚é”çš„ä¸€ç§å®žçŽ°ï¼Œæ˜¯éžå¸¸è½»é‡çº§çš„æ“ä½œï¼Œæ•ˆçŽ‡å¾ˆé«˜ã€‚ä½†ä¹Ÿæœ‰ç¼ºç‚¹ã€‚é¦–å…ˆå°±æ˜¯ ==ABA== é—®é¢˜ï¼Œå¯ä»¥å¸¦ä¸Šç‰ˆæœ¬å·è§£å†³ï¼›è¿˜æœ‰å°±æ˜¯==å¾ªçŽ¯æ—¶é—´é•¿å¼€é”€å¤§==ï¼Œé«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œè‡ªæ—‹ CAS å¦‚æžœé•¿æ—¶é—´ä¸æˆåŠŸï¼Œä¼šç™½ç™½æµªè´¹ CPUï¼›åŒæ—¶ CAS ä¹Ÿ==åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŽŸå­æ“ä½œ==ã€‚å½“éœ€è¦å¯¹å¤šä¸ªå…±äº«å˜é‡æ“ä½œæ—¶ï¼Œå°±å¸¦è€ƒè™‘ä½¿ç”¨é”ï¼Œæˆ–è€…æŠŠå¤šä¸ªå˜é‡æ”¾åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œï¼Œä½¿ç”¨ AtomicReference ä¿è¯å¼•ç”¨å¯¹è±¡æ“ä½œçš„åŽŸå­æ€§ã€‚
> - CAS æ“ä½œå¯ä»¥ç”¨äºŽå®žçŽ°ä¹è§‚é”ï¼Œåƒ AtomicInteger ä¹‹ç±»çš„ã€‚ä¹Ÿå¯ä»¥ç”¨äºŽä¸€äº›å¹¶å‘å®¹å™¨åº•å±‚åŒæ­¥çŠ¶æ€çš„è®¾ç½®ï¼Œæ¯”å¦‚ JDK ä¸­ AQS å’Œ ReetrantLock éƒ½æœ‰çš„ tryAcquire( )ï¼Œéƒ½æ˜¯ç”¨ CAS æ“ä½œç‹¬å å¼åœ°èŽ·å–å¹¶è®¾ç½®å½“å‰çº¿ç¨‹çš„åŒæ­¥çŠ¶æ€ã€‚è¿˜æœ‰ Java ä¸­çš„åå‘é”å’Œè½»é‡çº§é”åº•å±‚ä¹Ÿç”¨åˆ°äº† CASï¼Œä½œç”¨ç±»ä¼¼ã€‚
>

---

==é—®é¢˜äº”==ï¼š==æˆ‘ä»¬è¯´äº†ï¼Œåœ¨é«˜å¹¶å‘æƒ…å†µä¸‹ï¼ŒCAS æˆ–è®¸æ•ˆçŽ‡æ›´ä½Žï¼Œé‚£ä¹ˆå¯¹æ­¤ï¼Œä½ è§‰å¾—å¯ä»¥æ€Žä¹ˆä¼˜åŒ– CAS å‘¢ï¼Ÿï¼ˆPSï¼šJava8 å°±æœ‰è¿›è¡Œäº†ä¸€äº›ä¼˜åŒ–ï¼‰==

==æˆ‘çš„å›žç­”==ï¼š

> 1. CAS åœ¨é«˜å¹¶å‘ä¸‹æ€§èƒ½é™ä½Žçš„åŽŸå› ä¸»è¦æ˜¯åå¤è‡ªæ—‹é•¿æ—¶é—´èŽ·å–ä¸åˆ°å…±äº«å˜é‡ï¼Œå ç”¨å¤§é‡ CPU èµ„æºã€‚å› æ­¤å¯ä»¥==è®¾ç½®è‡ªæ—‹æ¬¡æ•°çš„ä¸Šé™==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - é«˜å¹¶å‘ä¸‹ä¸»è¦æ˜¯ CAS è‡ªæ—‹å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ï¼Œå¯ä»¥å¯¹çº¿ç¨‹==åŠ å…¥è‡ªæ—‹æ¬¡æ•°çš„é™åˆ¶==ï¼Œè¶…è¿‡é™åˆ¶æ—¶å¯ä»¥æ ¹æ®æƒ…å†µè°ƒæ•´è‡ªæ—‹æ¬¡æ•°ã€‚
>
> - è¿˜æœ‰å°±æ˜¯ Java 8 ä¸­å¼•å…¥äº† ==LongAdder== ç±»ï¼Œå®ƒç”¨ã€Œ==åˆ†æ®µè®¡æ•°==ã€çš„æ–¹æ³•æ¥ä¼˜åŒ– CASï¼Œå…·ä½“æ¥è¯´ï¼ŒLongAdder å°†å†…éƒ¨çš„æ•°å€¼åˆ†ä¸ºå¤šä¸ªæ®µï¼Œæ¯ä¸ªæ®µéƒ½æ˜¯ç‹¬ç«‹çš„è®¡æ•°å™¨ã€‚å½“å¤šä¸ªçº¿ç¨‹åŒæ—¶æ›´æ–°æ•°æ®æ—¶ï¼Œä¼šå°†è¿™äº›æ›´æ–°åˆ†å‘ç»™ä¸åŒçš„æ®µï¼Œå‡å°‘äº†ç«žäº‰ã€‚
>
> 	<img src="bgwROUND1.assets/image-20240618162151189.png" alt="image-20240618162151189" style="zoom:67%;" />
>

---



### 4.ã€å¹¶å‘ä¸“é¢˜ã€‘volitale è¿žçŽ¯ç‚®ðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==é—®é¢˜ä¸€==ï¼š==Volitale äº†è§£å—ï¼Ÿç®€å•ä»‹ç»ä¸€ä¸‹ï¼ˆæŒ‡å¯¼ï¼šå›žç­”å®ƒçš„ä¸‰ä¸ªä½œç”¨ï¼‰==

==æˆ‘çš„å›žç­”==ï¼š

> 1. volatie ç”¨äºŽä¿è¯æ‰€ä¿®é¥°å˜é‡å¯¹æ‰€æœ‰çº¿ç¨‹çš„==å¯è§æ€§==å’Œ==é¡ºåºæ€§==ã€‚
> 2. volatile ==æœ€åˆçš„è¯­ä¹‰å°±æ˜¯ç¦ç”¨ CPU ç¼“å­˜==ï¼Œè®©==å¤šä¸ªå¤„ç†å™¨è¯»å–çš„æ•°æ®éƒ½æ¥è‡ªäºŽå†…å­˜==ï¼Œä»Žè€Œä¿è¯å¯è§æ€§ã€‚å¯è§æ€§å°±æ˜¯æŒ‡å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹ä¸€ä¸ªå…±äº«å˜é‡æ—¶ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹èƒ½ç«‹é©¬è¯»åˆ°è¿™ä¸ªä¿®æ”¹çš„å€¼ã€‚
> 3. volatile è¿˜å¯ä»¥==é˜²æ­¢é‡æŽ’åº==ã€‚å³ä¿è¯==è¢« volatile ä¿®é¥°çš„å˜é‡ä¹‹å‰çš„ä»£ç ä¸€å®šä¼šåœ¨å…¶ä¹‹å‰æ‰§è¡Œ==ï¼Œä½†æ˜¯å¹¶ä¸èƒ½ä¿è¯åŽé¢çš„ä»£ç ä¸ä¼šè¿›è¡Œé‡æŽ’åºã€‚
> 4. ä½†æ˜¯è¢« volatile ä¿®é¥°çš„å˜é‡==è¿˜æ˜¯å¯èƒ½å‡ºçŽ°çº¿ç¨‹ä¸å®‰å…¨çš„é—®é¢˜==ï¼Œå› ä¸º ==volatile ä¸èƒ½ä¿è¯åŽŸå­æ€§==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - volatie ç”¨äºŽä¿è¯æ‰€ä¿®é¥°å˜é‡å¯¹æ‰€æœ‰çº¿ç¨‹çš„==å¯è§æ€§==å’Œ==é¡ºåºæ€§==ã€‚
> - å¯è§æ€§å°±æ˜¯æŒ‡å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹ä¸€ä¸ªå…±äº«å˜é‡æ—¶ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹èƒ½ç«‹é©¬è¯»åˆ°è¿™ä¸ªä¿®æ”¹çš„å€¼ã€‚é¡ºåºæ€§å°±æ˜¯æŒ‡å¯¹ ==volatile å˜é‡çš„è¯»å†™æ“ä½œéƒ½æ˜¯æŒ‰é¡ºåºæ‰§è¡Œ==çš„ï¼Œä¸ä¼šå‡ºçŽ°é‡æŽ’åºæƒ…å†µã€‚
> - æ²¡æœ‰åŽŸå­æ€§æ˜¯å› ä¸ºï¼Œå®ƒ==åªå¯¹å•ä¸ª volatile å˜é‡çš„è¯»å†™å…·æœ‰åŽŸå­æ€§==ï¼Œå¦‚æžœæ˜¯==å¤šä¸ª volatile æ“ä½œæˆ–æ˜¯ volatile++ è¿™ç§å¤åˆæ“ä½œï¼Œæ•´ä½“ä¸Šä¸ä¿è¯åŽŸå­æ€§==ã€‚
>

---

==é—®é¢˜äºŒ==ï¼š==Volitale å¯è§æ€§åº•å±‚å®žçŽ°äº†è§£ä¸ï¼Ÿç®€å•è¯´ä¸€ä¸‹==

==æˆ‘çš„å›žç­”==ï¼š

> 1. å½“è¢« volatile ä¿®é¥°çš„å˜é‡åœ¨ç¼–è¯‘ä¹‹å‰ï¼Œä¼š==åœ¨ä¸‹é¢åŠ ä¸€è¡Œä»¥ `lock` å¼€å¤´çš„æŒ‡ä»¤==ï¼Œå½“å¤„ç†å™¨è¯»å–åˆ°ä»¥ `lock` å¼€å¤´çš„æŒ‡ä»¤æ—¶ï¼Œä¸ä¼šå†é”ä½æ€»çº¿ï¼Œè€Œæ˜¯ä¼šæ£€æŸ¥æ•°æ®æ‰€åœ¨çš„å†…å­˜åŒºåŸŸï¼Œå¦‚æžœ==è¯¥æ•°æ®æ˜¯åœ¨å¤„ç†å™¨çš„å†…éƒ¨ç¼“å­˜ä¸­ï¼Œåˆ™ä¼šé”å®šæ­¤ç¼“å­˜åŒºåŸŸï¼Œå¤„ç†å®ŒåŽæŠŠç¼“å­˜å†™å›žåˆ°ä¸»å­˜ä¸­==ï¼Œå¹¶ä¸”ä¼šåˆ©ç”¨==ç¼“å­˜ä¸€è‡´æ€§åè®®ï¼ˆMESI åè®®ï¼‰==æ¥ä¿è¯==å…¶ä»–å¤„ç†å™¨ä¸­çš„ç¼“å­˜æ•°æ®çš„ä¸€è‡´æ€§==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - å…¶å®žå°±æ˜¯åœ¨å¯¹ volatile å˜é‡è¿›è¡Œå†™æ“ä½œçš„æ±‡ç¼–ä»£ç ä¹‹å‰ï¼Œ==åŠ äº†ä¸€æ¡ Lock å‰ç¼€æŒ‡ä»¤==ã€‚è¿™ä¸ª Lock å‰ç¼€æŒ‡ä»¤åœ¨å¤šæ ¸å¤„ç†å™¨ä¸‹ä¼šå°†ï¼šå½“å‰==å¤„ç†å™¨ç¼“å­˜è¡Œçš„æ•°æ®å†™å›žåˆ°å†…å­˜==å¹¶ä½¿==å…¶å®ƒ CPU é‡Œç¼“å­˜äº†è¯¥å†…å­˜åœ°å€çš„æ•°æ®æ— æ•ˆ==ã€‚åŽè€…ä¸»è¦æ˜¯é€šè¿‡å¤„ç†å™¨éµå¾ª ==MESI åè®®==æ¥å®žçŽ°çš„ï¼Œæ¯ä¸ªå¤„ç†å™¨é€šè¿‡å—…æŽ¢æ€»çº¿æ¥æ£€æŸ¥è‡ªå·±çš„æ•°æ®æ˜¯å¦è¿‡æœŸï¼Œå¹¶åšå¯¹åº”çš„å¤„ç†ã€‚
>

---

==é—®é¢˜ä¸‰==ï¼š==ä½ è§‰å¾—ä»€ä¹ˆæ ·çš„åœºæ™¯ä¸‹éœ€è¦ç”¨åˆ° volitaleï¼Œå¯ä»¥ä½ è§è¿‡çš„ä¸€äº›ä¾‹å­å—ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. çŽ°å®žåœºæ™¯ä¸­å¦‚æžœè¦ç”¨åˆ° volatileï¼Œå¯ä»¥åˆ©ç”¨å®ƒçš„å¯è§æ€§å’Œé¡ºåºæ€§ã€‚
> 2. åˆ©ç”¨==å¯è§æ€§==çš„ä¾‹å­ï¼šç”¨äºŽ==æ ‡è®°çŠ¶æ€å˜é‡==ï¼Œæ¯”å¦‚åœ¨å¤šçº¿ç¨‹çš„æ¡ä»¶ä¸‹æŸä¸€ä¸ªçº¿ç¨‹å°†æ­¤çŠ¶æ€å˜é‡æ›´æ”¹ä¸º falseï¼Œé‚£ä¹ˆ==å…¶å®ƒçš„çº¿ç¨‹å¯ä»¥ç«‹å³å¯¹æ­¤å˜åŒ–åšå‡ºå“åº”==ã€‚
> 3. åˆ©ç”¨==é¡ºåºæ€§==çš„ä¾‹å­ï¼šæ¯”å¦‚==å•ä¾‹æ¨¡å¼==ä¸­å¯ä»¥ä½¿ç”¨ ==volatile ä¿®é¥°å•ä¾‹å®žä¾‹å¯¹è±¡==ï¼Œ==é˜²æ­¢åœ¨ç¼–è¯‘æœŸé—´å¯¹å…¶è¿›è¡Œé‡æŽ’åºï¼Œå¯¼è‡´å…ˆèµ‹åœ°å€ï¼Œåœ¨åˆ›å»ºå®žä¾‹å¯¹è±¡ï¼Œé€ æˆå¯èƒ½çš„ç©ºæŒ‡é’ˆå¼‚å¸¸==ã€‚
>

 ==å‚è€ƒç­”æ¡ˆ==ï¼š

> - volatile åŸºäºŽå¯è§æ€§ï¼Œæ¯”è¾ƒé€‚åˆç”¨äºŽ==æ ‡è®°ä¸€ä¸ªçŠ¶æ€å˜é‡==ã€‚æ¯”å¦‚åœ¨å¤šçº¿ç¨‹é—´æŽ§åˆ¶å¾ªçŽ¯æˆ–è€…ä»»åŠ¡çš„æ‰§è¡Œã€‚å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº† volatile ä¿®é¥°çš„çŠ¶æ€å˜é‡åŽï¼Œ==å…¶ä»–çº¿ç¨‹èƒ½ç«‹é©¬æ„ŸçŸ¥å¹¶åšå¯¹åº”çš„å¤„ç†==ã€‚
> - é™¤æ­¤ä¹‹å¤–ï¼Œå•ä¾‹æ¨¡å¼çš„ä¸€ç§å®žçŽ°æ˜¯åˆ©ç”¨åŒé‡æ£€æŸ¥é”å®šæ¥åˆ›å»ºå¯¹è±¡ï¼Œå…¶ä¸­å°±ç”¨åˆ°äº† ==volatile æ¥ä¿®é¥°é‚£ä¸ªå•ä¾‹å®žä¾‹==ï¼Œç›®çš„å°±åœ¨äºŽ==é¿å… new å¯¹è±¡æ—¶å¯èƒ½å‡ºçŽ°çš„æŒ‡ä»¤é‡æŽ’åºï¼Œå¯¼è‡´é”™è¯¯ç»“æžœ==ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸»è¦ç”¨åˆ°äº† volatile çš„é¡ºåºæ€§ã€‚
>

----



### 5.ã€å¹¶å‘ä¸“é¢˜ã€‘synchronized è¿žçŽ¯ç‚®ðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==é—®é¢˜ä¸€==ï¼š==ç®€å•è¯´ä¸€ä¸‹ synchronized çš„ä½œç”¨ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. synchronized å…³é”®å­—ä¸€èˆ¬ç”¨äºŽ==å¹¶å‘æŽ§åˆ¶==ï¼Œå®ƒæ˜¯ä¸€ç§==é‡é‡çº§é”==ï¼Œè¢« synchronized ä¿®é¥°çš„å…±äº«å˜é‡æˆ–å…±äº«ä»£ç å—æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œè®¿é—®å’Œæ“ä½œã€‚çº¿ç¨‹åœ¨è¿›å…¥ä¸´ç•ŒåŒºä¹‹å‰ï¼Œä¼šå°è¯•èŽ·å–é”ï¼Œå¦‚æžœèŽ·å–ä¸åˆ°åˆ™è¿›å…¥é˜»å¡žçŠ¶æ€ï¼Œç­‰å¾…å…¶å®ƒçº¿ç¨‹é‡Šæ”¾é”åŽå”¤é†’ã€‚æ¯”å¦‚åœ¨ç”µå•†ç³»ç»Ÿä¸­å­˜åœ¨å•†å“è¶…å–çš„é—®é¢˜ï¼Œå› ä¸ºè¿™ä¸ªè¿‡ç¨‹æœ‰ä¸‰ä¸ªæ“ä½œï¼Œç”±äºŽçº¿ç¨‹è°ƒåº¦ï¼Œåœ¨ä»»æ„ä¸€ä¸ªæ“ä½œå®Œæˆä¹‹åŽéƒ½å¯èƒ½åˆ‡æ¢åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ä¸Šï¼Œå› æ­¤ä¸èƒ½ä¿è¯åŽŸå­æ€§ã€‚è€Œå¦‚æžœç”¨ synchronized å…³é”®å­—ä¿®é¥°æ­¤ä»£ç å—ï¼Œå°±èƒ½ä¿è¯å…¶åŽŸå­æ€§ï¼Œä»Žè€Œè§£å†³å•†å“è¶…å–é—®é¢˜ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - synchronized ä¸»è¦ç”¨æ¥å®žçŽ°åŒæ­¥ï¼Œ==è¢« synchronized ä¿®é¥°çš„ä»£ç å—æˆ–æ–¹æ³•ç§°ä¸ºä¸´ç•ŒåŒºä»£ç ==ï¼Œåœ¨è¿›å…¥ä¸´ç•ŒåŒºä¹‹å‰ï¼Œ==çº¿ç¨‹ä¼šå°è¯•èŽ·å–é”==ï¼Œå¦‚æžœé”å¯ç”¨ï¼Œåˆ™çº¿ç¨‹ä¼šèŽ·å–é”å¹¶è¿›å…¥ä¸´ç•ŒåŒºï¼Œæ‰§è¡Œç›¸åº”çš„ä»£ç ã€‚å¦åˆ™çº¿ç¨‹å°†è¢«==é˜»å¡ž==ï¼Œç›´åˆ°èŽ·å–åˆ°é”ä¸ºæ­¢ã€‚
>

---

==é—®é¢˜äºŒ==ï¼š==synchronized åŠ åœ¨ç±»æ–¹æ³•ï¼Œéžç±»æ–¹æ³•ï¼Œä»£ç å—ä¸Šæ—¶ï¼Œæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ==

> ==synchronized ä¸èƒ½ä¿®é¥°å±žæ€§==ã€‚

==æˆ‘çš„å›žç­”==ï¼š

> 1. å½“ synchronized åŠ åœ¨è¢« static ä¿®é¥°çš„ç±»æ–¹æ³•ä¸Šæ—¶ï¼Œé”æ˜¯é»˜è®¤å¤¹åœ¨ç±»çš„ Class å¯¹è±¡ä¸Šçš„ã€‚
> 2. åŠ åœ¨éžç±»æ–¹æ³•ä¸Šæ—¶ï¼Œé”é»˜è®¤åŠ åœ¨å½“å‰çš„å®žä¾‹å¯¹è±¡ä¸Šã€‚
> 3. åŠ è½½ä»£ç å—ä¸Šæ—¶ï¼Œé”åŠ è½½ synchronized åŽé¢æ‹¬å·ä¸­æŒ‡å®šçš„å¯¹è±¡ä¸Šã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - å¯¹äºŽæ™®é€šåŒæ­¥æ–¹æ³•ï¼Œé”çš„æ˜¯å½“å‰çš„å®žä¾‹å¯¹è±¡ï¼›å¯¹äºŽé™æ€åŒæ­¥æ–¹æ³•ï¼Œé”çš„æ˜¯å½“å‰ç±»çš„ Class å¯¹è±¡ï¼›å¯¹äºŽåŒæ­¥ä»£ç å—ï¼Œé”çš„æ˜¯ synchronized æ‹¬å·é‡Œé…ç½®çš„å¯¹è±¡ã€‚
>

---

==é—®é¢˜ä¸‰==ï¼š==è®²ä¸€ä¸‹ synchronized çš„åº•å±‚æ˜¯æ€Žä¹ˆå®žçŽ°çš„ï¼Ÿï¼ˆPSï¼šåŠ åœ¨å®žä¾‹ä¸Šå’ŒåŠ åœ¨æ–¹æ³•ä¸Šï¼Œå®žçŽ°ä¸ä¸€æ ·ï¼Œéƒ½è¦è¯´æ˜Žï¼Œä¸€ä¸ªä»Žå­—èŠ‚ç è§’åº¦è¯´ï¼Œä¸€ä¸ªä»Žå¯¹è±¡å¤´è§’åº¦è¯´ï¼‰==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==è¢« synchronized ä¿®é¥°çš„ä»£ç å—ä¼šåœ¨ç¼–è¯‘çš„ä»£ç å‰åŽåˆ†åˆ«æ·»åŠ  monitorenter å’Œ monitorexit æŒ‡ä»¤==ã€‚JVM ç¡®ä¿è¢« synchronized é”å®šçš„å¯¹è±¡éƒ½ä¼šå¯¹åº”ä¸€ä¸ª ==monitor==ï¼Œå½“çº¿ç¨‹æ‰§è¡Œåˆ° ==monitorenter æ—¶ä¼šå°è¯•èŽ·å–å½“å‰çš„ monitor å¯¹è±¡==ï¼Œä¹Ÿå°±æ˜¯åŠ é”æ“ä½œï¼Œå¦‚æžœèŽ·å–ä¸åˆ°åˆ™ä¼šè¿›å…¥é˜»å¡žçŠ¶æ€ã€‚åŒæ ·çš„ï¼Œæ‰§è¡Œåˆ° ==monitorexit æŒ‡ä»¤æ—¶ä¼šé‡Šæ”¾è¿™ä¸ª monitor==ï¼Œä¹Ÿå°±æ˜¯è§£é”æ“ä½œï¼Œä»¥ä¾›å…¶å®ƒçº¿ç¨‹èŽ·å–ã€‚
> 2. è€Œå¯¹äºŽ==è¢« synchronized ä¿®é¥°çš„æ–¹æ³•==è€Œè¨€ï¼Œå¤„ç†å™¨é¦–å…ˆ==æŸ¥çœ‹å­—èŠ‚ç çš„æ–¹æ³•è¡¨çš„ access_flags å­—æ®µæ˜¯å¦æœ‰ ACC_SYNCHRONIZED æ ‡å¿—==ã€‚å¦‚æžœæœ‰åˆ™å°è¯•èŽ·å– monitor é”ï¼Œå¹¶åœ¨æ‰§è¡Œå®ŒåŽé‡Šæ”¾ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - å¯¹äºŽ==æ–¹æ³•çº§==çš„åŒæ­¥æ¥è¯´ï¼ŒJVM åˆ©ç”¨==æ–¹æ³•å¸¸é‡æ± ä¸­çš„ ACC_SYNCHRONIZED æ ‡å¿—==ï¼ˆ==æ–¹æ³•å­—èŠ‚ç çš„ access_flags å­—æ®µ==ï¼‰æ¥åŒºåˆ†ä¸€ä¸ªæ–¹æ³•æ˜¯å¦ä¸ºåŒæ­¥æ–¹æ³•ã€‚å½“çº¿ç¨‹è®¿é—®åŒæ­¥æ–¹æ³•æ—¶ï¼Œé¦–å…ˆä¼šæ£€æŸ¥è¿™ä¸ªæ ‡å¿—æ˜¯å¦è¢«è®¾ç½®ï¼Œå¦‚æžœæ˜¯ï¼Œåˆ™éœ€è¦å…ˆèŽ·å¾—ç›‘è§†å™¨é”ï¼Œç„¶åŽå¼€å§‹æ‰§è¡Œæ–¹æ³•ï¼Œæ‰§è¡Œç»“æŸä¼šé‡Šæ”¾ç›‘è§†å™¨é”ã€‚
> - å¯¹äºŽ==åŒæ­¥ä»£ç å—==æ¥è¯´ï¼ŒJVM æ˜¯åœ¨ç¼–è¯‘åŽä»£ç å—çš„å¼€å§‹å’Œç»“æŸå¤„ï¼Œ==æ’å…¥ monitorenter å’Œ monitorexit æŒ‡ä»¤==æ¥å®žçŽ°çš„ã€‚ä»»ä½•å¯¹è±¡éƒ½ä¼šå¯¹åº”ä¸€ä¸ª monitorï¼Œçº¿ç¨‹æ‰§è¡Œåˆ° monitorenter æ—¶ä¼šå°è¯•èŽ·å–å¯¹è±¡æ‰€å¯¹åº”çš„ monitor çš„æ‰€æœ‰æƒï¼Œä¹Ÿå°±æ˜¯åŠ é”ã€‚æ‰§è¡Œåˆ° monitorexit æ—¶ä¼šé‡Šæ”¾ monitor çš„æ‰€æœ‰æƒï¼Œä¹Ÿå°±æ˜¯è§£é”ã€‚
>

---

==é—®é¢˜å››==ï¼š==åœ¨ Java ä¸­ï¼Œsynchronized å±žäºŽé‡é‡çº§é”ï¼Œä¸ºäº†è®© synchronized æ•ˆçŽ‡æ›´å¿«ï¼ŒJDKåšäº†å“ªäº›å‡çº§ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ç”±äºŽé‡é‡çº§é”æ¶‰åŠåˆ°å¤§é‡çš„çº¿ç¨‹é˜»å¡žå’Œå”¤é†’æ“ä½œï¼Œè¿™ä½¿å¾—æ“ä½œç³»ç»Ÿé¢‘ç¹çš„åœ¨ç”¨æˆ·æ€å’Œå†…æ ¸æ€ä¹‹é—´åˆ‡æ¢ï¼Œæ¶ˆè€—å¤§é‡çš„æ—¶é—´ã€‚å› æ­¤ä¸ºäº†æå‡æ•ˆçŽ‡ï¼Œå¯ä»¥è€ƒè™‘å‡å°‘é˜»å¡žå’Œå”¤é†’æ“ä½œçš„é¢‘çŽ‡ã€‚
> 2. å…·ä½“çš„æŽªæ–½æ˜¯==é¦–å…ˆä½¿ç”¨åå‘é”ï¼Œå¦‚æžœäº§ç”Ÿå†²çªåˆ™é™çº§ä¸ºè½»é‡çº§é”ï¼Œå†äº§ç”Ÿå†²çªæ‰é™çº§ä¸ºé‡é‡çº§é”==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - Java 1.6 ä»¥åŽä¸»è¦å¼•å…¥äº†åå‘é”ï¼Œè½»é‡çº§é”å’Œé€‚åº”æ€§è‡ªæ—‹ç­‰ç‰¹æ€§ã€‚æ€»ä½“ä¸Šæ¥è¯´ï¼Œé”å‡çº§çš„è¿‡ç¨‹ä¸ºï¼šæ— é”->åå‘é”->è½»é‡çº§é”->é‡é‡çº§é”ã€‚
> - å¯¹äºŽåå‘é”æ¥è¯´ï¼Œé¦–æ¬¡èŽ·å–æ—¶éœ€è¦ç”¨ CAS è®¾ç½® Java å¯¹è±¡å¤´ä¸­ mark word å­—æ®µçš„çº¿ç¨‹ id ï¼Œä¹‹åŽæŒæœ‰åå‘é”çš„çº¿ç¨‹æ¯æ¬¡è¿›å…¥è¿™ä¸ªé”ç›¸å…³çš„åŒæ­¥å—æ—¶ï¼Œåªéœ€æ¯”å¯¹ä¸€ä¸‹æ˜¯å¦ä¸ºæœ¬çº¿ç¨‹ï¼Œå¦‚æžœæ˜¯åˆ™ç›´æŽ¥èŽ·å–é”æˆåŠŸã€‚==è¿™é€‚ç”¨åœ¨ä¸€ä¸ªçº¿ç¨‹åå¤èŽ·å–åŒä¸€ä¸ªé”çš„æƒ…å†µ==ï¼Œå¯ä»¥æé«˜å¸¦æœ‰åŒæ­¥ä½†æ— ç«žäº‰çš„ç¨‹åºæ€§èƒ½ã€‚
> - åå‘é”ä¸­å‘ç”Ÿçº¿ç¨‹ç«žäº‰ï¼Œä¼šå‡çº§ä¸ºè½»é‡çº§é”ã€‚è½»é‡çº§é”åœ¨æ¯æ¬¡èŽ·å–æ—¶éƒ½éœ€è¦ç”¨ ==CAS== æ¯”è¾ƒå¹¶æ›¿æ¢å¯¹è±¡å¤´ä¸­çš„æ•´ä¸ª Mark Wrod å­—æ®µï¼Œå¦‚æžœ CAS æˆåŠŸåˆ™ä»£è¡¨èŽ·å–é”æˆåŠŸã€‚ç”±äºŽç»å¤§éƒ¨åˆ†çš„é”åœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…éƒ½ä¸ä¼šå­˜åœ¨ç«žäº‰ï¼Œé‚£ä¹ˆåœ¨å¤šçº¿ç¨‹äº¤æ›¿æ‰§è¡ŒåŒæ­¥å—çš„æƒ…å†µä¸‹ï¼Œè½»é‡çº§é”å¯ä»¥é¿å…é‡é‡çº§é”å¼•èµ·çš„æ€§èƒ½æ¶ˆè€—ã€‚
> - è½»é‡çº§é”é‡Šæ”¾æ—¶è‹¥å­˜åœ¨å…¶å®ƒçº¿ç¨‹ç«žäº‰ï¼Œé”å°†è†¨èƒ€ä¸ºé‡é‡çº§é”ï¼Œ==ä»»ä½•æ²¡æœ‰ç«žäº‰åˆ°é”çš„çº¿ç¨‹éƒ½ä¼šè¢«é˜»å¡žï¼Œç›´åˆ°è¢«å…¶å®ƒçº¿ç¨‹å”¤é†’==ã€‚ä½†çº¿ç¨‹å”¤é†’çš„è¿‡ç¨‹æ¶‰åŠåˆ°æ“ä½œç³»ç»Ÿçš„è°ƒç”¨ï¼Œä¼šæœ‰é¢å¤–çš„å¼€é”€ã€‚
> - ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œåœ¨çº¿ç¨‹ç«žäº‰è½»é‡çº§é”å¤±è´¥åŽï¼Œ==è†¨èƒ€ä¸ºé‡é‡çº§é”ä¹‹å‰çº¿ç¨‹ä¼šå°è¯•é€‚åº”æ€§è‡ªæ—‹ï¼ˆå¾ªçŽ¯å¤šæ¬¡å°è¯•èŽ·å–é”ï¼Œè€Œä¸æ˜¯æ²¡å¾—åˆ°å°±ç›´æŽ¥é˜»å¡žï¼‰==ï¼Œ==è‡ªæ—‹çš„æ¬¡æ•°æ ¹æ®å‰ä¸€æ¬¡åœ¨åŒä¸€ä¸ªé”ä¸Šçš„è‡ªæ—‹æ—¶é—´åŠé”çš„æ‹¥æœ‰è€…çš„çŠ¶æ€æ¥å†³å®š==ã€‚å¦‚æžœè¿™ä¸ªé”å¾ˆå°‘è‡ªæ—‹æˆåŠŸï¼Œé‚£ä¹ˆä»¥åŽæœ‰å¯èƒ½çœç•¥æŽ‰è‡ªæ—‹è¿‡ç¨‹ä»¥é¿å… CPU èµ„æºæµªè´¹ã€‚
>

---



### 6.ã€å¹¶å‘ä¸“é¢˜ã€‘AQS è¿žçŽ¯ç‚®ðŸŒŸðŸŒŸï¼ˆè¿˜æ²¡å­¦å‘¢ï¼‰



### 7.ã€å¹¶å‘ä¸“é¢˜ã€‘ReentrantLock è¿žçŽ¯ç‚®ðŸŒŸðŸŒŸ

==é—®é¢˜ä¸€==ï¼š==ç®€å•ä»‹ç»ä¸‹ ReentrantLockï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ReenTrantLock æ„ä¸º==å¯é‡å…¥é”==ï¼Œå³==å·²ç»èŽ·å–é”çš„çº¿ç¨‹å¯ä»¥å†æ¬¡èŽ·å–é”èµ„æº==ã€‚
> 1. ReenTrantLock çš„==åº•å±‚æ˜¯ AQS==ï¼Œåœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­åŠ é”æ—¶é€’å¢žï¼Œé‡Šæ”¾é”æ—¶é€’å‡ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ReentrantLock æ˜¯ Java ä¸­==é‡å…¥é”==çš„ä¸€ç§å®žçŽ°ï¼Œå¯ä»¥æ”¯æŒ==ä¸€ä¸ªçº¿ç¨‹å¯¹æŸä¸ªèµ„æºçš„é‡å¤åŠ é”==ï¼Œ==åº•å±‚æ˜¯åŸºäºŽ AQS å®žçŽ°==ï¼Œåœ¨åŒä¸€ä¸ªçº¿ç¨‹åŠ é”æ—¶é€’å¢žï¼Œé‡Šæ”¾é”æ—¶é€’å‡åŒæ­¥çŠ¶æ€çš„å€¼ã€‚
>

---

==é—®é¢˜äºŒ==ï¼š==synchronized å’Œ ReentrantLock æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ä¸¤è€…==éƒ½æ”¯æŒé‡å…¥==ï¼Œä½†æ˜¯ ==synchronized çš„é‡å…¥æ˜¯éšå¼çš„==ï¼Œæ¯”å¦‚é€’å½’è°ƒç”¨ä¸€ä¸ªè¢« synchronized ä¿®é¥°çš„æ–¹æ³•ï¼›è€Œ ==ReenTrantLock æ”¯æŒæ˜¾ç¤ºé‡å…¥==ï¼Œä½¿ç”¨ lock æ–¹æ³•ã€‚
> 2. ReenTrantLock æ¯” synchronized æ›´åŠ çµæ´»ã€‚ReentrantLock æä¾›æœ‰ ==tryLock( )ï¼Œå¯ä»¥å°è¯•èŽ·å–é”è€Œä¸é˜»å¡ž==ï¼Œå¹¶ä¸”å¯ä»¥è®¾ç½®==è¶…æ—¶æ—¶é—´==ã€‚
> 3. ReenTrantLock å¯ä»¥è®¾ç½®==å…¬å¹³é”æˆ–éžå…¬å¹³é”==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ä¸¤è€…ç›¸åŒä¹‹å¤„åœ¨äºŽ==éƒ½æ”¯æŒé‡å…¥æ€§==ï¼Œsynchronized æ”¯æŒ==éšæ€§==çš„é‡è¿›å…¥ï¼Œæ¯”å¦‚çº¿ç¨‹å¯ä»¥åœ¨é€’å½’æ‰§è¡ŒåŒæ­¥å—é‡Œçš„ä»£ç è€Œä¸è¢«é˜»å¡žï¼ŒReentrantLock éœ€è¦æ˜¾ç¤ºè°ƒç”¨ lock( )ã€‚
> - ä¸åŒä¹‹å¤„åœ¨äºŽ ReentrantLock æ¯” synchronized æ›´åŠ çµæ´»ã€‚ReentrantLock æä¾›æœ‰ ==tryLock( )ï¼Œå¯ä»¥å°è¯•èŽ·å–é”è€Œä¸é˜»å¡ž==ï¼Œå¹¶ä¸”å¯ä»¥è®¾ç½®==è¶…æ—¶æ—¶é—´==ã€‚é™¤æ­¤ä¹‹å¤– ReentrantLock è¿˜æ”¯æŒèŽ·å–é”æ—¶çš„å…¬å¹³å’Œéžå…¬å¹³æ€§é€‰æ‹©ã€‚
>

---

==é—®é¢˜ä¸‰==ï¼š==æ—¢ç„¶è¯´åˆ°äº†å¯é‡å…¥é”ï¼Œé‚£ä½ è§‰å¾—ä¸ºå•¥éœ€è¦å¯é‡å…¥é”ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. å¯é‡å…¥é”ä¸»è¦æ˜¯ä¸ºäº†==é¿å…æ­»é”==ã€‚æ¯”å¦‚ä¸€ä¸ªçº¿ç¨‹èŽ·å–äº†éžå¯é‡å…¥é”ï¼Œå¦‚æžœå†æ¬¡å°è¯•èŽ·å–è¯¥é”ï¼Œåˆ™ä¼šå› ä¸º==æ— é™ç­‰å¾…è‡ªå·±ç”³è¯·çš„é”è€Œé™·å…¥æ­»é”==ã€‚è€Œå¯é‡å…¥é”åˆ™ä¸ä¼šå‡ºçŽ°è¿™ä¸ªé—®é¢˜ã€‚
> 2. åœ¨å®žé™…çš„åœºæ™¯ä¸­æ¯”å¦‚åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­==é€’å½’è°ƒç”¨ä¸€ä¸ªä½¿ç”¨é”çš„æ–¹æ³•==ï¼Œå¦‚æžœé”ä¸å¯é‡å…¥ï¼Œé‚£ä¹ˆè¯¥çº¿ç¨‹è°ƒç”¨çš„æ—¶å€™å°±ä¼šè¢«é€’å½’æ ˆé‡Œçš„å‰ä¸€ä¸ªæ–¹æ³•æ‰€é˜»å¡žï¼Œé™·å…¥æ­»é”ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - å¯é‡å…¥é”ä¸»è¦æ˜¯ç”¨æ¥è§£å†³çº¿ç¨‹åœ¨æŒæœ‰é”çš„æƒ…å†µä¸‹ï¼Œå†æ¬¡è¯·æ±‚åŒä¸€ä¸ªé”æ—¶å‘ç”Ÿçš„æ­»é”é—®é¢˜ã€‚å¦‚æžœæ²¡æœ‰å¯é‡å…¥é”ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å·²ç»èŽ·å–äº†é”åŽï¼Œå†æ¬¡è¯·æ±‚è¯¥é”ä¼šå¯¼è‡´è‡ªå·±è¦ç­‰å¾…è‡ªå·±é‡Šæ”¾é”ï¼Œè¿›è€Œäº§ç”Ÿæ­»é”ã€‚
> - å…·ä½“çš„åœºæ™¯æ¯”å¦‚ï¼Œé€’å½’å‡½æ•°ä¸­éœ€è¦èŽ·å–é”ï¼Œå¦‚æžœæ²¡æœ‰é‡å…¥é”ï¼Œçº¿ç¨‹åœ¨æ¯æ¬¡é€’å½’è°ƒç”¨æ—¶éƒ½ä¼šè¢«è‡ªå·±é˜»å¡žã€‚è¿˜æœ‰å¤šä¸ªæ–¹æ³•å¯èƒ½éƒ½éœ€è¦èŽ·å–ç›¸åŒçš„é”ï¼Œæ²¡æœ‰é‡å…¥é”çš„è¯ï¼Œå®ƒä»¬ä¹‹é—´å°±ä¸èƒ½ç›¸äº’è°ƒç”¨ã€‚
>

---

==é—®é¢˜å››==ï¼š==ReentrantLock åº•å±‚æ˜¯æ€Žä¹ˆå®žçŽ°çš„ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ReenTrantLock çš„==åº•å±‚æ˜¯ AQS==ï¼ˆAbstractQueuedSynchronizer æŠ½è±¡åŒæ­¥é˜Ÿåˆ—ï¼‰
> 2. å½“å·²ç»èŽ·å–é”çš„çº¿ç¨‹å†æ¬¡å°è¯•==èŽ·å–é”==æ—¶ï¼ŒAQS ä¸­è¢« ==volatile ä¿®é¥°çš„ int å˜é‡è‡ªå¢ž==ï¼Œè¡¨ç¤ºå¢žåŠ äº†ä¸€å±‚é”ã€‚
> 3. è€Œå½“å°è¯•==é‡Šæ”¾é”==æ—¶ï¼Œ==è¯¥å€¼è‡ªå‡ï¼Œå‡åˆ°é›¶æ—¶è¡¨ç¤ºè¯¥çº¿ç¨‹ä¸Šçš„é”å…¨éƒ¨é‡Šæ”¾==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ReentrantLock éœ€è¦åœ¨ AQS çš„åŸºç¡€ä¸Šå¤šè€ƒè™‘ä¸¤ä¸ªé—®é¢˜ï¼Œä¸€ä¸ªæ˜¯èŽ·å–é”çš„çº¿ç¨‹==å†æ¬¡èŽ·å–é”==çš„åˆ¤æ–­ï¼Œæ­¤æ—¶éœ€è¦å°†åº•å±‚==è¡¨ç¤ºåŒæ­¥çŠ¶æ€ volatile int ç±»åž‹çš„å€¼ + 1==ã€‚å¦ä¸€ä¸ªæ˜¯é”çš„æœ€ç»ˆé‡Šæ”¾ï¼Œçº¿ç¨‹é‡å¤èŽ·å– n æ¬¡é”ï¼Œé‚£ä¹ˆé‡Šæ”¾æ—¶ä¹Ÿè¦é‡å¤é‡Šæ”¾ n æ¬¡ï¼Œå¯¹åº”åŒæ­¥çŠ¶æ€çš„å€¼è‡ªå‡ï¼Œç›´è‡³==ä¸º 0 ä»£è¡¨é”å·²æˆåŠŸé‡Šæ”¾==ã€‚
>

---



### 8.ã€å¹¶å‘ä¸“é¢˜ã€‘threadLocal è¿žçŽ¯ç‚®ðŸŒŸðŸŒŸ

==é—®é¢˜ä¸€==ï¼š==ä»‹ç»ä¸€ä¸‹ threadLocalï¼Œç®€å•è¯´ä¸€ä¸‹ä»–çš„ä½¿ç”¨åœºæ™¯ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ThreadLocal ä¸­æœ‰ä¸€ä¸ª==å†…éƒ¨ç±» ThreadLocalMap==ï¼›
> 2. è€Œåœ¨ ==Thread ç±»ä¸­æœ‰ä¸€ä¸ªå±žæ€§ threadLocalsï¼Œå…¶ç±»åž‹å°±æ˜¯ ThreadLocal.ThreadLocalMap==ã€‚è®¾è®¡è¿™ä¸ªå±žæ€§çš„ç›®çš„æ˜¯åœ¨ ==Thread ä¸­åˆ›å»ºä¸€ä¸ªåªå±žäºŽè¯¥çº¿ç¨‹çš„ç©ºé—´ï¼Œç”¨äºŽå­˜å‚¨åªå±žäºŽè¯¥çº¿ç¨‹çš„æ•°æ®==ï¼Œé˜²æ­¢å¤šçº¿ç¨‹å¹¶å‘çš„æƒ…å†µä¸‹ç”±äºŽçº¿ç¨‹è°ƒåº¦çš„åŽŸå­æ€§é—®é¢˜äº§ç”Ÿçš„æ•°æ®è¦†ç›–ç­‰é—®é¢˜ï¼Œ==ä¿è¯å¹¶å‘å®‰å…¨==ã€‚
> 3. æ¯”å¦‚åœ¨æ¶‰åŠåˆ°ç”¨æˆ·ç™»å½•çš„ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªç”¨äºŽ==å­˜å‚¨å„çº¿ç¨‹çš„ User å¯¹è±¡çš„ ThreadLocal å®žä¾‹==ï¼Œä½¿ç”¨å…¶ set æ–¹æ³•ï¼Œä»¥è¯¥ ThreadLocal å®žä¾‹ä¸º keyï¼Œå°† `(ThreadLocal, value)` é”®å€¼å¯¹å­˜å‚¨åˆ°å„ä¸ªçº¿ç¨‹çš„ threadLocals å±žæ€§ä¸­ï¼›ç„¶åŽåœ¨åŽç»­éœ€è¦å„ä¸ªçº¿ç¨‹çš„ User å¯¹è±¡æ—¶ï¼Œä½¿ç”¨ ThreadLocal.get æ–¹æ³•ï¼Œä»¥è¯¥ ThreadLocal å®žä¾‹ä¸º keyï¼Œä»Žå½“å‰çº¿ç¨‹çš„ threadLocals å±žæ€§ä¸­å–å‡ºè‡ªå·± Userã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ThreadLocal ç”¨äºŽæä¾›çº¿ç¨‹çš„å±€éƒ¨å˜é‡ï¼Œ==åœ¨å¤šçº¿ç¨‹çŽ¯å¢ƒå¯ä»¥ä¿è¯å„ä¸ªçº¿ç¨‹é‡Œçš„å˜é‡ç‹¬ç«‹äºŽå…¶å®ƒçº¿ç¨‹==ï¼Œæ˜¯ä¸€ä¸ªä»¥ ThreadLocal å¯¹è±¡ä¸ºé”®ï¼Œä»»æ„å¯¹è±¡ä¸ºå€¼çš„å­˜å‚¨ç»“æž„ã€‚==åº•å±‚æ˜¯ ThreadLocalMap==ã€‚å®ƒå¯ä»¥ç”¨äºŽå¤šçº¿ç¨‹å¤„ç†å¤šä»»åŠ¡çš„åœºæ™¯ï¼Œ==æ¯ä¸ªçº¿ç¨‹ä½¿ç”¨ ThreadLocal å•ç‹¬ä¿å­˜è‡ªå·±çš„ä»»åŠ¡ä¸Šä¸‹æ–‡==ï¼Œç„¶åŽæ‰§è¡Œè®¡ç®—ã€‚
>

---

==é—®é¢˜äºŒ==ï¼š==ThreadLocalçš„keyæ˜¯å“ªç§å¼•ç”¨ç±»åž‹ï¼Ÿä¸ºå•¥è¿™ä¹ˆè®¾è®¡ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==å¼±å¼•ç”¨==ã€‚è¿™æ ·è®¾è®¡æ˜¯ä¸ºäº†==é˜²æ­¢æŸäº›æƒ…å†µä¸‹ ThreadLocal å¯èƒ½ä¼šå¯¼è‡´çš„å†…å­˜æ³„æ¼==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ==å¼±å¼•ç”¨==ã€‚è¿™æ ·è®¾è®¡æ˜¯ä¸ºäº†==é˜²æ­¢æŸäº›æƒ…å†µä¸‹ ThreadLocal å¯èƒ½ä¼šå¯¼è‡´çš„å†…å­˜æ³„æ¼==ã€‚
>

---

==é—®é¢˜ä¸‰==ï¼š==ThreadLocal æ˜¯æ€Žä¹ˆé˜²æ­¢å†…å­˜æ³„æ¼ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. Thread.threadLocals ä¸­çš„ ==Entry å¯¹ ThreadLocal çš„å¼•ç”¨æ˜¯å¼±å¼•ç”¨==ï¼Œå› æ­¤==åœ¨å †æ ˆå¯¹ ThreadLocal çš„å¼•ç”¨ç½®ä¸º null ä¹‹åŽï¼Œå°±ä¼šå¯¹ ThreadLocal è¿›è¡Œåžƒåœ¾å›žæ”¶==ã€‚ä½†æ˜¯æ­¤æ—¶ç”±äºŽ Thread.threadLocal.entry.value ä»ç„¶==å¯¹ value æœ‰å¼ºå¼•ç”¨==ï¼Œå› æ­¤ ==value å¹¶ä¸ä¼šè¢«åžƒåœ¾å›žæ”¶ï¼Œå³ value ä¼šå‘ç”Ÿå†…å­˜æ³„æ¼==ã€‚
> 2. è§£å†³ä¸Šè¿°å†…å­˜æ³„éœ²çš„æ–¹æ³•åˆ™æ˜¯==æ¯æ¬¡ç”¨å®Œ ThreadLocal ä¹‹åŽéƒ½è°ƒç”¨ ThreadLocal.remove()==ï¼Œ==æ¸…é™¤å½“å‰ ThreadLocal.threadLocal.entryï¼Œè¿™æ ·å°±èƒ½ä½¿å¾— value ä¹Ÿä¼šæ­£å¸¸è¢«åžƒåœ¾å›žæ”¶==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ç®€å•æ¥è¯´æ˜¯==ã€Œå¼±å¼•ç”¨ã€åŠ ã€Œæ‰‹åŠ¨è°ƒç”¨ remove( ) ã€==æ–¹æ³•ã€‚
> - å› ä¸º ThreadLocalMap ä¸»è¦æœ‰ä¸€ä¸ª Entry æ•°ç»„ï¼Œæ¯ä¸€ä¸ª ==Entry æ˜¯ç»§æ‰¿äº† ThreadLocal ç±»åž‹çš„å¼±å¼•ç”¨==ï¼Œå¹¶å°†å…¶ä½œä¸º keyã€‚value æ˜¯ Entry ä¸­çš„ä¸€ä¸ª Object æˆå‘˜å˜é‡ã€‚é‚£ä¹ˆæˆ‘ä»¬åœ¨åˆ›å»º ThreadLocal å˜é‡æ—¶ï¼Œ==æ¯ä¸€ä¸ª ThreadLocal å¯¹è±¡å°±æœ‰ä¸¤ä¸ªå¼•ç”¨ï¼Œä¸€ä¸ªæ˜¯å †æ ˆå¯¹å®ƒçš„å¼ºå¼•ç”¨ï¼Œä¸€ä¸ªæ˜¯ ThreadLocalMap ä¸­çš„ Entry å¯¹å®ƒçš„å¼±å¼•ç”¨==ã€‚
> - çŽ°åœ¨å‡è®¾ Entry æ˜¯å¯¹ ThreadLocal çš„å¼ºå¼•ç”¨è€Œä¸æ˜¯å¼±å¼•ç”¨ï¼Œåœ¨==å°† ThreadLocal ç½®ç©ºåŽï¼Œå †æ ˆä¸Šçš„ ThreadLocal å¼ºå¼•ç”¨å°±ä¼šæ¶ˆå¤±==ï¼Œä½† Entry å¯¹å®ƒçš„å¼ºå¼•ç”¨è¿˜åœ¨ï¼Œæ— æ³•è¢«å›žæ”¶ï¼Œå¹¶ä¸” ==Entry çš„ value å€¼ä¹Ÿæ˜¯ä¸ªå¼ºå¼•ç”¨ï¼Œä¹Ÿæ— æ³•è¢«å›žæ”¶ï¼Œè¿™å°±å¯¼è‡´äº†å†…å­˜æ³„æ¼==ã€‚
> - ==å°† Entry ç»§æ‰¿è‡ª ThreadLocal çš„å¼±å¼•ç”¨å¯ä»¥è§£å†³ ThreadLocal çš„å›žæ”¶é—®é¢˜==ï¼Œä½†è¿˜æ˜¯æ— æ³•è§£å†³ value çš„å›žæ”¶é—®é¢˜ã€‚ThreadLocal åœ¨è®¾è®¡æ—¶å°±è€ƒè™‘åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œå¹¶ä¸”æœ‰ä¸€äº›é˜²æŠ¤æŽªæ–½ï¼š==åœ¨è°ƒç”¨ ThreadLocal çš„ get( )ï¼Œset( ) å’Œ remove( ) çš„æ—¶å€™éƒ½ä¼šæ¸…é™¤å½“å‰çº¿ç¨‹ ThreadLocalMap ä¸­æ‰€æœ‰ key ä¸º null çš„ value==ã€‚æ‰€ä»¥åœ¨ä½¿ç”¨ ThreadLocal çš„æ—¶å€™ï¼Œ==æ¯æ¬¡ç”¨å®Œéƒ½æœ€å¥½æ‰‹åŠ¨è°ƒç”¨ä¸€ä¸‹ remove( ) æ–¹æ³•ï¼Œæ¥é˜²æ­¢å†…å­˜æ³„æ¼==ã€‚
>

---



### 9.ã€å¹¶å‘ä¸“é¢˜ã€‘çº¿ç¨‹æ±  è¿žçŽ¯ç‚®ðŸŒŸðŸŒŸðŸŒŸ

==é—®é¢˜ä¸€==ï¼š==ä¸ºä»€ä¹ˆè¦ä½¿ç”¨çº¿ç¨‹æ± ï¼Ÿçº¿ç¨‹æ± æ˜¯æ€Žä¹ˆæå‡æ•ˆçŽ‡çš„ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==å‡å°‘é‡å¤åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹æ‰€å ç”¨çš„å¤§é‡æ—¶é—´==ï¼Œä»Žè€Œæå‡å¯¹ä»»åŠ¡çš„å“åº”é€Ÿåº¦ã€‚
> 2. æ¯”å¦‚æˆ‘ä»¬æœ‰1000ä¸ªä»»åŠ¡éœ€è¦æ‰§è¡Œï¼Œå¦‚æžœåˆ›å»º1000ä¸ªçº¿ç¨‹çš„è¯ï¼Œå°±ä¼šåœ¨åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹çš„è¿‡ç¨‹ä¸­æµªè´¹å¤§é‡çš„æ—¶é—´ã€‚è€Œå¦‚æžœä½¿ç”¨çº¿ç¨‹æ± ï¼Œæˆ‘ä»¬åªéœ€åˆ›å»ºä¸€å®šæ•°é‡çš„çº¿ç¨‹æ¥æ‰§è¡Œå³å¯ã€‚
> 3. å¦ä¸€æ–¹é¢ï¼Œé€šè¿‡çº¿ç¨‹æ± å¯ä»¥==å¯¹è¿™äº›çº¿ç¨‹è¿›è¡Œç»Ÿä¸€çš„é…ç½®å’Œç®¡ç†==ï¼Œæ¯”å¦‚å¯ä»¥ä½¿ç”¨ shutdown æ¥ç»Ÿä¸€åœ°è®©çº¿ç¨‹æ± ä¸­çš„æ‰€æœ‰çº¿ç¨‹åœæ­¢æŽ¥æ”¶æ–°çš„ä»»åŠ¡ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥é¿å…æ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹å¸¦æ¥çš„==éš¾ä»¥ç®¡ç†==å’Œ==é¢‘ç¹åˆ›å»ºå¼€é”€å¤§==çš„ç¼ºç‚¹ã€‚åˆç†çš„ä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥==é™ä½Žèµ„æºæ¶ˆè€—ï¼Œæé«˜å“åº”é€Ÿåº¦å’Œæé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§==ã€‚
> - å…·ä½“æ¥è¯´ï¼Œçº¿ç¨‹æ± å¯ä»¥==é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹ï¼Œæ¥é™ä½Žçº¿ç¨‹åˆ›å»ºå’Œé”€æ¯å¸¦æ¥çš„å¼€é”€==ï¼›åŒæ—¶ä¹Ÿå¯ä»¥ä½¿==ä»»åŠ¡åˆ°è¾¾æ—¶å°±å¯ä»¥ç«‹åˆ»æ‰§è¡Œï¼Œå“åº”é€Ÿåº¦å¿«ï¼ˆçœä¸‹æ¥é¢å¤–åˆ›å»ºæ–°çº¿ç¨‹çš„æ—¶é—´ï¼‰==ï¼›çº¿ç¨‹æ± è¿˜å¯ä»¥å¯¹åˆ›å»ºçš„çº¿ç¨‹è¿›è¡Œ==ç»Ÿä¸€åˆ†é…ï¼Œè°ƒåº¦å’Œç›‘æŽ§==ã€‚
>

---

==é—®é¢˜äºŒ==ï¼š==ç®€å•è¯´ä¸€ä¸‹çº¿ç¨‹æ± éƒ½æœ‰å“ªäº›å¯é€‰å‚æ•°ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==corePoolSize==ï¼š==æ ¸å¿ƒçº¿ç¨‹æ•°==ï¼Œå¦‚æžœæ–°ä»»åŠ¡äº§ç”Ÿæ—¶ï¼Œçº¿ç¨‹æ± çº¿ç¨‹==æ€»æ•°æ²¡æœ‰åˆ°è¾¾ corePoolSizeï¼Œåˆ™ä¼šç›´æŽ¥åˆ›å»ºæ–°çš„çº¿ç¨‹æ‰§è¡Œæ­¤ä»»åŠ¡==ï¼Œå¹¶ä¸”å°±ç®—==æ²¡æœ‰ä»»åŠ¡å¯æ‰§è¡Œï¼Œæ ¸å¿ƒçº¿ç¨‹ä¹Ÿä¸ä¼šè¢«é”€æ¯==ã€‚
> 2. ==maxPoolSize==ï¼š==æœ€å¤§çº¿ç¨‹æ•°==ï¼Œå¦‚æžœå½“å‚¨å­˜é˜Ÿåˆ—ï¼ˆworkingQueueï¼‰è¢«å¡«æ»¡äº†ï¼Œè¿˜æœ‰æ–°ä»»åŠ¡æ—¶ï¼Œå¦‚æžœæ²¡æœ‰è¾¾åˆ° maxPoolSizeï¼Œåˆ™ä¼šåˆ›å»ºæ–°çš„çº¿ç¨‹ã€‚==è¶…è¿‡ keepAliveTime æ²¡æœ‰ä»»åŠ¡æ‰§è¡Œï¼Œåˆ™ä¼šå°†æ­¤çº¿ç¨‹é”€æ¯==ã€‚
> 3. ==keepAliveTime==ï¼šéžæ ¸å¿ƒçº¿ç¨‹ keepAliveTime æ²¡æœ‰æ‰§è¡Œä»»åŠ¡åˆ™ä¼šé”€æ¯ã€‚
> 4. ==workQueue==ï¼šä»»åŠ¡å‚¨å­˜é˜Ÿåˆ—ã€‚è¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°åŽçš„æ–°ä»»åŠ¡æ”¾åˆ°å‚¨å­˜é˜Ÿåˆ—ä¸­ã€‚
> 5. ==threadFactory==ï¼šä½¿ç”¨ threadFactory åˆ›å»ºæ–°çš„çº¿ç¨‹ã€‚
> 6. ==Handler==ï¼šç±»åž‹æ˜¯ ==RejectedExecutionHandler==ï¼Œæ‹’ç»ä»»åŠ¡æ—¶çš„ä¸šåŠ¡é€»è¾‘ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - Java å¯ä»¥ä½¿ç”¨ ==ThreadPoolExecutor ç±»æ¥æ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹æ± ==ï¼Œå®ƒçš„æž„é€ å‚æ•°æœ‰ä¸ƒä¸ªï¼Œæœ‰ï¼šçº¿ç¨‹æ± çš„æ ¸å¿ƒçº¿ç¨‹æ•°å’Œæœ€å¤§çº¿ç¨‹æ•°ï¼Œç©ºé—²çº¿ç¨‹çš„å­˜æ´»æ—¶é•¿å’Œæ—¶é•¿å•ä½ï¼Œå­˜æ”¾ä»»åŠ¡çš„é˜»å¡žé˜Ÿåˆ—ï¼Œçº¿ç¨‹å·¥åŽ‚å’Œæ‹’ç»æ‰§è¡Œç­–ç•¥ã€‚
> - å…¶ä¸­å­˜æ”¾ä»»åŠ¡çš„==é˜»å¡žé˜Ÿåˆ—å¸¸è§çš„æœ‰å››ç§å¯é€‰==ï¼Œå‰ä¸¤ç§åˆ†åˆ«æ˜¯==åŸºäºŽæ•°ç»„æˆ–é“¾è¡¨çš„é˜Ÿåˆ—ï¼Œéƒ½æŒ‰ FIFO æŽ’åº==ä»»åŠ¡ã€‚ç¬¬ä¸‰ç§æ˜¯==ä¸å­˜å‚¨å…ƒç´ çš„==é˜»å¡žé˜Ÿåˆ—ï¼Œæ¯ä¸ªä»»åŠ¡çš„åŠ å…¥éƒ½å¿…é¡»é˜»å¡žç­‰å¾…ï¼Œç›´åˆ°è…¾å‡ºæ¥çº¿ç¨‹æ‰§è¡Œã€‚ç¬¬å››ç§æ˜¯ä¸€ä¸ªå…·æœ‰==ä¼˜å…ˆçº§==çš„æ— é™é˜»å¡žé˜Ÿåˆ—ã€‚
>

---

==é—®é¢˜ä¸‰==ï¼š==çº¿ç¨‹æ•°æ˜¯è¶Šå¤§è¶Šå¥½å—ï¼Ÿè®²ä¸€ä¸‹æ ¸å¿ƒçº¿ç¨‹æ•°ä¸Žæœ€å¤§çº¿ç¨‹æ•°ä¹‹é—´çš„å…³ç³»ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. å¦‚æžœç¨‹åºæ˜¯ ==CPU å¯†é›†åž‹==ï¼ˆå¤§é‡çš„è®¡ç®—ä»»åŠ¡ï¼‰ï¼Œé‚£ä¹ˆçº¿ç¨‹æ•°ä¸è¦å¤ªå¤šï¼Œå¦åˆ™==çº¿ç¨‹é—´çš„é¢‘ç¹åˆ‡æ¢==åè€Œä¼šè€—è´¹å¤§é‡æ—¶é—´ï¼›
> 2. å¦‚æžœç¨‹åºæ˜¯ ==IO å¯†é›†åž‹==ï¼ˆè¾“å…¥è¾“å‡ºä»»åŠ¡ï¼Œç£ç›˜å†™å…¥å†™å›žä¹‹ç±»çš„ä»»åŠ¡ï¼‰ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€‚å½“å¢žåŠ çº¿ç¨‹æ•°ï¼Œä»¥==å……åˆ†è¿ç”¨ç­‰å¾… IO çš„æ—¶é—´==ã€‚
> 3. ==æ ¸å¿ƒçº¿ç¨‹æ•°==å¯ä»¥ç†è§£ä¸ºæœ€å°çš„çº¿ç¨‹æ•°ï¼Œå¦‚æžœæ ¸å¿ƒçº¿ç¨‹æ²¡æœ‰ä»»åŠ¡å¯å¤„ç†ï¼Œä¹Ÿä¸ä¼šè¢«é”€æ¯ã€‚
> 4. ==æœ€å¤§çº¿ç¨‹æ•°==æ˜¯é˜»å¡žé˜Ÿåˆ—è¢«å¡«æ»¡åŽï¼Œä¸´æ—¶å¢žåŠ çš„çº¿ç¨‹ï¼Œç”¨äºŽå¿«é€Ÿå¤„ç†å®Œå †ç§¯å†é˜»å¡žé˜Ÿåˆ—é‡Œçš„çº¿ç¨‹ï¼Œå¦‚æžœå®ƒä»¬==è¶…è¿‡ keepAliveTime æ²¡æœ‰å¤„ç†æ–°ä»»åŠ¡ï¼Œåˆ™ä¼šè¢«é”€æ¯==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ä¸æ˜¯çš„ï¼Œå¦‚æžœç¨‹åºæ˜¯ CPU å¯†é›†åž‹ä»»åŠ¡ï¼Œçº¿ç¨‹æ•°ä¸èƒ½å¤ªå¤§ï¼Œé¿å…çº¿ç¨‹é—´çš„é¢‘ç¹åˆ‡æ¢ï¼›å¦‚æžœç¨‹åºæ˜¯ IO å¯†é›†åž‹ä»»åŠ¡ï¼Œå¯ä»¥é€‚å½“å¢žåŠ çº¿ç¨‹æ•°ï¼Œæ¥å……åˆ†åˆ©ç”¨ CPU ç­‰å¾… IO çš„æ—¶é—´ï¼Œæé«˜åžåé‡ã€‚ä½†å³ä½¿æ˜¯ IO å¯†é›†åž‹ä»»åŠ¡çº¿ç¨‹æ•°ä¹Ÿä¸èƒ½è¿‡å¤§ï¼Œå¦åˆ™ä¹Ÿä¼šå‡ºçŽ°çº¿ç¨‹é¢‘ç¹åˆ‡æ¢å¸¦æ¥çš„é¢å¤–å¼€é”€ã€‚
> - æ ¸å¿ƒçº¿ç¨‹æ•°è¡¨ç¤ºçº¿ç¨‹æ± ä¸­ä¿æŒæ´»åŠ¨çŠ¶æ€çš„çº¿ç¨‹æ•°é‡ï¼Œå³ç©ºé—²çº¿ç¨‹çš„æœ€å°æ•°é‡ï¼Œè¿™äº›çº¿ç¨‹æ‰§è¡Œå®Œä»»åŠ¡åŽä¸ä¼šè¢«é”€æ¯ã€‚
> - æœ€å¤§çº¿ç¨‹æ•°æ˜¯æŒ‡çº¿ç¨‹æ± ä¸­å…è®¸çš„æœ€å¤§çº¿ç¨‹æ•°é‡ï¼ŒåŒ…æ‹¬æ ¸å¿ƒçº¿ç¨‹æ•°å’Œéžæ ¸å¿ƒçº¿ç¨‹æ•°ã€‚éžæ ¸å¿ƒçº¿ç¨‹æ•°æ˜¯åœ¨ä»»åŠ¡é˜Ÿåˆ—å·²æ»¡ä¸”æ ¸å¿ƒçº¿ç¨‹æ•°å·²æ»¡çš„æƒ…å†µä¸‹ï¼Œåˆ›å»ºçš„é¢å¤–çº¿ç¨‹æ•°é‡ï¼Œè¿™äº›çº¿ç¨‹åœ¨æ‰§è¡Œå®Œä»»åŠ¡åŽå°±ä¼šè¢«é”€æ¯ã€‚
>

---

==é—®é¢˜å››==ï¼š==è¿è¡Œçš„æ—¶å€™ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°èƒ½ä¸èƒ½ä¿®æ”¹ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. å¯ä»¥ï¼Œ==è°ƒç”¨ ThreadPoolExecutor.setCorePoolSize å¯ä»¥ä¿®æ”¹æ ¸å¿ƒçº¿ç¨‹æ•°==ã€‚å¦‚æžœä¿®æ”¹åŽçš„çº¿ç¨‹æ•°å°‘äº†ï¼Œé‚£ä¹ˆå¤šä½™çš„çº¿ç¨‹åœ¨æ‰§è¡Œå®Œå½“å‰çš„ä»»åŠ¡ä¹‹åŽå°±ä¼šè¢«é”€æ¯ï¼›çº¿ç¨‹å˜å¤šäº†ï¼Œé˜Ÿåˆ—æœ‰ä»»åŠ¡å°±ä¼šåˆ›å»ºæ–°çš„çº¿ç¨‹ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - å¯ä»¥ï¼Œ==ThreadPoolExecutor ç±»æä¾›äº† setCorePoolSize( )==ï¼Œå¯ä»¥åœ¨çº¿ç¨‹æ± è¿è¡Œæ—¶åŠ¨æ€ä¿®æ”¹æ ¸å¿ƒçº¿ç¨‹æ•°ã€‚å¦‚æžœæˆ‘ä»¬è°ƒç”¨è¿™ä¸ªæ–¹æ³•å°è¯•å‡å°‘æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œé‚£ä¹ˆå°±ä¼š==ä¸­æ–­ä¸€éƒ¨åˆ†ç©ºé—²çº¿ç¨‹==ã€‚å¦‚æžœæ˜¯å¢žåŠ ï¼Œåˆ™éœ€è¦æ ¹æ®å½“å‰==å·¥ä½œé˜Ÿåˆ—æ˜¯å¦æœ‰ä»»åŠ¡==æ¥å†³å®šæ˜¯å¦å¢žåŠ æ ¸å¿ƒçº¿ç¨‹ã€‚
>

---

==é—®é¢˜äº”==ï¼š==ä¸€ä¸ªä»»åŠ¡è¿›æ¥åŽï¼Œçº¿ç¨‹æ± æ˜¯æ€Žä¹ˆå¤„ç†çš„ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. é¦–å…ˆå¡«æ»¡==æ ¸å¿ƒçº¿ç¨‹æ•°==ï¼Œç„¶åŽæ”¾åˆ°==é˜»å¡žé˜Ÿåˆ—==ä¸­ï¼Œå¦‚æžœé˜»å¡žé˜Ÿåˆ—æ”¾æ»¡äº†è¿˜æœ‰æ–°ä»»åŠ¡ï¼Œé‚£å°±å°è¯•æŠŠæœ€å¤§çº¿ç¨‹æ•°å¡«æ»¡ï¼Œå¦‚æžœæœ€å¤§çº¿ç¨‹æ•°æ»¡äº†è¿˜æœ‰æ–°ä»»åŠ¡ï¼Œå°±æ‹’ç»ï¼Œå¹¶æ‰§è¡Œä¼ å…¥çš„ Handler å¤„ç†è¢«æ‹’ç»çš„ä»»åŠ¡ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - é¦–å…ˆéœ€è¦åˆ¤æ–­==æ ¸å¿ƒçº¿ç¨‹æ± ==æ˜¯å¦å·²æ»¡ï¼Œå¦‚æžœæ²¡æ»¡åˆ™åˆ›å»ºä¸€ä¸ªæ ¸å¿ƒçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ã€‚
> - å¦‚æžœæ ¸å¿ƒçº¿ç¨‹æ± é‡Œçš„çº¿ç¨‹éƒ½åœ¨æ‰§è¡Œä»»åŠ¡ï¼ŒæŽ¥ç€è¦åˆ¤æ–­==å·¥ä½œé˜Ÿåˆ—==æ˜¯å¦å·²æ»¡ï¼Œå¦‚æžœæ²¡æ»¡åˆ™å°†è¿™ä¸ªä»»åŠ¡æ·»åŠ åˆ°å·¥ä½œé˜Ÿåˆ—ä¸­ã€‚
> - å¦‚æžœå·¥ä½œé˜Ÿåˆ—ä¹Ÿæ»¡äº†ï¼Œè¿˜éœ€åˆ¤æ–­çº¿ç¨‹æ± ä¸­æ‰€æœ‰çš„çº¿ç¨‹æ˜¯å¦è¶…å‡ºäº†==æœ€å¤§çº¿ç¨‹æ•°==ï¼Œå¦‚æžœæ²¡æœ‰ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªéžæ ¸å¿ƒçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ã€‚
> - å¦‚æžœæ•´ä¸ªçº¿ç¨‹æ± éƒ½æ»¡äº†ï¼Œåˆ™éœ€è¦äº¤ç»™åˆ›å»ºçº¿ç¨‹æ—¶æŒ‡å®šçš„==ã€Œæ‹’ç»æ‰§è¡Œç­–ç•¥ã€==åŽ»å¤„ç†ã€‚
>

---

==é—®é¢˜å…­==ï¼š==çº¿ç¨‹æ± çš„æ‹’ç»ç­–ç•¥æœ‰å“ªå‡ ç§ï¼Ÿè®²ä¸€ä¸‹å¸¸è§çš„å‡ ç§==

==æˆ‘çš„å›žç­”==ï¼š

> 1. å¸¸è§çš„æœ‰å››ç§ç­–ç•¥ï¼š
> 2. ç¬¬ä¸€ç§æ˜¯å¼‚å¸¸ç­–ç•¥ï¼ˆAbortPolicyï¼‰ï¼Œ==ç›´æŽ¥æŠ›å‡ºå¼‚å¸¸==ã€‚
> 3. ç¬¬äºŒç« æ˜¯è°ƒç”¨è€…è¿è¡Œç­–ç•¥ï¼ˆCallerRunsPolicyï¼‰ï¼Œ==å°†è¯¥ä»»åŠ¡äº¤ç»™è°ƒç”¨è€…æ‰€åœ¨çš„çº¿ç¨‹==åŽ»æ‰§è¡Œã€‚
> 4. ç¬¬ä¸‰ç§æ˜¯ä¸¢å¼ƒæœ€ä¹…ç­–ç•¥ï¼ˆDiscardOldestPolicyï¼‰ï¼Œ==ä¸¢å¼ƒé˜Ÿåˆ—ä¸­æœ€æ—©æäº¤çš„ä»»åŠ¡==ï¼Œå¹¶æ‰§è¡Œå½“å‰ä»»åŠ¡ã€‚
> 5. ç¬¬å››ç§æ˜¯ç›´æŽ¥ä¸¢å¼ƒç­–ç•¥ï¼ˆDiscardPolicyï¼‰ï¼Œ==ç›´æŽ¥ä¸¢å¼ƒä¸å¤„ç†==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - å¸¸è§çš„æœ‰å››ç§ç­–ç•¥ï¼š
> - ç¬¬ä¸€ç§æ˜¯å¼‚å¸¸ç­–ç•¥ï¼ˆAbortPolicyï¼‰ï¼Œ==ç›´æŽ¥æŠ›å‡ºå¼‚å¸¸==ã€‚
> - ç¬¬äºŒç« æ˜¯è°ƒç”¨è€…è¿è¡Œç­–ç•¥ï¼ˆCallerRunsPolicyï¼‰ï¼Œ==å°†è¯¥ä»»åŠ¡äº¤ç»™è°ƒç”¨è€…æ‰€åœ¨çš„çº¿ç¨‹==åŽ»æ‰§è¡Œã€‚
> - ç¬¬ä¸‰ç§æ˜¯ä¸¢å¼ƒæœ€ä¹…ç­–ç•¥ï¼ˆDiscardOldestPolicyï¼‰ï¼Œ==ä¸¢å¼ƒé˜Ÿåˆ—ä¸­æœ€æ—©æäº¤çš„ä»»åŠ¡==ï¼Œå¹¶æ‰§è¡Œå½“å‰ä»»åŠ¡ã€‚
> - ç¬¬å››ç§æ˜¯ç›´æŽ¥ä¸¢å¼ƒç­–ç•¥ï¼ˆDiscardPolicyï¼‰ï¼Œ==ç›´æŽ¥ä¸¢å¼ƒä¸å¤„ç†==ã€‚
>

---

==é—®é¢˜ä¸ƒ==ï¼š==å¹³æ—¶å¯ä»¥æ€Žä¹ˆåˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. å¯ä»¥é€šè¿‡ ==ThreadPoolExecutor çš„æž„é€ æ–¹æ³•==è‡ªå®šä¹‰ç›¸å…³å‚æ•°åˆ›å»ºï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ ==Executors çš„æ–¹æ³•==ç›´æŽ¥èŽ·å–å‡ ä¸ªåˆ›å»ºå¥½çš„çº¿ç¨‹æ± ã€‚ä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯ä½¿ç”¨ ThreadPoolExecutor çš„æž„é€ æ–¹æ³•ï¼Œæ›´åŠ çµæ´»ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - æœ€å¥½æ˜¯ç”¨ ThreadPoolExecutor åˆ›å»ºï¼Œä¸æŽ¨èä½¿ç”¨ Executors åˆ›å»ºã€‚å› ä¸º==ä»Ž Executors è¿”å›žçš„çº¿ç¨‹æ± å¯¹è±¡ï¼Œè¯·æ±‚é˜Ÿåˆ—çš„é•¿åº¦æˆ–è€…å…è®¸åˆ›å»ºçš„çº¿ç¨‹æ•°ä¸º Integer.MAX_VALUEï¼Œå¯èƒ½ä¼šå †ç§¯å¤§é‡çš„è¯·æ±‚æˆ–è€…çº¿ç¨‹ï¼Œå¯¼è‡´ OOM==ã€‚
>

---

==é—®é¢˜å…«==ï¼š==çº¿ç¨‹æ± æœ‰å“ªäº›å…³é—­æ–¹å¼ï¼Ÿä»–ä»¬çš„åŒºåˆ«ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ä½¿ç”¨ shutdown æˆ–è€… shutdownNow æ–¹æ³•ã€‚ä¸¤è€…çš„åŒºåˆ«æ˜¯ ==shutdown æ–¹æ³•ç›¸å¯¹æ›´åŠ æŸ”å’Œ==ï¼Œå¦‚æžœå½“å‰çº¿ç¨‹æ± ä¸­è¿˜æœ‰ä»»åŠ¡æ²¡æœ‰æ‰§è¡Œå®Œçš„è¯ï¼Œä¼šå°†æ²¡æ‰§è¡Œå®Œçš„ä»»åŠ¡æ‰§è¡Œå®Œå†å…³é—­ï¼›è€Œ ==shutdownNow åˆ™ä¼šç›´æŽ¥å¼ºè¡Œç»ˆæ­¢æ‰€æœ‰æ­£åœ¨æ‰§è¡Œä»»åŠ¡ï¼Œå¹¶æŠŠæ‰€æœ‰æœªæ‰§è¡Œå®Œçš„ä»»åŠ¡æ‰“åŒ…ä¸º List\<Runnable> è¿”å›ž==ï¼Œæ„åœ¨è®©æˆ‘ä»¬è‡ªè¡Œå¤„ç†ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - æœ‰ä¸¤ç§æ–¹å¼ï¼Œä½¿ç”¨ shutdown( ) æˆ–è€… shutdownNow( ) æ¥å…³é—­çº¿ç¨‹æ± ã€‚å®ƒä»¬çš„==åŽŸç†æ˜¯éåŽ†çº¿ç¨‹æ± ä¸­çš„å·¥ä½œçº¿ç¨‹ï¼Œç„¶åŽé€ä¸ªè°ƒç”¨çº¿ç¨‹çš„ interrupt æ–¹æ³•æ¥ä¸­æ–­çº¿ç¨‹==ã€‚ä½†ä¹Ÿæœ‰ä¸€å®šçš„åŒºåˆ«ï¼Œ==shutdown( ) åªæ˜¯çº¿ç¨‹æ± çš„çŠ¶æ€è®¾ç½®æˆ SHUTDOWNï¼Œç„¶åŽä¸­æ–­æ‰€æœ‰æ²¡æœ‰æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹==ï¼Œè€Œ ==shutdownNow( ) æ˜¯å…ˆå°†çº¿ç¨‹æ± çŠ¶æ€è®¾ä¸º STOPï¼Œç„¶åŽå°è¯•åœæ­¢æ‰€æœ‰çš„æ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹==ï¼Œå¹¶è¿”å›žç­‰å¾…æ‰§è¡Œä»»åŠ¡çš„åˆ—è¡¨ã€‚
> - æ— è®ºè°ƒç”¨è¿™ä¸¤ä¸ªæ–¹æ³•çš„å“ªä¸€ä¸ªï¼ŒisShutdown( ) éƒ½ä¼šè¿”å›ž trueã€‚==å½“æ‰€æœ‰çš„ä»»åŠ¡éƒ½æ‰§è¡Œå®ŒåŽï¼Œæ‰çœŸæ­£è¡¨ç¤ºçº¿ç¨‹æ± å…³é—­æˆåŠŸï¼Œæ­¤æ—¶ isTerminaed( ) è¿”å›ž true==ã€‚å®žé™…ä¸­å¦‚æžœæœŸæœ›æ­¤æ—¶æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ç»§ç»­æ‰§è¡Œå®Œï¼Œå¯ä»¥ç”¨ shutdown( )ï¼Œåä¹‹å¯ä»¥ç”¨ shutdownNow( )ã€‚
>

---



## 5.Java IO + Java8 æ–°ç‰¹æ€§

### æ–‡ç« 

#### 1.ä½ ç®¡è¿™ç ´çŽ©æ„å« IO å¤šè·¯å¤ç”¨ï¼Ÿ

1. ==é˜»å¡ž IO==ï¼š

	> - ç®€å•æ¥è¯´å°±æ˜¯æœåŠ¡ç«¯ç›´æŽ¥ç­‰å¾…å®¢æˆ·ç«¯ä¼ æ¥çš„æ•°æ®ã€‚å¦‚æžœå®¢æˆ·ç«¯è¿Ÿè¿Ÿä¸æŠŠæ•°æ®ä¼ æ¥ï¼ŒæœåŠ¡ç«¯å°±ä¼šä¸€ç›´åœ¨ read å¤„è¢«é˜»å¡žï¼Œæ— æ³•æŽ¥æ”¶å…¶å®ƒå®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚
	> - <img src="bgwROUND1.assets/image-20240620111330389.png" alt="image-20240620111330389" style="zoom: 67%;" />
	> - ä¸ºäº†è§£å†³è¿™ç§é˜»å¡žæœåŠ¡ç«¯çš„é—®é¢˜ï¼Œå¯ä»¥æ¯æ¬¡éƒ½==åˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹æˆ–çº¿ç¨‹ä¸Žå®¢æˆ·ç«¯ä¿æŒè”ç³»==ï¼ŒåŽ»è°ƒç”¨ read å‡½æ•°ï¼Œå¹¶åšä¸šåŠ¡å¤„ç†ï¼ˆ==è¿™æ ·ä¾ç„¶æ˜¯é˜»å¡ž IO==ï¼‰

2. ==éžé˜»å¡ž IO==ï¼š

	> - ä¸ºäº†å®žçŽ°éžé˜»å¡ž IOï¼Œéœ€è¦è®©==æ“ä½œç³»ç»Ÿä¸ºæˆ‘ä»¬æä¾›ä¸€ä¸ªéžé˜»å¡žçš„ read å‡½æ•°==ã€‚
	> - è¿™ä¸ª read å‡½æ•°çš„æ•ˆæžœæ˜¯ï¼Œå¦‚æžœ==æ²¡æœ‰æ•°æ®åˆ°è¾¾ï¼ˆæ²¡æœ‰åˆ°è¾¾ç½‘å¡å¹¶æ‹·è´åˆ°å†…æ ¸ç¼“å†²åŒºï¼‰ï¼Œç«‹åˆ»è¿”å›žä¸€ä¸ªé”™è¯¯å€¼ï¼ˆ-1ï¼‰==ï¼Œè€Œä¸æ˜¯é˜»å¡žåœ°ç­‰å¾…ã€‚
	> - <img src="bgwROUND1.assets/640-17188538586172.webp" alt="å›¾ç‰‡" style="zoom:125%;" />
	> - å¯ä»¥çœ‹åˆ°ï¼Œ==åªæœ‰å½“æ•°æ®è¿˜æœªåˆ°è¾¾ç½‘å¡ï¼Œæˆ–è€…è¿˜æ²¡æœ‰æ‹·è´åˆ°å†…æ ¸ç¼“å†²åŒºä¹‹å‰ï¼Œæ‰æ˜¯éžé˜»å¡žçš„==ã€‚
	> - è€Œå½“==æ•°æ®å·²åˆ°è¾¾å†…æ ¸ç¼“å†²åŒºï¼Œæ­¤æ—¶è°ƒç”¨ read å‡½æ•°ä»ç„¶æ˜¯é˜»å¡žçš„==ï¼Œéœ€è¦ç­‰å¾…æ•°æ®ä»Žå†…æ ¸ç¼“å†²åŒºæ‹·è´åˆ°ç”¨æˆ·ç¼“å†²åŒºï¼Œæ‰èƒ½è¿”å›žã€‚

3. ==IO å¤šè·¯å¤ç”¨==ï¼š

	> - é¦–å…ˆä¸€ä¸ªçº¿ç¨‹ä¸æ–­æŽ¥å—å®¢æˆ·ç«¯è¿žæŽ¥ï¼Œå¹¶==æŠŠ socket æ–‡ä»¶æè¿°ç¬¦æ”¾åˆ°ä¸€ä¸ª list== é‡Œã€‚
	> - ç„¶åŽï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸å†è‡ªå·±éåŽ†ï¼Œè€Œæ˜¯==è°ƒç”¨ selectï¼Œå°†è¿™æ‰¹æ–‡ä»¶æè¿°ç¬¦ list äº¤ç»™æ“ä½œç³»ç»Ÿçš„å†…æ ¸æ€åŽ»éåŽ†ï¼ˆå¦‚æžœè‡ªå·±éåŽ†çš„è¯ï¼Œæ¯ä¸€ä¸ªéƒ½éœ€è¦ä»Žç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€ï¼Œè¿™æ ·åªéœ€ä¸€æ¬¡è½¬æ¢ï¼‰==ã€‚
	> - ä¸è¿‡ï¼Œå½“ select å‡½æ•°è¿”å›žåŽï¼Œç”¨æˆ·ä¾ç„¶éœ€è¦éåŽ†åˆšåˆšæäº¤ç»™æ“ä½œç³»ç»Ÿçš„ listã€‚åªä¸è¿‡ï¼Œ==æ“ä½œç³»ç»Ÿä¼šå°†å‡†å¤‡å°±ç»ªçš„æ–‡ä»¶æè¿°ç¬¦åšä¸Šæ ‡è¯†==ï¼Œç”¨æˆ·å±‚å°±æ— éœ€ç­‰å¾…æ–‡ä»¶ã€‚
	> - ![å›¾ç‰‡](bgwROUND1.assets/640-17188685955764.gif)
	>
	> 1. select è°ƒç”¨éœ€è¦ä¼ å…¥ fd æ•°ç»„ï¼Œ==éœ€è¦æ‹·è´ä¸€ä»½åˆ°å†…æ ¸==ï¼Œé«˜å¹¶å‘åœºæ™¯ä¸‹è¿™æ ·çš„==æ‹·è´æ¶ˆè€—çš„èµ„æºæ˜¯æƒŠäººçš„==ã€‚ï¼ˆå¯ä¼˜åŒ–ä¸ºä¸å¤åˆ¶ï¼‰
	>
	> 2. ==select åœ¨å†…æ ¸å±‚==ä»ç„¶æ˜¯é€šè¿‡éåŽ†çš„æ–¹å¼æ£€æŸ¥æ–‡ä»¶æè¿°ç¬¦çš„å°±ç»ªçŠ¶æ€ï¼Œæ˜¯ä¸ª==åŒæ­¥è¿‡ç¨‹==ï¼Œåªä¸è¿‡==æ— ç³»ç»Ÿè°ƒç”¨åˆ‡æ¢ä¸Šä¸‹æ–‡çš„å¼€é”€==ã€‚ï¼ˆå†…æ ¸å±‚å¯ä¼˜åŒ–ä¸ºå¼‚æ­¥äº‹ä»¶é€šçŸ¥ï¼‰
	>
	> 3. ==select ä»…ä»…è¿”å›žå¯è¯»æ–‡ä»¶æè¿°ç¬¦çš„ä¸ªæ•°==ï¼Œå…·ä½“å“ªä¸ªå¯è¯»è¿˜æ˜¯è¦ç”¨æˆ·è‡ªå·±éåŽ†ã€‚ï¼ˆå¯ä¼˜åŒ–ä¸ºåªè¿”å›žç»™ç”¨æˆ·å°±ç»ªçš„æ–‡ä»¶æè¿°ç¬¦ï¼Œæ— éœ€ç”¨æˆ·åšæ— æ•ˆçš„éåŽ†ï¼‰
	>
	> è¿™ç§æ–¹å¼ï¼Œæ—¢åšåˆ°äº†==ä¸€ä¸ªçº¿ç¨‹å¤„ç†å¤šä¸ªå®¢æˆ·ç«¯è¿žæŽ¥ï¼ˆæ–‡ä»¶æè¿°ç¬¦==ï¼‰ï¼Œåˆ==å‡å°‘äº†ç³»ç»Ÿè°ƒç”¨==çš„å¼€é”€ã€‚

4. ==poll==ï¼š

	> - poll ä¹Ÿæ˜¯æ“ä½œç³»ç»Ÿæä¾›çš„ç³»ç»Ÿè°ƒç”¨å‡½æ•°ã€‚
	> - å®ƒå’Œ select çš„ä¸»è¦åŒºåˆ«å°±æ˜¯ï¼Œ==åŽ»æŽ‰äº† select åªèƒ½ç›‘å¬ 1024 ä¸ªæ–‡ä»¶æè¿°ç¬¦çš„é™åˆ¶==ã€‚

5. ==epoll==ï¼š

	> - è¿˜è®°å¾—ä¸Šé¢è¯´çš„ select çš„ä¸‰ä¸ªç»†èŠ‚ä¹ˆï¼Ÿ
	>
	> 	1. select è°ƒç”¨éœ€è¦ä¼ å…¥ fd æ•°ç»„ï¼Œéœ€è¦æ‹·è´ä¸€ä»½åˆ°å†…æ ¸ï¼Œé«˜å¹¶å‘åœºæ™¯ä¸‹è¿™æ ·çš„æ‹·è´æ¶ˆè€—çš„èµ„æºæ˜¯æƒŠäººçš„ã€‚ï¼ˆå¯ä¼˜åŒ–ä¸ºä¸å¤åˆ¶ï¼‰
	>
	> 	2. select åœ¨å†…æ ¸å±‚ä»ç„¶æ˜¯é€šè¿‡éåŽ†çš„æ–¹å¼æ£€æŸ¥æ–‡ä»¶æè¿°ç¬¦çš„å°±ç»ªçŠ¶æ€ï¼Œæ˜¯ä¸ªåŒæ­¥è¿‡ç¨‹ï¼Œåªä¸è¿‡æ— ç³»ç»Ÿè°ƒç”¨åˆ‡æ¢ä¸Šä¸‹æ–‡çš„å¼€é”€ã€‚ï¼ˆå†…æ ¸å±‚å¯ä¼˜åŒ–ä¸ºå¼‚æ­¥äº‹ä»¶é€šçŸ¥ï¼‰
	>
	> 	3. select ä»…ä»…è¿”å›žå¯è¯»æ–‡ä»¶æè¿°ç¬¦çš„ä¸ªæ•°ï¼Œå…·ä½“å“ªä¸ªå¯è¯»è¿˜æ˜¯è¦ç”¨æˆ·è‡ªå·±éåŽ†ã€‚ï¼ˆå¯ä¼˜åŒ–ä¸ºåªè¿”å›žç»™ç”¨æˆ·å°±ç»ªçš„æ–‡ä»¶æè¿°ç¬¦ï¼Œæ— éœ€ç”¨æˆ·åšæ— æ•ˆçš„éåŽ†ï¼‰
	>
	> - æ‰€ä»¥ ==epoll ä¸»è¦å°±æ˜¯é’ˆå¯¹è¿™ä¸‰ç‚¹è¿›è¡Œäº†æ”¹è¿›==ã€‚
	>
	> 	1. ==å†…æ ¸ä¸­ä¿å­˜ä¸€ä»½æ–‡ä»¶æè¿°ç¬¦é›†åˆ==ï¼Œæ— éœ€ç”¨æˆ·æ¯æ¬¡éƒ½é‡æ–°ä¼ å…¥ï¼Œ==åªéœ€å‘Šè¯‰å†…æ ¸ä¿®æ”¹çš„éƒ¨åˆ†==å³å¯ã€‚
	>
	> 	2. å†…æ ¸ä¸å†é€šè¿‡è½®è¯¢çš„æ–¹å¼æ‰¾åˆ°å°±ç»ªçš„æ–‡ä»¶æè¿°ç¬¦ï¼Œè€Œæ˜¯==é€šè¿‡å¼‚æ­¥ IO äº‹ä»¶å”¤é†’==ã€‚
	>
	> 	3. å†…æ ¸==ä»…ä¼šå°†æœ‰ IO äº‹ä»¶çš„æ–‡ä»¶æè¿°ç¬¦è¿”å›žç»™ç”¨æˆ·==ï¼Œç”¨æˆ·ä¹Ÿæ— éœ€éåŽ†æ•´ä¸ªæ–‡ä»¶æè¿°ç¬¦é›†åˆã€‚

6. ==æ€»ç»“==ï¼š

	> - ä¸€åˆ‡çš„å¼€å§‹ï¼Œéƒ½èµ·æºäºŽè¿™ä¸ª read å‡½æ•°æ˜¯æ“ä½œç³»ç»Ÿæä¾›çš„ï¼Œè€Œä¸”æ˜¯é˜»å¡žçš„ï¼Œæˆ‘ä»¬å«å®ƒ ==é˜»å¡ž IO==ã€‚
	>
	> 	ä¸ºäº†ç ´è¿™ä¸ªå±€ï¼Œç¨‹åºå‘˜åœ¨ç”¨æˆ·æ€é€šè¿‡==å¤šçº¿ç¨‹æ¥é˜²æ­¢ä¸»çº¿ç¨‹å¡æ­»==ã€‚
	>
	> - åŽæ¥æ“ä½œç³»ç»Ÿå‘çŽ°è¿™æ ·==å¯¹çº¿ç¨‹çš„éœ€æ±‚æ¯”è¾ƒå¤§==ï¼ŒäºŽæ˜¯åœ¨æ“ä½œç³»ç»Ÿå±‚é¢æä¾›äº†==éžé˜»å¡žçš„ read å‡½æ•°==ï¼Œè¿™æ ·ç¨‹åºå‘˜å°±å¯ä»¥==åœ¨ä¸€ä¸ªçº¿ç¨‹å†…å®Œæˆå¤šä¸ªæ–‡ä»¶æè¿°ç¬¦çš„è¯»å–==ï¼Œè¿™å°±æ˜¯ ==éžé˜»å¡ž IO==ã€‚
	>
	> 	ä½†å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦çš„è¯»å–å°±éœ€è¦éåŽ†ï¼Œå½“é«˜å¹¶å‘åœºæ™¯è¶Šæ¥è¶Šå¤šæ—¶ï¼Œ==ç”¨æˆ·æ€éåŽ†çš„æ–‡ä»¶æè¿°ç¬¦ä¹Ÿè¶Šæ¥è¶Šå¤š==ï¼Œç›¸å½“äºŽåœ¨ while å¾ªçŽ¯é‡Œè¿›è¡Œäº†è¶Šæ¥è¶Šå¤šçš„ç³»ç»Ÿè°ƒç”¨ã€‚
	>
	> - åŽæ¥æ“ä½œç³»ç»Ÿåˆå‘çŽ°è¿™ä¸ªåœºæ™¯éœ€æ±‚é‡è¾ƒå¤§ï¼ŒäºŽæ˜¯åˆåœ¨æ“ä½œç³»ç»Ÿå±‚é¢æä¾›äº†è¿™æ ·çš„éåŽ†æ–‡ä»¶æè¿°ç¬¦çš„æœºåˆ¶ï¼Œè¿™å°±æ˜¯ ==IO å¤šè·¯å¤ç”¨==ã€‚
	>
	> - å¤šè·¯å¤ç”¨æœ‰ä¸‰ä¸ªå‡½æ•°ï¼Œæœ€å¼€å§‹æ˜¯ selectï¼Œç„¶åŽåˆå‘æ˜Žäº†==poll è§£å†³äº† select æ–‡ä»¶æè¿°ç¬¦çš„é™åˆ¶==ï¼Œç„¶åŽåˆå‘æ˜Žäº† ==epoll è§£å†³ select çš„ä¸‰ä¸ªä¸è¶³==ã€‚

---



#### 2.åŒæ­¥/å¼‚æ­¥/é˜»å¡ž/éžé˜»å¡ž/BIO/NIO/AIO

1. ==åŒæ­¥å’Œå¼‚æ­¥==ï¼š

	> - ==åŒæ­¥==ï¼Œ==èµ„æºå°‘éœ€æ±‚å¤šçš„åœºæ™¯==ä¸‹ä½¿ç”¨ï¼Œè¿˜å­˜åœ¨ä¸€ç§ç”±äºŽ==é€»è¾‘ä¸Šçš„å…ˆåŽé¡ºåº==å¯¼è‡´çš„åŒæ­¥ã€‚
	> - åŒæ­¥çš„==èŒƒå›´==ï¼šå¹¶ä¸éœ€è¦åœ¨å…¨å±€èŒƒå›´å†…éƒ½åŽ»åŒæ­¥ï¼Œ==åªéœ€è¦åœ¨æŸäº›å…³é”®çš„ç‚¹æ‰§è¡ŒåŒæ­¥==å³å¯ã€‚
	> - åŒæ­¥çš„==ç²’åº¦==ï¼šå¹¶ä¸æ˜¯åªæœ‰å¤§ç²’åº¦çš„äº‹ç‰©æ‰æœ‰åŒæ­¥ï¼Œå°ç²’åº¦çš„äº‹ç‰©ä¹Ÿæœ‰åŒæ­¥ã€‚
	> - ==å¼‚æ­¥==ï¼šå¤šä¸ªäº‹ç‰©å¯ä»¥ä½ è¿›è¡Œä½ çš„ã€æˆ‘è¿›è¡Œæˆ‘çš„ï¼Œè°éƒ½ä¸ç”¨ç®¡è°ï¼Œæ‰€æœ‰çš„äº‹ç‰©éƒ½åœ¨åŒæ—¶è¿›è¡Œä¸­ã€‚

2. ==é˜»å¡žå’Œéžé˜»å¡ž==ï¼š

	> - é˜»å¡žåŒæ ·æ„å‘³ç€åœä¸‹æ¥ç­‰å¾…ï¼Œéžé˜»å¡žè¡¨æ˜Žå¯ä»¥ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚

3. ==é˜»å¡žå’Œç­‰å¾…==ï¼š

	> - é˜»å¡žçš„çœŸæ­£å«ä¹‰æ˜¯ä½ å…³å¿ƒçš„äº‹ç‰©ç”±äºŽæŸäº›åŽŸå› æ— æ³•ç»§ç»­è¿›è¡Œï¼Œå› æ­¤è®©ä½ ç­‰å¾…ã€‚ä½†==æ²¡å¿…è¦å¹²ç­‰==ï¼Œä½ ==å¯ä»¥åšä¸€äº›å…¶å®ƒæ— å…³çš„äº‹ç‰©==ï¼Œå› ä¸ºè¿™å¹¶ä¸å½±å“ä½ å¯¹ç›¸å…³äº‹ç‰©çš„ç­‰å¾…ã€‚
	> - è®¡ç®—æœºä¸­ï¼Œä¸€èˆ¬åœ¨é˜»å¡žæ—¶ï¼Œé€‰åœ¨å¹²ç­‰ï¼Œå› ä¸ºè¿™æœ€å®¹æ˜“å®žçŽ°ï¼Œåªéœ€è¦==æŒ‚èµ·çº¿ç¨‹ï¼Œè®©å‡ºCPUå³å¯==ã€‚åœ¨æ¡ä»¶æ»¡è¶³æ—¶ï¼Œä¼š==é‡æ–°è°ƒåº¦è¯¥çº¿ç¨‹==ã€‚

4. ==I/O==ï¼š

	> - IO æŒ‡çš„å°±æ˜¯è¯»å…¥/å†™å‡ºæ•°æ®çš„è¿‡ç¨‹ï¼Œå’Œ==ç­‰å¾…==è¯»å…¥/å†™å‡ºæ•°æ®çš„è¿‡ç¨‹ã€‚ä¸€æ—¦æ‹¿åˆ°æ•°æ®åŽå°±å˜æˆäº†æ•°æ®æ“ä½œäº†ï¼Œå°±ä¸æ˜¯ IO äº†ã€‚
	> - æ‹¿ç½‘ç»œ IO æ¥è¯´ï¼Œ==ç­‰å¾…==çš„è¿‡ç¨‹å°±æ˜¯==æ•°æ®ä»Žç½‘ç»œåˆ°ç½‘å¡å†åˆ°å†…æ ¸ç©ºé—´==ã€‚==è¯»å†™==çš„è¿‡ç¨‹å°±æ˜¯==å†…æ ¸ç©ºé—´å’Œç”¨æˆ·ç©ºé—´çš„ç›¸äº’æ‹·è´==ã€‚
	> - æ‰€ä»¥ IO å°±åŒ…æ‹¬ä¸¤ä¸ªè¿‡ç¨‹ï¼Œä¸€ä¸ªæ˜¯==ç­‰å¾…æ•°æ®==çš„è¿‡ç¨‹ï¼Œä¸€ä¸ªæ˜¯==è¯»å†™ï¼ˆæ‹·è´ï¼‰æ•°æ®==çš„è¿‡ç¨‹ã€‚è€Œä¸”è¿˜è¦æ˜Žç™½ï¼Œä¸€å®š==ä¸èƒ½åŒ…æ‹¬æ“ä½œæ•°æ®çš„è¿‡ç¨‹==ã€‚

5. ==é˜»å¡ž IO å’Œéžé˜»å¡ž IO==ï¼š

	> - é˜»å¡ž IOï¼šç”¨æˆ·çº¿ç¨‹è¢«é˜»å¡žåœ¨==ç­‰å¾…æ•°æ®==ä¸Šæˆ–==æ‹·è´æ•°æ®==ä¸Šã€‚
	> - éžé˜»å¡ž IOï¼šå°±æ˜¯ç”¨æˆ·çº¿ç¨‹==ä¸å‚ä¸Žä»¥ä¸Šä¸¤ä¸ªè¿‡ç¨‹==ï¼Œå³æ•°æ®å·²ç»æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´åŽï¼Œæ‰åŽ»==é€šçŸ¥ç”¨æˆ·çº¿ç¨‹==ï¼Œä¸€ä¸Šæ¥å°±å¯ä»¥==ç›´æŽ¥æ“ä½œæ•°æ®==äº†ã€‚

6. ==åŒæ­¥ IO å’ŒåŒæ­¥é˜»å¡ž IO==ï¼š

	> - åŒæ­¥ IO æ˜¯æŒ‡å‘èµ· IO è¯·æ±‚åŽï¼Œ==å¿…é¡»æ‹¿åˆ° IO çš„æ•°æ®æ‰å¯ä»¥ç»§ç»­æ‰§è¡Œ==ã€‚
	> - åœ¨ç­‰å¾…æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œå’Œæ‹·è´æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œçº¿ç¨‹éƒ½åœ¨é˜»å¡žï¼Œè¿™å°±æ˜¯åŒæ­¥é˜»å¡ž IOã€‚
	> - åœ¨==ç­‰å¾…æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œçº¿ç¨‹é‡‡ç”¨æ­»å¾ªçŽ¯å¼è½®è¯¢==ï¼Œåœ¨==æ‹·è´æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œçº¿ç¨‹åœ¨é˜»å¡ž==ï¼Œè¿™å…¶å®žè¿˜æ˜¯åŒæ­¥é˜»å¡ž IOã€‚
	> - ==åŒæ­¥ IO== æ„å‘³ç€å¿…é¡»æ‹¿åˆ° IO çš„æ•°æ®ï¼Œæ‰å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚å› ä¸º==åŽç»­æ“ä½œä¾èµ– IO æ•°æ®ï¼Œæ‰€ä»¥å®ƒå¿…é¡»æ˜¯é˜»å¡žçš„==ã€‚==éžé˜»å¡ž IO== æ„å‘³ç€å‘èµ· IO è¯·æ±‚åŽï¼Œå¯ä»¥ç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚==è¯´æ˜ŽåŽç»­æ‰§è¡Œä¸ä¾èµ–äºŽ IO æ•°æ®==ï¼Œæ‰€ä»¥å®ƒè‚¯å®šä¸æ˜¯åŒæ­¥çš„ã€‚
	> - æ‰€ä»¥ï¼Œ==åŒæ­¥ IO ä¸€å®šæ˜¯é˜»å¡ž IO==ï¼ŒåŒæ­¥ IO ä¹Ÿå°±æ˜¯åŒæ­¥é˜»å¡ž IOã€‚

7. ==å¼‚æ­¥ IO å’Œå¼‚æ­¥é˜»å¡ž/éžé˜»å¡ž IO==ï¼š

	> - å¼‚æ­¥é˜»å¡ž IOï¼šç”¨æˆ·çº¿ç¨‹==æ²¡æœ‰å‚ä¸Žæ•°æ®ç­‰å¾…çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥å®ƒæ˜¯å¼‚æ­¥çš„==ã€‚ä½†==ç”¨æˆ·çº¿ç¨‹å‚ä¸Žäº†æ•°æ®æ‹·è´çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥å®ƒåˆæ˜¯é˜»å¡žçš„==ã€‚
	> - å¼‚æ­¥éžé˜»å¡ž IOï¼šç”¨æˆ·çº¿ç¨‹æ—¢æ²¡æœ‰å‚ä¸Žç­‰å¾…è¿‡ç¨‹ä¹Ÿæ²¡æœ‰å‚ä¸Žæ‹·è´è¿‡ç¨‹ï¼Œæ‰€ä»¥å®ƒæ˜¯å¼‚æ­¥çš„ã€‚==å½“å®ƒæŽ¥åˆ°é€šçŸ¥æ—¶ï¼Œæ•°æ®å·²ç»å‡†å¤‡å¥½äº†ï¼Œå®ƒæ²¡æœ‰å› ä¸ºIOæ•°æ®è€Œé˜»å¡žè¿‡==ï¼Œæ‰€ä»¥å®ƒåˆæ˜¯éžé˜»å¡žçš„ã€‚

---



#### 3.Java8 çš„æ–°ç‰¹æ€§ä¸Žæ¡ˆä¾‹è§£æž

1. ==Lambda è¡¨è¾¾å¼==ï¼š

	> - Lambda ==ä¸»è¦è§£å†³çš„æ˜¯ä»£ç çš„å†—ä½™é—®é¢˜==ã€‚Java 8 ä¹‹å‰ï¼Œä¸ºäº†ä¼ é€’åŠŸèƒ½åˆ°æ–¹æ³•ä¸­ï¼Œå¿…é¡»ä½¿ç”¨==åŒ¿åå†…éƒ¨ç±»ï¼Œå¯¼è‡´ä»£ç éžå¸¸å†—ä½™ä¸”éš¾ä»¥é˜…è¯»==ï¼Œä½¿ç”¨ lambda è¡¨è¾¾å¼å¯ä»¥ä»¥ä¸€ç§éžå¸¸==ç®€æ´çš„æ–¹å¼==æ›¿ä»£å®ƒï¼ŒåŒæ—¶ä¹Ÿä¸º Java å¼•å…¥äº†å‡½æ•°å¼ç¼–ç¨‹çš„èƒ½åŠ›ã€‚
	> - Lambda çš„å¥½å¤„åœ¨äºŽå®ƒèƒ½ä»¥æ›´ç´§å‡‘çš„æ–¹å¼è¡¨ç¤ºä»£ç é€»è¾‘ï¼Œå†™å‡ºæ¥çš„ä»£ç ç®€æ´æ¸…æ™°ï¼Œå¯è¯»æ€§å¥½ã€‚==ç»“åˆ Stream API å¯ä»¥ç®€æ´é«˜æ•ˆçš„å¯¹é›†åˆè¿›è¡Œæ“ä½œ==ã€‚

2. ==Stream API==ï¼š

	> - ä¸åŒäºŽé›†åˆå…³æ³¨çš„æ˜¯å¯¹æ•°æ®çš„å­˜å‚¨ï¼Œå®ƒå…³æ³¨çš„æ˜¯å¯¹æ•°æ®çš„è¿ç®—å¤„ç†ï¼Œæ¯”å¦‚å¯ä»¥å¯¹é›†åˆè¿›è¡Œ==è¿‡æ»¤ï¼ˆfilterï¼‰ï¼Œæ˜ å°„ï¼ˆmapï¼‰ï¼ŒæŽ’åºï¼ˆsortï¼‰==ç­‰ç­‰ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿååˆ†ç®€æ´ã€‚
	>
	> - Lambda + Stream demoï¼š
	>
	> 	```java
	> 	public class LambdaStreamExample {
	> 	    public static void main(String[] args) {
	> 	        List numbers = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);
	> 																					
	> 	        // ä½¿ç”¨Lambdaå’ŒStream APIè¿‡æ»¤å’Œæ˜ å°„é›†åˆ
	> 	        List result = numbers.stream()
	> 	            .filter(n -> n % 2 != 0) // è¿‡æ»¤æŽ‰å¶æ•°
	> 	            .map(n -> n * 2) // å°†å‰©ä¸‹çš„æ•°å­—åŠ å€
	> 	            .toList();
	> 																					
	> 	        // è¾“å‡ºç»“æžœ
	> 	        System.out.println(result); // è¾“å‡º: [2, 6, 10, 14, 18]
	> 	    }
	> 	}
	> 	```

3. ==Optional ç±»==ï¼š

	> - Optionalç±»æ˜¯Java 8ä¸­å¼•å…¥çš„ä¸€ä¸ªæ–°ç±»ï¼Œç”¨äºŽ==è§£å†³ç©ºæŒ‡é’ˆå¼‚å¸¸é—®é¢˜==ã€‚å®ƒæ˜¯ä¸€ä¸ªå®¹å™¨å¯¹è±¡ï¼Œ==å¯ä»¥åŒ…å«ä¸€ä¸ªéžç©ºå€¼æˆ–è€…ä¸ºç©º==ã€‚
	>
	> - ```java
	> 	public static void main(String[] args) {
	> 																					
	> 	    // åˆ›å»ºä¸€ä¸ªåŒ…å«éžç©ºå€¼çš„Optionalå¯¹è±¡
	> 	    Optional<String> optional1 = Optional.of("Hello World");
	> 																					
	> 	    // åˆ›å»ºä¸€ä¸ªä¸ºç©ºçš„Optionalå¯¹è±¡
	> 	    Optional<String> optional2 = Optional.empty();
	> 																					
	> 	    // è¾“å‡ºOptionalå¯¹è±¡çš„å€¼
	> 	    System.out.println(optional1.get()); // Hello World
	> 																					
	> 	    // å¦‚æžœOptionalå¯¹è±¡ä¸ºç©ºï¼Œåˆ™æŠ›å‡ºNoSuchElementExceptionå¼‚å¸¸
	> 	    System.out.println(optional2.get()); // æŠ›å‡ºNoSuchElementExceptionå¼‚å¸¸
	> 																					
	> 	    // åˆ¤æ–­Optionalå¯¹è±¡æ˜¯å¦æœ‰å€¼
	> 	    System.out.println(optional1.isPresent()); // true
	> 	    System.out.println(optional2.isPresent()); // false
	> 																					
	> 	    // å¦‚æžœOptionalå¯¹è±¡ä¸ºç©ºï¼Œåˆ™è¿”å›žæŒ‡å®šçš„é»˜è®¤å€¼
	> 	    System.out.println(optional2.orElse("Default Value")); // Default Value
	> 																					
	> 	    // å¦‚æžœOptionalå¯¹è±¡ä¸ºç©ºï¼Œåˆ™æ‰§è¡ŒæŒ‡å®šçš„æ“ä½œ
	> 	    optional2.ifPresent(value -> System.out.println("Value is present"));
	> 	}
	> 	```

4. ==æ—¶é—´ API==ï¼š

	> - ==LocalDateTime==ï¼šLocalDateTimeæ˜¯ä¸€ä¸ªåŒæ—¶è¡¨ç¤ºæ—¥æœŸå’Œæ—¶é—´çš„ç±»ï¼Œå¯ä»¥ç”¨äºŽå­˜å‚¨å’Œæ“ä½œ==å¹´ã€æœˆã€æ—¥ã€å°æ—¶ã€åˆ†é’Ÿã€ç§’==ç­‰ä¿¡æ¯ã€‚
	>
	> - ==Instant==ï¼šInstantæ˜¯ä¸€ä¸ªè¡¨ç¤ºæ—¶é—´æˆ³çš„ç±»ï¼Œå¯ä»¥ç”¨äºŽ==å­˜å‚¨å’Œæ“ä½œä»¥1970å¹´1æœˆ1æ—¥ä¸ºèµ·ç‚¹çš„ç§’æ•°==ã€‚
	>
	> - ==Duration==ï¼šDurationæ˜¯ä¸€ä¸ªè¡¨ç¤ºæ—¶é—´é—´éš”çš„ç±»ï¼Œå¯ä»¥ç”¨äºŽ==è®¡ç®—ä¸¤ä¸ªæ—¶é—´ç‚¹ä¹‹é—´çš„å·®å€¼==ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨Durationæ¥è®¡ç®—ä¸¤ä¸ªæ—¶é—´ç‚¹çš„å·®å€¼ï¼š
	>
	> 	```java
	> 	LocalDateTime dateTime1 = LocalDateTime.of(2021, 1, 1, 0, 0, 0);
	> 	LocalDateTime dateTime2 = LocalDateTime.now();
	> 	Duration duration = Duration.between(dateTime1, dateTime2);
	> 	System.out.println("Duration between " + dateTime1 + " and " + dateTime2 + ": " + duration);
	> 	```
	>
	> - ==Period==ï¼šPeriodæ˜¯ä¸€ä¸ªè¡¨ç¤ºæ—¥æœŸé—´éš”çš„ç±»ï¼Œå¯ä»¥ç”¨äºŽè®¡ç®—==ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„å·®å€¼==ã€‚

5. ==æŽ¥å£çš„é»˜è®¤æ–¹æ³•å’Œé™æ€æ–¹æ³•==

6. ==æ–¹æ³•å¼•ç”¨==ï¼š

	> - ==é™æ€æ–¹æ³•å¼•ç”¨==ï¼š
	>
	> 	```java
	> 	public class MethodReferenceExample {
	> 	
	> 	    public static void printMessage() {
	> 	        System.out.println("Hello, world!");
	> 	    }
	> 	
	> 	    public static void main(String[] args) {
	> 	        // ä½¿ç”¨æ–¹æ³•å¼•ç”¨çš„æ–¹å¼å°†å®ƒä¼ é€’ç»™ä¸€ä¸ªå‡½æ•°å¼æŽ¥å£
	> 	        Runnable runnable = MethodReferenceExample::printMessage;
	> 	        Thread thread = new Thread(runnable);
	> 	        thread.start();
	> 	    }
	> 	}
	> 	```
	>
	> - ==å®žä¾‹æ–¹æ³•å¼•ç”¨==ï¼š
	>
	> 	```java
	> 	public class MethodReferenceExample {
	> 	
	> 	    public static void main(String[] args) {
	> 	        List<Person> people = Arrays.asList(
	> 	            new Person("Alice"), new Person("Bob"), new Person("Charlie"));
	> 	
	> 	        // ä½¿ç”¨ Lambda è¡¨è¾¾å¼
	> 	        people.forEach(person -> System.out.println(person.getName()));
	> 	
	> 	        // ä½¿ç”¨æ–¹æ³•å¼•ç”¨
	> 	        people.forEach(Person::getName);
	> 	    }
	> 	}
	> 	
	> 	class Person {
	> 	    private String name;
	> 	
	> 	    public Person(String name) {
	> 	        this.name = name;
	> 	    }
	> 	
	> 	    public String getName() {
	> 	        return name;
	> 	    }
	> 	}
	> 	```
	>
	> - ==æž„é€ æ–¹æ³•å¼•ç”¨==ï¼š
	>
	> 	```java
	> 	public class MethodReferenceExample {
	> 																					
	> 	    public static void main(String[] args) {
	> 	        // ä½¿ç”¨ Lambda è¡¨è¾¾å¼
	> 	        Supplier<Person> supplier1 = () -> new Person();
	> 																					
	> 	        // ä½¿ç”¨æ–¹æ³•å¼•ç”¨
	> 	        Supplier<Person> supplier2 = Person::new;
	> 	    }
	> 	}
	> 																					
	> 	class Person {
	> 	    public Person() {
	> 	    }
	> 	}
	> 	```

---



### é¢˜ç›®

#### 1.ã€IOä¸“é¢˜ã€‘åŒæ­¥ å¼‚æ­¥ é˜»å¡ž éžé˜»å¡žæ¦‚å¿µé—®é¢˜

==é—®é¢˜ä¸€==ï¼š==è§£é‡Šä¸€ä¸‹ åŒæ­¥ å¼‚æ­¥ é˜»å¡ž éžé˜»å¡ž çš„æ¦‚å¿µï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. åŒæ­¥æ˜¯æŒ‡å¤šä¸ªä»»åŠ¡ä¸èƒ½åŒæ—¶æ‰§è¡Œï¼Œå¿…é¡»æŒ‰ç…§é¡ºåºä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œã€‚
> 2. å¼‚æ­¥åˆ™å…è®¸å¤šä¸ªä»»åŠ¡åŒæ—¶æ‰§è¡Œï¼Œå®ƒä»¬ä¹‹é—´äº’ä¸å¹²æ‰°ã€‚
> 3. ==é˜»å¡žå°±æ˜¯æŸä¸ªäº‹ä»¶ç”±äºŽæŸäº›åŽŸå› ä¸èƒ½è¿›è¡Œï¼Œéœ€è¦åœä¸‹ç­‰å¾…ï¼Œä¸è¿‡è¿™æœŸé—´å¯ä»¥å¹²å…¶å®ƒçš„äº‹==ã€‚
> 4. éžé˜»å¡žå°±æ˜¯ç¨‹åºè¿è¡Œæ—¶ç•…é€šæ— é˜»ï¼Œä¸éœ€è¦ç­‰å¾…ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - åŒæ­¥å°±æ˜¯æŒ‡å¤šä¸ªäº‹ä»¶ä¸èƒ½åŒæ—¶è¿›è¡Œï¼Œéœ€è¦æŒ‰ç…§ä¸€å®šçš„æ¬¡åºä¸€ä¸ªä¸€ä¸ªè¿›è¡Œã€‚å¼‚æ­¥å°±æ˜¯æŒ‡å¤šä¸ªäº‹ä»¶èƒ½å¤ŸåŒæ—¶è¿›è¡Œï¼Œäº’ä¸å¹²æ‰°ã€‚
> - ==é˜»å¡žå°±æ˜¯æŸä¸ªäº‹ä»¶ç”±äºŽæŸäº›åŽŸå› ä¸èƒ½è¿›è¡Œï¼Œéœ€è¦åœä¸‹æ¥ç­‰å¾…ï¼Œä½†åœ¨ç­‰å¾…çš„æœŸé—´å¯ä»¥å¹²å…¶ä»–äº‹æƒ…==ã€‚éžé˜»å¡žå°±æ˜¯äº‹ä»¶çš„è¿›è¡Œç•…é€šæ— é˜»ï¼Œæ²¡æœ‰é˜»ç¢ã€‚
>

---

==é—®é¢˜äºŒ==ï¼š==åŒæ­¥/å¼‚æ­¥ å’Œ é˜»å¡ž/éžé˜»å¡ž æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«åœ¨äºŽ==ä»»åŠ¡æ˜¯å¦å¯ä»¥åŒæ—¶æ‰§è¡Œ==ï¼›é˜»å¡žå’Œéžé˜»å¡žçš„åŒºåˆ«åœ¨äºŽ==ä»»åŠ¡èƒ½ä¸èƒ½ç»§ç»­æ‰§è¡Œ==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - åŒæ­¥/å¼‚æ­¥å…³å¿ƒçš„æ˜¯äº‹ä»¶ä¹‹é—´èƒ½ä¸èƒ½åŒæ—¶è¿›è¡Œï¼Œé˜»å¡ž/éžé˜»å¡žå…³å¿ƒçš„æ˜¯å½“å‰äº‹ä»¶èƒ½ä¸èƒ½å¤Ÿç»§ç»­è¿›è¡Œã€‚
> - ä¹Ÿå¯ä»¥æŠŠå®ƒä»¬ä¸¤ä¸¤ç»„åˆï¼Œä»¥çº¿ç¨‹ä¸ºä¾‹å­ï¼š
> - åŒæ­¥é˜»å¡žï¼Œç›¸å½“ä¸ŽåŒä¸€æ—¶åˆ»åªèƒ½è¿è¡Œä¸€ä¸ªçº¿ç¨‹ï¼Œå¹¶ä¸”æ­¤æ—¶è¿˜åœ¨ç­‰å¾…ã€‚
> - åŒæ­¥éžé˜»å¡žï¼Œç›¸å½“ä¸Žä¸€ä¸ªçº¿ç¨‹åœ¨æ­£å¸¸è¿è¡Œã€‚
> - å¼‚æ­¥é˜»å¡žï¼Œç›¸å½“ä¸ŽåŒä¸€æ—¶åˆ»å¯ä»¥è¿è¡Œå¤šä¸ªçº¿ç¨‹ï¼Œä½†æ­¤æ—¶æŸäº›çº¿ç¨‹åœ¨ç­‰å¾…ã€‚
> - å¼‚æ­¥éžé˜»å¡žï¼Œç›¸ç­‰äºŽå¤šä¸ªçº¿ç¨‹éƒ½åœ¨åŒæ—¶æ­£å¸¸è¿è¡Œã€‚
>

---

==é—®é¢˜ä¸‰==ï¼š==è§£é‡Šä¸‹æˆ‘ä»¬å¸¸è¯´çš„ IO æ˜¯æŒ‡ä»€ä¹ˆï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. IO æŒ‡çš„æ˜¯çº¿ç¨‹åœ¨==ç­‰å¾…æ•°æ®==å’Œ==æ‹·è´æ•°æ®==çš„è¿‡ç¨‹ã€‚
> 2. ä»¥ç½‘ç»œ IO ä¸ºä¾‹ï¼Œ==ç­‰å¾…æ•°æ®æ˜¯å®¢æˆ·ç«¯çš„èµ„æºé€šè¿‡ç½‘ç»œä¼ è¾“åˆ°æœåŠ¡ç«¯çš„è¿‡ç¨‹==ï¼›è€Œæ‹·è´æ•°æ®åˆ™æ˜¯åœ¨==æœåŠ¡ç«¯ï¼Œå°†æŽ¥æ”¶åˆ°çš„èµ„æºåœ¨ç”¨æˆ·æ€å’Œå†…æ ¸æ€ä¸­æ‹·è´çš„è¿‡ç¨‹==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ==IO æ˜¯è¯»/å†™æ•°æ®çš„è¿‡ç¨‹ï¼Œä»¥åŠç­‰å¾…æ•°æ®è¿›è¡Œè¯»/å†™çš„è¿‡ç¨‹==ã€‚æ‹¿ç½‘ç»œ IO æ¥è¯´ï¼Œ==ç­‰å¾…çš„è¿‡ç¨‹å°±æ˜¯æ•°æ®ä»Žç½‘ç»œåˆ°ç½‘å¡å†åˆ°å†…æ ¸ç©ºé—´==ï¼Œ==çœŸæ­£è¯»å†™çš„è¿‡ç¨‹æ˜¯æ•°æ®ä»Žå†…æ ¸ç©ºé—´åˆ°ç”¨æˆ·ç©ºé—´çš„ç›¸äº’æ‹·è´==ã€‚

---

==é—®é¢˜å››==ï¼š==ä»€ä¹ˆæ˜¯é˜»å¡ž IO å’Œéžé˜»å¡ž IOï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. é˜»å¡ž IOï¼šç”¨æˆ·çº¿ç¨‹è¢«é˜»å¡žåœ¨==ç­‰å¾…æ•°æ®==ä¸Šæˆ–==æ‹·è´æ•°æ®==ä¸Šã€‚
> 2. éžé˜»å¡ž IOï¼šå°±æ˜¯ç”¨æˆ·çº¿ç¨‹==ä¸å‚ä¸Žä»¥ä¸Šä¸¤ä¸ªè¿‡ç¨‹==ï¼Œå³æ•°æ®å·²ç»æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´åŽï¼Œæ‰åŽ»==é€šçŸ¥ç”¨æˆ·çº¿ç¨‹==ï¼Œä¸€ä¸Šæ¥å°±å¯ä»¥==ç›´æŽ¥æ“ä½œæ•°æ®==äº†ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - é˜»å¡žIO æ˜¯æŒ‡ç¨‹åºåœ¨å‘å‡º IO è¯·æ±‚æ—¶ï¼Œå¦‚æžœ==æ•°æ®æ²¡æœ‰å‡†å¤‡å¥½è¢«æ“ä½œæˆ–æ— æ³•ç«‹å³è¿›è¡Œè¯»å–æˆ–å†™å…¥==ï¼Œç¨‹åºå°†ä¼šè¢«é˜»å¡žï¼Œä¹Ÿå°±æ˜¯æš‚åœæ‰§è¡Œï¼Œç›´åˆ°æ“ä½œå®Œæˆæˆ–è€…æœ‰æ•°æ®å¯ç”¨ï¼Œæ‰èƒ½è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚
> - éžé˜»å¡ž IO åˆ™æ˜¯ç›¸åçš„æ¦‚å¿µã€‚éžé˜»å¡ž IO æ˜¯æŒ‡ç¨‹åºå‘å‡º IO è¯·æ±‚æ—¶ï¼Œå¦‚æžœæ•°æ®æ²¡æœ‰å‡†å¤‡å¥½æˆ–æ— æ³•ç«‹å³è¿›è¡Œè¯»å–æˆ–å†™å…¥ï¼Œ==ç¨‹åºä¸ä¼šè¢«é˜»å¡žï¼Œè€Œæ˜¯ç«‹å³è¿”å›ž==ï¼Œå¹¶==å…è®¸ç¨‹åºåŽ»æ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼ˆå…¶å®ƒä»»åŠ¡éœ€è¦ä¸ä¾èµ– IO çš„æ•°æ®ï¼‰==ã€‚ç¨‹åºå¯ä»¥==å®šæœŸè½®è¯¢== IO æ“ä½œçš„çŠ¶æ€ï¼Œæ¥ç¡®å®šä½•æ—¶æ•°æ®å·²ç»å‡†å¤‡å¥½ï¼Œæˆ–è€…å¯ä»¥ä½¿ç”¨==å›žè°ƒå‡½æ•°==æˆ–==äº‹ä»¶é€šçŸ¥==ç­‰æœºåˆ¶æ¥æŽ¥æ”¶é€šçŸ¥ã€‚
>

---

==é—®é¢˜äº”==ï¼š==ä»€ä¹ˆæ˜¯ åŒæ­¥ IO å’ŒåŒæ­¥é˜»å¡ž IOï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. åŒæ­¥ IO å…¶å®žå°±æ˜¯åŒæ­¥é˜»å¡ž IOï¼Œå› ä¸ºåŒæ­¥å’Œé˜»å¡ž==éƒ½éœ€è¦ä¾èµ– IO çš„æ•°æ®æ‰èƒ½è¿›è¡ŒåŽç»­çš„æ“ä½œ==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - åŒæ­¥IO å°±æ˜¯åŒæ­¥é˜»å¡ž IOï¼Œéƒ½å±žäºŽé˜»å¡žIOï¼Œè¡¨ç¤ºç¨‹åºå‘èµ· IO è¯·æ±‚åŽï¼Œå¿…é¡»æ‹¿åˆ° IO çš„æ•°æ®åŽæ‰èƒ½ç»§ç»­æ‰§è¡Œï¼Œå¹¶ä¸”åœ¨ç­‰å¾…æ•°æ®æˆ–è€…æ‹·è´æ•°æ®çš„æœŸé—´ï¼Œç¨‹åºéƒ½æ˜¯é˜»å¡žçŠ¶æ€ã€‚
>

---

==é—®é¢˜å…­==ï¼š==ä»€ä¹ˆæ˜¯å¼‚æ­¥ IO å’Œå¼‚æ­¥é˜»å¡ž/éžé˜»å¡ž IOï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==å¼‚æ­¥ IO æ— éœ€è¿›è¡Œ IO æ“ä½œä¸­çš„ç­‰å¾…æ•°æ®==çš„éƒ¨åˆ†ï¼Œå³å¯ç»§ç»­æ‰§è¡Œã€‚
> 2. è€Œå¼‚æ­¥çš„é˜»å¡žå’Œéžé˜»å¡ž IOï¼Œåˆ™ç”±==æ˜¯å¦ä¼šåœ¨æ‹·è´æ•°æ®æ—¶é˜»å¡žåŒºåˆ†==ã€‚å¼‚æ­¥é˜»å¡ž IO ä¼šåœ¨æ‹·è´æ•°æ®æ—¶é˜»å¡žï¼Œè€Œéžé˜»å¡ž IO åˆ™ä¸ä¼šè¢«æ‹·è´æ•°æ®é˜»å¡žã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - å¼‚æ­¥IO å°±æ˜¯ç¨‹åºå‘èµ· IO è¯·æ±‚åŽï¼Œ==ä¸ç”¨æ‹¿åˆ°æ•°æ®å°±å¯ä»¥ç»§ç»­æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯åœ¨ç­‰å¾…æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œç¨‹åºæ˜¯å¯ä»¥ç»§ç»­æ‰§è¡Œçš„==ã€‚ä½†æ ¹æ®==æ‹·è´æ•°æ®æ—¶ç¨‹åºæ˜¯å¦é˜»å¡ž==ï¼Œåˆå¯ä»¥åˆ†ä¸ºå¼‚æ­¥é˜»å¡ž/éžé˜»å¡žIOã€‚
> - ä¹Ÿå°±æ˜¯è¯´ï¼Œ==ç­‰å¾…æ•°æ®è¿‡ç¨‹ä¸­ï¼Œç¨‹åºç»§ç»­æ‰§è¡Œ==ï¼Œä½†==æ‹·è´æ•°æ®æ—¶ç¨‹åºé˜»å¡žï¼Œæ˜¯å¼‚æ­¥é˜»å¡žIO==ã€‚ç­‰å¾…è¿‡ç¨‹ä¸­ï¼Œç¨‹åºç»§ç»­æ‰§è¡Œï¼Œæ‹·è´æ•°æ®æ—¶ç¨‹åºä¹Ÿç»§ç»­æ‰§è¡Œï¼Œæ˜¯å¼‚æ­¥éžé˜»å¡žIOã€‚
>

---



#### 2.ã€IOä¸“é¢˜ã€‘select, poll, epollðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==é—®é¢˜ä¸€==ï¼š==I/Oå¤šè·¯å¤ç”¨è®²ä¸€ä¸‹ï¼Œæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. é¦–å…ˆä¸€ä¸ªçº¿ç¨‹ä¸æ–­æŽ¥å—å®¢æˆ·ç«¯è¿žæŽ¥ï¼Œå¹¶==æŠŠ socket æ–‡ä»¶æè¿°ç¬¦æ”¾åˆ°ä¸€ä¸ª list== é‡Œã€‚
> 2. ç„¶åŽï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸å†è‡ªå·±éåŽ†ï¼Œè€Œæ˜¯==è°ƒç”¨ selectï¼Œå°†è¿™æ‰¹æ–‡ä»¶æè¿°ç¬¦ list äº¤ç»™æ“ä½œç³»ç»Ÿçš„å†…æ ¸æ€åŽ»éåŽ†ï¼ˆå¦‚æžœè‡ªå·±éåŽ†çš„è¯ï¼Œæ¯ä¸€ä¸ªéƒ½éœ€è¦ä»Žç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€ï¼Œè¿™æ ·åªéœ€ä¸€æ¬¡è½¬æ¢ï¼‰==ã€‚
> 3. ä¸è¿‡ï¼Œå½“ select å‡½æ•°è¿”å›žåŽï¼Œç”¨æˆ·ä¾ç„¶éœ€è¦éåŽ†åˆšåˆšæäº¤ç»™æ“ä½œç³»ç»Ÿçš„ listã€‚åªä¸è¿‡ï¼Œ==æ“ä½œç³»ç»Ÿä¼šå°†å‡†å¤‡å°±ç»ªçš„æ–‡ä»¶æè¿°ç¬¦åšä¸Šæ ‡è¯†==ï¼Œç”¨æˆ·å±‚å°±æ— éœ€ç­‰å¾…æ–‡ä»¶ã€‚
> 4. å®ƒçš„ä¼˜ç‚¹å¾ˆæ˜Žæ˜¾ï¼Œä½¿ç”¨==å•çº¿ç¨‹å°±å¯ä»¥ç›‘å¬å¤šä¸ª IO äº‹ä»¶==ï¼Œ==é¿å…äº†çº¿ç¨‹åˆ‡æ¢çš„å¼€é”€==ã€‚åŒæ—¶==åˆ©ç”¨äº†æ“ä½œç³»ç»Ÿæä¾›çš„ç³»ç»Ÿè°ƒç”¨ï¼Œæ•ˆçŽ‡å¾ˆé«˜==ã€‚ä½†å®ƒ==ä¸èƒ½å……åˆ†åˆ©ç”¨å¤šæ ¸å¤„ç†å™¨==ï¼Œå¹¶ä¸”ä½¿ç”¨ä¸åŒçš„ç³»ç»Ÿè°ƒç”¨ï¼Œä¼˜ç¼ºç‚¹ä¹Ÿä¸åŒã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - I/O å¤šè·¯å¤ç”¨æ˜¯æŒ‡ï¼Œ==ç”¨ä¸€ä¸ªçº¿ç¨‹åŒæ—¶ç›‘å¬å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦==ã€‚å®ƒçš„==ä¸»è¦æ€æƒ³æ˜¯å°†å¤šä¸ª I/O äº‹ä»¶æ³¨å†Œåˆ°ä¸€ä¸ªç»Ÿä¸€çš„äº‹ä»¶å¾ªçŽ¯ä¸­==ï¼Œç„¶åŽé€šè¿‡è°ƒç”¨ç³»ç»Ÿè°ƒç”¨ï¼Œå¸¸è§çš„æœ‰ selectï¼Œpollï¼Œepollï¼Œç­‰å¾…å…¶ä¸­ä»»æ„ä¸€ä¸ªäº‹ä»¶å‘ç”Ÿã€‚ä¸€æ—¦æœ‰äº‹ä»¶å‘ç”Ÿï¼Œç³»ç»Ÿè°ƒç”¨å°±ä¼šè¿”å›žå¹¶å‘Šè¯‰åº”ç”¨ç¨‹åºå“ªäº›äº‹ä»¶å·²ç»å°±ç»ªï¼Œåº”ç”¨ç¨‹åºå¯ä»¥æ ¹æ®è¿”å›žçš„ç»“æžœè¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚
> - å®ƒçš„ä¼˜ç‚¹å¾ˆæ˜Žæ˜¾ï¼Œä½¿ç”¨==å•çº¿ç¨‹å°±å¯ä»¥ç›‘å¬å¤šä¸ª IO äº‹ä»¶ï¼Œé¿å…äº†çº¿ç¨‹åˆ‡æ¢çš„å¼€é”€==ã€‚åŒæ—¶==åˆ©ç”¨äº†æ“ä½œç³»ç»Ÿæä¾›çš„ç³»ç»Ÿè°ƒç”¨ï¼Œæ•ˆçŽ‡å¾ˆé«˜==ã€‚ä½†å®ƒ==ä¸èƒ½å……åˆ†åˆ©ç”¨å¤šæ ¸å¤„ç†å™¨==ï¼Œå¹¶ä¸”ä½¿ç”¨ä¸åŒçš„ç³»ç»Ÿè°ƒç”¨ï¼Œä¼˜ç¼ºç‚¹ä¹Ÿä¸åŒã€‚
>

---

==é—®é¢˜äºŒ==ï¼š==ä»‹ç»ä¸€ä¸‹ selectï¼Œpoll å’Œ epollï¼Œä»–ä»¬åŒºåˆ«çŸ¥é“å˜›ï¼Ÿè®²ä¸€ä¸‹ï¼Œå®ƒä»¬ç®—åŒæ­¥è¿˜æ˜¯å¼‚æ­¥ IOï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. select ==å°† socker æ–‡ä»¶æè¿°ç¬¦æ•°ç»„ä¼ ç»™æ“ä½œç³»ç»Ÿçš„å†…æ ¸æ€==ï¼Œç”±å†…æ ¸æ€éåŽ†è°ƒç”¨éžé˜»å¡ž readï¼Œç„¶åŽå°†==ç­›é€‰å‡ºå¯ä»¥è¿›è¡Œè¯»å†™çš„æ–‡ä»¶æè¿°ç¬¦å¹¶åšä¸ªæ ‡è®°==ï¼Œç„¶åŽå°†å…¶ã€Œä¸ªæ•°ã€é€šè¿‡å‡½æ•°è¿”å›žå€¼å‘ŠçŸ¥ç”¨æˆ·å±‚ï¼Œç”¨æˆ·å±‚æ­¤æ—¶å†éåŽ†è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦æ•°ç»„ï¼Œæ‰¾å‡ºåšè¿‡æ ‡è®°çš„æ–‡ä»¶æè¿°ç¬¦å³å¯ã€‚
> 2. poll ç›¸è¾ƒäºŽ selectï¼Œä¸»è¦æ˜¯==å–æ¶ˆäº† select åªèƒ½ç›‘å¬ 1024 ä¸ªæ–‡ä»¶æè¿°ç¬¦çš„é™åˆ¶==ï¼Œä¹Ÿå°±æ˜¯æ— é™åˆ¶ã€‚
> 3. epoll é’ˆå¯¹ selectï¼Œpoll çš„ç¼ºç‚¹åšäº†ç›¸å¯¹åº”çš„æ”¹è¿›ã€‚æ¯”å¦‚ ==epoll ä¼šåœ¨å†…æ ¸æ€ä¸­ä¿å­˜æ–‡ä»¶æè¿°ç¬¦çš„é›†åˆï¼Œé¿å…æ¯æ¬¡è°ƒç”¨æ—¶éƒ½æ‹·è´==ï¼›å¹¶ä¸” epoll ==åªä¼šå°†å‘ç”Ÿ IO äº‹ä»¶çš„æ–‡ä»¶æè¿°ç¬¦è¿”å›žç»™ç”¨æˆ·==ï¼ŒçœåŽ»äº†ç”¨æˆ·å±‚çš„éåŽ†æ“ä½œï¼›é™¤æ­¤ä¹‹å¤–ï¼Œepoll å°†åŽŸå…ˆå¯¹æ–‡ä»¶æè¿°ç¬¦é›†åˆçš„==è½®è¯¢ä¼˜åŒ–ä¸ºäº†åŸºäºŽ IO äº‹ä»¶çš„å›žè°ƒ==ï¼Œæ•´ä½“æ•ˆçŽ‡ä¸ä¼šéšç€æ–‡ä»¶æè¿°ç¬¦çš„å¢žå¤šè€Œé™ä½Žï¼Œæ•ˆçŽ‡è¿œé«˜äºŽ select å’Œ pollã€‚ä¸è¿‡ ==epoll åªèƒ½åœ¨ linux ä¸‹ä½¿ç”¨==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - select å°±æ˜¯å°†åœ¨ç”¨æˆ·æ€å¯¹==æ–‡ä»¶æè¿°ç¬¦æ•°ç»„==çš„éåŽ†æ“ä½œï¼Œ==äº¤ç»™æ“ä½œç³»ç»Ÿåœ¨å†…æ ¸æ€åŽ»è¿›è¡Œ==ã€‚æ“ä½œç³»ç»Ÿä¼š==ç­›é€‰==å‡ºå¯ä»¥è¿›è¡Œè¯»å†™çš„æ–‡ä»¶æè¿°ç¬¦å¹¶åšä¸ª==æ ‡è®°==ï¼Œç„¶åŽå°†å…¶ã€Œä¸ªæ•°ã€é€šè¿‡å‡½æ•°è¿”å›žå€¼å‘ŠçŸ¥ç”¨æˆ·å±‚ï¼Œç”¨æˆ·å±‚æ­¤æ—¶å†éåŽ†è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦æ•°ç»„ï¼Œæ‰¾å‡ºåšè¿‡æ ‡è®°çš„æ–‡ä»¶æè¿°ç¬¦å³å¯ã€‚
> - select æœ€æ—©å®žçŽ°äº†==ä¸€ä¸ªçº¿ç¨‹å¤„ç†å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦==çš„åŠŸèƒ½ï¼Œå‡å°‘äº†ç³»ç»Ÿè°ƒç”¨çš„å¼€é”€ã€‚ä½†æ˜¯æ•´ä¸ªè¿‡ç¨‹ä¼šå‘ç”Ÿ==æ–‡ä»¶æè¿°ç¬¦æ•°ç»„ä»Žç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„æ¥å›žæ‹·è´ï¼Œé«˜å¹¶å‘åœºæ™¯ä¸‹èµ„æºæ¶ˆè€—å¤š==ã€‚å¹¶ä¸” select æœ€å¤šåªèƒ½ç›‘å¬ 1024 ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚
> - poll ç›¸è¾ƒäºŽ selectï¼Œä¸»è¦æ˜¯==å–æ¶ˆäº† select åªèƒ½ç›‘å¬ 1024 ä¸ªæ–‡ä»¶æè¿°ç¬¦çš„é™åˆ¶==ï¼Œä¹Ÿå°±æ˜¯æ— é™åˆ¶ã€‚
> - epoll é’ˆå¯¹ selectï¼Œpoll çš„ç¼ºç‚¹åšäº†ç›¸å¯¹åº”çš„æ”¹è¿›ã€‚æ¯”å¦‚ ==epoll ä¼šåœ¨å†…æ ¸æ€ä¸­ä¿å­˜æ–‡ä»¶æè¿°ç¬¦çš„é›†åˆï¼Œé¿å…æ¯æ¬¡è°ƒç”¨æ—¶éƒ½æ‹·è´==ï¼›å¹¶ä¸” epoll ==åªä¼šå°†å‘ç”Ÿ IO äº‹ä»¶çš„æ–‡ä»¶æè¿°ç¬¦è¿”å›žç»™ç”¨æˆ·==ï¼ŒçœåŽ»äº†ç”¨æˆ·å±‚çš„éåŽ†æ“ä½œï¼›é™¤æ­¤ä¹‹å¤–ï¼Œepoll å°†åŽŸå…ˆå¯¹æ–‡ä»¶æè¿°ç¬¦é›†åˆçš„==è½®è¯¢ä¼˜åŒ–ä¸ºäº†åŸºäºŽ IO äº‹ä»¶çš„å›žè°ƒ==ï¼Œæ•´ä½“æ•ˆçŽ‡ä¸ä¼šéšç€æ–‡ä»¶æè¿°ç¬¦çš„å¢žå¤šè€Œé™ä½Žï¼Œæ•ˆçŽ‡è¿œé«˜äºŽ select å’Œ pollã€‚ä¸è¿‡ ==epoll åªèƒ½åœ¨ linux ä¸‹ä½¿ç”¨==ã€‚
> - å®ƒä»¬==éƒ½ç®—æ˜¯åŒæ­¥ IO==ï¼Œå› ä¸ºç¨‹åºåœ¨æ‰§è¡Œè¿™ä¸‰ç§ç³»ç»Ÿè°ƒç”¨å‡½æ•°æ—¶ï¼Œ==éƒ½éœ€è¦é˜»å¡žç­‰å¾…ç›´åˆ° I/O æ“ä½œå®Œæˆ==ã€‚
>

---

==é—®é¢˜ä¸‰==ï¼š==å…³äºŽ select, epoll çš„åº”ç”¨ï¼Œä½ äº†è§£å“ªäº›ï¼Ÿï¼ˆå°±æ˜¯å“ªäº›å·¥å…·ç”¨äº†è¿™äº›æœºåˆ¶ï¼‰==

==æˆ‘çš„å›žç­”==ï¼š

> 1. æ¯”å¦‚ Redis æ˜¯å•çº¿ç¨‹å´è¿˜é‚£ä¹ˆå¿«ï¼ŒåŽŸå› å°±æ˜¯ ==Redis å€Ÿç”¨äº† Linux çš„ IO å¤šè·¯å¤ç”¨æœºåˆ¶==ã€‚è¯¥æœºåˆ¶ä¸­çš„==å†…æ ¸ï¼ˆå†…æ ¸æ€ï¼‰ä¼šæœ‰å¤šä¸ªç›‘å¬å¥—æŽ¥å­—å’Œå·²è¿žæŽ¥å¥—æŽ¥å­—==ï¼ŒåŒæ—¶å†…æ ¸ä¼šä¸€ç›´ç›‘å¬è¿™äº›å¥—æŽ¥å­—çš„è¿žæŽ¥è¯·æ±‚æˆ–æ•°æ®è¯·æ±‚ï¼Œ==ä¸€æ—¦æœ‰è¯·æ±‚åˆ°è¾¾ï¼Œå°±ä¼šå°†å…¶äº¤ç»™ Redis çº¿ç¨‹ï¼ˆæ ‡è®°å¹¶è¿”å›žç»™ç”¨æˆ·æ€ï¼‰å¤„ç†==ã€‚
> 2. å…¶å®ƒçš„æ¯”å¦‚ ==Nginxï¼ŒNetty è¿™ç§é«˜æ€§èƒ½ç½‘ç»œåº”ç”¨æ¡†æž¶==ï¼Œåº•å±‚éƒ½ä¼šç”¨åˆ° IO å¤šè·¯å¤ç”¨æ¥æé«˜æ€§èƒ½ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - æ¯”å¦‚ Redis æ˜¯å•çº¿ç¨‹å´è¿˜é‚£ä¹ˆå¿«ï¼ŒåŽŸå› å°±æ˜¯ ==Redis å€Ÿç”¨äº† Linux çš„ IO å¤šè·¯å¤ç”¨æœºåˆ¶==ã€‚è¯¥æœºåˆ¶ä¸­çš„==å†…æ ¸ï¼ˆå†…æ ¸æ€ï¼‰ä¼šæœ‰å¤šä¸ªç›‘å¬å¥—æŽ¥å­—å’Œå·²è¿žæŽ¥å¥—æŽ¥å­—==ï¼ŒåŒæ—¶å†…æ ¸ä¼šä¸€ç›´ç›‘å¬è¿™äº›å¥—æŽ¥å­—çš„è¿žæŽ¥è¯·æ±‚æˆ–æ•°æ®è¯·æ±‚ï¼Œ==ä¸€æ—¦æœ‰è¯·æ±‚åˆ°è¾¾ï¼Œå°±ä¼šå°†å…¶äº¤ç»™ Redis çº¿ç¨‹ï¼ˆæ ‡è®°å¹¶è¿”å›žç»™ç”¨æˆ·æ€ï¼‰å¤„ç†==ã€‚
> - å…¶å®ƒçš„æ¯”å¦‚ ==Nginxï¼ŒNetty è¿™ç§é«˜æ€§èƒ½ç½‘ç»œåº”ç”¨æ¡†æž¶==ï¼Œåº•å±‚éƒ½ä¼šç”¨åˆ° IO å¤šè·¯å¤ç”¨æ¥æé«˜æ€§èƒ½ã€‚
>

#### 3.ã€Java8æ–°ç‰¹æ€§ã€‘Java8æ–°ç‰¹æ€§ç›¸å…³é¢è¯•é¢˜

==é—®é¢˜ä¸€==ï¼š==å…³äºŽJava8çš„æ–°ç‰¹æ€§ï¼Œä½ äº†è§£å¤šå°‘ï¼Ÿå¯ä»¥è®²å‡ ä¸ªå—ï¼Ÿï¼ˆPSï¼šè®²3ï½ž4ä¸ªå³å¯ï¼ŒLambda å’Œ stream å¿…é¡»åŒ…å«ï¼‰==

==æˆ‘çš„å›žç­”==ï¼š

> 1. ==Lambda è¡¨è¾¾å¼==ï¼Œå®ƒå¯ä»¥ç›´æŽ¥==ä½œä¸ºå‚æ•°ä¼ é€’ç»™æ–¹æ³•==æˆ–å­˜å‚¨åœ¨å˜é‡ä¸­ï¼Œå¯ä»¥åœ¨ä»»ä½•éœ€è¦==å‡½æ•°å¼æŽ¥å£==çš„åœ°æ–¹ä½¿ç”¨ã€‚å¹¶ä¸”ä»¥å‰ä½¿ç”¨==åŒ¿åå†…éƒ¨ç±»çš„åœ°æ–¹çŽ°åœ¨éƒ½å¯ä»¥ç”¨ Lambda è¡¨è¾¾å¼æ¥åŒ–ç®€==ã€‚
> 2. ==Stream API==ï¼Œä¸åŒäºŽé›†åˆå…³æ³¨çš„æ˜¯å¯¹æ•°æ®çš„å­˜å‚¨ï¼Œå®ƒå…³æ³¨çš„æ˜¯å¯¹æ•°æ®çš„è¿ç®—å¤„ç†ï¼Œæ¯”å¦‚å¯ä»¥==å¯¹é›†åˆè¿›è¡Œè¿‡æ»¤ï¼Œæ˜ å°„ï¼ŒæŽ’åº==ç­‰ç­‰ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿååˆ†ç®€æ´ã€‚
> 3. ==Optional ç±»==ï¼Œå®ƒä¸»è¦æ˜¯ä¸ºäº†==è§£å†³ Java ä¸­çš„ç©ºæŒ‡é’ˆ==è€Œç”Ÿçš„ã€‚å®ƒå¯ä»¥==åŒ…è£…ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å¯èƒ½ä¸ºç©ºï¼Œé€šè¿‡ä¸€ç³»åˆ—çš„æ–¹æ³•æ“ä½œè¯¥å¯¹è±¡==ï¼Œè€Œæ— éœ€æ˜¾ç¤ºåœ°è¿›è¡Œ null æ£€æŸ¥ã€‚
> 4. ==æ–¹æ³•å¼•ç”¨==ï¼Œé€šè¿‡ä¸€å¯¹å†’å· â€˜ :: â€˜ æ“ä½œç¬¦æ¥è¡¨ç¤ºã€‚å¯¹äºŽé™æ€æ–¹æ³•å¼•ç”¨ï¼Œå¯ä»¥ç”¨ â€˜==ç±»å::é™æ€æ–¹æ³•å==â€™ è¡¨ç¤ºï¼Œå¯¹äºŽç¤ºä¾‹æ–¹æ³•å¼•ç”¨ï¼Œå¯ä»¥ç”¨ â€˜==ç±»å::æ–¹æ³•å==â€™ è¡¨ç¤ºç­‰ç­‰ï¼Œ==å’Œ Lambda è¡¨è¾¾å¼ä¸€æ ·ç”¨äºŽå‡½æ•°å¼æŽ¥å£==ã€‚
>

==å‚è€ƒç­”æ¡ˆ==ï¼š

> - ==Lambda è¡¨è¾¾å¼==ï¼Œå®ƒå¯ä»¥ç›´æŽ¥==ä½œä¸ºå‚æ•°ä¼ é€’ç»™æ–¹æ³•==æˆ–å­˜å‚¨åœ¨å˜é‡ä¸­ï¼Œå¯ä»¥åœ¨ä»»ä½•éœ€è¦==å‡½æ•°å¼æŽ¥å£==çš„åœ°æ–¹ä½¿ç”¨ã€‚å¹¶ä¸”ä»¥å‰ä½¿ç”¨==åŒ¿åå†…éƒ¨ç±»çš„åœ°æ–¹çŽ°åœ¨éƒ½å¯ä»¥ç”¨ Lambda è¡¨è¾¾å¼æ¥åŒ–ç®€==ã€‚
> - ==Stream API==ï¼Œä¸åŒäºŽé›†åˆå…³æ³¨çš„æ˜¯å¯¹æ•°æ®çš„å­˜å‚¨ï¼Œå®ƒå…³æ³¨çš„æ˜¯å¯¹æ•°æ®çš„è¿ç®—å¤„ç†ï¼Œæ¯”å¦‚å¯ä»¥==å¯¹é›†åˆè¿›è¡Œè¿‡æ»¤ï¼Œæ˜ å°„ï¼ŒæŽ’åº==ç­‰ç­‰ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿååˆ†ç®€æ´ã€‚
> - ==Optional ç±»==ï¼Œå®ƒä¸»è¦æ˜¯ä¸ºäº†==è§£å†³ Java ä¸­çš„ç©ºæŒ‡é’ˆ==è€Œç”Ÿçš„ã€‚å®ƒå¯ä»¥==åŒ…è£…ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å¯èƒ½ä¸ºç©ºï¼Œé€šè¿‡ä¸€ç³»åˆ—çš„æ–¹æ³•æ“ä½œè¯¥å¯¹è±¡==ï¼Œè€Œæ— éœ€æ˜¾ç¤ºåœ°è¿›è¡Œ null æ£€æŸ¥ã€‚
> - ==æ–¹æ³•å¼•ç”¨==ï¼Œé€šè¿‡ä¸€å¯¹å†’å· â€˜ :: â€˜ æ“ä½œç¬¦æ¥è¡¨ç¤ºã€‚å¯¹äºŽé™æ€æ–¹æ³•å¼•ç”¨ï¼Œå¯ä»¥ç”¨ â€˜==ç±»å::é™æ€æ–¹æ³•å==â€™ è¡¨ç¤ºï¼Œå¯¹äºŽç¤ºä¾‹æ–¹æ³•å¼•ç”¨ï¼Œå¯ä»¥ç”¨ â€˜==ç±»å::æ–¹æ³•å==â€™ è¡¨ç¤ºç­‰ç­‰ï¼Œ==å’Œ Lambda è¡¨è¾¾å¼ä¸€æ ·ç”¨äºŽå‡½æ•°å¼æŽ¥å£==ã€‚
>

---

==é—®é¢˜äºŒ==ï¼š==Lambda è¡¨è¾¾å¼è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼ŸLambda çœŸæ­£çš„å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿ==

==æˆ‘çš„å›žç­”==ï¼š

> 1. Lambda ä¸»è¦è§£å†³çš„æ˜¯==ä»£ç çš„å†—ä½™é—®é¢˜==ã€‚Java 8 ä¹‹å‰ï¼Œä¸ºäº†ä¼ é€’åŠŸèƒ½åˆ°æ–¹æ³•ä¸­ï¼Œå¿…é¡»ä½¿ç”¨==åŒ¿åå†…éƒ¨ç±»ï¼ˆéƒ½å¯ä½¿ç”¨ Lambda è¡¨ç¤ºæ˜¯åŒ–ç®€ï¼ŒIDEA ä¹Ÿå»ºè®®ä½ è¿™æ ·åšï¼Œå½“ç„¶ï¼Œæœ€å¥½ç›´æŽ¥åŒ–ç®€ä¸ºæ–¹æ³•å¼•ç”¨ï¼‰==ï¼Œå¯¼è‡´ä»£ç éžå¸¸å†—ä½™ä¸”éš¾ä»¥é˜…è¯»ï¼Œä½¿ç”¨ lambda è¡¨è¾¾å¼å¯ä»¥ä»¥ä¸€ç§éžå¸¸ç®€æ´çš„æ–¹å¼æ›¿ä»£å®ƒï¼ŒåŒæ—¶ä¹Ÿ==ä¸º Java å¼•å…¥äº†å‡½æ•°å¼ç¼–ç¨‹çš„èƒ½åŠ›==ã€‚
>

---



## 6.æ•°æ®ç»“æž„

### æŽ’åºç®—æ³•

#### 1.ä»€ä¹ˆæ˜¯æŽ’åºç®—æ³•çš„ç¨³å®šæ€§ï¼Œå†…éƒ¨æŽ’åºå’Œå¤–éƒ¨æŽ’åºï¼Ÿ

1. å¦‚æžœæŽ’åºå®Œæˆä¹‹åŽï¼Œç›¸åŒå…ƒç´ çš„ç›¸å¯¹ä½ç½®ä¸å˜ï¼Œé‚£ä¹ˆå°±æ˜¯ç¨³å®šçš„ç®—æ³•ï¼Œå¦åˆ™å°±æ˜¯ä¸ç¨³å®šçš„ç®—æ³•ã€‚æ¯”å¦‚å½’å¹¶æŽ’åºå°±æ˜¯ç¨³å®šçš„ç®—æ³•ï¼Œè€Œå¿«é€ŸæŽ’åºå°±æ˜¯ä¸ç¨³å®šçš„ç®—æ³•ã€‚
2. å†…éƒ¨æŽ’åºå°±æ˜¯ä¸éœ€è¦é¢å¤–ç©ºé—´çš„ç®—æ³•ï¼Œæ¯”å¦‚å¿«é€ŸæŽ’åºå°±æ˜¯å†…éƒ¨æŽ’åºï¼›åä¹‹å°±æ˜¯å¤–éƒ¨æŽ’åºï¼Œä¸å¦‚å½’å¹¶æŽ’åºéœ€è¦ä¾èµ–é¢å¤–ç©ºé—´ï¼Œå› æ­¤æ˜¯å¤–éƒ¨æŽ’åºã€‚

---



#### 2.å†’æ³¡æŽ’åºæ€Žä¹ˆä¼˜åŒ–ï¼Ÿ

1. ä¸€ç§ä¼˜åŒ–æ–¹æ³•æ˜¯å¦‚æžœåœ¨æŸæ¬¡å†’æ³¡çš„è¿‡ç¨‹ä¸­æ²¡æœ‰å‘ç”Ÿäº¤æ¢ï¼Œé‚£ä¹ˆè¯´æ˜Žå·²ç»æœ‰åºã€‚
2. åœ¨æ­¤åŸºç¡€ä¸Šï¼Œè¿˜å¯ä»¥åœ¨æ¯æ¬¡å†’æ³¡å®ŒæˆåŽï¼Œè®°å½•ä»Žæœ¬è½®ç¬¬ä¸€ä¸ªæ•°å¼€å§‹æœ€é•¿æœªå‘ç”Ÿäº¤æ¢çš„é•¿åº¦ï¼Œåœ¨ä¸‹ä¸€æ¬¡å†’æ³¡çš„è¿‡ç¨‹ä¸­å°±å¯ä»¥å°‘éåŽ†è¿™ä¹ˆå¤šæ¬¡ã€‚

---



#### 3.é€‰æ‹©æŽ’åºæ˜¯ç¨³å®šæŽ’åºå—ï¼Œä¸ºä»€ä¹ˆï¼Ÿ

1. é€‰æ‹©æŽ’åºä¸æ˜¯ç¨³å®šæŽ’åºã€‚å› ä¸ºæ¯ä¸€æ¬¡é€‰æ‹©ä¸­ï¼Œç›¸åŒçš„æ•°æ— æ³•ç¡®çŸ¥ä¼šé€‰æ‹©å“ªä¸€ä¸ªï¼Œå› æ­¤ä¼šç ´çŽ¯ç›¸å¯¹é¡ºåºã€‚

---



#### 4.æ’å…¥æŽ’åºçš„æ—¶é—´å¤æ‚åº¦ä¸€å®šæ˜¯ $O(n^2)$ å—ï¼Ÿ

1. ä¸ä¸€å®šï¼Œæ’å…¥æŽ’åºçš„åºåˆ—è¶Šç›¸å¯¹æœ‰åºï¼Œé‚£ä¹ˆå…¶å¤æ‚åº¦å°±ä¼šè¶Šä½Žã€‚æœ€æžç«¯çš„æƒ…å†µä¸‹ï¼Œå¦‚æžœè¿™ä¸ªåºåˆ—æœ¬å°±æ˜¯æœ‰åºçš„ï¼Œé‚£ä¹ˆå¤æ‚åº¦ä»…ä¸º $O(n)$ã€‚å¸Œå°”æŽ’åºå°±æ˜¯åˆ©ç”¨äº†æ’å…¥æŽ’åºè¶Šç›¸å¯¹æœ‰åºï¼Œå¤æ‚åº¦è¶Šä½Žçš„ç‰¹æ€§ã€‚
2. åŒæ—¶ï¼Œç”±äºŽè¿™ä¸€ç‰¹æ€§ï¼Œæ’å…¥æŽ’åºåœ¨åºåˆ—è¶ŠçŸ­æ—¶ï¼Œå¾€å¾€è¶Šå®¹æ˜“ç›¸å¯¹æœ‰åºï¼Œå¤æ‚åº¦ä¹Ÿå°±è¶Šä½Žï¼Œå› æ­¤å¯ä»¥ç”¨æ’å…¥æŽ’åºä¼˜åŒ–å½’å¹¶æŽ’åºï¼Œæ¯”å¦‚å½“å‰çš„åŒºé—´é•¿åº¦å°äºŽ10æ—¶ï¼Œå°±ä½¿ç”¨æ’å…¥æŽ’åºç›´æŽ¥è¿›è¡ŒæŽ’åºï¼Œè€Œä¸ç”¨ç»§ç»­é€’å½’äº†ã€‚

---



#### 5.å¸Œå°”æŽ’åºä¸ºä»€ä¹ˆæ¯”æ’å…¥æŽ’åºçš„æ€§èƒ½å¥½ï¼Ÿ

1. å¸Œå°”æŽ’åºå°±æ˜¯åˆ©ç”¨äº†æ’å…¥æŽ’åºåœ¨åºåˆ—è¶Šç›¸å¯¹æœ‰åºï¼Œå¤æ‚åº¦è¶Šä½Žçš„ç‰¹æ€§ã€‚å®ƒé¦–å…ˆæ ¹æ®ä¸€ä¸ªè¾ƒå¤§é—´éš”æŠŠåŽŸåºåˆ—æ‹†åˆ†æˆå¤šä¸ªå­åºåˆ—ï¼Œè¿™æ—¶æ¯ä¸ªå­åºåˆ—é•¿åº¦éƒ½å¾ˆå°ï¼Œé‡‡ç”¨æ’å…¥æŽ’åºé€Ÿåº¦å¾ˆå¿«ã€‚
2. è¿™æ ·ä¸€è½®æ’å…¥æŽ’åºä¹‹åŽï¼Œåºåˆ—å˜å¾—æ›´ç›¸å¯¹æœ‰åºäº†ï¼Œç„¶åŽæˆ‘ä»¬å‡å°é—´éš”ï¼Œé‡å¤ä¸Šè¿°æ“ä½œï¼Œç›´åˆ°é—´éš”è¢«å‡å°åˆ°1ï¼Œæœ€åŽå°±æ˜¯æ•´ä¸ªåºåˆ—è¿›è¡Œä¸€æ¬¡æ’å…¥æŽ’åºï¼Œæ­¤æ—¶åºåˆ—å·²ç»åŸºæœ¬æœ‰åºäº†ï¼Œæ’å…¥æŽ’åºæ€§èƒ½å¾ˆå¥½ã€‚

---



#### 6.å¦‚ä½•ä¼˜åŒ–å½’å¹¶æŽ’åºï¼Ÿ

1. ç”±äºŽæ’å…¥æŽ’åºåœ¨å¤„ç†è¾ƒçŸ­åºåˆ—çš„æ€§èƒ½å¾ˆå¥½ï¼Œå› æ­¤é€’å½’æ—¶å¦‚æžœå‘çŽ°å½“å‰åŒºé—´çš„é•¿åº¦å°åˆ°ä¸€å®šç¨‹åº¦äº†ï¼Œé‚£ä¹ˆå°±ç›´æŽ¥ä½¿ç”¨æ’å…¥æŽ’åºå°±å¯ä»¥äº†ã€‚
2. è¿˜æœ‰å°±æ˜¯å¯ä»¥ä¼˜åŒ– base çš„é€‰å–ï¼Œæ¯”å¦‚å¯ä»¥éšæœºå–åŒºé—´ä¸­çš„ä¸€ä¸ªæ•°ï¼Œæˆ–è€…å– left, right, mid çš„ä¸­ä½æ•°ã€‚

---



#### 7.ä½ ä¼šå½’å¹¶æŽ’åºçš„è¿­ä»£å†™æ³•å—ï¼Ÿ

1. æˆ‘ä»¬å¸¸ç”¨çš„é€’å½’æ–¹æ³•å†™çš„å½’å¹¶æŽ’åºæ˜¯è‡ªé¡¶å‘ä¸‹çš„ï¼Œè€Œè¿­ä»£å†™æ³•çš„å½’å¹¶æŽ’åºåˆ™æ˜¯è‡ªåº•å‘ä¸Šçš„ã€‚

2. å…·ä½“åœ°ï¼Œå°±æ˜¯å¤–å±‚å¾ªçŽ¯å­åºåˆ—çš„é•¿åº¦ï¼Œæœ€åˆåˆå¹¶é•¿åº¦ä¸º1çš„å­åºåˆ—ï¼Œä¹‹åŽé•¿åº¦ä¹˜2ï¼Œç›´åˆ°è¶…å‡ºåºåˆ—æ€»é•¿ã€‚å†…å±‚å¾ªçŽ¯å°†ç›¸é‚»çš„å­åºåˆ—åˆå¹¶ã€‚

3. ä¼ªä»£ç å¦‚ä¸‹ï¼š

	```java
	// æœ€å¼€å§‹å­åºåˆ—é•¿åº¦ä¸º1ï¼Œä¹‹åŽä¸æ–­ä¹˜2æ‰©å¤§
	for (int size = 1; size < nums.length; size *= 2) {
	    for (int l = 0; l + size - 1 < nums.length; l += size * 2) {
	        int mid = l + size - 1;
	        // è¿™é‡Œå³åŒºé—´è¦å—åˆ°nums.lengthçš„é™åˆ¶
	        int r = Math.min(l + size * 2 - 1, nums.length - 1);
	        merge(nums, l, mid, r);
	    }
	}
	```

---



#### 8.å¦‚ä½•ä¼˜åŒ–å¿«é€ŸæŽ’åºï¼Ÿ

1. å¯ä»¥ä½¿ç”¨æ’å…¥æŽ’åºç›´æŽ¥æŽ’åºè¾ƒçŸ­çš„åŒºé—´ï¼Œå› ä¸ºæ’å…¥æŽ’åºåœ¨åŒºé—´é•¿åº¦è¾ƒä½Žæ—¶ï¼Œåºåˆ—çš„æ•´ä½“æœ‰åºæ€§è¾ƒé«˜ï¼Œå› æ­¤æ€§èƒ½æ¯”è¾ƒå¥½ã€‚

---



#### 9.å¿«é€ŸæŽ’åºå¦‚ä½•ä¼˜åŒ–æ•°ç»„æœ‰å¤§é‡é‡å¤å…ƒç´ çš„åœºæ™¯ï¼Ÿ

1. å¿«é€ŸæŽ’åºçš„ç“¶é¢ˆåœ¨äºŽå¦‚æžœå­˜åœ¨å¤§é‡é‡å¤çš„å…ƒç´ ï¼Œæ­¤æ—¶å¦‚æžœä¸€ä¸ªé‡å¤å…ƒç´ è¢«é€‰æˆäº† baseï¼Œé‚£ä¹ˆå°±ä¼šå› ä¸ºå¯¹ç›¸åŒæ•°çš„å¤§é‡æ— ç”¨äº¤æ¢è€ŒæŠŠå¤æ‚åº¦é™ä½Žä¸º $O(n^2)$ã€‚

2. å› æ­¤å¯ä»¥ä½¿ç”¨ä¸‰è·¯å¿«é€ŸæŽ’åºï¼Œé¢å¤–å¼•å…¥ä¸€ä¸ª i å˜é‡ï¼Œè®© $[lt,l)$ ä¸ºå’Œ base ç›¸ç­‰çš„å…ƒç´ ï¼Œç„¶åŽåŽç»­çš„é€’å½’å°±åªéœ€è¦è®¡ç®—ä¸¤ä¾§éžå°äºŽå’Œå¤§äºŽ base çš„åŒºé—´å³å¯ã€‚

3. ä¼ªä»£ç å¦‚ä¸‹ï¼š

	```java
	int v = nums[l];
	int i = l + 1; // [lt, i)	ç­‰äºŽåŒºé—´
	int lt = l + 1;// [l, lt)	å°äºŽåŒºé—´
	int gt = r;    // (gt, r]	å¤§äºŽåŒºé—´
	while (i <= gt) {
	    if (nums[i] < v) {
	        swap(nums, i++, lt++);
	    } else if (nums[i] > v) {
	        swap(nums, i, gt--);
	    } else {
	        i++;
	    }
	}
	swap(nums, l, lt - 1);
	quickSort(nums, l, lt - 2);
	quickSort(nums, gt + 1, r);
	```

---



#### 10.è®¡æ•°æŽ’åºçš„æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿ

1. $O(n)$ï¼Œæ”¾è¿›æ¡¶é‡ŒéåŽ†ä¸€æ¬¡ï¼Œæ‹¿å‡ºæ¥å†éåŽ†ä¸€æ¬¡ã€‚

---



#### 11.åŸºæ•°æŽ’åºä¸ºä»€ä¹ˆä»Žå…ƒç´ çš„æœ€ä½Žä½å¼€å§‹æŽ’åºï¼Ÿ

1. LSD åŸºæ•°æŽ’åºä»Žä½Žä½å¼€å§‹æŽ’åºï¼Œæ¯ä¸€æ¬¡æŽ’åºåŽå‡ ä½æ˜¯æœ‰åºçš„ï¼Œç›´åˆ°æŠŠæ¯ä¸€ä½éƒ½éåŽ†å®Œï¼Œé‚£ä¹ˆå°±å®Œå…¨æœ‰åºã€‚
2. ç›¸åº”åœ°ï¼Œè¿˜æœ‰ MSD åŸºæ•°æŽ’åºï¼Œå…ˆæŽ’é«˜ä½ï¼Œå†æŽ’åˆ°ä½Žä½ã€‚

---



#### 12.å †æŽ’åºçš„è¿‡ç¨‹æ˜¯æ€Žä¹ˆå®žçŽ°çš„ï¼Ÿ

1. é¦–å…ˆæ‰¾åˆ°æœ€åŽä¸€ä¸ª parent çš„ indexï¼Œå‘å‰é¢éåŽ†ï¼ŒæŠŠæ¯ä¸ª parent éƒ½æ‰§è¡Œâ€œä¸‹æ²‰â€æ“ä½œï¼ŒæŠŠåŽŸåºåˆ—å…ˆå˜æˆä¸€ä¸ªæœ€å¤§å †ã€‚
2. ç„¶åŽå†æŠŠå †é¡¶æœ€å¤§çš„å…ƒç´ å’Œæœ€åŽä¸€ä¸ªå…ƒç´ äº¤æ¢ï¼Œè¿™æ ·æœ€å¤§çš„æ•°ä¾¿æˆåŠŸæ”¾åˆ°æœ€åŽäº†ï¼Œä¹‹åŽæŠŠäº¤æ¢ä¸ŠåŽ»çš„å…ƒç´ æ‰§è¡Œâ€œä¸‹æ²‰â€æ“ä½œï¼ŒæŠŠå‰ n-1 ä¸ªå…ƒç´ å†å˜æˆæœ€å¤§å †ï¼ˆå †é¡¶çš„å·¦å³å­æ ‘éƒ½å·²ç»æ˜¯å †äº†ï¼Œå› æ­¤åªéœ€åªéœ€ä¸€æ¬¡â€œä¸‹æ²‰â€æ“ä½œï¼‰ã€‚é‡å¤æ‰§è¡Œ n æ¬¡æ­¤æ“ä½œå³å¯ã€‚

---



# 2.è®¾è®¡æ¨¡å¼+æ¡†æž¶

## 1.è®¾è®¡æ¨¡å¼

### 1.Spring è®¾è®¡æ¨¡å¼æ€»ç»“ðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

1. ==æŽ§åˆ¶åè½¬ (IoC) å’Œä¾èµ–æ³¨å…¥ (DI)==

	> - ==IoC (Inversion of Control,æŽ§åˆ¶åè½¬)== å®ƒä¸æ˜¯ä»€ä¹ˆæŠ€æœ¯ï¼Œè€Œæ˜¯ä¸€ç§==è§£è€¦çš„è®¾è®¡æ€æƒ³==ã€‚å®ƒçš„ä¸»è¦ç›®çš„æ˜¯==å€ŸåŠ©äºŽâ€œç¬¬ä¸‰æ–¹â€(Spring ä¸­çš„ IOC å®¹å™¨) å®žçŽ°å…·æœ‰ä¾èµ–å…³ç³»çš„å¯¹è±¡ä¹‹é—´çš„è§£è€¦(IOCå®¹å™¨ç®¡ç†å¯¹è±¡ï¼Œä½ åªç®¡ä½¿ç”¨å³å¯)ï¼Œä»Žè€Œé™ä½Žä»£ç ä¹‹é—´çš„è€¦åˆåº¦==ã€‚==IOC æ˜¯ä¸€ä¸ªåŽŸåˆ™ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæ¨¡å¼==ã€‚
	>
	> - ==Spring IOC å®¹å™¨å°±åƒæ˜¯ä¸€ä¸ªå·¥åŽ‚ä¸€æ ·ï¼Œå½“æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œåªéœ€è¦é…ç½®å¥½é…ç½®æ–‡ä»¶/æ³¨è§£å³å¯ï¼Œå®Œå…¨ä¸ç”¨è€ƒè™‘å¯¹è±¡æ˜¯å¦‚ä½•è¢«åˆ›å»ºå‡ºæ¥çš„==ã€‚
	>
	> - <img src="bgwROUND1.assets/image-20240506162001966.png" alt="image-20240506162001966" style="zoom:67%;" />
	>
	> -  ==ä»Žåº•å±‚å‘ä¸Šä¾æ¬¡æ³¨å…¥==ï¼š
	>
	> 	![image-20240506164920983](bgwROUND1.assets/image-20240506164920983.png)
	>
	> - ==DI(Dependecy Inject,ä¾èµ–æ³¨å…¥==)æ˜¯==å®žçŽ°æŽ§åˆ¶åè½¬çš„ä¸€ç§è®¾è®¡æ¨¡å¼==ï¼Œä¾èµ–æ³¨å…¥å°±æ˜¯å°†==å®žä¾‹å˜é‡==ä¼ å…¥åˆ°ä¸€ä¸ªå¯¹è±¡ä¸­åŽ»ã€‚

2. ==å·¥åŽ‚è®¾è®¡æ¨¡å¼==

      > - Springä½¿ç”¨å·¥åŽ‚æ¨¡å¼å¯ä»¥é€šè¿‡ `BeanFactory` æˆ– `ApplicationContext` åˆ›å»º bean å¯¹è±¡ã€‚
      >
      > - ApplicationContextçš„ä¸‰ä¸ªå®žçŽ°ç±»ï¼š
      >
      > 	1. `ClassPathXmlApplication`ï¼šæŠŠä¸Šä¸‹æ–‡æ–‡ä»¶å½“æˆç±»è·¯å¾„èµ„æºã€‚
      > 	2. `FileSystemXmlApplication`ï¼šä»Žæ–‡ä»¶ç³»ç»Ÿä¸­çš„ XML æ–‡ä»¶è½½å…¥ä¸Šä¸‹æ–‡å®šä¹‰ä¿¡æ¯ã€‚
      > 	3. `XmlWebApplicationContext`ï¼šä»ŽWebç³»ç»Ÿä¸­çš„XMLæ–‡ä»¶è½½å…¥ä¸Šä¸‹æ–‡å®šä¹‰ä¿¡æ¯ã€‚
      >
      > - ```java
      > 	ApplicationContext context = new FileSystemXmlApplicationContext("C:/work/IOC/Containers/springframework.applicationcontext/src/main/resources/bean-factory-config.xml");
      > 	```

3. ==å•ä¾‹è®¾è®¡æ¨¡å¼==

	> - å¦‚æžœåˆ¶é€ å‡º==å¤šä¸ªå®žä¾‹==å°±å¯èƒ½ä¼š==å¯¼è‡´ä¸€äº›é—®é¢˜==çš„äº§ç”Ÿï¼Œæ¯”å¦‚ï¼šç¨‹åºçš„è¡Œä¸ºå¼‚å¸¸ã€èµ„æºä½¿ç”¨è¿‡é‡ã€æˆ–è€…ä¸ä¸€è‡´æ€§çš„ç»“æžœã€‚
	>
	> - ==ä½¿ç”¨å•ä¾‹æ¨¡å¼çš„å¥½å¤„:==
	>
	> 	- å¯¹äºŽé¢‘ç¹ä½¿ç”¨çš„å¯¹è±¡ï¼Œå¯ä»¥==çœç•¥åˆ›å»ºå¯¹è±¡æ‰€èŠ±è´¹çš„æ—¶é—´==ï¼Œè¿™å¯¹äºŽé‚£äº›é‡é‡çº§å¯¹è±¡è€Œè¨€ï¼Œæ˜¯éžå¸¸å¯è§‚çš„ä¸€ç¬”ç³»ç»Ÿå¼€é”€ï¼›
	> 	- ç”±äºŽ new æ“ä½œçš„æ¬¡æ•°å‡å°‘ï¼Œå› è€Œ==å¯¹ç³»ç»Ÿå†…å­˜çš„ä½¿ç”¨é¢‘çŽ‡ä¹Ÿä¼šé™ä½Ž==ï¼Œè¿™å°†==å‡è½» GC åŽ‹åŠ›==ï¼Œç¼©çŸ­ GC åœé¡¿æ—¶é—´ã€‚
	>
	> - ==Spring å®žçŽ°å•ä¾‹çš„æ–¹å¼ï¼š==
	>
	> 	- xml : `<bean id="userService" class="top.snailclimb.UserService" scope="singleton"/>`
	> 	- æ³¨è§£ï¼š`@Scope(value = "singleton")`
	>
	> - å•ä¾‹æ¨¡å¼åœ¨ Spring ä¸­çš„æ—¶æœºè¿ç”¨ï¼š==å•ä¾‹æ³¨å†Œè¡¨==
	>
	> 	```java
	> 	// é€šè¿‡ ConcurrentHashMapï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰ å®žçŽ°å•ä¾‹æ³¨å†Œè¡¨
	> 	private final Map<String, Object> singletonObjects = new ConcurrentHashMap<String, Object>(64);
	> 	```

4. ==ä»£ç†è®¾è®¡æ¨¡å¼==

	> - ==AOP==(Aspect-Oriented Programming:é¢å‘åˆ‡é¢ç¼–ç¨‹)èƒ½å¤Ÿå°†é‚£äº›ä¸Žä¸šåŠ¡æ— å…³ï¼Œ==å´ä¸ºä¸šåŠ¡æ¨¡å—æ‰€å…±åŒè°ƒç”¨çš„é€»è¾‘æˆ–è´£ä»»ï¼ˆä¾‹å¦‚äº‹åŠ¡å¤„ç†ã€æ—¥å¿—ç®¡ç†ã€æƒé™æŽ§åˆ¶ç­‰ï¼‰å°è£…èµ·æ¥==ï¼Œä¾¿äºŽ==å‡å°‘ç³»ç»Ÿçš„é‡å¤ä»£ç ==ï¼Œ==é™ä½Žæ¨¡å—é—´çš„è€¦åˆåº¦==ï¼Œå¹¶==æœ‰åˆ©äºŽæœªæ¥çš„å¯æ‹“å±•æ€§å’Œå¯ç»´æŠ¤æ€§==ã€‚
	> - ==Spring AOP å°±æ˜¯åŸºäºŽåŠ¨æ€ä»£ç†çš„==ï¼Œå¦‚æžœè¦ä»£ç†çš„å¯¹è±¡ï¼Œ==å®žçŽ°äº†æŸä¸ªæŽ¥å£==ï¼Œé‚£ä¹ˆSpring AOPä¼šä½¿ç”¨==JDK Proxy==ï¼ŒåŽ»åˆ›å»ºä»£ç†å¯¹è±¡ï¼Œè€Œå¯¹äºŽ==æ²¡æœ‰å®žçŽ°æŽ¥å£çš„å¯¹è±¡==ï¼Œå°±æ— æ³•ä½¿ç”¨ JDK Proxy åŽ»è¿›è¡Œä»£ç†äº†ï¼Œè¿™æ—¶å€™Spring AOPä¼šä½¿ç”¨==Cglib== ï¼Œè¿™æ—¶å€™Spring AOPä¼šä½¿ç”¨ ==Cglib== ç”Ÿæˆä¸€ä¸ªè¢«ä»£ç†å¯¹è±¡çš„å­ç±»æ¥ä½œä¸ºä»£ç†ã€‚
	> - ==Spring AOP å’Œ AspectJ AOP æœ‰ä»€ä¹ˆåŒºåˆ«==?
	> 	- ==Spring AOP å±žäºŽè¿è¡Œæ—¶å¢žå¼ºï¼Œè€Œ AspectJ æ˜¯ç¼–è¯‘æ—¶å¢žå¼ºã€‚== 
	> 	- ==Spring AOP åŸºäºŽåŠ¨æ€ä»£ç†==(Proxying)ï¼Œè€Œ ==AspectJ åŸºäºŽå­—èŠ‚ç æ“ä½œ==(Bytecode Manipulation)ã€‚

5. ==æ¨¡æ¿æ–¹æ³•==

	> - æ¨¡æ¿æ–¹æ³•æ¨¡å¼æ˜¯ä¸€ç§==è¡Œä¸ºè®¾è®¡æ¨¡å¼==ï¼Œå®ƒå®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„==éª¨æž¶==ï¼Œè€Œ==å°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»==ä¸­ã€‚ 

6. ==è§‚å¯Ÿè€…æ¨¡å¼==

	> - è§‚å¯Ÿè€…æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºåž‹æ¨¡å¼ã€‚å®ƒè¡¨ç¤ºçš„æ˜¯ä¸€ç§==å¯¹è±¡ä¸Žå¯¹è±¡ä¹‹é—´å…·æœ‰ä¾èµ–å…³ç³»==ï¼Œå½“==ä¸€ä¸ªå¯¹è±¡å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œè¿™ä¸ªå¯¹è±¡æ‰€ä¾èµ–çš„å¯¹è±¡ä¹Ÿä¼šåšå‡ºååº”==ã€‚==Spring äº‹ä»¶é©±åŠ¨æ¨¡åž‹==å°±æ˜¯è§‚å¯Ÿè€…æ¨¡å¼å¾ˆç»å…¸çš„ä¸€ä¸ªåº”ç”¨ã€‚
	>
	> - ==Spring çš„äº‹ä»¶æµç¨‹æ€»ç»“==ï¼š
	>
	> 	1. å®šä¹‰ä¸€ä¸ª==äº‹ä»¶==: å®žçŽ°ä¸€ä¸ªç»§æ‰¿è‡ª `ApplicationEvent`ï¼Œå¹¶ä¸”å†™ç›¸åº”çš„æž„é€ å‡½æ•°ï¼›
	> 	2. å®šä¹‰ä¸€ä¸ª==äº‹ä»¶ç›‘å¬è€…==ï¼šå®žçŽ° `ApplicationListener` æŽ¥å£ï¼Œé‡å†™ `onApplicationEvent()` æ–¹æ³•ï¼›
	> 	3. ä½¿ç”¨==äº‹ä»¶å‘å¸ƒè€…==å‘å¸ƒæ¶ˆæ¯: å¯ä»¥é€šè¿‡ `ApplicationEventPublisher` çš„ `publishEvent()` æ–¹æ³•å‘å¸ƒæ¶ˆæ¯ã€‚
	>
	> - ==ç¤ºä¾‹==ï¼š
	>
	> 	```java
	> 	// å®šä¹‰ä¸€ä¸ªäº‹ä»¶,ç»§æ‰¿è‡ªApplicationEventå¹¶ä¸”å†™ç›¸åº”çš„æž„é€ å‡½æ•°
	> 	public class DemoEvent extends ApplicationEvent{
	> 	    private static final long serialVersionUID = 1L;
	> 																																																																	
	> 	    private String message;
	> 																																																																	
	> 	    public DemoEvent(Object source,String message){
	> 	        super(source);
	> 	        this.message = message;
	> 	    }
	> 																																																																	
	> 	    public String getMessage() {
	> 	        return message;
	> 	    }
	> 	}
	> 																																																																	
	> 	// å®šä¹‰ä¸€ä¸ªäº‹ä»¶ç›‘å¬è€…,å®žçŽ°ApplicationListeneræŽ¥å£ï¼Œé‡å†™ onApplicationEvent() æ–¹æ³•ï¼›
	> 	@Component
	> 	public class DemoListener implements ApplicationListener<DemoEvent>{
	> 																																																																	
	> 	    //ä½¿ç”¨onApplicationEventæŽ¥æ”¶æ¶ˆæ¯
	> 	    @Override
	> 	    public void onApplicationEvent(DemoEvent event) {
	> 	        String msg = event.getMessage();
	> 	        System.out.println("æŽ¥æ”¶åˆ°çš„ä¿¡æ¯æ˜¯ï¼š"+msg);
	> 	    }
	> 	}
	> 																																																																	
	> 	// å‘å¸ƒäº‹ä»¶ï¼Œå¯ä»¥é€šè¿‡ApplicationEventPublisher  çš„ publishEvent() æ–¹æ³•å‘å¸ƒæ¶ˆæ¯ã€‚
	> 	@Component
	> 	public class DemoPublisher {
	> 																																																																	
	> 	    @Autowired
	> 	    ApplicationContext applicationContext;
	> 																																																																	
	> 	    public void publish(String message){
	> 	        //å‘å¸ƒäº‹ä»¶
	> 	        applicationContext.publishEvent(new DemoEvent(this, message));
	> 	    }
	> 	}
	> 	```

7. ==é€‚é…å™¨æ¨¡å¼==

	> - é€‚é…å™¨æ¨¡å¼(Adapter Pattern) ==å°†ä¸€ä¸ªæŽ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦ä¸€ä¸ªæŽ¥å£==ï¼Œé€‚é…å™¨æ¨¡å¼ä½¿æŽ¥å£ä¸å…¼å®¹çš„é‚£äº›ç±»å¯ä»¥ä¸€èµ·å·¥ä½œï¼Œå…¶åˆ«åä¸ºåŒ…è£…å™¨(Wrapper)ã€‚
	> - ==Spring AOP== ä¸­çš„åº”ç”¨ï¼šSpring é¢„å®šä¹‰çš„==é€šçŸ¥è¦é€šè¿‡å¯¹åº”çš„é€‚é…å™¨ï¼Œé€‚é…æˆ `MethodInterceptor`(æ–¹æ³•æ‹¦æˆªå™¨)ç±»åž‹çš„å¯¹è±¡==ã€‚
	> - ==Spring MVC== ä¸­çš„åº”ç”¨ï¼š`DispatcherServlet` æ ¹æ®è¯·æ±‚ä¿¡æ¯è°ƒç”¨ `HandlerMapping`ï¼Œè§£æžè¯·æ±‚å¯¹åº”çš„ `Handler`ã€‚==è§£æžåˆ°å¯¹åº”çš„ `Handler`ï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬å¹³å¸¸è¯´çš„ `Controller` æŽ§åˆ¶å™¨ï¼‰åŽï¼Œå¼€å§‹ç”±`HandlerAdapter` é€‚é…å™¨å¤„ç†ã€‚`HandlerAdapter` ä½œä¸ºæœŸæœ›æŽ¥å£ï¼Œå…·ä½“çš„é€‚é…å™¨å®žçŽ°ç±»ç”¨äºŽå¯¹ç›®æ ‡ç±»è¿›è¡Œé€‚é…==ï¼Œ`Controller` ä½œä¸ºéœ€è¦é€‚é…çš„ç±»ã€‚
	> - ==ä¸ºä»€ä¹ˆè¦åœ¨ Spring MVC ä¸­ä½¿ç”¨é€‚é…å™¨æ¨¡å¼==ï¼Ÿ
	> 	-  Spring MVC ä¸­çš„ `Controller` ç§ç±»ä¼—å¤šï¼Œ==ä¸åŒç±»åž‹çš„ `Controller` é€šè¿‡ä¸åŒçš„æ–¹æ³•æ¥å¯¹è¯·æ±‚è¿›è¡Œå¤„ç†==ã€‚å¦‚æžœ==ä¸åˆ©ç”¨é€‚é…å™¨æ¨¡å¼çš„è¯ï¼Œ`DispatcherServlet` ç›´æŽ¥èŽ·å–å¯¹åº”ç±»åž‹çš„ `Controller`ï¼Œéœ€è¦çš„è‡ªè¡Œæ¥åˆ¤æ–­ Controller çš„ç±»åž‹==ã€‚
	> 	- å‡å¦‚æˆ‘ä»¬==å†å¢žåŠ ä¸€ä¸ª `Controller `ç±»åž‹å°±è¦å†åŠ å…¥ä¸€è¡Œåˆ¤æ–­è¯­å¥==ï¼Œè¿™ç§å½¢å¼å°±ä½¿å¾—ç¨‹åºéš¾ä»¥ç»´æŠ¤ï¼Œä¹Ÿè¿åäº†è®¾è®¡æ¨¡å¼ä¸­çš„å¼€é—­åŽŸåˆ™ â€“ ==å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­==ã€‚

8. ==è£…é¥°è€…æ¨¡å¼==

	> - å½“æˆ‘ä»¬éœ€è¦==ä¿®æ”¹åŽŸæœ‰çš„åŠŸèƒ½ï¼Œä½†æˆ‘ä»¬åˆä¸æ„¿ç›´æŽ¥åŽ»ä¿®æ”¹åŽŸæœ‰çš„ä»£ç ==æ—¶ï¼Œ==è®¾è®¡ä¸€ä¸ªDecoratorå¥—åœ¨åŽŸæœ‰ä»£ç å¤–é¢==ã€‚å…¶å®žåœ¨ JDK ä¸­å°±æœ‰å¾ˆå¤šåœ°æ–¹ç”¨åˆ°äº†è£…é¥°è€…æ¨¡å¼ï¼Œ==æ¯”å¦‚ `InputStream`å®¶æ—ï¼Œ`InputStream` ç±»ä¸‹æœ‰ `FileInputStream` (è¯»å–æ–‡ä»¶)ã€`BufferedInputStream` (å¢žåŠ ç¼“å­˜,ä½¿è¯»å–æ–‡ä»¶é€Ÿåº¦å¤§å¤§æå‡)ç­‰å­ç±»éƒ½åœ¨ä¸ä¿®æ”¹`InputStream` ä»£ç çš„æƒ…å†µä¸‹æ‰©å±•äº†å®ƒçš„åŠŸèƒ½==ã€‚

9. ==æ€»ç»“==ï¼š

	> - ==å·¥åŽ‚è®¾è®¡æ¨¡å¼== : Springä½¿ç”¨å·¥åŽ‚æ¨¡å¼é€šè¿‡ `BeanFactory`ã€`ApplicationContext` åˆ›å»º bean å¯¹è±¡ã€‚
	> - ==ä»£ç†è®¾è®¡æ¨¡å¼== : ==Spring AOP åŠŸèƒ½çš„å®žçŽ°==ã€‚
	> - ==å•ä¾‹è®¾è®¡æ¨¡å¼== : Spring ä¸­çš„ Bean é»˜è®¤éƒ½æ˜¯å•ä¾‹ï¼ˆsingletonï¼‰çš„ã€‚
	> - ==æ¨¡æ¿æ–¹æ³•æ¨¡å¼== : Spring ä¸­==`jdbcTemplate`ã€`hibernateTemplate` ç­‰ä»¥ Template ç»“å°¾çš„å¯¹æ•°æ®åº“æ“ä½œçš„ç±»ï¼Œå®ƒä»¬å°±ä½¿ç”¨åˆ°äº†æ¨¡æ¿æ¨¡å¼==ã€‚
	> - ==è£…é¥°è€…è®¾è®¡æ¨¡å¼== : æˆ‘ä»¬çš„é¡¹ç›®éœ€è¦è¿žæŽ¥å¤šä¸ªæ•°æ®åº“ï¼Œè€Œä¸”==ä¸åŒçš„å®¢æˆ·åœ¨æ¯æ¬¡è®¿é—®ä¸­æ ¹æ®éœ€è¦ä¼šåŽ»è®¿é—®ä¸åŒçš„æ•°æ®åº“==ã€‚è¿™ç§æ¨¡å¼è®©æˆ‘ä»¬å¯ä»¥==æ ¹æ®å®¢æˆ·çš„éœ€æ±‚èƒ½å¤ŸåŠ¨æ€åˆ‡æ¢ä¸åŒçš„æ•°æ®æº==ã€‚
	> - ==è§‚å¯Ÿè€…æ¨¡å¼==ï¼š ==Spring äº‹ä»¶é©±åŠ¨æ¨¡åž‹==å°±æ˜¯è§‚å¯Ÿè€…æ¨¡å¼å¾ˆç»å…¸çš„ä¸€ä¸ªåº”ç”¨ã€‚
	> - ==é€‚é…å™¨æ¨¡å¼== : Spring AOP çš„å¢žå¼ºæˆ–é€šçŸ¥(Advice)ä½¿ç”¨åˆ°äº†é€‚é…å™¨æ¨¡å¼ã€==spring MVC ä¸­ä¹Ÿæ˜¯ç”¨åˆ°äº†é€‚é…å™¨æ¨¡å¼é€‚é…`Controller`==ã€‚

---



### 2.ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼ï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

1. å¦‚æžœå•ä¾‹åˆå§‹å€¼æ˜¯nullï¼Œè¿˜æœªæž„å»ºï¼Œåˆ™æž„å»ºå•ä¾‹å¯¹è±¡å¹¶è¿”å›žã€‚è¿™ä¸ªå†™æ³•å±žäºŽå•ä¾‹æ¨¡å¼å½“ä¸­çš„==æ‡’æ±‰æ¨¡å¼ã€‚==

2. å¦‚æžœå•ä¾‹å¯¹è±¡ä¸€å¼€å§‹å°±è¢«new Singleton()ä¸»åŠ¨æž„å»ºï¼Œåˆ™ä¸å†éœ€è¦åˆ¤ç©ºæ“ä½œï¼Œè¿™ç§å†™æ³•å±žäºŽ==é¥¿æ±‰æ¨¡å¼==ã€‚

3. å¤šçº¿ç¨‹ä¸‹çš„çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œ==åˆ›å»ºå¤šä¸ªå¯¹è±¡==ï¼š

	> <img src="bgwROUND1.assets/640-17150011442242.webp" alt="å›¾ç‰‡" style="zoom:125%;" />

4. ==éšè—çš„çº¿ç¨‹å®‰å…¨é—®é¢˜==ï¼š

	> - ==å…ˆçœ‹çœ‹æ”¹è¿›åŽå­˜åœ¨éšè—çº¿ç¨‹å®‰å…¨é—®é¢˜çš„ä»£ç ==ï¼š
	>
	> <img src="bgwROUND1.assets/640-17150013123104.webp" alt="å›¾ç‰‡" style="zoom:125%;" />
	>
	> - ==çº¿ç¨‹å®‰å…¨é—®é¢˜çš„åŽŸå› ==ï¼š==æŒ‡ä»¤é‡æŽ’==
	>
	> 	- æ¯”å¦‚javaä¸­ç®€å•çš„ä¸€å¥ instance = new Singletonï¼Œä¼šè¢«ç¼–è¯‘å™¨ç¼–è¯‘æˆå¦‚ä¸‹JVMæŒ‡ä»¤ï¼š
	>
	> 		```java
	> 		memory = allocate();  //1ï¼šåˆ†é…å¯¹è±¡çš„å†…å­˜ç©ºé—´ 
	> 		
	> 		ctorInstance(memory); //2ï¼šåˆå§‹åŒ–å¯¹è±¡ 
	> 		
	> 		instance = memory;   //3ï¼šè®¾ç½®instanceæŒ‡å‘åˆšåˆ†é…çš„å†…å­˜åœ°å€ 
	> 		```
	>
	> 		ä½†æ˜¯è¿™äº›æŒ‡ä»¤é¡ºåºå¹¶éžä¸€æˆä¸å˜ï¼Œ==æœ‰å¯èƒ½ä¼šç»è¿‡JVMå’ŒCPUçš„ä¼˜åŒ–ï¼ŒæŒ‡ä»¤é‡æŽ’æˆä¸‹é¢çš„é¡ºåº==ï¼š
	>
	> 		```java
	> 		memory = allocate();  //1ï¼šåˆ†é…å¯¹è±¡çš„å†…å­˜ç©ºé—´ 
	> 		
	> 		instance = memory;   //3ï¼šè®¾ç½®instanceæŒ‡å‘åˆšåˆ†é…çš„å†…å­˜åœ°å€ 
	> 		
	> 		ctorInstance(memory); //2ï¼šåˆå§‹åŒ–å¯¹è±¡ 
	> 		```
	>
	> 	- å½“çº¿ç¨‹Aæ‰§è¡Œå®Œ1,3,æ—¶ï¼Œ==instanceå¯¹è±¡è¿˜æœªå®Œæˆåˆå§‹åŒ–ï¼Œä½†å·²ç»ä¸å†æŒ‡å‘null==ã€‚æ­¤æ—¶å¦‚æžœçº¿ç¨‹BæŠ¢å åˆ°CPUèµ„æºï¼Œæ‰§è¡Œ ifï¼ˆinstance == nullï¼‰çš„ç»“æžœä¼šæ˜¯ ==false==ï¼Œä»Žè€Œè¿”å›žä¸€ä¸ª==æ²¡æœ‰åˆå§‹åŒ–å®Œæˆçš„instanceå¯¹è±¡==ã€‚
	>
	> 		<img src="bgwROUND1.assets/640-17150015361836.webp" alt="å›¾ç‰‡" style="zoom:125%;" />
	>
	> 	- è§£å†³æ–¹å¼ï¼š==ç»™å•ä¾‹å¯¹è±¡åŠ ä¸Š volatile ä¿®é¥°ç¬¦ `private static volatile instance`ï¼Œé¿å…ç¼–è¯‘æœŸé‡æŽ’åº==ã€‚

5. ==ç”¨é™æ€å†…éƒ¨ç±»å®žçŽ°å•ä¾‹æ¨¡å¼==ï¼š

	> - ```java
	> 	public class Singleton {
	> 	    private static class LazyHolder {
	> 	        private static final Singleton INSTANCE = new Singleton();
	> 	    }
	> 	    private Singleton (){}
	> 	    public static Singleton getInstance() {
	> 	        return LazyHolder.INSTANCE;
	> 	    }
	> 	}
	> 	```
	>
	> - INSTANCEå¯¹è±¡åˆå§‹åŒ–çš„æ—¶æœºå¹¶ä¸æ˜¯åœ¨å•ä¾‹ç±»Singletonè¢«åŠ è½½çš„æ—¶å€™ï¼Œè€Œæ˜¯åœ¨==è°ƒç”¨getInstanceæ–¹æ³•çš„æ—¶å€™ï¼Œä½¿å¾—é™æ€å†…éƒ¨ç±»LazyHolderè¢«åŠ è½½==ã€‚å› æ­¤è¿™ç§å®žçŽ°æ–¹å¼æ˜¯åˆ©ç”¨==classloaderçš„åŠ è½½æœºåˆ¶==æ¥å®žçŽ°==æ‡’åŠ è½½==ï¼Œå¹¶ä¿è¯æž„å»ºå•ä¾‹çš„çº¿ç¨‹å®‰å…¨ã€‚

6. ==åˆ©ç”¨åå°„æ‰“ç ´å•ä¾‹==ï¼š

	> - ```java
	> 	//èŽ·å¾—æž„é€ å™¨
	> 	Constructor con = Singleton.class.getDeclaredConstructor();
	> 	//è®¾ç½®ä¸ºå¯è®¿é—®
	> 	con.setAccessible(true);
	> 	//æž„é€ ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡
	> 	Singleton singleton1 = (Singleton)con.newInstance();
	> 	Singleton singleton2 = (Singleton)con.newInstance();
	> 	//éªŒè¯æ˜¯å¦æ˜¯ä¸åŒå¯¹è±¡
	> 	System.out.println(singleton1.equals(singleton2)); // false
	> 	```

7. ==ç”¨æžšä¸¾å®žçŽ°å•ä¾‹æ¨¡å¼==ï¼š

	> ```java
	> public enum SingletonEnum {
	>     INSTANCE;
	> }
	> ```
	>
	> ==æœ‰äº† enum è¯­æ³•ç³–ï¼ŒJVM ä¼šé˜»æ­¢åå°„èŽ·å–æžšä¸¾ç±»çš„ç§æœ‰æž„é€ æ–¹æ³•==ã€‚
	>
	> ==å†æ¬¡å°è¯•ä½¿ç”¨åå°„æ‰“ç ´å•ä¾‹æ—¶æŠ¥é”™==ï¼š
	>
	> ```java
	> Exception in thread "main" java.lang.NoSuchMethodException: com.xiaohui.singleton.test.SingletonEnum.<init>()
	> ```
	>
	> ==ç¼ºç‚¹==ï¼š==é¥¿æ±‰å¼åŠ è½½==ã€‚

8. ==æ€»ç»“==ï¼š

	> - <img src="bgwROUND1.assets/image-20240506213434574.png" alt="image-20240506213434574" style="zoom:67%;" />
	> - ä½¿ç”¨æžšä¸¾å®žçŽ°çš„å•ä¾‹æ¨¡å¼ï¼Œä¸ä½†å¯ä»¥é˜²æ­¢åˆ©ç”¨åå°„å¼ºè¡Œæž„å»ºå•ä¾‹å¯¹è±¡ï¼Œè€Œä¸”å¯ä»¥åœ¨æžšä¸¾ç±»å¯¹è±¡è¢«==ååºåˆ—åŒ–==çš„æ—¶å€™ï¼Œä¿è¯ååºåˆ—çš„==è¿”å›žç»“æžœæ˜¯åŒä¸€å¯¹è±¡==ã€‚
	> - å¯¹äºŽ==å…¶ä»–æ–¹å¼å®žçŽ°çš„å•ä¾‹æ¨¡å¼==ï¼Œå¦‚æžœæ—¢æƒ³è¦åšåˆ°å¯==åºåˆ—åŒ–ï¼Œåˆæƒ³è¦ååºåˆ—åŒ–ä¸ºåŒä¸€å¯¹è±¡ï¼Œåˆ™å¿…é¡»å®žçŽ° readResolve æ–¹æ³•==ã€‚

---



### 3.ä»€ä¹ˆæ˜¯ä»£ç†æ¨¡å¼ï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

1. ==é™æ€ä»£ç†==ï¼š==å†™æ­»ä»£ç†çš„ç±»ï¼Œç¼ºç‚¹æ˜¯æ³›ç”¨æ€§å·®==ï¼Œæ¯”å¦‚æˆ‘æƒ³ç»™å¾ˆå¤šç±»æ·»åŠ åŒä¸€ä¸ªåŠŸèƒ½ï¼Œé‚£æˆ‘æ€»ä¸èƒ½ç»™æ¯ä¸€ä¸ªç±»éƒ½ç¼–å†™ä¸€ä¸ªä»£ç†ç±»å§ã€‚

2. ==å®žçŽ°InvocationHandleræŽ¥å£ï¼Œå®šä¹‰è°ƒç”¨æ–¹æ³•å‰åŽæ‰€åšçš„äº‹æƒ…==ï¼š

	```java
	public class StudentInvocationHandler implements InvocationHandler {
	
	    private IStudentService studentService;
	
	    public StudentInvocationHandler(IStudentService studentService){
	        this.studentService = studentService;
	    }
	
	    @Override
	    public Object invoke(Object proxy, Method method, Object[] args) 
	        throws Throwable {
	        System.out.println(method.getName() + "æ–¹æ³•è°ƒç”¨å‰");
	        method.invoke(studentService, args);
	        System.out.println(method.getName() + "æ–¹æ³•è°ƒç”¨åŽ");
	        return null;
	    }
	}
	```

3. é€šè¿‡ ==Proxy ç±»çš„ newProxyInstance æ–¹æ³•ï¼ŒåŠ¨æ€ç”Ÿæˆä»£ç†å¯¹è±¡ studentServiceProxy==ï¼š

	```java
	public class Client {
	    public static void main(String[] args) {
	        // åˆå§‹åŒ– studentService
	        IStudentService studentService = new StudentService();
	        
	        //åˆå§‹åŒ– studentInvocationHandler(å®žçŽ° InvocationHandler æŽ¥å£)
	        InvocationHandler studentInvocationHandler = 
	            new StudentInvocationHandler(studentService);
	        
	        // é€šè¿‡ Proxy.newProxyInstance èŽ·å–ä»£ç†ç±» studentServiceProxy
	        IStudentService studentServiceProxy = (IStudentService) Proxy
	            .newProxyInstance(
	            // ä¼ å…¥ studentInvocationHandler çš„ç±»åŠ è½½å™¨
	            studentInvocationHandler.getClass().getClassLoader(), 
	            // ä¼ å…¥ studentService å®žçŽ°çš„æŽ¥å£        
	            studentService.getClass().getInterfaces(), 
	            // ä¼ å…¥ studentInvocationHandler
	            studentInvocationHandler);
	        
	        studentServiceProxy.insertStudent();
	        studentServiceProxy.deleteStudent();
	    }
	}
	```

4. ==ä»£ç†æ¨¡å¼ vs è£…é¥°å™¨æ¨¡å¼==

	> å¯¹äºŽåŽŸæœ‰çš„ç±»æ¥è¯´ï¼Œ==è£…é¥°å™¨==æ˜¯â€œè‡ªå·±äººâ€ï¼Œ==å¢žåŠ çš„åŠŸèƒ½æ˜¯å¯¹è‡ªèº«çš„å¢žå¼º==ï¼›
	>
	> è€Œ==ä»£ç†==æ˜¯â€œå¤–äººâ€ï¼Œ==å¢žåŠ çš„åŠŸèƒ½å’Œè‡ªèº«å¹¶æ— ç›´æŽ¥å…³ç³»==ã€‚

---



### 4.ä»€ä¹ˆæ˜¯å·¥åŽ‚æ¨¡å¼ï¼ŸðŸŒŸðŸŒŸ

1. å·¥åŽ‚æ¨¡å¼åœ¨åˆ›å»ºåž‹æ¨¡å¼å½“ä¸­æ¯”è¾ƒå¸¸ç”¨ï¼Œå®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è®¾è®¡æ¨¡å¼ï¼Œè€Œæ˜¯==ä¸‰ç§åŠŸèƒ½æŽ¥è¿‘çš„è®¾è®¡æ¨¡å¼çš„ç»Ÿç§°==ã€‚åˆ†åˆ«ä¸º==ç®€å•å·¥åŽ‚æ¨¡å¼ï¼Œå·¥åŽ‚æ–¹æ³•æ¨¡å¼ï¼ŒæŠ½è±¡å·¥åŽ‚æ¨¡å¼==ã€‚
2. é€šè¿‡å·¥åŽ‚ç±»åˆ›å»ºå¯¹è±¡å¹¶ä¸”==æ ¹æ®ä¼ å…¥å‚æ•°å†³å®šå…·ä½“å­ç±»å¯¹è±¡==çš„åšæ³•ï¼Œå°±æ˜¯==ç®€å•å·¥åŽ‚æ¨¡å¼==ã€‚
3. ==æ¯ä¸€ä¸ªå£ç½©å­ç±»éƒ½å¯¹åº”ä¸€ä¸ªå·¥åŽ‚å­ç±»ï¼Œåˆ©ç”¨å¤šæ€ç‰¹æ€§åŠ¨æ€åˆ›å»ºå¯¹è±¡çš„æ¨¡å¼==ï¼Œå°±æ˜¯==å·¥åŽ‚æ–¹æ³•æ¨¡å¼==ã€‚

---



### 5.ä»€ä¹ˆæ˜¯è§‚å¯Ÿè€…æ¨¡å¼ï¼ŸðŸŒŸðŸŒŸ

1. > <img src="bgwROUND1.assets/image-20240507105810215.png" alt="image-20240507105810215" style="zoom:67%;" />

2. åœ¨ä¸Šé¢çš„UMLå›¾ä¸­ï¼Œä¸»è¦æœ‰ä¸¤ç»„å®žä½“å¯¹è±¡ï¼Œä¸€ç»„æ˜¯è§‚å¯Ÿè€…ï¼Œä¸€ç»„æ˜¯è¢«è§‚å¯Ÿè€…ã€‚==æ‰€æœ‰çš„è§‚å¯Ÿè€…ï¼Œéƒ½å®žçŽ°äº†ObserveræŽ¥å£==ï¼›==æ‰€æœ‰çš„è¢«è§‚å¯Ÿè€…ï¼Œéƒ½ç»§æ‰¿è‡ªSubjectæŠ½è±¡ç±»==ã€‚

3. ==Subjectç±»çš„æˆå‘˜OberverListï¼Œå­˜å‚¨ç€å·²æ³¨å†Œçš„è§‚å¯Ÿè€…==ï¼Œå½“==äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œä¼šé€šçŸ¥åˆ—è¡¨ä¸­çš„æ‰€æœ‰è§‚å¯Ÿè€…==ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒOberverListæ‰€ä¾èµ–çš„æ˜¯çš„ObserveræŽ¥å£ï¼Œè¿™æ ·å°±é¿å…äº†è§‚å¯Ÿè€…ä¸Žè¢«è§‚å¯Ÿè€…çš„ç´§è€¦åˆã€‚

4. ==ç¤ºä¾‹ï¼Œåˆ›å»º Observer å’Œ Subject==ï¼š

	```java
	//è§‚å¯Ÿè€…
	public interface Observer {
	    public void update();
	}
	
	//è¢«è§‚å¯Ÿè€…
	abstract public class Subject {
	
	    private List<Observer> observerList = new ArrayList<Observer>();
	
	    public void attachObserver(Observer observer) {
	        observerList.add(observer);
	    }
	
	    public void detachObserver(Observer observer){
	        observerList.remove(observer);
	    }
	
	    public void notifyObservers(){
	        for (Observer observer: observerList){
	            observer.update();
	        }
	    }
	}
	```

5. è§‚å¯Ÿè€…ä»¬å®žçŽ° Observer æŽ¥å£ï¼Œè‡ªè¡Œå®žçŽ° update é€»è¾‘

	```java
	//æ€ªç‰©
	public class Monster implements Observer {
	
	    @Override
	    public void update() {
	        if(inRange()){
	            System.out.println("æ€ªç‰© å¯¹ä¸»è§’æ”»å‡»ï¼");
	        }
	    }
	
	    private boolean inRange(){
	        //åˆ¤æ–­ä¸»è§’æ˜¯å¦åœ¨è‡ªå·±çš„å½±å“èŒƒå›´å†…ï¼Œè¿™é‡Œå¿½ç•¥ç»†èŠ‚ï¼Œç›´æŽ¥è¿”å›žtrue
	        return true;
	    }
	}
	
	//é™·é˜±
	public class Trap implements Observer {
	
	    @Override
	    public void update() {
	        if(inRange()){
	            System.out.println("é™·é˜± å›°ä½ä¸»è§’ï¼");
	        }
	    }
	
	    private boolean inRange(){
	        //åˆ¤æ–­ä¸»è§’æ˜¯å¦åœ¨è‡ªå·±çš„å½±å“èŒƒå›´å†…ï¼Œè¿™é‡Œå¿½ç•¥ç»†èŠ‚ï¼Œç›´æŽ¥è¿”å›žtrue
	        return true;
	    }
	}
	
	//å®ç‰©
	public class Treasure implements Observer {
	
	    @Override
	    public void update() {
	        if(inRange()){
	            System.out.println("å®ç‰© ä¸ºä¸»è§’åŠ è¡€ï¼");
	        }
	    }
	
	    private boolean inRange(){
	        //åˆ¤æ–­ä¸»è§’æ˜¯å¦åœ¨è‡ªå·±çš„å½±å“èŒƒå›´å†…ï¼Œè¿™é‡Œå¿½ç•¥ç»†èŠ‚ï¼Œç›´æŽ¥è¿”å›žtrue
	        return true;
	    }
	}
	```

	æ¸¸æˆçš„ä¸»è§’ç»§æ‰¿ Subject ç±»

	```java
	public class Hero extends Subject{
	    void move(){
	        System.out.println("ä¸»è§’å‘å‰ç§»åŠ¨");
	        notifyObservers(); // é€šçŸ¥æ‰€æœ‰ Oberserï¼Œè‡ªå·±è¡ŒåŠ¨äº†
	    }
	}
	```

---



## 2.Java Web

### 1.ä»€ä¹ˆæ˜¯å•ç‚¹ç™»å½•ï¼ŸðŸŒŸðŸŒŸðŸŒŸ

1. å•ç‚¹ç™»å½•å°±æ˜¯==åœ¨å¤šä¸ªç³»ç»Ÿä¸­ï¼Œç”¨æˆ·åªéœ€ä¸€æ¬¡ç™»å½•ï¼Œå„ä¸ªç³»ç»Ÿå³å¯æ„ŸçŸ¥è¯¥ç”¨æˆ·å·²ç»ç™»å½•==ã€‚

	> æ¯”å¦‚é˜¿é‡Œç³»çš„==æ·˜å®å’Œå¤©çŒ«==ï¼Œå¾ˆæ˜Žæ˜¾åœ°æˆ‘ä»¬å¯ä»¥çŸ¥é“è¿™æ˜¯ä¸¤ä¸ªç³»ç»Ÿï¼Œä½†æ˜¯ä½ åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œç™»å½•äº†å¤©çŒ«ï¼Œæ·˜å®ä¹Ÿä¼šè‡ªåŠ¨ç™»å½•ã€‚

2. å›žé¡¾æˆ‘ä»¬å½“åˆçš„==å•ç³»ç»Ÿç™»å½•==ï¼š

	> - ç”¨æˆ·ç™»å½•æ—¶ï¼ŒéªŒè¯ç”¨æˆ·çš„è´¦æˆ·å’Œå¯†ç ã€‚
	> - ç”Ÿæˆä¸€ä¸ª LoginToken ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œå°† LoginToken å†™åˆ° Cookie ä¸­ã€‚
	> - å°†ç”¨æˆ·æ•°æ®ä¿å­˜åœ¨ Session / ThreadLocal ä¸­ã€‚
	> - è¯·æ±‚æ—¶éƒ½ä¼šå¸¦ä¸Š Cookieï¼Œæ£€æŸ¥æœ‰æ²¡æœ‰ç™»å½•ï¼Œå¦‚æžœå·²ç»ç™»å½•åˆ™æ”¾è¡Œï¼›æ²¡æœ‰ç™»å½•åˆ™æ ¹æ® LoginToken æŸ¥è¯¢å¯¹åº” Userï¼Œç„¶åŽå†™å…¥ Session / ThreadLocal å®žçŽ°è‡ªåŠ¨ç™»å½•ã€‚

3. ==å¤šç³»ç»Ÿç™»å½•çš„é—®é¢˜==ï¼š

	> - ==Sessionä¸å…±äº«é—®é¢˜==
	> - ==Cookieè·¨åŸŸçš„é—®é¢˜==
	> - ==CASåŽŸç†==

4. ==Sessionä¸å…±äº«é—®é¢˜==

	> - å•ç³»ç»Ÿç™»å½•åŠŸèƒ½ä¸»è¦æ˜¯ç”¨Sessionä¿å­˜ç”¨æˆ·ä¿¡æ¯æ¥å®žçŽ°çš„ï¼Œä½†æ˜¯ï¼š==å¤šç³»ç»Ÿå³å¯èƒ½æœ‰å¤šä¸ªTomcat==ï¼Œè€Œ==Sessionä¾èµ–çš„æ˜¯å½“å‰ç³»ç»Ÿçš„Tomcat==ï¼Œæ‰€ä»¥==ç³»ç»ŸAçš„Sessionå’Œç³»ç»ŸBçš„Session==æ˜¯==ä¸å…±äº«==çš„ã€‚
	>
	> - ![image-20240507115020651](bgwROUND1.assets/image-20240507115020651.png)
	>
	> - æˆ‘ä»¬å¯ä»¥å°†ç™»å½•åŠŸèƒ½==å•ç‹¬æŠ½å–==å‡ºæ¥ï¼Œåšæˆä¸€ä¸ª==å­ç³»ç»Ÿ==ã€‚
	>
	> 	![image-20240507121344108](bgwROUND1.assets/image-20240507121344108.png)
	>
	> 	- ==SSOç³»ç»Ÿç”Ÿæˆä¸€ä¸ªtokenï¼Œå¹¶å°†ç”¨æˆ·ä¿¡æ¯å­˜åˆ°Redisä¸­==ï¼Œå¹¶è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚
	> 	- ==å…¶ä»–ç³»ç»Ÿè¯·æ±‚SSOç³»ç»Ÿ==è¿›è¡Œç™»å½•ï¼Œ==å¾—åˆ°SSOè¿”å›žçš„tokenï¼Œå†™åˆ°Cookie==ä¸­ã€‚
	> 	- æ¯æ¬¡è¯·æ±‚æ—¶ï¼ŒCookieéƒ½ä¼šå¸¦ä¸Šï¼Œ==æ‹¦æˆªå™¨å¾—åˆ°tokenï¼Œåˆ¤æ–­æ˜¯å¦å·²ç»ç™»å½•==ã€‚
	>
	> 	åˆ°è¿™é‡Œï¼Œå…¶å®žæˆ‘ä»¬ä¼šå‘çŽ°å…¶å®žå°±ä¸¤ä¸ªå˜åŒ–ï¼š
	>
	> 	- ==å°†ç™»é™†åŠŸèƒ½æŠ½å–ä¸ºä¸€ä¸ªç³»ç»Ÿï¼ˆSSOï¼‰ï¼Œå…¶ä»–ç³»ç»Ÿè¯·æ±‚SSOè¿›è¡Œç™»å½•==ã€‚
	> 	- ==æœ¬æ¥å°†ç”¨æˆ·ä¿¡æ¯å­˜åˆ°Sessionï¼ŒçŽ°åœ¨å°†ç”¨æˆ·ä¿¡æ¯å­˜åˆ°Redis==ã€‚

5. ==Cookieè·¨åŸŸçš„é—®é¢˜==

	> - ==Cookieæ˜¯ä¸èƒ½è·¨åŸŸçš„==ã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬è¯·æ±‚`<https://www.google.com/>`æ—¶ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨æŠŠ`google.com`çš„Cookieå¸¦è¿‡åŽ»ç»™`google`çš„æœåŠ¡å™¨ï¼Œè€Œä¸ä¼šæŠŠ`<https://www.baidu.com/>`çš„Cookieå¸¦è¿‡åŽ»ç»™`google`çš„æœåŠ¡å™¨ã€‚
	> - ==ç”±äºŽåŸŸåä¸åŒ==ï¼Œç”¨æˆ·å‘ç³»ç»ŸAç™»å½•åŽï¼Œ==ç³»ç»ŸAè¿”å›žç»™æµè§ˆå™¨çš„Cookieï¼Œç”¨æˆ·å†è¯·æ±‚ç³»ç»ŸBçš„æ—¶å€™ä¸ä¼šå°†ç³»ç»ŸAçš„Cookieå¸¦è¿‡åŽ»==ã€‚
	> - ==è§£å†³æ–¹æ¡ˆ==ï¼š
	> 	1. æœåŠ¡ç«¯å°†Cookieå†™åˆ°å®¢æˆ·ç«¯åŽï¼Œ==å®¢æˆ·ç«¯å¯¹Cookieè¿›è¡Œè§£æžï¼Œå°†Tokenè§£æžå‡ºæ¥==ï¼Œ==æ­¤åŽè¯·æ±‚éƒ½æŠŠè¿™ä¸ªTokenå¸¦ä¸Šå°±è¡Œäº†==ã€‚
	> 	2. ==å¤šä¸ªåŸŸåå…±äº«Cookie==ï¼Œåœ¨å†™åˆ°å®¢æˆ·ç«¯çš„æ—¶å€™==è®¾ç½®Cookieçš„domain==ã€‚
	> 	3. å°†Tokenä¿å­˜åœ¨SessionStroageä¸­ï¼ˆ==ä¸ä¾èµ–Cookie==å°±æ²¡æœ‰è·¨åŸŸçš„é—®é¢˜äº†ï¼‰

6. ==CASåŽŸç†==

	> - ![image-20220303162331489](bgwROUND1.assets/image-20220303162331489.png)
	> - ç³»ç»ŸA`www.java3y.com`å‘çŽ°ç”¨æˆ·å¹¶æ²¡æœ‰ç™»å½•ï¼ŒäºŽæ˜¯==é‡å®šå‘åˆ°ssoè®¤è¯ä¸­å¿ƒï¼Œå¹¶å°†è‡ªå·±çš„åœ°å€ä½œä¸ºå‚æ•°==ï¼š==`www.sso.com?service=www.java3y.com`==ã€‚
	> - ssoè®¤è¯ä¸­å¿ƒå‘çŽ°ç”¨æˆ·æœªç™»å½•ï¼Œå°†ç”¨æˆ·å¼•å¯¼è‡³ç™»å½•é¡µé¢ï¼Œç”¨æˆ·è¿›è¡Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œç™»å½•ï¼Œ==ç”¨æˆ·ä¸Žè®¤è¯ä¸­å¿ƒ==å»ºç«‹==å…¨å±€ä¼šè¯ï¼ˆç”Ÿæˆä¸€ä»½Tokenï¼Œå†™åˆ°Cookieä¸­ï¼Œä¿å­˜åœ¨æµè§ˆå™¨ä¸Šï¼‰==ã€‚
	> - éšåŽï¼Œè®¤è¯ä¸­å¿ƒ==é‡å®šå‘å›žç³»ç»ŸA==ï¼Œå¹¶æŠŠTokenæºå¸¦è¿‡åŽ»ç»™ç³»ç»ŸAï¼Œé‡å®šå‘çš„åœ°å€å¦‚ä¸‹ï¼š==`www.java3y.com?token=xxxxxxx`==ã€‚
	> - ![image-20220303162426274](bgwROUND1.assets/image-20220303162426274.png)
	> - æ­¤æ—¶ï¼Œç”¨æˆ·æƒ³è¦è®¿é—®ç³»ç»ŸB`www.java4y.com`å—é™çš„èµ„æº(æ¯”å¦‚è¯´è®¢å•åŠŸèƒ½ï¼Œè®¢å•åŠŸèƒ½éœ€è¦ç™»å½•åŽæ‰èƒ½è®¿é—®)ï¼Œç³»ç»ŸB`www.java4y.com`å‘çŽ°ç”¨æˆ·å¹¶æ²¡æœ‰ç™»å½•ï¼ŒäºŽæ˜¯==é‡å®šå‘åˆ°ssoè®¤è¯ä¸­å¿ƒï¼Œå¹¶å°†è‡ªå·±çš„åœ°å€ä½œä¸ºå‚æ•°==ã€‚è®¤è¯ä¸­å¿ƒ==æ ¹æ®å¸¦è¿‡æ¥çš„Cookie==å‘çŽ°==å·²ç»ä¸Žç”¨æˆ·å»ºç«‹äº†å…¨å±€ä¼šè¯==äº†ï¼Œè®¤è¯ä¸­å¿ƒ==é‡å®šå‘å›žç³»ç»ŸB==ï¼Œå¹¶æŠŠ==Tokenæºå¸¦è¿‡åŽ»ç»™ç³»ç»ŸB==ã€‚
	> - ![image-20220303162448039](bgwROUND1.assets/image-20220303162448039.png)
	> - çœ‹åˆ°è¿™é‡Œï¼Œå…¶å®žSSOè®¤è¯ä¸­å¿ƒå°±ç±»ä¼¼ä¸€ä¸ª==ä¸­è½¬ç«™==ã€‚

---



### 2.é¢è¯•é¢˜ï¼šç»™æˆ‘è¯´ä¸€ä¸‹ä½ é¡¹ç›®ä¸­çš„å•ç‚¹ç™»å½•æ˜¯å¦‚ä½•å®žçŽ°çš„ï¼ŸðŸŒŸðŸŒŸðŸŒŸ

1. ==httpæ— çŠ¶æ€åè®®==

	> - ==httpæ˜¯æ— çŠ¶æ€åè®®==ï¼Œæµè§ˆå™¨çš„æ¯ä¸€æ¬¡è¯·æ±‚ï¼ŒæœåŠ¡å™¨ä¼šç‹¬ç«‹å¤„ç†ï¼Œ==ä¸ä¸Žä¹‹å‰æˆ–ä¹‹åŽçš„è¯·æ±‚äº§ç”Ÿå…³è”==ã€‚
	> - <img src="bgwROUND1.assets/797930-20161129155231912-1627010726.png" alt="3c91a3bf-25d8-4b1f-8e4a-68535c51aaa8" style="zoom:125%;" />
	> - ==æ—¢ç„¶httpåè®®æ— çŠ¶æ€ï¼Œé‚£å°±è®©æœåŠ¡å™¨å’Œæµè§ˆå™¨å…±åŒç»´æŠ¤ä¸€ä¸ªçŠ¶æ€å§==ï¼è¿™å°±æ˜¯==ä¼šè¯æœºåˆ¶==ã€‚

2. ==ä¼šè¯æœºåˆ¶==

	> - æµè§ˆå™¨ç¬¬ä¸€æ¬¡è¯·æ±‚æœåŠ¡å™¨ï¼Œ==æœåŠ¡å™¨åˆ›å»ºä¸€ä¸ªä¼šè¯ï¼Œå¹¶å°†ä¼šè¯çš„idä½œä¸ºå“åº”çš„ä¸€éƒ¨åˆ†å‘é€ç»™æµè§ˆå™¨==ï¼Œæµè§ˆå™¨å­˜å‚¨ä¼šè¯idï¼Œ==å¹¶åœ¨åŽç»­ç¬¬äºŒæ¬¡å’Œç¬¬ä¸‰æ¬¡è¯·æ±‚ä¸­å¸¦ä¸Šä¼šè¯idï¼ŒæœåŠ¡å™¨å–å¾—è¯·æ±‚ä¸­çš„ä¼šè¯idå°±çŸ¥é“æ˜¯ä¸æ˜¯åŒä¸€ä¸ªç”¨æˆ·äº†==ã€‚
	> - <img src="bgwROUND1.assets/797930-20161129155233115-1744636093.png" alt="8a9fb230-d506-4b19-b821-4001c68c4588" style="zoom:125%;" />
	> - tomcatä¼šè¯æœºåˆ¶å½“ç„¶ä¹Ÿå®žçŽ°äº†cookieï¼Œè®¿é—®tomcatæœåŠ¡å™¨æ—¶ï¼Œæµè§ˆå™¨ä¸­å¯ä»¥çœ‹åˆ°ä¸€ä¸ªåä¸ºâ€œ==JSESSIONIDâ€çš„cookieï¼Œè¿™å°±æ˜¯tomcatä¼šè¯æœºåˆ¶ç»´æŠ¤çš„ä¼šè¯id==ã€‚
	> - <img src="bgwROUND1.assets/797930-20161129155234443-99011212.png" alt="518293d9-64b2-459c-9d45-9f353c757d1f" style="zoom:125%;" />

3. ==ç™»å½•çŠ¶æ€==

	> - <img src="bgwROUND1.assets/797930-20161129155235693-1708276896.png" alt="70e396fa-1bf2-42f8-a504-ce20306e31fa" style="zoom:125%;" />
	> - ==ä»¥ä¸Šè®¨è®ºï¼Œéƒ½æ˜¯åœ¨å•ç³»ç»Ÿçš„èŒƒç•´ä¸­==ã€‚

4. ==å¤šç³»ç»Ÿçš„å¤æ‚æ€§==

	> - ==webç³»ç»Ÿæ—©å·²ä»Žä¹…è¿œçš„å•ç³»ç»Ÿå‘å±•æˆä¸ºå¦‚ä»Šç”±å¤šç³»ç»Ÿç»„æˆçš„åº”ç”¨ç¾¤==ï¼Œé¢å¯¹å¦‚æ­¤ä¼—å¤šçš„ç³»ç»Ÿï¼Œç”¨æˆ·==éš¾é“è¦ä¸€ä¸ªä¸€ä¸ªç™»å½•ã€ç„¶åŽä¸€ä¸ªä¸€ä¸ªæ³¨é”€==å—ï¼Ÿå°±åƒä¸‹å›¾æè¿°çš„è¿™æ ·ï¼š
	>
	> 	![6dfbb0b1-46c0-4945-a3bf-5f060fa80710](bgwROUND1.assets/797930-20161129155236615-855014039.png)
	>
	> - è™½ç„¶å•ç³»ç»Ÿçš„ç™»å½•è§£å†³æ–¹æ¡ˆå¾ˆå®Œç¾Žï¼Œä½†å¯¹äºŽå¤šç³»ç»Ÿåº”ç”¨ç¾¤å·²ç»ä¸å†é€‚ç”¨äº†ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ
	>
	> 	- ==Cookie ä¸èƒ½è·¨åŸŸ==ã€‚
	>
	> 	<img src="bgwROUND1.assets/797930-20161129155238881-1171826792.png" alt="4d58ccfa-0114-486d-bec2-c28f2f9eb513" style="zoom:150%;" />
	>
	> - ==å…±äº« Cookie== è§£å†³ Cookie è·¨åŸŸé—®é¢˜ï¼š
	>
	> 	- æ—¢ç„¶è¿™æ ·ï¼Œä¸ºä»€ä¹ˆä¸å°†webåº”ç”¨ç¾¤ä¸­æ‰€æœ‰å­ç³»ç»Ÿçš„åŸŸåç»Ÿä¸€åœ¨ä¸€ä¸ªé¡¶çº§åŸŸåä¸‹ï¼Œä¾‹å¦‚â€œ*.baidu.comâ€ï¼Œç„¶åŽ==å°†å®ƒä»¬çš„cookieåŸŸè®¾ç½®ä¸ºâ€œbaidu.comâ€==ï¼Œè¿™ç§åšæ³•ç†è®ºä¸Šæ˜¯å¯ä»¥çš„ï¼Œç”šè‡³æ—©æœŸå¾ˆå¤šå¤šç³»ç»Ÿç™»å½•å°±é‡‡ç”¨è¿™ç§==åŒåŸŸåå…±äº«cookie==çš„æ–¹å¼ã€‚
	> 	- ç„¶è€Œï¼Œå¯è¡Œå¹¶ä¸ä»£è¡¨å¥½ï¼Œå…±äº«cookieçš„æ–¹å¼å­˜åœ¨==ä¼—å¤šå±€é™==ã€‚
	> 		1. é¦–å…ˆï¼Œ==åº”ç”¨ç¾¤åŸŸåå¾—ç»Ÿä¸€==ï¼›
	> 		2. å…¶æ¬¡ï¼Œåº”ç”¨ç¾¤å„ç³»ç»Ÿä½¿ç”¨çš„æŠ€æœ¯ï¼ˆ==è‡³å°‘æ˜¯webæœåŠ¡å™¨ï¼‰è¦ç›¸åŒ==ï¼Œ==ä¸ç„¶cookieçš„keyå€¼ï¼ˆtomcatä¸ºJSESSIONIDï¼‰ä¸åŒï¼Œæ— æ³•ç»´æŒä¼šè¯==ï¼›
	> 		3. å…±äº«cookieçš„æ–¹å¼æ˜¯==æ— æ³•å®žçŽ°è·¨è¯­è¨€æŠ€æœ¯å¹³å°ç™»å½•==çš„ï¼Œæ¯”å¦‚javaã€phpã€.netç³»ç»Ÿä¹‹é—´ï¼›ç¬¬ä¸‰ï¼Œcookieæœ¬èº«ä¸å®‰å…¨ã€‚

5. ==å•ç‚¹ç™»å½•==

	> - å•ç‚¹ç™»å½•å…¨ç§°Single Sign Onï¼ˆä»¥ä¸‹ç®€ç§°SSOï¼‰ï¼Œæ˜¯æŒ‡==åœ¨å¤šç³»ç»Ÿåº”ç”¨ç¾¤ä¸­ç™»å½•ä¸€ä¸ªç³»ç»Ÿï¼Œä¾¿å¯åœ¨å…¶ä»–æ‰€æœ‰ç³»ç»Ÿä¸­å¾—åˆ°æŽˆæƒè€Œæ— éœ€å†æ¬¡ç™»å½•==ã€‚
	> - <img src="bgwROUND1.assets/797930-20161203152650974-276822362.png" alt="img" style="zoom:125%;" />
	> - ==å¯¹ä¸Šå›¾çš„è§£é‡Š==ï¼š
	> 	1. ç”¨æˆ·è®¿é—®ç³»ç»Ÿ1çš„å—ä¿æŠ¤èµ„æºï¼Œç³»ç»Ÿ1å‘çŽ°ç”¨æˆ·æœªç™»å½•ï¼Œ==é‡å®šå‘è‡³ssoè®¤è¯ä¸­å¿ƒï¼Œå¹¶å°†è‡ªå·±çš„åœ°å€ä½œä¸ºå‚æ•°==ã€‚
	> 	2. ssoè®¤è¯ä¸­å¿ƒå‘çŽ°ç”¨æˆ·æœªç™»å½•ï¼Œå°†ç”¨æˆ·å¼•å¯¼è‡³ç™»å½•é¡µé¢ã€‚
	> 	3. ç”¨æˆ·è¾“å…¥ç”¨æˆ·åå¯†ç æäº¤ç™»å½•ç”³è¯·ã€‚
	> 	4. ssoè®¤è¯ä¸­å¿ƒæ ¡éªŒç”¨æˆ·ä¿¡æ¯ï¼Œ==åˆ›å»ºç”¨æˆ·ä¸Žssoè®¤è¯ä¸­å¿ƒä¹‹é—´çš„ä¼šè¯ï¼Œç§°ä¸ºå…¨å±€ä¼šè¯==ï¼ŒåŒæ—¶==åˆ›å»ºæŽˆæƒä»¤ç‰Œ==ã€‚
	> 	5. ssoè®¤è¯ä¸­å¿ƒå¸¦ç€ä»¤ç‰Œè·³è½¬å›žæœ€åˆçš„è¯·æ±‚åœ°å€ï¼ˆç³»ç»Ÿ1ï¼‰
	> 	6. ==ç³»ç»Ÿ1æ‹¿åˆ°ä»¤ç‰Œ==ï¼ŒåŽ»ssoè®¤è¯ä¸­å¿ƒ==æ ¡éªŒä»¤ç‰Œæ˜¯å¦æœ‰æ•ˆ==ã€‚
	> 	7. ==ssoè®¤è¯ä¸­å¿ƒæ ¡éªŒä»¤ç‰Œï¼Œè¿”å›žæœ‰æ•ˆï¼Œæ³¨å†Œç³»ç»Ÿ1==ã€‚
	> 	8. ==ç³»ç»Ÿ1ä½¿ç”¨è¯¥ä»¤ç‰Œåˆ›å»ºä¸Žç”¨æˆ·çš„ä¼šè¯ï¼Œç§°ä¸ºå±€éƒ¨ä¼šè¯==ï¼Œè¿”å›žå—ä¿æŠ¤èµ„æºã€‚
	> 	9. ç”¨æˆ·è®¿é—®ç³»ç»Ÿ2çš„å—ä¿æŠ¤èµ„æºã€‚
	> 	10. ç³»ç»Ÿ2å‘çŽ°ç”¨æˆ·æœªç™»å½•ï¼Œè·³è½¬è‡³ssoè®¤è¯ä¸­å¿ƒï¼Œå¹¶å°†è‡ªå·±çš„åœ°å€ä½œä¸ºå‚æ•°ã€‚
	> 	11. ==ssoè®¤è¯ä¸­å¿ƒå‘çŽ°ç”¨æˆ·å·²ç™»å½•ï¼ˆå…¨å±€ä¼šè¯ï¼‰ï¼Œè·³è½¬å›žç³»ç»Ÿ2çš„åœ°å€ï¼Œå¹¶é™„ä¸Šä»¤ç‰Œ==ã€‚
	> 	12. ç³»ç»Ÿ2æ‹¿åˆ°ä»¤ç‰Œï¼ŒåŽ»ssoè®¤è¯ä¸­å¿ƒæ ¡éªŒä»¤ç‰Œæ˜¯å¦æœ‰æ•ˆã€‚
	> 	13. ssoè®¤è¯ä¸­å¿ƒæ ¡éªŒä»¤ç‰Œï¼Œè¿”å›žæœ‰æ•ˆï¼Œæ³¨å†Œç³»ç»Ÿ2ã€‚
	> 	14. ç³»ç»Ÿ2ä½¿ç”¨è¯¥ä»¤ç‰Œåˆ›å»ºä¸Žç”¨æˆ·çš„å±€éƒ¨ä¼šè¯ï¼Œè¿”å›žå—ä¿æŠ¤èµ„æºã€‚
	> - ==ç”¨æˆ·ç™»å½•æˆåŠŸä¹‹åŽï¼Œä¼šä¸Žssoè®¤è¯ä¸­å¿ƒåŠå„ä¸ªå­ç³»ç»Ÿå»ºç«‹ä¼šè¯==ã€‚
	> - ç”¨æˆ·==ä¸Žssoè®¤è¯ä¸­å¿ƒå»ºç«‹çš„ä¼šè¯ç§°ä¸ºå…¨å±€ä¼šè¯==ï¼Œç”¨æˆ·==ä¸Žå„ä¸ªå­ç³»ç»Ÿå»ºç«‹çš„ä¼šè¯ç§°ä¸ºå±€éƒ¨ä¼šè¯==ã€‚
	> - ==å±€éƒ¨ä¼šè¯å»ºç«‹ä¹‹åŽï¼Œç”¨æˆ·è®¿é—®å­ç³»ç»Ÿå—ä¿æŠ¤èµ„æºå°†ä¸å†é€šè¿‡ssoè®¤è¯ä¸­å¿ƒ==ã€‚

6. ==å•ç‚¹æ³¨é”€==

	> - å•ç‚¹ç™»å½•è‡ªç„¶ä¹Ÿè¦å•ç‚¹æ³¨é”€ï¼Œ==åœ¨ä¸€ä¸ªå­ç³»ç»Ÿä¸­æ³¨é”€ï¼Œæ‰€æœ‰å­ç³»ç»Ÿçš„ä¼šè¯éƒ½å°†è¢«é”€æ¯==ã€‚
	>
	> 	<img src="bgwROUND1.assets/797930-20161129155243068-1378377736.png" alt="3b139d2e-0b83-4a69-b4f2-316adb8997ce" style="zoom:150%;" />
	>
	> - ==è§£é‡Š==ï¼š
	>
	> 	1. ç”¨æˆ·å‘ç³»ç»Ÿ1å‘èµ·æ³¨é”€è¯·æ±‚ã€‚
	> 	2. ç³»ç»Ÿ1æ ¹æ®ç”¨æˆ·ä¸Žç³»ç»Ÿ1å»ºç«‹çš„ä¼šè¯idæ‹¿åˆ°ä»¤ç‰Œï¼Œå‘ssoè®¤è¯ä¸­å¿ƒå‘èµ·æ³¨é”€è¯·æ±‚ã€‚
	> 	3. ssoè®¤è¯ä¸­å¿ƒæ ¡éªŒä»¤ç‰Œæœ‰æ•ˆï¼Œ==é”€æ¯å…¨å±€ä¼šè¯ï¼ŒåŒæ—¶å–å‡ºæ‰€æœ‰ç”¨æ­¤ä»¤ç‰Œæ³¨å†Œçš„ç³»ç»Ÿåœ°å€==ã€‚
	> 	4. ssoè®¤è¯ä¸­å¿ƒ==å‘æ‰€æœ‰æ³¨å†Œç³»ç»Ÿå‘èµ·æ³¨é”€è¯·æ±‚==ã€‚
	> 	5. ==å„æ³¨å†Œç³»ç»ŸæŽ¥æ”¶ssoè®¤è¯ä¸­å¿ƒçš„æ³¨é”€è¯·æ±‚ï¼Œé”€æ¯å±€éƒ¨ä¼šè¯==ã€‚
	> 	6. ssoè®¤è¯ä¸­å¿ƒå¼•å¯¼ç”¨æˆ·è‡³ç™»å½•é¡µé¢ã€‚

7. ==éƒ¨ç½²å›¾==

	> - å•ç‚¹ç™»å½•æ¶‰åŠssoè®¤è¯ä¸­å¿ƒä¸Žä¼—å­ç³»ç»Ÿï¼Œå­ç³»ç»Ÿä¸Žssoè®¤è¯ä¸­å¿ƒéœ€è¦é€šä¿¡ä»¥äº¤æ¢ä»¤ç‰Œã€æ ¡éªŒä»¤ç‰ŒåŠå‘èµ·æ³¨é”€è¯·æ±‚ï¼Œå› è€Œ==å­ç³»ç»Ÿå¿…é¡»é›†æˆssoçš„å®¢æˆ·ç«¯==ï¼Œ==ssoè®¤è¯ä¸­å¿ƒåˆ™æ˜¯ssoæœåŠ¡ç«¯==ï¼Œ==æ•´ä¸ªå•ç‚¹ç™»å½•è¿‡ç¨‹å®žè´¨æ˜¯ssoå®¢æˆ·ç«¯ä¸ŽæœåŠ¡ç«¯é€šä¿¡çš„è¿‡ç¨‹==ï¼Œç”¨ä¸‹å›¾æè¿°ï¼š
	>
	> 	![image-20240507154519493](bgwROUND1.assets/image-20240507154519493.png)

8. ==å®žçŽ°==

	> - sso-server å’Œ sso-cli éœ€è¦å®žçŽ°çš„åŠŸèƒ½ï¼š
	> 	- ==sso-client==
	> 		1. ==æ‹¦æˆªå­ç³»ç»Ÿæœªç™»å½•ç”¨æˆ·è¯·æ±‚ï¼Œè·³è½¬è‡³ssoè®¤è¯ä¸­å¿ƒ==
	> 		2. ==æŽ¥æ”¶å¹¶å­˜å‚¨ssoè®¤è¯ä¸­å¿ƒå‘é€çš„ä»¤ç‰Œ==
	> 		3. ==ä¸Žsso-serveré€šä¿¡ï¼Œæ ¡éªŒä»¤ç‰Œçš„æœ‰æ•ˆæ€§==
	> 		4. ==å»ºç«‹å±€éƒ¨ä¼šè¯==
	> 		5. ==æ‹¦æˆªç”¨æˆ·æ³¨é”€è¯·æ±‚ï¼Œå‘ssoè®¤è¯ä¸­å¿ƒå‘é€æ³¨é”€è¯·æ±‚==
	> 		6. ==æŽ¥æ”¶ssoè®¤è¯ä¸­å¿ƒå‘å‡ºçš„æ³¨é”€è¯·æ±‚ï¼Œé”€æ¯å±€éƒ¨ä¼šè¯==
	> 	- ==sso-server==
	> 		1. ==éªŒè¯ç”¨æˆ·çš„ç™»å½•ä¿¡æ¯==
	> 		2. ==åˆ›å»ºå…¨å±€ä¼šè¯==
	> 		3. ==åˆ›å»ºæŽˆæƒä»¤ç‰Œ==
	> 		4. ==ä¸Žsso-clienté€šä¿¡å‘é€ä»¤ç‰Œ==
	> 		5. ==æ ¡éªŒsso-clientä»¤ç‰Œæœ‰æ•ˆæ€§==
	> 		6. ==ç³»ç»Ÿåœ°å€æ³¨å†Œ==
	> 		7. ==æŽ¥æ”¶sso-clientæ³¨é”€è¯·æ±‚ï¼Œæ³¨é”€æ‰€æœ‰ä¼šè¯==

---



### 3.Servlet çš„æ‰§è¡Œæµç¨‹ðŸŒŸðŸŒŸ

1. æµè§ˆå™¨ç»™ tomcat å‘é€è¯·æ±‚ã€‚
2. tomcat æ ¹æ®æ”¶åˆ°çš„ url ==åœ¨ web.xml ä¸­æŸ¥æ‰¾å¯¹åº”çš„ servlet==ï¼Œ==å¦‚æžœè¯¥ servlet æ˜¯ç¬¬ä¸€æ¬¡è¢«è®¿é—®ï¼Œåˆ™è¿›è¡Œå®žä¾‹åŒ–==ã€‚å¹¶å°†å…¶è¾“å‡ºç»“æžœè¿”å›žç»™æµè§ˆå™¨ã€‚

---



### 4.Servlet ç”Ÿå‘½å‘¨æœŸðŸŒŸðŸŒŸ

1. > <img src="bgwROUND1.assets/image-20240507185555463.png" alt="image-20240507185555463" style="zoom: 50%;" />

---



### 5.è¯·æ±‚è½¬å‘ä¸Žå“åº”é‡å®šå‘çš„åŒºåˆ«ðŸŒŸðŸŒŸ

1. ==è¯·æ±‚è½¬å‘==ï¼š

	> <img src="bgwROUND1.assets/image-20240507185814775.png" alt="image-20240507185814775" style="zoom:50%;" />
	>
	> - ==æœåŠ¡å™¨è·³è½¬==ã€‚
	> - ==åªæœ‰ä¸€æ¬¡è¯·æ±‚ï¼ˆrequest æ˜¯ç›¸åŒçš„ï¼‰==ã€‚

2. ==å“åº”é‡å®šå‘==ï¼š

	> <img src="bgwROUND1.assets/image-20240507185910947.png" alt="image-20240507185910947" style="zoom:50%;" />
	>
	> - ==æµè§ˆå™¨è·³è½¬ï¼Œåœ°å€æ å˜åŒ–==ã€‚
	> - ==ç¬¬ä¸€æ¬¡è¯·æ±‚è¿”å›žçš„è¯·æ±‚ï¼Œè¦æ±‚æµè§ˆå™¨é‡æ–°è®¿é—®å¦ä¸€ä¸ª url==ã€‚

---



### 6.Statement å’Œ PreparedStatement çš„åŒºåˆ«ðŸŒŸðŸŒŸ

1. PreparedStatement æ˜¯==é¢„ç¼–è¯‘çš„ SQL è¯­å¥==ï¼Œæ•ˆçŽ‡é«˜äºŽ Statementã€‚

2. PreparedStatement ==æ”¯æŒ ? æ“ä½œç¬¦==ï¼Œç›¸å¯¹äºŽ Statement æ›´åŠ çµæ´»ã€‚

3. PreparedStatement ==å¯ä»¥é˜²æ­¢ SQL æ³¨å…¥==ã€‚

4. ==PreparedStatement==ï¼š

	```sql
	select * from user where username = ?
	```

	å‡å¦‚æŸ¥è¯¢å¾ˆå¤šæ¬¡ï¼Œ==åªéœ€è¦è§£é‡Šä¸€æ¬¡ï¼Œå› ä¸º sql æ²¡æœ‰æ”¹å˜ï¼Œåªéœ€å¡«å…¥ä¸åŒå‚æ•°==ã€‚

	è€Œ ==Statement åˆ™ä¼šè§£é‡Šå¾ˆå¤šæ¬¡ï¼Œå› ä¸º sql ç›´æŽ¥æ‹¼æŽ¥è€Œæ¥ï¼Œå› æ­¤æ¯æ¬¡çš„ sql éƒ½ä¸åŒ==ã€‚

	==å°†ä¼ å…¥çš„å‚æ•°çš„ç‰¹æ®Šå­—ç¬¦è½¬ç§»é˜²æ­¢ sql æ³¨å…¥==ã€‚

---



## 3.æ¡†æž¶

### 1.Spring çš„æœ¬è´¨ç³»åˆ— (1) â€” ä¾èµ–æ³¨å…¥ðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

1. ==Spring ä¾èµ–æ³¨å…¥==

	> - ==æ­¥éª¤==ï¼š
	>
	> 	1. è§£æžxmlï¼ŒèŽ·å–å„ç§å…ƒç´ 
	> 	2. é€šè¿‡ ==Java åå°„==æŠŠå„ä¸ª bean çš„å®žä¾‹åˆ›å»ºèµ·æ¥ï¼š com.coderising.OrderProcessorï¼ŒOrderServiceImplï¼ŒEmailServiceImplã€‚
	> 	3. è¿˜æ˜¯é€šè¿‡ ==Java åå°„==è°ƒç”¨ OrderProcessor çš„ä¸¤ä¸ªæ–¹æ³•ï¼šsetOrderService(â€¦.) å’Œ setEmailService(â€¦) æŠŠorderServiceï¼ŒemailService å®žä¾‹ æ³¨å…¥è¿›åŽ»ã€‚
	>
	> - ```java
	> 	XmlAppContext ctx = new XmlAppContext("c:\\bean.xml");
	> 																																																															
	> 	OrderProcessor op = (OrderProcessor) ctx.getBean("order-processor");
	> 																																																															
	> 	op.process();
	> 	```
	>
	> - ==æ—¢ç„¶å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹å’Œè£…é…è¿‡ç¨‹éƒ½æ˜¯Springåšçš„ï¼Œ é‚£Spring åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å°±å¯ä»¥çŽ©å¾ˆå¤šæŠŠæˆäº†ï¼Œ æ¯”å¦‚å¯¹ä½ çš„ä¸šåŠ¡ç±»åšç‚¹å­—èŠ‚ç çº§åˆ«çš„å¢žå¼ºï¼Œ æžç‚¹AOPä»€ä¹ˆçš„ï¼Œ è¿™éƒ½ä¸åœ¨è¯ä¸‹äº†==ã€‚

---



### 2.Springçš„æœ¬è´¨ç³»åˆ— (2) â€” AOPðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

å®žçŽ° AOP çš„å‡ ç§æŠ€æœ¯ï¼š

(1) åœ¨ç¼–è¯‘çš„æ—¶å€™ï¼Œ æ ¹æ®AOPçš„é…ç½®ä¿¡æ¯ï¼Œæ‚„æ‚„çš„æŠŠæ—¥å¿—ï¼Œå®‰å…¨ï¼Œäº‹åŠ¡ç­‰â€œåˆ‡é¢â€ä»£ç å’Œä¸šåŠ¡ç±»ç¼–è¯‘åˆ°ä¸€èµ·åŽ»ã€‚

(2) åœ¨è¿è¡ŒæœŸï¼Œä¸šåŠ¡ç±»åŠ è½½ä»¥åŽï¼Œ é€šè¿‡JavaåŠ¨æ€ä»£ç†æŠ€æœ¯==ä¸ºä¸šåŠ¡ç±»ç”Ÿäº§ä¸€ä¸ªä»£ç†ç±»==ï¼Œ ==æŠŠâ€œåˆ‡é¢â€ä»£ç æ”¾åˆ°ä»£ç†ç±»ä¸­==ï¼Œ Java åŠ¨æ€ä»£ç†è¦æ±‚ä¸šåŠ¡ç±»==éœ€è¦å®žçŽ°æŽ¥å£==æ‰è¡Œã€‚

(3) åœ¨è¿è¡ŒæœŸï¼Œ ä¸šåŠ¡ç±»åŠ è½½ä»¥åŽï¼Œ ==åŠ¨æ€çš„ä½¿ç”¨å­—èŠ‚ç æž„å»ºä¸€ä¸ªä¸šåŠ¡ç±»çš„å­ç±»ï¼Œå°†â€œåˆ‡é¢â€é€»è¾‘åŠ å…¥åˆ°å­ç±»å½“ä¸­==åŽ»ï¼Œ==CGLIB==å°±æ˜¯è¿™ä¹ˆåšçš„ã€‚

Springé‡‡ç”¨çš„å°±æ˜¯(1) +(2) çš„æ–¹å¼ï¼Œé™äºŽç¯‡å¹…ï¼Œè¿™é‡Œä¸å†å±•å¼€å„ç§æŠ€æœ¯äº†ï¼Œ ä¸ç®¡ä½¿ç”¨å“ªä¸€ç§æ–¹å¼ï¼Œ åœ¨è¿è¡Œæ—¶ï¼Œ==çœŸæ­£å¹²æ´»çš„â€œä¸šåŠ¡ç±»â€å…¶å®žå·²ç»ä¸æ˜¯åŽŸæ¥å•çº¯çš„ä¸šåŠ¡ç±»äº†ï¼Œ å®ƒä»¬è¢«AOPäº†== ï¼

---



## 4.é¢˜ç›®ï¼ˆæœªå®Œå¾…ç»­ï¼‰

### 1.ã€Springä¸“é¢˜ã€‘

#### 1.AOP åŽŸç†

==æˆ‘çš„å›žç­”==ï¼š

1. AOP æ˜¯é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œåœ¨ ==Spring ä¸­ä½¿ç”¨åŠ¨æ€ä»£ç†==å®žçŽ°ã€‚å¦‚æžœæŸä¸€ä¸ª Bean è¢«é…ç½®ä¸ºåˆ‡é¢ï¼Œé‚£ä¹ˆ ==Spring åœ¨åˆ›å»ºå®ƒçš„æ—¶å€™ï¼Œå°±ä¼šå†åˆ›å»ºä¸€ä¸ªè¯¥ Bean çš„ä»£ç†ç±»==ï¼Œç”±ä»£ç†ç±»åœ¨è¯¥ Bean çš„åŸºç¡€ä¸Šå®žçŽ°åˆ‡é¢çš„é€»è¾‘ã€‚==æˆ‘ä»¬åœ¨è°ƒç”¨è¯¥ Bean çš„æ–¹æ³•æ—¶ï¼Œå®žé™…ä¸Šæ˜¯åœ¨è°ƒç”¨ä»£ç†ç±»å¯¹åº”çš„æ–¹æ³•==ã€‚Spring ä¸­å®žçŽ°åŠ¨æ€ä»£ç†çš„æ–¹æ³•æœ‰ Java åŽŸç”Ÿçš„ ==JDK åŠ¨æ€ä»£ç†==å’Œ ==CGLib åŠ¨æ€ä»£ç†==ã€‚
2. ==JDK åŠ¨æ€ä»£ç†==è¦æ±‚è¢«ä»£ç†çš„ Bean ==å¿…é¡»å®žçŽ°æŸä¸ªæŽ¥å£==ï¼Œç„¶åŽ==åˆ›å»ºä¸€ä¸ªå®žçŽ° InvocatorHandler çš„åŠ¨æ€ä»£ç†ç±»==ï¼Œä¹‹åŽ==è°ƒç”¨ java.reflect.Proxy.newProxyInstance æ–¹æ³•ï¼Œä¼ å…¥ç›®æ ‡ç±»çš„ç±»åŠ è½½å™¨ï¼Œæ‰€æœ‰æŽ¥å£ï¼Œä»¥åŠåˆšåˆšåˆ›å»ºçš„åŠ¨æ€ä»£ç†ç±»ï¼Œå³å¯å¾—åˆ°ä»£ç†å®žä¾‹==ã€‚è¿™ä¸ªæ“ä½œçš„åº•å±‚æ˜¯åˆ©ç”¨==åå°„èŽ·å–åˆ° Method å¹¶ invoke==ã€‚
3. ==CGLib åŠ¨æ€ä»£ç†==åˆ™ä¸éœ€è¦ç›®æ ‡ç±»å®žçŽ°æŽ¥å£ï¼Œè€Œæ˜¯==åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ªç›®æ ‡ç±»çš„å­ç±»==ï¼Œé€šè¿‡åå°„èŽ·å–ç›®æ ‡ç±»çš„æ‰€æœ‰æ–¹æ³•ï¼Œç„¶åŽåœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œ==é‡å†™==ï¼Œå®žçŽ°ä»£ç†çš„é€»è¾‘ã€‚
4. JDK åŠ¨æ€ä»£ç†ä¸éœ€è¦å¤–éƒ¨ä¾èµ–ï¼Œä½†æ˜¯ä¼šå—åˆ°ç›®æ ‡ç±»å¿…é¡»å®žçŽ°æŽ¥å£çš„é™åˆ¶ï¼›è€Œ CGLib æ²¡æœ‰æ­¤é™åˆ¶ï¼Œä½†æ˜¯å±žäºŽå¤–éƒ¨ä¾èµ–ï¼ŒåŒæ—¶ï¼Œ==ç”±äºŽå…¶éœ€è¦ç»§æ‰¿ç›®æ ‡ç±»ï¼Œå¦‚æžœç›®æ ‡ç±»è¢« final ä¿®é¥°å°±æ— æ³•ç»§æ‰¿ï¼Œå¹¶ä¸”éœ€è¦é‡å†™çš„æ–¹æ³•å¦‚æžœæ˜¯ private æˆ– finalï¼Œåˆ™ä¹Ÿæ— æ³•é‡å†™==ã€‚

==å‚è€ƒç­”æ¡ˆ==ï¼š

- Spring çš„ AOP æ˜¯ç”¨==åŠ¨æ€ä»£ç†==å®žçŽ°çš„ã€‚å¦‚æžœæˆ‘ä»¬ä¸º Spring çš„æŸä¸ª bean é…ç½®äº†åˆ‡é¢ï¼Œé‚£ä¹ˆ ==Spring åœ¨åˆ›å»ºè¿™ä¸ª Bean æ—¶ä¼šç›´æŽ¥åˆ›å»ºè¿™ä¸ª Bean çš„ä»£ç†å¯¹è±¡==ã€‚åŽç»­å¯¹ Bean æ–¹æ³•çš„è°ƒç”¨ï¼Œ==å®žé™…è°ƒç”¨çš„æ˜¯ä»£ç†ç±»é‡å†™çš„ä»£ç†æ–¹æ³•==ã€‚Spring çš„ AOP é‡‡ç”¨äº†ä¸¤ç§æ–¹æ³•å®žçŽ°åŠ¨æ€ä»£ç†ï¼Œåˆ†åˆ«æ˜¯ ==JDK åŠ¨æ€ä»£ç†==å’Œ ==CGLib åŠ¨æ€ä»£ç†==ã€‚
- å…¶ä¸­ Spring é»˜è®¤ä½¿ç”¨ JDK çš„åŠ¨æ€ä»£ç†å®žçŽ° AOPï¼Œå‰ææ¡ä»¶æ˜¯ç±»è¦==å®žçŽ°äº†æŸä¸ªå€Ÿå£==ï¼Œç„¶åŽå€ŸåŠ© reflect åŒ…ä¸‹çš„ ==Proxy ç±»å’Œ InvocationHandler æŽ¥å£æ¥åŠ¨æ€ç”Ÿæˆä»£ç†å¯¹è±¡==ã€‚å½“æˆ‘ä»¬é€šè¿‡ä»£ç†å¯¹è±¡==è°ƒç”¨æ–¹æ³•æ—¶ï¼Œåº•å±‚å°†é€šè¿‡åå°„==ï¼ŒåŽ»è°ƒç”¨æˆ‘ä»¬å®žçŽ°çš„ä»£ç†æ–¹æ³•ã€‚
- æ­£å¼ç”±äºŽ JDK çš„åŠ¨æ€ä»£ç†å­˜åœ¨ç±»å¿…é¡»å®žçŽ°æŽ¥å£çš„é™åˆ¶ï¼Œ==Spring åœ¨å…¶ä»–æƒ…å†µä¸‹ä¼šä½¿ç”¨ CGLib åŠ¨æ€ä»£ç†æ¥ä»£ç†å¯¹è±¡==ã€‚CGLib å®žçŽ°åŠ¨æ€ä»£ç†çš„åŽŸç†æ˜¯ï¼Œåº•å±‚é‡‡ç”¨äº†ASM å­—èŠ‚ç ç”Ÿæˆæ¡†æž¶ï¼Œ==ç›´æŽ¥å¯¹éœ€è¦ä»£ç†çš„ç±»çš„å­—èŠ‚ç è¿›è¡Œæ“ä½œï¼Œç”Ÿæˆè¿™ä¸ªç±»çš„ä¸€ä¸ªå­ç±»ï¼Œå¹¶é‡å†™ç±»ä¸­æ‰€æœ‰å¯ä»¥é‡å†™çš„æ–¹æ³•==ï¼Œ==åœ¨é‡å†™çš„è¿‡ç¨‹ä¸­ï¼Œå°†æˆ‘ä»¬å®šä¹‰çš„é¢å¤–çš„é€»è¾‘ç»‡å…¥åˆ°æ–¹æ³•ä¸­ï¼Œå¯¹æ–¹æ³•è¿›è¡Œå¢žå¼º==ã€‚
- ä¸¤ç§æ–¹å¼å„æœ‰ä¼˜åŠ£ï¼ŒJDK åŠ¨æ€ä»£ç†æ˜¯ JDK åŽŸç”Ÿçš„ï¼Œä¸éœ€è¦ä»»ä½•ä¾èµ–å³å¯ä½¿ç”¨ã€‚ç¼ºç‚¹æ˜¯ç›®æ ‡ç±»å¿…é¡»å®žçŽ°äº†æŸä¸ªæŽ¥å£ï¼Œæ‰èƒ½ç”¨ JDK åŠ¨æ€ä»£ç†ã€‚CGLib åŠ¨æ€ä»£ç†ä¸éœ€è¦ç›®æ ‡ç±»å¿…é¡»å®žçŽ°æŽ¥å£ï¼Œä¾µå…¥æ€§å°ã€‚ä½† CGLib æ˜¯é€šè¿‡ç»§æ‰¿çš„æ–¹å¼ï¼Œç”Ÿæˆä¸€ä¸ªç›®æ ‡ç±»çš„å­ç±»ä½œä¸ºä»£ç†ç±»ï¼Œå› æ­¤==å‡å¦‚ç›®æ ‡ç±»æ˜¯ final ç±»ä¹Ÿæ— æ³•ä½¿ç”¨ CGLib ä»£ç†==ã€‚å¹¶ä¸” CGLib å®žçŽ°ä»£ç†æ–¹æ³•çš„æ–¹å¼æ˜¯é‡å†™ç›®æ ‡ç±»çš„æ–¹æ³•ï¼Œæ‰€ä»¥==æ— æ³•å¯¹ finalï¼Œprivate æ–¹æ³•è¿›è¡Œä»£ç†==ã€‚

---



2.



# 3.Mysql

## 1.ç´¢å¼•æ¨¡å—

### 1.ä¸ºä»€ä¹ˆMySQLæ•°æ®åº“è¦ç”¨B+æ ‘å­˜å‚¨ç´¢å¼•ï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

1. ==hashtable vs B+ tree==

	> - è¿™å’Œä¸šåŠ¡åœºæ™¯æœ‰å…³ã€‚å¦‚æžœåªé€‰ä¸€ä¸ªæ•°æ®ï¼Œé‚£ç¡®å®žæ˜¯hashæ›´å¿«ã€‚ä½†æ˜¯æ•°æ®åº“ä¸­ç»å¸¸ä¼š==é€‰æ‹©å¤šæ¡==ï¼Œè¿™æ—¶å€™ç”±äºŽB+æ ‘ç´¢å¼•æœ‰åºï¼Œå¹¶ä¸”åˆæœ‰é“¾è¡¨ç›¸è¿žï¼Œå®ƒçš„æŸ¥è¯¢æ•ˆçŽ‡æ¯”hashå°±å¿«å¾ˆå¤šäº†ã€‚
	> - è€Œä¸”==æ•°æ®åº“ä¸­çš„ç´¢å¼•ä¸€èˆ¬æ˜¯åœ¨ç£ç›˜==ä¸Šï¼Œ==æ•°æ®é‡å¤§çš„æƒ…å†µå¯èƒ½æ— æ³•ä¸€æ¬¡è£…å…¥å†…å­˜==ï¼Œ==B+æ ‘çš„è®¾è®¡å¯ä»¥å…è®¸æ•°æ®åˆ†æ‰¹åŠ è½½ï¼ŒåŒæ—¶æ ‘çš„é«˜åº¦è¾ƒä½Žï¼Œæé«˜æŸ¥æ‰¾æ•ˆçŽ‡==ã€‚
	> - ==ä¼˜ç‚¹==ï¼š
	> 	1. ==å‡å°‘ç£ç›˜æ“ä½œ==ï¼šB+æ ‘éžå¶å­ä¸å­˜ Valueï¼Œåªå­˜æ”¾ keyï¼Œæ‰€ä»¥==ä¸€æ¬¡æ›´å¯ä»¥åŠ è½½æ›´å¤šèŠ‚ç‚¹ï¼Œå‡å°‘ç£ç›˜åŠ è½½åˆ°å†…å­˜çš„æ¬¡æ•°==ã€‚
	> 	2. ==èŒƒå›´æŸ¥æ‰¾æ›´å¤šä¼˜åŠ¿==ï¼šmysqlç»å¸¸æœ‰èŒƒå›´æŸ¥æ‰¾ï¼ŒB+æ ‘çš„å¶å­ç»“ç‚¹ä¹‹é—´æ˜¯ä¸€ä¸ª==åŒå‘é“¾è¡¨ï¼Œå¾ˆå¥½æ”¯æŒèŒƒå›´æŸ¥æ‰¾==ã€‚
	> 	3. ==æŸ¥æ‰¾é€Ÿåº¦å¿«==ï¼šB+æ ‘ç±»ä¼¼ä¸€ä¸ªå¤šè·¯çš„æ ‘äº†ï¼Œæ‰€ä»¥åŒæ ·èŠ‚ç‚¹ï¼Œ==æ ‘çš„é«˜åº¦æ›´ä½Žï¼ŒæŸ¥æ‰¾é€Ÿåº¦æ›´å¿«==ã€‚

---



### 2.é«˜é¢‘é¢è¯•é¢˜ï¼šä»€ä¹ˆæ˜¯Bæ ‘ï¼Ÿä¸ºå•¥æ–‡ä»¶ç´¢å¼•è¦ç”¨Bæ ‘è€Œä¸ç”¨äºŒå‰æŸ¥æ‰¾æ ‘ï¼Ÿ

1. ==ä¸ºå•¥ä¸åŒå“ˆå¸Œè¡¨==ï¼Ÿ

	> 1. å“ˆå¸Œè¡¨è™½ç„¶èƒ½å¤Ÿåœ¨ O(1) æŸ¥æ‰¾åˆ°ç›®æ ‡æ•°æ®ï¼Œä¸è¿‡å¦‚æžœæˆ‘ä»¬è¦è¿›è¡Œ==æ¨¡ç³ŠæŸ¥æ‰¾==çš„è¯ï¼Œå´==åªèƒ½éåŽ†æ‰€æœ‰æ•°æ®==ï¼Œå¹¶ä¸”å¦‚æžœå‡ºçŽ°äº†==æžç«¯æƒ…å†µï¼Œå“ˆå¸Œè¡¨å†²çªçš„å…ƒç´ å¤ªå¤š==ï¼Œä¹Ÿä¼šå¯¼è‡´çº¿æ€§æ—¶é—´çš„æŸ¥æ‰¾æ•ˆçŽ‡çš„ã€‚

2. ==ä¸ºå•¥ä¸ç”¨äºŒå‰æŸ¥æ‰¾æ ‘==ï¼Ÿ

	> 1. å¦‚æžœæ˜¯æŸ¥æ‰¾æ•ˆçŽ‡ï¼ˆå³æ¯”è¾ƒæ¬¡æ•°ï¼‰çš„è¯ï¼Œå®žé™…ä¸ŠäºŒå‰æ ‘å¯ä»¥è¯´æ˜¯æœ€å¿«çš„äº†ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬çš„==æ–‡ä»¶ç´¢å¼•æ˜¯å­˜æ”¾åœ¨ç£ç›˜==ä¸Šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸ä»…è¦è€ƒè™‘æŸ¥æ‰¾æ•ˆçŽ‡ï¼Œè¿˜è¦è€ƒè™‘==ç£ç›˜çš„å¯»å€åŠ è½½æ¬¡æ•°==å“¦ï¼Œè€Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦ç”¨ B æ ‘çš„åŽŸå› ã€‚
	>
	> 2. æŠŠç£ç›˜é‡Œçš„æ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­çš„æ—¶å€™ï¼Œæ˜¯==ä»¥é¡µä¸ºå•ä½æ¥åŠ è½½==çš„ï¼Œè€Œæˆ‘ä»¬ä¹ŸçŸ¥é“ï¼Œ==èŠ‚ç‚¹ä¸ŽèŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®æ˜¯ä¸è¿žç»­çš„==ï¼Œæ‰€ä»¥==ä¸åŒçš„èŠ‚ç‚¹ï¼Œå¾ˆæœ‰å¯èƒ½åˆ†å¸ƒåœ¨ä¸åŒçš„ç£ç›˜é¡µä¸­==ã€‚æ‰€ä»¥å¯¹äºŽä¸Šé¢çš„äºŒå‰æŸ¥æ‰¾æ ‘ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦==è¿›è¡Œ 4 æ¬¡å¯»å€åŠ è½½==ï¼Œå¦‚å›¾ï¼š
	>
	> 	![image-20240508153054423](bgwROUND1.assets/image-20240508153054423.png)
	>
	> 3. ç”±äºŽ ==B æ ‘çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¯ä»¥å­˜æ”¾å¤šä¸ªå…ƒç´ ==ï¼Œæ‰€ä»¥==ç£ç›˜å¯»å€åŠ è½½çš„æ¬¡æ•°ä¼šæ¯”è¾ƒå°‘==ï¼Œä¾‹å¦‚ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç”¨ B æ ‘çš„è¯ï¼Œ==åªéœ€è¦åŠ è½½ 3 æ¬¡==ï¼Œå¦‚å›¾ï¼š
	>
	> 	<img src="bgwROUND1.assets/image-20240508153313300.png" alt="image-20240508153313300" style="zoom:67%;" />
	>
	> 4. åœ¨==å†…å­˜çš„è¿ç®—é€Ÿåº¦æ˜¯éžå¸¸å¿«çš„ï¼Œè‡³å°‘æ¯”ç£ç›˜çš„å¯»å€åŠ è½½é€Ÿåº¦ï¼Œå¿«äº†å‡ ç™¾å€==ï¼Œè€Œæˆ‘ä»¬è¿›è¡Œæ•°å€¼æ¯”è¾ƒçš„æ—¶å€™ï¼Œæ˜¯åœ¨å†…å­˜ä¸­è¿›è¡Œçš„ï¼Œè™½ç„¶ B æ ‘çš„æ¯”è¾ƒæ¬¡æ•°å¯èƒ½æ¯”äºŒå‰æŸ¥æ‰¾æ ‘å¤šï¼Œä½†æ˜¯==ç£ç›˜æ“ä½œæ¬¡æ•°å°‘ï¼Œæ‰€ä»¥æ€»ä½“æ¥è¯´ï¼Œè¿˜æ˜¯ B æ ‘å¿«çš„å¤š==ã€‚
	>
	> 5. å®žé™…ä¸Šç£ç›˜çš„åŠ è½½æ¬¡æ•°ï¼ŒåŸºæœ¬ä¸Šæ˜¯å’Œæ ‘çš„==é«˜åº¦==ç›¸å…³è”çš„ï¼Œé«˜==åº¦è¶Šé«˜ï¼ŒåŠ è½½æ¬¡æ•°è¶Šå¤šï¼Œè¶ŠçŸ®ï¼ŒåŠ è½½æ¬¡æ•°è¶Šå°‘==ã€‚æ‰€ä»¥å¯¹äºŽè¿™ç§æ–‡ä»¶ç´¢å¼•çš„å­˜å‚¨ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šé€‰æ‹©==çŸ®èƒ–==çš„æ ‘å½¢ç»“æž„ã€‚

---



### 3.æ·±å…¥æµ…å‡ºç´¢å¼•ï¼ˆä¸Šï¼‰ðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

è§ç¬”è®°ã€‚

---



### 4.æ·±å…¥æµ…å‡ºç´¢å¼•ï¼ˆä¸‹ï¼‰ðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

è§ç¬”è®°ã€‚

---



### 5.MyISAMä¸ŽInnoDBçš„ç´¢å¼•ï¼Œç©¶ç«Ÿæœ‰ä»€ä¹ˆå·®å¼‚ï¼ŸðŸŒŸðŸŒŸ

1. ==MyISAMçš„ç´¢å¼•==

	> - ==MyISAMçš„ç´¢å¼•ä¸Žè¡Œè®°å½•æ˜¯åˆ†å¼€å­˜å‚¨==çš„ï¼Œå«åš==éžèšé›†ç´¢å¼•==ï¼ˆUnClustered Indexï¼‰ã€‚
	>
	> - ï¼ˆ1ï¼‰æœ‰è¿žç»­èšé›†çš„åŒºåŸŸå•ç‹¬å­˜å‚¨è¡Œè®°å½•ï¼›
	>
	> 	ï¼ˆ2ï¼‰ä¸»é”®ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ï¼Œå­˜å‚¨ä¸»é”®ï¼Œ==ä¸Žå¯¹åº”è¡Œè®°å½•çš„æŒ‡é’ˆ==ï¼›
	>
	> 	ï¼ˆ3ï¼‰æ™®é€šç´¢å¼•çš„å¶å­ç»“ç‚¹ï¼Œå­˜å‚¨ç´¢å¼•åˆ—ï¼Œ==ä¸Žå¯¹åº”è¡Œè®°å½•çš„æŒ‡é’ˆ==ï¼›
	>
	> - å³ï¼šä¸»é”®ç´¢å¼•å’Œæ™®é€šç´¢å¼•çš„å¶å­èŠ‚ç‚¹==å‡å­˜å‚¨å¯¹åº”é‚£ä¸€è¡Œçš„æŒ‡é’ˆ==ã€‚
	>
	> - ![å›¾ç‰‡](bgwROUND1.assets/202202242312354.jpeg)

2. ==InnoDBçš„ç´¢å¼•==

	> - InnoDBçš„==ä¸»é”®ç´¢å¼•ä¸Ž==è¡Œè®°å½•æ˜¯å­˜å‚¨åœ¨ä¸€èµ·çš„ï¼Œæ•…å«åš==èšé›†ç´¢å¼•==ï¼ˆClustered Indexï¼‰ï¼š
	>
	> 	ï¼ˆ1ï¼‰==æ²¡æœ‰å•ç‹¬åŒºåŸŸå­˜å‚¨è¡Œè®°å½•==ï¼›
	>
	> 	ï¼ˆ2ï¼‰ä¸»é”®ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ï¼Œå­˜å‚¨ä¸»é”®ï¼Œä¸Žå¯¹åº”è¡Œè®°å½•ï¼ˆè€Œä¸æ˜¯æŒ‡é’ˆï¼‰ï¼›
	>
	> 	ç”»å¤–éŸ³ï¼šå› æ­¤ï¼Œ==InnoDBçš„PKæŸ¥è¯¢æ˜¯éžå¸¸å¿«çš„==ã€‚
	>
	> - å› ä¸ºè¿™ä¸ªç‰¹æ€§ï¼Œ==InnoDBçš„è¡¨å¿…é¡»è¦æœ‰èšé›†ç´¢å¼•==ï¼š
	>
	> 	ï¼ˆ1ï¼‰å¦‚æžœè¡¨å®šä¹‰äº†PKï¼Œåˆ™PKå°±æ˜¯èšé›†ç´¢å¼•ï¼›
	>
	> 	ï¼ˆ2ï¼‰å¦‚æžœè¡¨==æ²¡æœ‰å®šä¹‰PKï¼Œåˆ™ç¬¬ä¸€ä¸ªéžç©ºuniqueåˆ—æ˜¯èšé›†ç´¢å¼•==ï¼›
	>
	> 	ï¼ˆ3ï¼‰==å¦åˆ™==ï¼ŒInnoDBä¼š==åˆ›å»ºä¸€ä¸ªéšè—çš„row-idä½œä¸ºèšé›†ç´¢å¼•==ï¼›
	>
	> - å¯ç¤ºï¼š
	>
	> 	ï¼ˆ1ï¼‰==ä¸å»ºè®®ä½¿ç”¨è¾ƒé•¿çš„åˆ—åšä¸»é”®==ï¼Œä¾‹å¦‚char(64)ï¼Œå› ä¸ºæ‰€æœ‰çš„æ™®é€šç´¢å¼•éƒ½ä¼šå­˜å‚¨ä¸»é”®ï¼Œä¼šå¯¼è‡´æ™®é€šç´¢å¼•è¿‡äºŽåºžå¤§ï¼›
	>
	> 	ï¼ˆ2ï¼‰å»ºè®®ä½¿ç”¨==è¶‹åŠ¿é€’å¢žçš„keyåšä¸»é”®==ï¼Œç”±äºŽæ•°æ®è¡Œä¸Žç´¢å¼•ä¸€ä½“ï¼Œè¿™æ ·ä¸è‡³äºŽæ’å…¥è®°å½•æ—¶ï¼Œæœ‰å¤§é‡ç´¢å¼•åˆ†è£‚ï¼Œè¡Œè®°å½•ç§»åŠ¨ï¼›
	>
	> - ![å›¾ç‰‡](bgwROUND1.assets/202202242312413.jpeg)

3. ==æ€»ç»“==ï¼š

	> ==MyISAMå’ŒInnoDBéƒ½ä½¿ç”¨B+æ ‘æ¥å®žçŽ°ç´¢å¼•==ï¼š
	>
	> ï¼ˆ1ï¼‰MyISAMçš„==ç´¢å¼•ä¸Žæ•°æ®åˆ†å¼€å­˜å‚¨==ï¼›
	>
	> ï¼ˆ2ï¼‰MyISAMçš„ç´¢å¼•==å¶å­å­˜å‚¨æŒ‡é’ˆ==ï¼Œä¸»é”®ç´¢å¼•ä¸Žæ™®é€šç´¢å¼•æ— å¤ªå¤§åŒºåˆ«ï¼›
	>
	> ï¼ˆ3ï¼‰InnoDBçš„==èšé›†ç´¢å¼•==å’Œæ•°æ®è¡Œç»Ÿä¸€å­˜å‚¨ï¼›
	>
	> ï¼ˆ4ï¼‰InnoDBçš„==èšé›†ç´¢å¼•å­˜å‚¨æ•°æ®è¡Œæœ¬èº«==ï¼Œ==æ™®é€šç´¢å¼•å­˜å‚¨ä¸»é”®==ï¼›
	>
	> ï¼ˆ5ï¼‰InnoDB==ä¸€å®šæœ‰ä¸”åªæœ‰ä¸€ä¸ªèšé›†ç´¢å¼•==ï¼›
	>
	> ï¼ˆ6ï¼‰InnoDBå»ºè®®ä½¿ç”¨è¶‹åŠ¿é€’å¢žæ•´æ•°ä½œä¸ºPKï¼Œè€Œ==ä¸å®œä½¿ç”¨è¾ƒé•¿çš„åˆ—ä½œä¸ºPK==ï¼›

---



## 2.é”

### 1.å…¨å±€é”å’Œè¡¨é”ðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

è§ç¬”è®°ã€‚

---



### 2.è¡Œé”åŠŸè¿‡ï¼šæ€Žä¹ˆå‡å°‘è¡Œé”å¯¹æ€§èƒ½çš„å½±å“ï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

è§ç¬”è®°ã€‚

---



### 3.è¡Œé”åˆ°åº•é”ä½çš„æ˜¯ä»€ä¹ˆï¼Ÿè®°å½•ï¼Ÿå­—æ®µï¼Ÿç´¢å¼•ï¼Ÿ

1.  ==InnoDBçš„è¡Œé”ï¼Œå°±æ˜¯é€šè¿‡é”ä½ç´¢å¼•æ¥å®žçŽ°çš„==ã€‚

	> ![img](bgwROUND1.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzkzNTkyNw==,size_16,color_FFFFFF,t_70#pic_center.png)

2. ==é—®é¢˜ä¸€==ï¼šä¸ºä»€ä¹ˆè¡¨é‡Œé¢==æ²¡æœ‰ç´¢å¼•çš„æ—¶å€™==ï¼Œå®žéªŒä¸€==é”ä½ä¸€è¡Œæ•°æ®ä¼šå¯¼è‡´é”è¡¨==ï¼Ÿæˆ–è€…è¯´ï¼Œ==å¦‚æžœé”ä½çš„æ˜¯ç´¢å¼•ï¼Œä¸€å¼ è¡¨æ²¡æœ‰ç´¢å¼•æ€Žä¹ˆåŠž==ï¼Ÿæ‰€ä»¥ï¼Œä¸€å¼ è¡¨æœ‰æ²¡æœ‰å¯èƒ½æ²¡æœ‰ç´¢å¼•ï¼Ÿ

	> 1. å¦‚æžœæˆ‘ä»¬å®šä¹‰äº†ä¸»é”®(PRIMARYKEY)ï¼Œé‚£ä¹ˆ InnoDB ä¼šé€‰æ‹©ä¸»é”®ä½œä¸ºèšé›†ç´¢å¼•ã€‚
	> 2. å¦‚æžœ==æ²¡æœ‰æ˜¾å¼å®šä¹‰ä¸»é”®==ï¼Œåˆ™ InnoDB ä¼šé€‰æ‹©==ç¬¬ä¸€ä¸ªä¸åŒ…å«æœ‰ NULL å€¼çš„å”¯ä¸€ç´¢å¼•ä½œä¸ºä¸»é”®ç´¢å¼•==ã€‚
	> 3. å¦‚æžœ==ä¹Ÿæ²¡æœ‰è¿™æ ·çš„å”¯ä¸€ç´¢å¼•==ï¼Œåˆ™ InnoDB ä¼šé€‰æ‹©==å†…ç½® 6 å­—èŠ‚é•¿çš„ ROWID ä½œä¸ºéšè—çš„èšé›†ç´¢å¼•==ï¼Œå®ƒä¼š==éšç€è¡Œè®°å½•çš„å†™å…¥è€Œä¸»é”®é€’å¢ž==ã€‚
	>
	> æ‰€ä»¥ï¼Œå®žéªŒä¸€ä¸ºä»€ä¹ˆé”è¡¨ï¼Œæ˜¯å› ä¸º==æŸ¥è¯¢æ—¶æ²¡æœ‰ç´¢å¼•å¯ä½¿ç”¨ï¼Œä¼šè¿›è¡Œå…¨è¡¨æ‰«æ==ï¼Œç„¶åŽ==æŠŠæ¯ä¸€ä¸ªéšè—çš„èšé›†ç´¢å¼•éƒ½é”ä½äº†==ã€‚

3. ==é—®é¢˜äºŒ==ï¼šå®žéªŒäºŒä¸ºä»€ä¹ˆ==é€šè¿‡å”¯ä¸€ç´¢å¼•ç»™æ•°æ®è¡ŒåŠ é”ï¼Œä¸»é”®ç´¢å¼•ä¹Ÿä¼šè¢«é”ä½==ï¼Ÿ

	> ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](bgwROUND1.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzkzNTkyNw==,size_16,color_FFFFFF,t_70#pic_center-17152272004022.png)

---



### 4.è¿™æ¬¡ç»ˆäºŽæ‡‚äº†ï¼ŒInnoDBçš„ä¸ƒç§é”ðŸŒŸ

1. InnoDBå…±æœ‰==ä¸ƒç§ç±»åž‹çš„é”==ï¼š

	> ï¼ˆ1ï¼‰è‡ªå¢žé”(Auto-inc Locks)ï¼›
	>
	> ï¼ˆ2ï¼‰å…±äº«/æŽ’å®ƒé”(Shared and Exclusive Locks)ï¼›
	>
	> ï¼ˆ3ï¼‰æ„å‘é”(Intention Locks)ï¼›
	>
	> ï¼ˆ4ï¼‰æ’å…¥æ„å‘é”(Insert Intention Locks)ï¼›
	>
	> ï¼ˆ5ï¼‰è®°å½•é”(Record Locks)ï¼›
	>
	> ï¼ˆ6ï¼‰é—´éš™é”(Gap Locks)ï¼›
	>
	> ï¼ˆ7ï¼‰ä¸´é”®é”(Next-key Locks)ï¼›

2. ==è‡ªå¢žé”==ï¼ˆAuto-inc Locksï¼‰

	> - è‡ªå¢žé”æ˜¯ä¸€ç§ç‰¹æ®Šçš„==è¡¨çº§åˆ«é”==ï¼ˆtable-level lockï¼‰ï¼Œ==é’ˆå¯¹äº‹åŠ¡æ’å…¥AUTO_INCREMENTç±»åž‹çš„åˆ—==ã€‚
	> - æœ€ç®€å•çš„æƒ…å†µï¼Œå¦‚æžœä¸€ä¸ªäº‹åŠ¡æ­£åœ¨å¾€è¡¨ä¸­æ’å…¥è®°å½•ï¼Œ==æ‰€æœ‰å…¶ä»–äº‹åŠ¡çš„æ’å…¥å¿…é¡»ç­‰å¾…==ï¼Œ==ä»¥ä¾¿ç¬¬ä¸€ä¸ªäº‹åŠ¡æ’å…¥çš„è¡Œï¼Œæ˜¯è¿žç»­çš„ä¸»é”®å€¼==ã€‚

3. ==å…±äº«/æŽ’å®ƒé”==(Shared and Exclusive Locks)

	> - ï¼ˆ1ï¼‰å¤šä¸ªäº‹åŠ¡å¯ä»¥æ‹¿åˆ°ä¸€æŠŠSé”ï¼Œ==è¯»è¯»å¯ä»¥å¹¶è¡Œ==ï¼›
	> - ï¼ˆ2ï¼‰è€Œåªæœ‰ä¸€ä¸ªäº‹åŠ¡å¯ä»¥æ‹¿åˆ°Xé”ï¼Œ==å†™å†™/è¯»å†™å¿…é¡»äº’æ–¥==ï¼›

4. ==æ„å‘é”(Intention Locks)==

	> - æ„å‘é”æœ‰è¿™æ ·ä¸€äº›==ç‰¹ç‚¹==ï¼š
	>
	> 	ï¼ˆ1ï¼‰é¦–å…ˆï¼Œæ„å‘é”ï¼Œæ˜¯ä¸€ä¸ª==è¡¨çº§åˆ«çš„é”==(table-level locking)ï¼›
	>
	> 	ï¼ˆ2ï¼‰æ„å‘é”åˆ†ä¸ºï¼š
	>
	> 	- ==æ„å‘å…±äº«é”==(intention shared lock, IS)ï¼Œå®ƒé¢„ç¤ºç€ï¼Œäº‹åŠ¡==æœ‰æ„å‘==å¯¹è¡¨ä¸­çš„==æŸäº›è¡ŒåŠ å…±äº«Sé”==ã€‚
	> 	- ==æ„å‘æŽ’å®ƒé”==(intention exclusive lock, IX)ï¼Œå®ƒé¢„ç¤ºç€ï¼Œäº‹åŠ¡==æœ‰æ„å‘==å¯¹è¡¨ä¸­çš„==æŸäº›è¡ŒåŠ æŽ’å®ƒXé”==ã€‚
	>
	> - ==ä¾‹å­==ï¼š
	>
	> 	- `select â€¦ lock in share mode`ï¼Œè¦è®¾ç½®==ISé”==ï¼›
	> 	- `select â€¦ for update`ï¼Œè¦è®¾ç½®==IXé”==ï¼›
	>
	> - ==æ„å‘é”åè®®== (intention locking protocol)ï¼š
	>
	> 	- äº‹åŠ¡è¦èŽ·å¾—æŸäº›è¡Œçš„Sé”ï¼Œ==å¿…é¡»å…ˆèŽ·å¾—è¡¨çš„ISé”==ã€‚
	> 	- äº‹åŠ¡è¦èŽ·å¾—æŸäº›è¡Œçš„Xé”ï¼Œ==å¿…é¡»å…ˆèŽ·å¾—è¡¨çš„IXé”==ã€‚
	>
	> - ![å›¾ç‰‡](bgwROUND1.assets/202202242307055.png)
	>
	> - ![å›¾ç‰‡](bgwROUND1.assets/202202242307604.png)

5. ==æ’å…¥æ„å‘é”(Insert Intention Locks)==

	> - ==å¤šä¸ªäº‹åŠ¡==ï¼Œåœ¨==åŒä¸€ä¸ªç´¢å¼•ï¼ŒåŒä¸€ä¸ªèŒƒå›´åŒºé—´æ’å…¥è®°å½•==æ—¶ï¼Œå¦‚æžœ==æ’å…¥çš„ä½ç½®ä¸å†²çªï¼Œä¸ä¼šé˜»å¡žå½¼æ­¤==ã€‚
	>
	> - *10, shenjian*
	>
	> 	*20, zhangsan*
	>
	> 	*30, lisi*
	>
	> 	äº‹åŠ¡Aå…ˆæ‰§è¡Œï¼Œåœ¨10ä¸Ž20ä¸¤æ¡è®°å½•ä¸­æ’å…¥äº†ä¸€è¡Œï¼Œè¿˜æœªæäº¤ï¼š
	>
	> 	```sql
	> 	insert into t values(11, xxx);
	> 	```
	>
	> 	äº‹åŠ¡BåŽæ‰§è¡Œï¼Œä¹Ÿåœ¨10ä¸Ž20ä¸¤æ¡è®°å½•ä¸­æ’å…¥äº†ä¸€è¡Œï¼š
	>
	> 	```sql
	> 	insert into t values(12, ooo);
	> 	```
	>
	> 	ï¼ˆ1ï¼‰ä¼šä½¿ç”¨ä»€ä¹ˆé”ï¼Ÿ
	>
	> 	ï¼ˆ2ï¼‰äº‹åŠ¡Bä¼šä¸ä¼šè¢«é˜»å¡žå‘¢ï¼Ÿ
	>
	> 	==å›žç­”==ï¼šè™½ç„¶äº‹åŠ¡éš”ç¦»çº§åˆ«æ˜¯RRï¼Œè™½ç„¶æ˜¯åŒä¸€ä¸ªç´¢å¼•ï¼Œè™½ç„¶æ˜¯åŒä¸€ä¸ªåŒºé—´ï¼Œä½†==æ’å…¥çš„è®°å½•å¹¶ä¸å†²çª==ï¼Œæ•…è¿™é‡Œï¼š
	>
	> 	ï¼ˆ1ï¼‰ä½¿ç”¨çš„æ˜¯==æ’å…¥æ„å‘é”==ï¼›
	>
	> 	ï¼ˆ2ï¼‰å¹¶==ä¸ä¼šé˜»å¡žäº‹åŠ¡B==ï¼›

6. ==è®°å½•é”(Record Locks)==

	> - ==è®°å½•é”==ï¼Œå®ƒ==å°é”ç´¢å¼•è®°å½•==ï¼Œä¾‹å¦‚ï¼š
	>
	> 	```sql
	> 	select * from t where id=1 for update;
	> 	```
	>
	> 	å®ƒä¼šåœ¨ id=1 çš„==ç´¢å¼•è®°å½•ä¸ŠåŠ é”==ï¼Œä»¥é˜»æ­¢å…¶ä»–äº‹åŠ¡æ’å…¥ï¼Œæ›´æ–°ï¼Œåˆ é™¤id=1çš„è¿™ä¸€è¡Œã€‚
	>
	> 	==éœ€è¦è¯´æ˜Žçš„æ˜¯==ï¼š
	>
	> 	```sql
	> 	select * from t where id=1;
	> 	```
	>
	> 	æ˜¯==å¿«ç…§è¯»==(SnapShot Read)ï¼Œå®ƒ==å¹¶æ²¡æœ‰åŠ é”==ã€‚

7. ==é—´éš™é”(Gap Locks)==

	> - ==é—´éš™é”==ï¼Œå®ƒ==å°é”ç´¢å¼•è®°å½•ä¸­çš„é—´éš”==ï¼Œæˆ–è€…ç¬¬ä¸€æ¡ç´¢å¼•è®°å½•ä¹‹å‰çš„èŒƒå›´ï¼Œåˆæˆ–è€…æœ€åŽä¸€æ¡ç´¢å¼•è®°å½•ä¹‹åŽçš„èŒƒå›´ã€‚
	>
	> 	*1, shenjian, m, A*
	>
	> 	*3, zhangsan, m, A*
	>
	> 	*5, lisi, m, A*
	>
	> 	*9, wangwu, f, B*
	>
	> 	```sql
	> 	select * from t where id between 8 and 15 for update;
	> 	```
	>
	> 	ä¼š==å°é”åŒºé—´==ï¼Œä»¥==é˜»æ­¢å…¶ä»–äº‹åŠ¡id=10çš„è®°å½•æ’å…¥==ã€‚
	>
	> 	==ä¸ºä»€ä¹ˆè¦é˜»æ­¢id=10çš„è®°å½•æ’å…¥ï¼Ÿå¦‚æžœèƒ½å¤Ÿæ’å…¥æˆåŠŸï¼Œå¤´ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œç›¸åŒçš„SQLè¯­å¥ï¼Œä¼šå‘çŽ°ç»“æžœé›†å¤šå‡ºäº†ä¸€æ¡è®°å½•ï¼Œå³å¹»å½±æ•°æ®==ã€‚
	>
	> 	é—´éš™é”çš„==ä¸»è¦ç›®çš„==ï¼Œå°±æ˜¯ä¸ºäº†==é˜²æ­¢å…¶ä»–äº‹åŠ¡åœ¨é—´éš”ä¸­æ’å…¥æ•°æ®ï¼Œä»¥å¯¼è‡´â€œä¸å¯é‡å¤è¯»â€==ã€‚
	>
	> 	å¦‚æžœæŠŠäº‹åŠ¡çš„éš”ç¦»çº§åˆ«==é™çº§ä¸ºè¯»æäº¤==(Read Committed, RC)ï¼Œ==é—´éš™é”åˆ™ä¼šè‡ªåŠ¨å¤±æ•ˆ==ã€‚

8. ==ä¸´é”®é”(Next-Key Locks)==

	> - ==ä¸´é”®é”==ï¼Œæ˜¯è®°å½•é”ä¸Žé—´éš™é”çš„ç»„åˆï¼Œå®ƒçš„å°é”èŒƒå›´ï¼Œæ—¢åŒ…å«ç´¢å¼•è®°å½•ï¼ŒåˆåŒ…å«ç´¢å¼•åŒºé—´ã€‚
	>
	> - ä¸€ä¸ªä¼šè¯å æœ‰äº†==ç´¢å¼•è®°å½•Rçš„å…±äº«/æŽ’ä»–é”==ï¼Œå…¶ä»–ä¼šè¯==ä¸èƒ½==ç«‹åˆ»åœ¨==Rä¹‹å‰çš„åŒºé—´æ’å…¥æ–°çš„ç´¢å¼•è®°å½•==ã€‚
	>
	> - è¡¨ä¸­æœ‰å››æ¡è®°å½•ï¼š
	>
	> 	*1, shenjian, m, A*
	>
	> 	*3, zhangsan, m, A*
	>
	> 	*5, lisi, m, A*
	>
	> 	*9, wangwu, f, B*
	>
	> 	PKä¸Š==æ½œåœ¨çš„ä¸´é”®é”ä¸º==ï¼š
	>
	> 	*(-infinity, 1]*
	>
	> 	*(1, 3]*
	>
	> 	*(3, 5]*
	>
	> 	*(5, 9]*
	>
	> 	*(9, +infinity)*
	>
	> 	ä¸´é”®é”çš„ä¸»è¦ç›®çš„ï¼Œä¹Ÿæ˜¯ä¸ºäº†==é¿å…å¹»è¯»==(Phantom Read)ã€‚å¦‚æžœæŠŠäº‹åŠ¡çš„éš”ç¦»çº§åˆ«==é™çº§ä¸ºRC==ï¼Œ==ä¸´é”®é”åˆ™ä¹Ÿä¼šå¤±æ•ˆ==ã€‚

9. ==æ€»ç»“==ï¼š

	> ï¼ˆ1ï¼‰==è‡ªå¢žé”==(Auto-inc Locks)ï¼š==è¡¨çº§é”ï¼Œä¸“é—¨é’ˆå¯¹äº‹åŠ¡æ’å…¥AUTO_INCçš„åˆ—==ï¼Œå¦‚æžœæ’å…¥ä½ç½®å†²çªï¼Œå¤šä¸ªäº‹åŠ¡ä¼šé˜»å¡žï¼Œä»¥ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼›
	>
	> ï¼ˆ2ï¼‰==å…±äº«/æŽ’å®ƒé”==(Shared and Exclusive Locks)ï¼š==è¡Œçº§é”==ï¼ŒSé”ä¸ŽXé”ï¼Œ==å¼ºé”==ï¼›
	>
	> ï¼ˆ3ï¼‰==æ„å‘é”==(Intention Locks)ï¼š==è¡¨çº§é”==ï¼ŒISé”ä¸ŽIXé”ï¼Œ==å¼±é”==ï¼Œä»…==ä»…è¡¨æ˜Žæ„å‘==ï¼›
	>
	> ï¼ˆ4ï¼‰==æ’å…¥æ„å‘é”==(Insert Intention Locks)ï¼š==é’ˆå¯¹insert==çš„ï¼Œå¦‚æžœ==æ’å…¥ä½ç½®ä¸å†²çªï¼Œå¤šä¸ªäº‹åŠ¡ä¸ä¼šé˜»å¡ž==ï¼Œä»¥æé«˜æ’å…¥å¹¶å‘ï¼›
	>
	> ï¼ˆ5ï¼‰==è®°å½•é”==(Record Locks)ï¼š==ç´¢å¼•è®°å½•ä¸ŠåŠ é”==ï¼Œå¯¹ç´¢å¼•è®°å½•å®žæ–½äº’æ–¥ï¼Œä»¥ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼›
	>
	> ï¼ˆ6ï¼‰==é—´éš™é”==(Gap Locks)ï¼š==å°é”ç´¢å¼•è®°å½•ä¸­é—´çš„é—´éš”==ï¼Œåœ¨RRä¸‹æœ‰æ•ˆï¼Œé˜²æ­¢é—´éš”ä¸­è¢«å…¶ä»–äº‹åŠ¡æ’å…¥ï¼›
	>
	> ï¼ˆ7ï¼‰==ä¸´é”®é”==(Next-key Locks)ï¼š==å°é”ç´¢å¼•è®°å½•ï¼Œä»¥åŠç´¢å¼•è®°å½•ä¸­é—´çš„é—´éš”==ï¼Œåœ¨RRä¸‹æœ‰æ•ˆï¼Œ==é˜²æ­¢å¹»è¯»==ï¼›

---



### 5.ä¸€æ¡sqlæ‰§è¡Œçš„å¾ˆæ…¢çš„åŽŸå› æœ‰å“ªäº›ðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

1. ==æ•°æ®åº“åœ¨åˆ·æ–°è„é¡µæˆ‘ä¹Ÿæ— å¥ˆå•Šï¼ˆå¶å°”å¾ˆæ…¢ï¼‰==

	> - å¦‚æžœ==æ•°æ®åº“ä¸€ç›´å¾ˆå¿™ï¼Œæ›´æ–°åˆå¾ˆé¢‘ç¹==ï¼Œè¿™ä¸ªæ—¶å€™ ==redo log å¾ˆå¿«å°±ä¼šè¢«å†™æ»¡äº†==ï¼Œè¿™ä¸ªæ—¶å€™å°±æ²¡åŠžæ³•ç­‰åˆ°ç©ºé—²çš„æ—¶å€™å†æŠŠæ•°æ®åŒæ­¥åˆ°ç£ç›˜çš„ï¼Œ==åªèƒ½æš‚åœå…¶ä»–æ“ä½œï¼Œå…¨èº«å¿ƒæ¥æŠŠæ•°æ®åŒæ­¥åˆ°ç£ç›˜ä¸­åŽ»çš„==ï¼Œè€Œè¿™ä¸ªæ—¶å€™ï¼Œ==å°±ä¼šå¯¼è‡´æˆ‘ä»¬å¹³æ—¶æ­£å¸¸çš„SQLè¯­å¥çªç„¶æ‰§è¡Œçš„å¾ˆæ…¢==ï¼Œæ‰€ä»¥è¯´ï¼Œæ•°æ®åº“åœ¨åœ¨åŒæ­¥æ•°æ®åˆ°ç£ç›˜çš„æ—¶å€™ï¼Œå°±æœ‰å¯èƒ½å¯¼è‡´æˆ‘ä»¬çš„SQLè¯­å¥æ‰§è¡Œçš„å¾ˆæ…¢äº†ã€‚

2. ==æ‹¿ä¸åˆ°é”æˆ‘èƒ½æ€Žä¹ˆåŠžï¼ˆå¶å°”å¾ˆæ…¢ï¼‰==

	> - å¦‚æžœè¦åˆ¤æ–­æ˜¯å¦çœŸçš„åœ¨ç­‰å¾…é”ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ ==show processlist ==è¿™ä¸ªå‘½ä»¤æ¥æŸ¥çœ‹å½“å‰çš„çŠ¶æ€å“¦ã€‚

3. ==æ‰Žå¿ƒäº†ï¼Œæ²¡ç”¨åˆ°ç´¢å¼•ï¼ˆä¸€ç›´å¾ˆæ…¢ï¼Œä¸€èˆ¬éƒ½æ˜¯ sql è¯­å¥çš„é—®é¢˜ï¼‰==

	> - ==å‡½æ•°æ“ä½œå¯¼è‡´æ²¡æœ‰ç”¨ä¸Šç´¢å¼•==ã€‚
	> - æˆ–è€… `select * from t where c - 1 = 1000;`ï¼Œä½¿ç”¨åŠ æ³•å‡½æ•°.

4. ==å‘µå‘µï¼Œæ•°æ®åº“è‡ªå·±é€‰é”™ç´¢å¼•äº†ï¼ˆä¸€ç›´å¾ˆæ…¢ï¼‰==

	> - ==ç³»ç»Ÿæ˜¯æœ‰å¯èƒ½èµ°å…¨è¡¨æ‰«æè€Œä¸èµ°ç´¢å¼•çš„ã€‚é‚£ç³»ç»Ÿæ˜¯æ€Žä¹ˆåˆ¤æ–­å‘¢ï¼Ÿ==
	> 	- åˆ¤æ–­æ¥æºäºŽ==ç³»ç»Ÿçš„é¢„æµ‹==ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æžœè¦èµ° c å­—æ®µç´¢å¼•çš„è¯ï¼Œç³»==ç»Ÿä¼šé¢„æµ‹èµ° c å­—æ®µç´¢å¼•å¤§æ¦‚éœ€è¦æ‰«æå¤šå°‘è¡Œ==ã€‚å¦‚æžœé¢„æµ‹åˆ°è¦æ‰«æçš„è¡Œæ•°å¾ˆå¤šï¼Œå®ƒå¯èƒ½å°±ä¸èµ°ç´¢å¼•è€Œç›´æŽ¥æ‰«æå…¨è¡¨äº†ã€‚
	> - ==ç³»ç»Ÿæ˜¯æ€Žä¹ˆé¢„æµ‹åˆ¤æ–­çš„å‘¢ï¼Ÿ==
	> 	- ==ç´¢å¼•çš„åŒºåˆ†åº¦==æ¥åˆ¤æ–­çš„ï¼Œä¸€ä¸ª==ç´¢å¼•ä¸Šä¸åŒçš„å€¼è¶Šå¤šï¼Œæ„å‘³ç€å‡ºçŽ°ç›¸åŒæ•°å€¼çš„ç´¢å¼•è¶Šå°‘==ï¼Œæ„å‘³ç€ç´¢å¼•çš„åŒºåˆ†åº¦è¶Šé«˜ã€‚æˆ‘ä»¬ä¹ŸæŠŠåŒºåˆ†åº¦ç§°ä¹‹ä¸º==åŸºæ•°==ã€‚
	> 	- ç³»ç»Ÿé€šè¿‡==é‡‡æ ·==çš„æ–¹å¼ï¼Œæ¥==é¢„æµ‹ç´¢å¼•çš„åŸºæ•°==çš„ã€‚
	> 	- ==é‡‡æ ·çš„æ—¶å€™ï¼Œå´å¾ˆä¸å¹¸ï¼ŒæŠŠè¿™ä¸ªç´¢å¼•çš„åŸºæ•°é¢„æµ‹æˆå¾ˆå°==ã€‚ä¾‹å¦‚ä½ é‡‡æ ·çš„é‚£ä¸€éƒ¨åˆ†æ•°æ®åˆšå¥½åŸºæ•°å¾ˆå°ï¼Œç„¶åŽå°±è¯¯ä»¥ä¸ºç´¢å¼•çš„åŸºæ•°å¾ˆå°ã€‚==ç„¶åŽç³»ç»Ÿå°±ä¸èµ° c ç´¢å¼•äº†ï¼Œç›´æŽ¥èµ°å…¨éƒ¨æ‰«æäº†==ã€‚
	> - ç³»ç»Ÿåˆ¤æ–­æ˜¯å¦èµ°ç´¢å¼•ï¼Œ==æ‰«æè¡Œæ•°çš„é¢„æµ‹å…¶å®žåªæ˜¯åŽŸå› ä¹‹ä¸€==ï¼Œè¿™æ¡æŸ¥è¯¢è¯­å¥==æ˜¯å¦éœ€è¦ä½¿ç”¨ä½¿ç”¨ä¸´æ—¶è¡¨ã€æ˜¯å¦éœ€è¦æŽ’åº==ç­‰ä¹Ÿæ˜¯ä¼šå½±å“ç³»ç»Ÿçš„é€‰æ‹©çš„ã€‚

5. æˆ‘ä»¬æœ‰æ—¶å€™ä¹Ÿå¯ä»¥é€šè¿‡==å¼ºåˆ¶èµ°ç´¢å¼•çš„æ–¹å¼æ¥æŸ¥è¯¢==ï¼Œä¾‹å¦‚

	```sql
	select * from t force index(a) where c < 100 and c < 100000;
	```

	æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡

	```sql
	show index from t;
	```

	æ¥==æŸ¥è¯¢ç´¢å¼•çš„åŸºæ•°å’Œå®žé™…æ˜¯å¦ç¬¦åˆ==ï¼Œå¦‚æžœå’Œå®žé™…å¾ˆä¸ç¬¦åˆçš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥==é‡æ–°æ¥ç»Ÿè®¡ç´¢å¼•çš„åŸºæ•°==ï¼Œå¯ä»¥ç”¨è¿™æ¡å‘½ä»¤

	```sql
	analyze table t;
	```

	æ¥==é‡æ–°ç»Ÿè®¡åˆ†æž==ã€‚

6. ==æ—¢ç„¶ä¼šé¢„æµ‹é”™ç´¢å¼•çš„åŸºæ•°ï¼Œè¿™ä¹Ÿæ„å‘³ç€ï¼Œå½“æˆ‘ä»¬çš„æŸ¥è¯¢è¯­å¥æœ‰å¤šä¸ªç´¢å¼•çš„æ—¶å€™ï¼Œç³»ç»Ÿæœ‰å¯èƒ½ä¹Ÿä¼šé€‰é”™ç´¢å¼•å“¦==ï¼Œè¿™ä¹Ÿå¯èƒ½æ˜¯ SQL æ‰§è¡Œçš„å¾ˆæ…¢çš„ä¸€ä¸ªåŽŸå› ã€‚

7. ==æ€»ç»“==ï¼š

	> 1ã€å¤§å¤šæ•°æƒ…å†µä¸‹å¾ˆæ­£å¸¸ï¼Œ==å¶å°”å¾ˆæ…¢==ï¼Œåˆ™æœ‰å¦‚ä¸‹åŽŸå› 
	>
	> (1) æ•°æ®åº“åœ¨åˆ·æ–°è„é¡µï¼Œä¾‹å¦‚ ==redo log å†™æ»¡äº†éœ€è¦åŒæ­¥åˆ°ç£ç›˜==ã€‚
	>
	> (2) æ‰§è¡Œçš„æ—¶å€™ï¼Œ==é‡åˆ°é”==ï¼Œå¦‚è¡¨é”ã€è¡Œé”ã€‚
	>
	> 2ã€è¿™æ¡ SQL è¯­å¥==ä¸€ç›´æ‰§è¡Œ==çš„å¾ˆæ…¢ï¼Œåˆ™æœ‰å¦‚ä¸‹åŽŸå› ã€‚
	>
	> (1) ==æ²¡æœ‰ç”¨ä¸Šç´¢å¼•==ï¼šä¾‹å¦‚è¯¥å­—æ®µæ²¡æœ‰ç´¢å¼•ï¼›ç”±äºŽå¯¹å­—æ®µè¿›è¡Œè¿ç®—ã€å‡½æ•°æ“ä½œå¯¼è‡´æ— æ³•ç”¨ç´¢å¼•ã€‚
	>
	> (2) æ•°æ®åº“==é€‰é”™äº†ç´¢å¼•==ã€‚

---



### 6.ä¸ºä»€ä¹ˆæˆ‘åªæ”¹ä¸€è¡Œçš„è¯­å¥ï¼Œé”è¿™ä¹ˆå¤šï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

è§ç¬”è®°ã€‚

---



### 7.å¹»è¯»æ˜¯ä»€ä¹ˆï¼Œå¹»è¯»æœ‰ä»€ä¹ˆé—®é¢˜ï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

è§ç¬”è®°ã€‚

---



## 3.æ—¥å¿—ä¸Žäº‹åŠ¡

### 1.æ—¥å¿—ï¼šä¸€æ¡SQLæ›´æ–°è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

è§ç¬”è®°ã€‚

---



### 2.äº‹åŠ¡éš”ç¦»ï¼šä¸ºä»€ä¹ˆä½ æ”¹äº†æˆ‘è¿˜çœ‹ä¸è§ï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

è§ç¬”è®°ã€‚

---



## 4.å…¶ä»–

### 1.å¦‚ä½•ç”¨ explain æ¥åˆ†æž sql çš„æ€§èƒ½ðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

1. æœ€ä¸ºå¸¸è§çš„æ‰«ææ–¹å¼ï¼ˆ==type==ï¼‰æœ‰ï¼š

	> - ==system==ï¼šç³»ç»Ÿè¡¨ï¼Œå°‘é‡æ•°æ®ï¼Œå¾€å¾€ä¸éœ€è¦è¿›è¡Œç£ç›˜IOï¼›
	> - ==const==ï¼šå¸¸é‡è¿žæŽ¥ï¼›
	> - ==eq_ref==ï¼šä¸»é”®ç´¢å¼•(primary key)æˆ–è€…éžç©ºå”¯ä¸€ç´¢å¼•(unique not null)ç­‰å€¼æ‰«æï¼›
	> - ==ref==ï¼šéžä¸»é”®éžå”¯ä¸€ç´¢å¼•ç­‰å€¼æ‰«æï¼›
	> - ==range==ï¼šèŒƒå›´æ‰«æï¼›
	> - ==index==ï¼šç´¢å¼•æ ‘æ‰«æï¼›
	> - ==ALL==ï¼šå…¨è¡¨æ‰«æ(full table scan)ï¼›

2. ä¸Šé¢å„ç±»æ‰«ææ–¹å¼==ç”±å¿«åˆ°æ…¢==ï¼š

	```java
	system > const > eq_ref > ref > range > index > ALL
	```

3. ==system==

	> - ![å›¾ç‰‡](bgwROUND1.assets/202202242323281.png)
	>
	> 	```sql
	> 	explain select * from mysql.time_zone;
	> 	```
	>
	> 	ä¸Šä¾‹ä¸­ï¼Œä»Žç³»ç»Ÿåº“mysqlçš„ç³»ç»Ÿè¡¨time_zoneé‡ŒæŸ¥è¯¢æ•°æ®ï¼Œæ‰«ç ç±»åž‹ä¸ºsystemï¼Œ==è¿™äº›æ•°æ®å·²ç»åŠ è½½åˆ°å†…å­˜é‡Œï¼Œä¸éœ€è¦è¿›è¡Œç£ç›˜IO==ã€‚å› æ­¤è¿™ç±»æ‰«ææ˜¯é€Ÿåº¦æœ€å¿«çš„ã€‚
	>
	> - ![å›¾ç‰‡](bgwROUND1.assets/202202242323215.jpeg)
	>
	> 	```sql
	> 	explain select * from (select * from user where id=1) tmp;
	> 	```
	>
	> 	å†ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œ==å†…å±‚åµŒå¥—(const)è¿”å›žäº†ä¸€ä¸ªä¸´æ—¶è¡¨==ï¼Œ==å¤–å±‚åµŒå¥—ä»Žä¸´æ—¶è¡¨æŸ¥è¯¢ï¼Œå…¶æ‰«æç±»åž‹ä¹Ÿæ˜¯system==ï¼Œä¹Ÿä¸éœ€è¦èµ°ç£ç›˜IOï¼Œé€Ÿåº¦è¶…å¿«ã€‚

4. ==const==

	> - constæ‰«æçš„æ¡ä»¶ä¸ºï¼š
	>
	> 	ï¼ˆ1ï¼‰å‘½ä¸­==ä¸»é”®(primary key)==æˆ–è€…==å”¯ä¸€ç´¢å¼•(unique)==ï¼›
	>
	> 	ï¼ˆ2ï¼‰è¢«==è¿žæŽ¥çš„éƒ¨åˆ†æ˜¯ä¸€ä¸ªå¸¸é‡(const)å€¼ï¼ˆå³è¾¹çš„å€¼ä¸ºå¸¸é‡ï¼‰==ï¼›
	>
	> 	```sql
	> 	explain select * from user where id=1;
	> 	```
	>
	> 	å¦‚ä¸Šä¾‹ï¼Œidæ˜¯PKï¼Œè¿žæŽ¥éƒ¨åˆ†æ˜¯å¸¸é‡1ã€‚
	>
	> - ==ç”»å¤–éŸ³ï¼šåˆ«æžä»€ä¹ˆç±»åž‹è½¬æ¢çš„å¹ºè›¾å­ã€‚==
	>
	> 	è¿™ç±»æ‰«ææ•ˆçŽ‡æžé«˜ï¼Œè¿”å›žæ•°æ®é‡å°‘ï¼Œé€Ÿåº¦éžå¸¸å¿«ã€‚

5. ==eq_ref==

	> - eq_refæ‰«æçš„æ¡ä»¶ä¸ºï¼Œå¯¹äºŽ==å‰è¡¨çš„æ¯ä¸€è¡Œ(row)==ï¼Œ==åŽè¡¨åªæœ‰ä¸€è¡Œè¢«æ‰«æ==ã€‚
	>
	> 	å†ç»†åŒ–ä¸€ç‚¹ï¼š
	>
	> 	ï¼ˆ1ï¼‰==joinæŸ¥è¯¢==ï¼›
	>
	> 	ï¼ˆ2ï¼‰å‘½ä¸­==ä¸»é”®(primary key)==æˆ–è€…éžç©º==å”¯ä¸€(unique not null)ç´¢å¼•==ï¼›
	>
	> 	ï¼ˆ3ï¼‰==ç­‰å€¼è¿žæŽ¥==ï¼› 
	>
	> - 	```sql
	> 	explain select * from user,user_ex where user.id = user_ex.id;
	> 	```
	>
	> 	å¦‚ä¸Šä¾‹ï¼Œ==user.id å’Œ user_ex.id éƒ½æ˜¯ä¸»é”®==ï¼Œè¯¥ join æŸ¥è¯¢ä¸º eq_ref æ‰«æã€‚
	>
	> 	è¿™ç±»æ‰«æçš„é€Ÿåº¦ä¹Ÿå¼‚å¸¸ä¹‹å¿«ã€‚
	
6. ==ref==

      > - å¦‚æžœæŠŠä¸Šä¾‹eq_refæ¡ˆä¾‹ä¸­çš„==ä¸»é”®ç´¢å¼•ï¼Œæ”¹ä¸ºæ™®é€šéžå”¯ä¸€(non unique)ç´¢å¼•==ã€‚
      >
      > 	```sql
      > 	explain select * from user,user_ex where user.id=user_ex.id;
      > 	```
      >
      > 	å°±==ç”± eq_ref é™çº§ä¸ºäº† ref==ï¼Œæ­¤æ—¶å¯¹äºŽå‰è¡¨çš„æ¯ä¸€è¡Œ(row)ï¼ŒåŽè¡¨å¯èƒ½æœ‰å¤šäºŽä¸€è¡Œçš„æ•°æ®è¢«æ‰«æã€‚
      >
      > - å½“id==æ”¹ä¸ºæ™®é€šéžå”¯ä¸€ç´¢å¼•åŽ==ï¼Œå¸¸é‡çš„è¿žæŽ¥æŸ¥è¯¢ï¼Œä¹Ÿç”±==consté™çº§ä¸ºäº†ref==ï¼Œå› ä¸ºä¹Ÿ==å¯èƒ½æœ‰å¤šäºŽä¸€è¡Œçš„æ•°æ®è¢«æ‰«æ==ã€‚
      >
      > - refæ‰«æï¼Œå¯èƒ½å‡ºçŽ°åœ¨joiné‡Œï¼Œä¹Ÿå¯èƒ½å‡ºçŽ°åœ¨==å•è¡¨æ™®é€šç´¢å¼•==é‡Œï¼Œ==æ¯ä¸€æ¬¡åŒ¹é…å¯èƒ½æœ‰å¤šè¡Œæ•°æ®è¿”å›ž==ï¼Œè™½ç„¶å®ƒæ¯”eq_refè¦æ…¢ï¼Œä½†å®ƒä»ç„¶æ˜¯ä¸€ä¸ªå¾ˆå¿«çš„joinç±»åž‹ã€‚

7. ==range==

      > - åƒä¸Šä¾‹ä¸­çš„ ==betweenï¼Œinï¼Œ>== éƒ½æ˜¯å…¸åž‹çš„èŒƒå›´(range)æŸ¥è¯¢ã€‚
      >
      > 	==ç”»å¤–éŸ³ï¼šå¿…é¡»æ˜¯ç´¢å¼•ï¼Œå¦åˆ™ä¸èƒ½æ‰¹é‡â€è·³è¿‡â€ã€‚==

8. ==index==

    > - å¦‚æžœidä¸Šä¸å»ºç´¢å¼•ï¼Œå¯¹äºŽå‰è¡¨çš„æ¯ä¸€è¡Œ(row)ï¼ŒåŽè¡¨éƒ½è¦è¢«å…¨è¡¨æ‰«æã€‚

9. ==æ€»ç»“==ï¼š

      > - ==system==æœ€å¿«ï¼š==ä¸è¿›è¡Œç£ç›˜IO==
      > - ==const==ï¼š==PKæˆ–è€…unique==ä¸Šçš„==ç­‰å€¼æŸ¥è¯¢ï¼ˆå³ä¾§æ˜¯å¸¸é‡ï¼‰==
      > - ==eq_ref==ï¼š==PKæˆ–è€…unique==ä¸Šçš„==joinæŸ¥è¯¢==ï¼Œ==ç­‰å€¼åŒ¹é…ï¼ˆå¤šè¡¨è”ç«‹ï¼‰==ï¼Œå¯¹äºŽå‰è¡¨çš„æ¯ä¸€è¡Œ(row)ï¼ŒåŽè¡¨åªæœ‰ä¸€è¡Œå‘½ä¸­
      > - ==ref==ï¼š==éžå”¯ä¸€ç´¢å¼•ï¼Œç­‰å€¼åŒ¹é…==ï¼Œå¯èƒ½æœ‰å¤šè¡Œå‘½ä¸­
      > - ==range==ï¼šç´¢å¼•ä¸Šçš„==èŒƒå›´æ‰«æ==ï¼Œä¾‹å¦‚ï¼š==between/in/>==
      > - ==index==ï¼šç´¢å¼•ä¸Šçš„==å…¨é›†æ‰«æ==ï¼Œä¾‹å¦‚ï¼šInnoDBçš„==count==
      > - ==ALL==æœ€æ…¢ï¼šå…¨è¡¨æ‰«æ(full table scan)

---



### 2.åˆ†æž sql åˆä¸€å…³é”®å­—æ®µï¼šExtraðŸŒŸðŸŒŸ

1. ```sql
	create table user (
	    id int primary key,
	    name varchar(20),
	    sex varchar(5),
	    index(name)
	) engine=innodb;
	
	insert into user values(1, 'shenjian','no');
	insert into user values(2, 'zhangsan','no');
	insert into user values(3, 'lisi', 'yes');
	insert into user values(4, 'lisi', 'no');
	```

2. ==Using where==

	> - Extraä¸ºUsing whereè¯´æ˜Žï¼Œ==SQLä½¿ç”¨äº†whereæ¡ä»¶è¿‡æ»¤æ•°æ®==ã€‚

3. ==Using index==

	> - Extraä¸ºUsing indexè¯´æ˜Žï¼Œ==SQLæ‰€éœ€è¦è¿”å›žçš„æ‰€æœ‰åˆ—æ•°æ®å‡åœ¨ä¸€æ£µç´¢å¼•æ ‘ä¸Š==ï¼Œè€Œæ— éœ€è®¿é—®å®žé™…çš„è¡Œè®°å½•ã€‚
	>
	> - å¦‚ï¼š
	>
	> 	```sql
	> 	explain select id,name from user where name='shenjian';
	> 	```

4. ==Using index condition==

	> - Extraä¸ºUsing index conditionè¯´æ˜Žï¼Œç¡®å®ž==å‘½ä¸­äº†ç´¢å¼•ï¼Œä½†ä¸æ˜¯æ‰€æœ‰çš„åˆ—æ•°æ®éƒ½åœ¨ç´¢å¼•æ ‘ä¸Š==ï¼Œè¿˜éœ€è¦è®¿é—®å®žé™…çš„è¡Œè®°å½•ã€‚
	>
	> - å¦‚ï¼š
	>
	> 	```sql
	> 	explain select id,name,sex from user # sex æ²¡æœ‰ç´¢å¼•
	> 	where name='shenjian';
	> 	```

5. ==Using filesort==

	> - ```sql
	> 	explain select * from user order by sex;
	> 	```
	>
	> 	ç»“æžœè¯´æ˜Žï¼š
	>
	> - Extraä¸ºUsing filesortè¯´æ˜Žï¼Œå¾—åˆ°==æ‰€éœ€ç»“æžœé›†ï¼Œéœ€è¦å¯¹æ‰€æœ‰è®°å½•è¿›è¡Œæ–‡ä»¶æŽ’åº==ã€‚
	>
	> - è¿™ç±»SQLè¯­å¥==æ€§èƒ½æžå·®==ï¼Œéœ€è¦è¿›è¡Œä¼˜åŒ–ã€‚
	>
	> - å…¸åž‹çš„ï¼Œ==åœ¨ä¸€ä¸ªæ²¡æœ‰å»ºç«‹ç´¢å¼•çš„åˆ—ä¸Šè¿›è¡Œäº†order byï¼Œå°±ä¼šè§¦å‘filesort==ï¼Œå¸¸è§çš„==ä¼˜åŒ–æ–¹æ¡ˆ==æ˜¯ï¼Œåœ¨==order byçš„åˆ—ä¸Šæ·»åŠ ç´¢å¼•==ï¼Œ==é¿å…æ¯æ¬¡æŸ¥è¯¢éƒ½å…¨é‡æŽ’åº==ã€‚

6. ==Using temporary==

	> - ```sql
	> 	explain select * from user group by name order by sex;
	> 	```
	>
	> 	ç»“æžœè¯´æ˜Žï¼š
	>
	> - Extraä¸ºUsing temporaryè¯´æ˜Žï¼Œ==éœ€è¦å»ºç«‹ä¸´æ—¶è¡¨(temporary table)æ¥æš‚å­˜ä¸­é—´ç»“æžœ==ã€‚
	>
	> - è¿™ç±»SQLè¯­å¥==æ€§èƒ½è¾ƒä½Ž==ï¼Œå¾€å¾€ä¹Ÿéœ€è¦è¿›è¡Œä¼˜åŒ–ã€‚
	>
	> - å…¸åž‹çš„ï¼Œ==group byå’Œorder byåŒæ—¶å­˜åœ¨ï¼Œä¸”ä½œç”¨äºŽä¸åŒçš„å­—æ®µæ—¶ï¼Œå°±ä¼šå»ºç«‹ä¸´æ—¶è¡¨==ï¼Œä»¥ä¾¿è®¡ç®—å‡ºæœ€ç»ˆçš„ç»“æžœé›†ã€‚

7. ==Using join buffer (Blocked Nested Loop)==

	> - ```sql
	> 	explain select * from user where id in(select id from user where sex='no');
	> 	```
	>
	> 	ç»“æžœè¯´æ˜Žï¼š
	>
	> - Extraä¸ºUsing join buffer (Block Nested Loop)è¯´æ˜Žï¼Œéœ€è¦è¿›è¡Œ==åµŒå¥—å¾ªçŽ¯è®¡ç®—==ã€‚
	>
	> - *ç”»å¤–éŸ³ï¼šå†…å±‚å’Œå¤–å±‚çš„ typeå‡ä¸º ALLï¼Œrowså‡ä¸º4ï¼Œéœ€è¦å¾ªçŽ¯è¿›è¡Œ 4\*4æ¬¡è®¡ç®—ã€‚*
	>
	> - è¿™ç±»SQLè¯­å¥==æ€§èƒ½å¾€å¾€ä¹Ÿè¾ƒä½Ž==ï¼Œéœ€è¦è¿›è¡Œä¼˜åŒ–ã€‚
	>
	> - å…¸åž‹çš„ï¼Œä¸¤ä¸ªå…³è”è¡¨joinï¼Œå…³è”å­—æ®µå‡æœªå»ºç«‹ç´¢å¼•ï¼Œå°±ä¼šå‡ºçŽ°è¿™ç§æƒ…å†µã€‚å¸¸è§çš„ä¼˜åŒ–æ–¹æ¡ˆæ˜¯ï¼Œ==åœ¨å…³è”å­—æ®µä¸Šæ·»åŠ ç´¢å¼•ï¼Œé¿å…æ¯æ¬¡åµŒå¥—å¾ªçŽ¯è®¡ç®—==ã€‚

---



### 3.æ•°æ®åº“å…è®¸ç©ºå€¼(null)ï¼Œå¾€å¾€æ˜¯æ‚²å‰§çš„å¼€å§‹ðŸŒŸðŸŒŸ

```sql
create table user (
    id int,
    name varchar(20),
    index(id)
) engine=innodb;

insert into user values(1,'shenjian');
insert into user values(2,'zhangsan');
insert into user values(3,'lisi');
```

1. ==è´Ÿå‘æ¯”è¾ƒ==ï¼ˆä¾‹å¦‚ï¼š!=ï¼‰ä¼šå¼•å‘==å…¨è¡¨æ‰«æ==ï¼›

	> ![å›¾ç‰‡](bgwROUND1.assets/202202242327004.png)

2. å¦‚æžœå…è®¸ç©ºå€¼ï¼Œ==ä¸ç­‰äºŽ(!=)çš„æŸ¥è¯¢ï¼Œä¸ä¼šå°†ç©ºå€¼è¡Œ(row)åŒ…å«è¿›æ¥==ï¼Œæ­¤æ—¶çš„ç»“æžœé›†å¾€å¾€æ˜¯ä¸ç¬¦åˆé¢„æœŸçš„ï¼Œæ­¤æ—¶==å¾€å¾€è¦åŠ ä¸Šä¸€ä¸ªoræ¡ä»¶ï¼ŒæŠŠç©ºå€¼(is null)ç»“æžœåŒ…å«è¿›æ¥==ï¼›

	> ![å›¾ç‰‡](bgwROUND1.assets/202202242327075.png)

3. ==orå¯èƒ½ä¼šå¯¼è‡´å…¨è¡¨æ‰«æ==ï¼Œæ­¤æ—¶å¯ä»¥==ä¼˜åŒ–ä¸ºunionæŸ¥è¯¢==ï¼›

	> ==ä½¿ç”¨ or is null==ï¼Œ==å…¨è¡¨æŸ¥è¯¢==ï¼š
	>
	> ![å›¾ç‰‡](bgwROUND1.assets/202202242327104.png)
	>
	> ---
	>
	> ==ä½¿ç”¨ union==ï¼Œä½¿ç”¨==æ™®é€šç´¢å¼•æŸ¥è¯¢==ï¼š
	>
	> ![å›¾ç‰‡](bgwROUND1.assets/202202242327695.png)

4. å»ºè¡¨æ—¶åŠ ä¸Š==é»˜è®¤(default)å€¼==ï¼Œè¿™æ ·èƒ½==é¿å…ç©ºå€¼çš„å‘==ï¼›

---



### 4.count( * )è¿™ä¹ˆæ…¢ï¼Œæˆ‘è¯¥æ€Žä¹ˆåŠž?ðŸŒŸðŸŒŸ

è§ç¬”è®°ã€‚

---



# 4.Redis

### 1.Rediså•çº¿ç¨‹ä¸ºå•¥è¿˜èƒ½è¿™ä¹ˆå¿«ï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

1. ==memcached ä¸Ž redis çš„åŒºåˆ«==ï¼š

	> - Redis æ‹¥æœ‰==æ›´å¤šçš„æ•°æ®ç»“æž„å’Œæ“ä½œç§ç±»==ï¼Œå¯ä»¥è¿›è¡Œæ›´å¤æ‚çš„æ“ä½œã€‚
	> - ==Redis å•çº¿ç¨‹ï¼Œè€Œ memcached å¤šçº¿ç¨‹==ã€‚å­˜å‚¨å°‘é‡æ•°æ®æ—¶ Redis çš„æ•ˆçŽ‡æ›´é«˜ï¼Œä½†æ˜¯å­˜å‚¨ 100k ä»¥ä¸Šçš„æ•°æ®æ—¶ memcached æ€§èƒ½è¦å¥½ä¸€äº›ã€‚
	> - ==memcached æ²¡æœ‰åŽŸç”Ÿçš„é›†ç¾¤çŽ¯å¢ƒ==ï¼Œéœ€è¦ä¾é å®¢æˆ·ç«¯å®žçŽ°å¾€é›†ç¾¤ä¸­åˆ†ç‰‡å†™å…¥æ•°æ®ã€‚

2. ==Redis å•çº¿ç¨‹ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«==ï¼Ÿ

      > - ç›¸æ¯”äºŽå¤šçº¿ç¨‹ï¼Œå•çº¿ç¨‹ä¸éœ€è¦è¿›è¡Œ==å¹¶å‘æŽ§åˆ¶==å’Œæ“ä½œç³»ç»Ÿ==å†…æ ¸æ€ä¸Žç”¨æˆ·æ€ä¹‹é—´çš„åˆ‡æ¢==ã€‚
      > - Redis å¤§éƒ¨åˆ†==æ“ä½œåœ¨å†…å­˜ä¸­==ï¼Œå¹¶ä¸”æœ‰å¤§é‡==é«˜æ•ˆçš„æ•°æ®ç»“æž„==ã€‚
      > - é‡‡ç”¨ ==IO å¤šè·¯å¤ç”¨æŠ€æœ¯==ï¼Œé¿å…åœ¨ accept() å»ºç«‹è¿žæŽ¥å’Œ resv() è¯»å–è¯·æ±‚æ—¶==ç­‰å¾…å®¢æˆ·ç«¯æ•°æ®é€ æˆé˜»å¡ž==ã€‚

è§ç¬”è®°ï¼š4.é«˜æ€§èƒ½IOæ¨¡åž‹ï¼šä¸ºä»€ä¹ˆå•çº¿ç¨‹Redisèƒ½é‚£ä¹ˆå¿«ï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

---



### 2.rediséƒ½æœ‰å“ªäº›æ•°æ®ç±»åž‹ï¼Ÿåˆ†åˆ«åœ¨å“ªäº›åœºæ™¯ä¸‹ä½¿ç”¨æ¯”è¾ƒåˆé€‚å‘¢ï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

1. > ![image-20210608011637051](bgwROUND1.assets/image-20210608011637051.png)

2. ==Redis é€‚åˆçš„åœºæ™¯==

	> 1. ==ç¼“å­˜==ï¼šå‡è½» MySQL çš„==æŸ¥è¯¢åŽ‹åŠ›==ï¼Œæå‡ç³»ç»Ÿæ€§èƒ½ï¼›
	> 2. ==æŽ’è¡Œæ¦œ==ï¼šåˆ©ç”¨ Redis çš„ ==SortSet==ï¼ˆæœ‰åºé›†åˆï¼‰å®žçŽ°ï¼›
	> 3. ==è®¡ç®—å™¨/é™é€Ÿå™¨==ï¼šåˆ©ç”¨ Redis ä¸­==åŽŸå­æ€§çš„è‡ªå¢žæ“ä½œ(INCR)==ï¼Œæˆ‘ä»¬å¯ä»¥ç»Ÿè®¡ç±»ä¼¼ç”¨æˆ·ç‚¹èµžæ•°ã€ç”¨æˆ·è®¿é—®æ•°ç­‰ã€‚è¿™ç±»æ“ä½œå¦‚æžœç”¨ MySQLï¼Œé¢‘ç¹çš„è¯»å†™ä¼šå¸¦æ¥ç›¸å½“å¤§çš„åŽ‹åŠ›ï¼›==é™é€Ÿå™¨æ¯”è¾ƒå…¸åž‹çš„ä½¿ç”¨åœºæ™¯æ˜¯é™åˆ¶æŸä¸ªç”¨æˆ·è®¿é—®æŸä¸ª API çš„é¢‘çŽ‡==ï¼Œå¸¸ç”¨çš„æœ‰æŠ¢è´­æ—¶ï¼Œé˜²æ­¢ç”¨æˆ·ç–¯ç‹‚ç‚¹å‡»å¸¦æ¥ä¸å¿…è¦çš„åŽ‹åŠ›ï¼›
	> 4. ==å¥½å‹å…³ç³»==ï¼šåˆ©ç”¨é›†åˆçš„ä¸€äº›å‘½ä»¤ï¼Œæ¯”å¦‚==æ±‚äº¤é›†ã€å¹¶é›†ã€å·®é›†ç­‰ã€‚å¯ä»¥æ–¹ä¾¿è§£å†³ä¸€äº›å…±åŒå¥½å‹ã€å…±åŒçˆ±å¥½ä¹‹ç±»çš„åŠŸèƒ½==ï¼›
	> 5. ==æ¶ˆæ¯é˜Ÿåˆ—==ï¼š==é™¤äº†== Redis è‡ªèº«çš„==å‘å¸ƒ/è®¢é˜…æ¨¡å¼==ï¼Œæˆ‘ä»¬==ä¹Ÿ==å¯ä»¥åˆ©ç”¨ ==List æ¥å®žçŽ°ä¸€ä¸ªé˜Ÿåˆ—æœºåˆ¶==ï¼Œæ¯”å¦‚ï¼šåˆ°è´§é€šçŸ¥ã€é‚®ä»¶å‘é€ä¹‹ç±»çš„éœ€æ±‚ï¼Œä¸éœ€è¦é«˜å¯é ï¼Œä½†æ˜¯ä¼šå¸¦æ¥éžå¸¸å¤§çš„ DB åŽ‹åŠ›ï¼Œå®Œå…¨å¯ä»¥ç”¨ List æ¥å®Œæˆå¼‚æ­¥è§£è€¦ï¼›
	> 6. ==Session å…±äº«==ï¼šSession æ˜¯ä¿å­˜åœ¨æœåŠ¡å™¨çš„æ–‡ä»¶ä¸­ï¼Œå¦‚æžœæ˜¯==é›†ç¾¤æœåŠ¡ï¼ŒåŒä¸€ä¸ªç”¨æˆ·è¿‡æ¥å¯èƒ½è½åœ¨ä¸åŒæœºå™¨ä¸Š==ï¼Œè¿™å°±ä¼šå¯¼è‡´ç”¨æˆ·é¢‘ç¹ç™»é™†ï¼›==é‡‡ç”¨ Redis ä¿å­˜ Session åŽï¼Œæ— è®ºç”¨æˆ·è½åœ¨é‚£å°æœºå™¨ä¸Šéƒ½èƒ½å¤ŸèŽ·å–åˆ°å¯¹åº”çš„ Session ä¿¡æ¯==ã€‚

3. ==Redis ä¸é€‚åˆçš„åœºæ™¯==

	> ==æ•°æ®é‡å¤ªå¤§==ã€æ•°æ®==è®¿é—®é¢‘çŽ‡éžå¸¸ä½Ž==çš„ä¸šåŠ¡éƒ½ä¸é€‚åˆä½¿ç”¨ Redisï¼Œ==æ•°æ®å¤ªå¤§ä¼šå¢žåŠ æˆæœ¬==ï¼Œ==è®¿é—®é¢‘çŽ‡å¤ªä½Žï¼Œä¿å­˜åœ¨å†…å­˜ä¸­çº¯å±žæµªè´¹èµ„æº==ã€‚

è§ç¬”è®°ï¼š3.æ•°æ®ç»“æž„ï¼šå¿«é€Ÿçš„Redisæœ‰å“ªäº›æ…¢æ“ä½œï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

---



### 3.RedisæŒä¹…åŒ–æœºåˆ¶ðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

==RDB==

> RDB æ˜¯ Redis DataBase çš„ç¼©å†™ã€‚æŒ‰ç…§ä¸€å®šçš„æ—¶é—´å‘¨æœŸç­–ç•¥æŠŠå†…å­˜çš„æ•°æ®ä»¥å¿«ç…§çš„å½¢å¼ä¿å­˜åˆ°ç¡¬ç›˜çš„==äºŒè¿›åˆ¶æ–‡ä»¶==ã€‚å³ Snapshot å¿«ç…§å­˜å‚¨ï¼Œå¯¹åº”äº§ç”Ÿçš„æ•°æ®æ–‡ä»¶ä¸º dump.rdbï¼Œé€šè¿‡é…ç½®æ–‡ä»¶ä¸­çš„ save å‚æ•°æ¥å®šä¹‰å¿«ç…§çš„å‘¨æœŸã€‚æ ¸å¿ƒå‡½æ•°ï¼šrdbSaveï¼ˆç”Ÿæˆ RDB æ–‡ä»¶ï¼‰å’Œ rdbLoadï¼ˆä»Žæ–‡ä»¶åŠ è½½å†…å­˜ï¼‰ä¸¤ä¸ªå‡½æ•°ã€‚
>
> ![image-20210608012429690](bgwROUND1.assets/image-20210608012429690.png)

==AOF==

> AOF æ˜¯ ==Append-only file== çš„ç¼©å†™ã€‚Redisä¼š==å°†æ¯ä¸€ä¸ªæ”¶åˆ°çš„å†™å‘½ä»¤éƒ½é€šè¿‡ Write å‡½æ•°è¿½åŠ åˆ°æ–‡ä»¶æœ€åŽ==ï¼Œ==ç±»ä¼¼äºŽ MySQL çš„ binlogï¼ˆå‚¨å­˜å‘½ä»¤ï¼‰==ã€‚å½“ Redis ==é‡å¯==æ˜¯ä¼šé€šè¿‡==é‡æ–°æ‰§è¡Œ==æ–‡ä»¶ä¸­==ä¿å­˜çš„å†™å‘½ä»¤æ¥åœ¨å†…å­˜ä¸­é‡å»ºæ•´ä¸ªæ•°æ®åº“çš„å†…å®¹==ã€‚æ¯å½“æ‰§è¡ŒæœåŠ¡å™¨ï¼ˆå®šæ—¶ï¼‰ä»»åŠ¡æˆ–è€…å‡½æ•°æ—¶ï¼ŒflushAppendOnlyFile å‡½æ•°éƒ½ä¼šè¢«è°ƒç”¨ï¼Œ è¿™ä¸ªå‡½æ•°æ‰§è¡Œä»¥ä¸‹ä¸¤ä¸ªå·¥ä½œï¼š
>
> - WRITEï¼šæ ¹æ®æ¡ä»¶ï¼Œå°† aof_buf ä¸­çš„ç¼“å­˜å†™å…¥åˆ° AOF æ–‡ä»¶ï¼›
> - SAVEï¼šæ ¹æ®æ¡ä»¶ï¼Œè°ƒç”¨ fsync æˆ– fdatasync å‡½æ•°ï¼Œå°† AOF æ–‡ä»¶ä¿å­˜åˆ°ç£ç›˜ä¸­ã€‚
>
> ![image-20210608012457207](bgwROUND1.assets/image-20210608012457207.png)

==RDB å’Œ AOF çš„åŒºåˆ«ï¼š==

> 1. ==AOF æ–‡ä»¶æ¯” RDB æ›´æ–°é¢‘çŽ‡é«˜==ï¼Œä¼˜å…ˆä½¿ç”¨ AOF è¿˜åŽŸæ•°æ®ï¼›
> 2. AOFæ¯” RDB æ›´å®‰å…¨ä¹Ÿæ›´å¤§ï¼›
> 3. RDB æ€§èƒ½æ¯” AOF å¥½ï¼›
> 4. å¦‚æžœä¸¤ä¸ªéƒ½é…äº†==ä¼˜å…ˆåŠ è½½ AOF==ã€‚

è§ç¬”è®°ï¼š5.AOFæ—¥å¿—ï¼šå®•æœºäº†ï¼ŒRediså¦‚ä½•é¿å…æ•°æ®ä¸¢å¤±ï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

è§ç¬”è®°ï¼š6.å†…å­˜å¿«ç…§ï¼šå®•æœºåŽï¼ŒRediså¦‚ä½•å®žçŽ°å¿«é€Ÿæ¢å¤ï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

---



### 4.Rediså®žçŽ°åˆ†å¸ƒå¼é”ðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

1. ==åŠ é”==ï¼š

	> ==set å‘½ä»¤å¯ä»¥è®¾ç½®è¿‡æœŸå‚æ•°ä¿è¯åŽŸå­æ€§==ï¼Œè€Œ ==setnx å‘½ä»¤å’Œ expire å‘½ä»¤åˆç”¨åˆ™ä¸èƒ½ä¿è¯åŽŸå­æ€§==ã€‚
	>
	> ```bash
	> # åŠ é”, unique_value ä½œä¸ºå®¢æˆ·ç«¯å”¯ä¸€æ€§çš„æ ‡è¯†ï¼Œè¿‡æœŸæ—¶é—´10ç§’ã€‚
	> SET lock_key unique_value NX PX 10000 # unique_value é˜²æ­¢è¯¯åˆ é”ï¼Œ
	> 									  # expire é˜²æ­¢å¼‚å¸¸ä¸€ç›´ä¸é‡Šæ”¾é”
	> 									  # NX: åªåœ¨é”®ä¸å­˜åœ¨æ—¶ï¼Œæ‰å¯¹é”®è¿›è¡Œè®¾ç½®æ“ä½œ
	> ```

2. ==è§£é”==ï¼š

	> ==ä½¿ç”¨ lua è„šæœ¬ä¿è¯åŽŸå­æ€§==ã€‚
	>
	> ```lua
	> //é‡Šæ”¾é” æ¯”è¾ƒunique_valueæ˜¯å¦ç›¸ç­‰ï¼Œé¿å…è¯¯é‡Šæ”¾
	> if redis.call("get",KEYS[1]) == ARGV[1] then
	>     return redis.call("del",KEYS[1])
	> else
	>     return 0
	> end
	> ```

3. ==å¯èƒ½é‡åˆ°çš„é—®é¢˜==ï¼š

	> 1. ==åŽŸå­æ€§é—®é¢˜==ï¼š
	> 	- setnx è®¾ç½®é”ä¹‹åŽæ²¡æ¥å¾—åŠè®¾ç½® expire å°±å¼‚å¸¸ï¼Œå¯¼è‡´é”æ°¸è¿œä¸ä¼šé‡Šæ”¾ã€‚
	> 	- ==è§£å†³æ–¹å¼==ï¼š==ä½¿ç”¨å¯ä»¥è®¾ç½® PX å‚æ•°çš„ set å‘½ä»¤==ï¼Œä¿è¯åŽŸå­æ€§ã€‚
	> 2. ==é”è¯¯è§£é”==ï¼š
	> 	- ä¸»è¦æ˜¯æŒ‡ A å®¢æˆ·ç«¯è¯¯ del äº† B å®¢æˆ·ç«¯ä¸Šçš„åˆ†å¸ƒå¼é”ã€‚
	> 	- ==è§£å†³æ–¹å¼==ï¼šæ¯ä¸€ä¸ªå®¢æˆ·ç«¯==åŠ é”å‰è®¾ç½®unique_valueå”¯ä¸€å€¼==ï¼Œ==è§£é”æ—¶åˆ¤æ–­æ˜¯å¦æ—¶åŠ é”çš„å®¢æˆ·ç«¯==ã€‚
	> 3. ==é”è¶…æ—¶å¯¼è‡´å’Œå…¶å®ƒå®¢æˆ·ç«¯å¹¶å‘æ‰§è¡Œ==ï¼š
	> 	- ==æ²¡èƒ½åœ¨é”è¿‡æœŸçš„æ—¶é™å†…å®Œæˆæ“ä½œ==ï¼Œå¯¼è‡´==é”åˆ°æ—¶è‡ªåŠ¨é‡Šæ”¾ï¼Œå…¶å®ƒå®¢æˆ·ç«¯èŽ·å¾—é”==ä¸Žå½“å‰çš„å¹¶å‘æ‰§è¡Œã€‚
	> 	- ==è§£å†³æ–¹æ³•==ï¼šè®¾ç½®è¶³å¤Ÿé•¿æ—¶é—´çš„ expire æ—¶é—´ã€‚ä¸ºèŽ·å–é”çš„çº¿ç¨‹==å¢žåŠ å®ˆæŠ¤çº¿ç¨‹==ï¼Œ==ä¸ºå°†è¦è¿‡æœŸä½†æœªé‡Šæ”¾çš„é”å¢žåŠ æœ‰æ•ˆæ—¶é—´==ã€‚
	> 4. ==æ— æ³•ç­‰å¾…é”é‡Šæ”¾==ï¼š
	> 	- è§£å†³æ–¹å¼ï¼šæ²¡æœ‰èŽ·å–åˆ°é”å¾ªçŽ¯é‡å¤å°è¯•èŽ·å–ï¼Œæ¯”è¾ƒæ¶ˆè€— CPU èµ„æºï¼›é‡‡ç”¨å‘å¸ƒè®¢é˜…åŠŸèƒ½ï¼Œå½“==èŽ·å–é”å¤±è´¥æ—¶ï¼Œè®¢é˜…é”é‡Šæ”¾æ¶ˆæ¯==ï¼ŒèŽ·å–é”æˆåŠŸåŽ==é‡Šæ”¾æ—¶ï¼Œå‘é€é”é‡Šæ”¾æ¶ˆæ¯==ã€‚

è§ç¬”è®°ï¼š31.å¦‚ä½•ä½¿ç”¨Rediså®žçŽ°åˆ†å¸ƒå¼é”ï¼Ÿâ­ï¸â­ï¸â­ï¸â­ï¸â­ï¸

---



### 5.Rediså®žçŽ°æ¶ˆæ¯é˜Ÿåˆ—ðŸŒŸðŸŒŸðŸŒŸ

è§ç¬”è®°ï¼š16.æ¶ˆæ¯é˜Ÿåˆ—çš„è€ƒéªŒï¼šRedisæœ‰å“ªäº›è§£å†³æ–¹æ¡ˆï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

----



### 6.redisçš„è¿‡æœŸç­–ç•¥èƒ½ä»‹ç»ä¸€ä¸‹ï¼Ÿè¦ä¸ä½ å†æ‰‹å†™ä¸€ä¸ªLRUï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

1. Redis ç¼“å­˜éœ€è¦å¯¹æ•°æ®è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚
2. Redis å¯¹è¿‡æœŸæ•°æ®çš„åˆ é™¤ç­–ç•¥æ˜¯==æƒ°æ€§åˆ é™¤ï¼ˆè®¿é—®åˆ°æ‰åˆ ï¼‰+å®šæœŸåˆ é™¤ï¼ˆå®šæœŸæŠ½æ ·è¿›è¡Œæ£€æŸ¥ï¼Œåˆ é™¤æ ·æœ¬ä¸­è¿‡æœŸçš„é”®ï¼Œå¯èƒ½å‡ºçŽ°æœ‰çš„è¿‡æœŸé”®è¿Ÿè¿Ÿä¸è¢«æŠ½åˆ°çš„æƒ…å†µï¼‰==ä¸¤ç§ç­–ç•¥å¯¹==è¿‡æœŸé”®åˆ é™¤==ã€‚

è§ç¬”è®°ï¼š25.æ›¿æ¢ç­–ç•¥ï¼šç¼“å­˜æ»¡äº†æ€Žä¹ˆåŠžï¼Ÿâ­ï¸â­ï¸â­ï¸â­ï¸â­ï¸

---



### 7.ä½ èƒ½è¯´è¯´redisçš„å¹¶å‘ç«žäº‰é—®é¢˜è¯¥å¦‚ä½•è§£å†³å—ï¼ŸðŸŒŸðŸŒŸ

è§†é¢‘ä¸­çš„é‡ç‚¹ï¼šå¯¹äºŽ==ç¼“å­˜çš„æ›´æ–°==ï¼Œä¸æ˜¯è¯´åŠ é”å°±è¡Œï¼Œæ ¸å¿ƒè¿˜å¾—==åŠ ä¸Šæ—¶é—´æˆ³==ã€‚

1. ä½ è¦å†™å…¥ç¼“å­˜çš„æ•°æ®ï¼Œéƒ½å…ˆå†™å…¥mysqlä¸­ï¼Œ==å†™å…¥mysqä¸­çš„æ˜¯æ—¶å€™å¿…é¡»ä¿å­˜ä¸€ä¸ªæ—¶é—´æˆ³==ã€‚ä»ŽmysqlæŸ¥å‡ºæ¥çš„æ—¶å€™ï¼Œ==æ—¶é—´æˆ³ä¹ŸæŸ¥å‡ºæ¥==ã€‚
2. æ¯æ¬¡è¦å†™ä¹‹å‰ï¼Œå…ˆ==åˆ¤æ–­==ä¸€ä¸‹å½“å‰è¿™ä¸ªvalueçš„æ—¶é—´æˆ³==æ˜¯å¦æ¯”ç¼“å­˜é‡Œçš„vleçš„æ—¶é—´æˆ³è¦æ›´æ–°==ï¼Œå¦‚æžœæ›´æ–°ï¼Œé‚£ä¹ˆå¯ä»¥å†™ã€‚å¦‚æžœæ›´æ—§ï¼Œå°±==ä¸èƒ½ç”¨æ—§çš„æ•°æ®è¦†ç›–æ–°çš„æ•°æ®==ã€‚

è§ç¬”è®°ï¼š30.æ— é”çš„åŽŸå­æ“ä½œï¼šRediså¦‚ä½•åº”å¯¹å¹¶å‘è®¿é—®ï¼Ÿâ­ï¸â­ï¸â­ï¸â­ï¸

è§ç¬”è®°ï¼š31.å¦‚ä½•ä½¿ç”¨Rediså®žçŽ°åˆ†å¸ƒå¼é”ï¼Ÿâ­ï¸â­ï¸â­ï¸â­ï¸â­ï¸

---



### 8.ç¼“å­˜é›ªå´©+ç©¿é€+æ•°æ®åº“ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸

1. ==ç¼“å­˜é›ªå´©==ï¼š

	> - ==åŽŸå› ==ï¼š
	> 	1. ==Redis å®žä¾‹æŒ‚æŽ‰äº†==ï¼Œè¯·æ±‚å…¨éƒ¨èµ°æ•°æ®åº“ã€‚
	> 	2. å¯¹ç¼“å­˜æ•°æ®è®¾ç½®ç›¸åŒçš„è¿‡æœŸæ—¶é—´ï¼Œå¯¼è‡´æŸæ®µæ—¶é—´å†…==ç¼“å­˜é›†ä½“å¤±æ•ˆ==ï¼Œè¯·æ±‚å…¨éƒ¨èµ°æ•°æ®åº“ã€‚
	> - ==è§£å†³æ–¹æ³•==ï¼š
	> 	1. äº‹å‘å‰ï¼šå®žçŽ°Redisçš„==é«˜å¯ç”¨==(ä¸»ä»Žæž¶æž„+Sentinel æˆ–è€…Redis Clusterï¼Œ==ä¸€ä¸ªæŒ‚äº†æˆ–å‡ºäº‹äº†è¿˜æœ‰å…¶å®ƒçš„å®žä¾‹==)ï¼Œå°½é‡é¿å…RedisæŒ‚æŽ‰è¿™ç§æƒ…å†µå‘ç”Ÿã€‚
	> 	2. äº‹å‘ä¸­ï¼šä¸‡ä¸€RedisçœŸçš„æŒ‚äº†ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®==æœ¬åœ°ç¼“å­˜(ehcacheï¼Œå³åœ¨æœåŠ¡å™¨æœ¬åœ°è¿›è¡Œç¼“å­˜è€Œæš‚æ—¶ä¸ä½¿ç”¨ Redis å®žä¾‹) + é™æµ(hystrix)==ï¼Œå°½é‡é¿å…æˆ‘ä»¬çš„æ•°æ®åº“è¢«å¹²æŽ‰(èµ·ç èƒ½ä¿è¯æˆ‘ä»¬çš„æœåŠ¡è¿˜æ˜¯èƒ½æ­£å¸¸å·¥ä½œçš„)
	> 	3. äº‹å‘åŽï¼šredisæŒä¹…åŒ–ï¼Œé‡å¯åŽè‡ªåŠ¨ä»Žç£ç›˜ä¸ŠåŠ è½½æ•°æ®ï¼Œ==å¿«é€Ÿæ¢å¤ç¼“å­˜æ•°æ®==ã€‚

2. ==ç¼“å­˜ç©¿é€==ï¼š

	> - ==åŽŸå› ==ï¼š
	> 	1. è¯·æ±‚çš„æ•°æ®åœ¨==ç¼“å­˜å¤§é‡ä¸å‘½ä¸­==ï¼Œå¯¼è‡´è¯·æ±‚èµ°æ•°æ®åº“ã€‚
	> - ==è§£å†³æ–¹æ³•==ï¼š
	> 	1. ä½¿ç”¨==å¸ƒéš†è¿‡æ»¤å™¨==(BloomFilter)æˆ–è€…åŽ‹ç¼©filter==æå‰æ‹¦æˆª==ï¼Œä¸åˆæ³•å°±ä¸è®©è¿™ä¸ªè¯·æ±‚åˆ°æ•°æ®åº“å±‚ï¼
	> 	2. å½“æˆ‘ä»¬ä»Žæ•°æ®åº“æ‰¾ä¸åˆ°çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿå°†è¿™ä¸ª==ç©ºå¯¹è±¡è®¾ç½®åˆ°ç¼“å­˜é‡Œè¾¹åŽ»ï¼ˆæ¯”å¦‚-1:nullï¼‰==ã€‚ä¸‹æ¬¡å†è¯·æ±‚çš„æ—¶å€™ï¼Œå°±å¯ä»¥ä»Žç¼“å­˜é‡Œè¾¹èŽ·å–äº†ã€‚
	> 		- è¿™ç§æƒ…å†µæˆ‘ä»¬ä¸€èˆ¬ä¼šå°†==ç©ºå¯¹è±¡==è®¾ç½®ä¸€ä¸ª==è¾ƒçŸ­çš„è¿‡æœŸæ—¶é—´==ã€‚

3. ==å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜==

	> - ==æ•°æ®åº“é‡Œæ˜¯æ–°æ•°æ®ï¼Œè€Œç¼“å­˜é‡Œæ˜¯æ—§æ•°æ®==ã€‚
	> - ==è§£å†³æ€è·¯==ï¼š
	> 	- å°†==éœ€è¦åˆ é™¤çš„keyå­˜åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­==ã€‚
	> 	- è‡ªå·±æ¶ˆè´¹æ¶ˆæ¯ï¼Œ==åˆ é™¤æˆåŠŸå°±æŠŠå¯¹åº”çš„keyä»Žæ¶ˆæ¯é˜Ÿåˆ—ä¸­åˆ é™¤==ã€‚
	> 	- ==å¤±è´¥ä¸æ–­é‡è¯•åˆ é™¤æ“ä½œï¼Œç›´åˆ°æˆåŠŸï¼ˆæœ‰ä¸Šé™æ¬¡æ•°ï¼Œè¾¾åˆ°è¿˜æ˜¯æ²¡æˆåŠŸå°±æŠ¥é”™ï¼‰==ã€‚

4. ==å…ˆåˆ é™¤ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“==

	> - ç¬¬ä¸€æ­¥æˆåŠŸ(åˆ é™¤ç¼“å­˜)ï¼Œç¬¬äºŒæ­¥å¤±è´¥(æ›´æ–°æ•°æ®åº“)ï¼Œæ•°æ®åº“å’Œç¼“å­˜çš„æ•°æ®è¿˜æ˜¯ä¸€è‡´çš„ã€‚
	> - ==è§£å†³æ–¹æ³•==ï¼š
	> 	- å°†åˆ é™¤ç¼“å­˜ã€ä¿®æ”¹æ•°æ®åº“ã€è¯»å–ç¼“å­˜ç­‰çš„æ“ä½œç§¯åŽ‹åˆ°==é˜Ÿåˆ—==é‡Œè¾¹ï¼Œå®žçŽ°==ä¸²è¡ŒåŒ–==ã€‚
	> 	- ![å›¾ç‰‡](bgwROUND1.assets/202202190727335.webp)

è§ç¬”è®°ï¼š24.æ—è·¯ç¼“å­˜ï¼šRedisæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿâ­ï¸â­ï¸â­ï¸â­ï¸ï¼ˆåªè¯»ç¼“å­˜å’Œå‡ ç§è¯»å†™ç¼“å­˜ï¼‰

è§ç¬”è®°ï¼š26.ç¼“å­˜å¼‚å¸¸ï¼ˆä¸Šï¼‰ï¼šå¦‚ä½•è§£å†³ç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®ä¸ä¸€è‡´é—®é¢˜ï¼Ÿâ­ï¸â­ï¸â­ï¸â­ï¸â­ï¸

è§ç¬”è®°ï¼š27.ç¼“å­˜å¼‚å¸¸ï¼ˆä¸‹ï¼‰ï¼šå¦‚ä½•è§£å†³ç¼“å­˜é›ªå´©ã€å‡»ç©¿ã€ç©¿é€éš¾é¢˜ï¼Ÿâ­ï¸â­ï¸â­ï¸â­ï¸â­ï¸

---



### 9.å“ˆå¸Œæ‰©å®¹ï¼šrehashâ­ï¸â­ï¸â­ï¸

1. redis æœ‰==ä¸¤ä¸ªæ•°ç»„==ï¼Œä¸»è¦ç”¨äºŽ==æ¸è¿›å¼æ‰©å®¹==ã€‚
2. ä¹‹æ‰€ä»¥éœ€è¦æ¸è¿›ï¼Œä¸»è¦æ˜¯ä¸ºäº†åˆ†æ‘Šæ‰©å®¹çš„åŽ‹åŠ›ï¼Œ==é¿å…ä¸€æ¬¡æ€§ç§»åˆ°å¤§é‡æ•°æ®é˜»å¡žçº¿ç¨‹==ã€‚

è§ç¬”è®°ï¼š3.æ•°æ®ç»“æž„ï¼šå¿«é€Ÿçš„Redisæœ‰å“ªäº›æ…¢æ“ä½œï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ

---



### 10.åˆ†å¸ƒå¼ä¸€è‡´æ€§ç®—æ³•ï¼šleaderé€‰ä¸¾â­ï¸â­ï¸

è§ç¬”è®°ï¼š9.å“¨å…µé›†ç¾¤ï¼šå“¨å…µæŒ‚äº†ï¼Œä¸»ä»Žåº“è¿˜èƒ½åˆ‡æ¢å—ï¼ŸðŸŒŸðŸŒŸðŸŒŸï¼ˆLeaderé€‰ä¸¾ï¼‰

è§ç¬”è®°ï¼š7.åŒæ­¥ï¼šä¸»ä»Žåº“å¦‚ä½•å®žçŽ°æ•°æ®ä¸€è‡´ï¼ŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸï¼ˆä¸»ä»ŽåŒæ­¥ï¼‰

---



# 5.è®¡ç®—æœºç½‘ç»œ

> ç¬”è®°ç›´æŽ¥çœ‹ ComputerNetworks

### 1.OSI çš„ä¸ƒå±‚æ¨¡åž‹åˆ†åˆ«æ˜¯ï¼Ÿå„è‡ªçš„åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿ

==æˆ‘çš„å›žç­”==ï¼š

1. ==ç‰©ç†å±‚==ï¼š==ä½¿ç”¨ç‰©ç†è®¾å¤‡å°†è®¡ç®—æœºè¿žæŽ¥èµ·æ¥==ï¼Œå®žçŽ°é€šä¿¡ã€‚

	å¸¸ç”¨çš„ç‰©ç†è®¾å¤‡æœ‰==åŒç»žçº¿ï¼ŒåŒè½´ç”µç¼†ï¼Œå…‰çº¤==ç­‰ã€‚==æ¯”å¦‚æˆ‘ä»¬çš„å®¶åº­å®½å¸¦å°±æ˜¯ä½¿ç”¨å…‰çº¤è¿žæŽ¥==èµ·æ¥çš„ã€‚æˆ‘ä»¬å‘é€çš„==æ•°æ®åœ¨ç‰©ç†å±‚éƒ½æ˜¯ä»¥é«˜ä½Žç”µå¹³çš„å½¢å¼è¿›è¡Œä¼ è¾“çš„==ã€‚

	è¿™ä¹Ÿæ„å‘³ç€å‘é€æ–¹å’ŒæŽ¥æ”¶æ–¹éœ€è¦æœ‰==ç»Ÿä¸€çš„ç¼–ç å’Œè§£ç æ–¹å¼ï¼Œä»Žè€Œå°†é«˜ä½Žç”µå¹³è½¬åŒ–ä¸º0,1==ã€‚

2. ==æ•°æ®é“¾è·¯å±‚==ï¼šæ ¹æ®ä»¥å¤ªç½‘åè®®ï¼Œæ•°æ®é“¾è·¯å±‚ä¸­æ•°æ®ä¼ è¾“çš„==æœ€å°å•ä½æ˜¯å¸§==ã€‚å¸§çš„å­˜åœ¨æ˜¯ä¸ºäº†==å°†ç‰©ç†å±‚ä¼ æ¥çš„0,1å­—èŠ‚æµå°è£…æˆå¸§ï¼Œå¹¶è¿›è¡Œå·®é”™æ£€éªŒ==ã€‚

	æ—¢ç„¶æˆ‘ä»¬è¦è¿›è¡Œæ•°æ®çš„ä¼ è¾“ï¼Œé‚£ä¹ˆè‚¯å®šéœ€è¦æ ‡è¯†æ•°æ®çš„å‘é€è€…å’ŒæŽ¥æ”¶è€…ï¼Œè€Œ ==MAC åœ°å€å°±èƒ½å”¯ä¸€åœ°æ ‡è¯†ä¸€å°è®¾å¤‡ï¼Œå®ƒåœ¨ç½‘å¡ç”Ÿäº§çš„æ—¶å€™å°±è¢«å”¯ä¸€ç¡®å®šäº†==ï¼Œä¸”æ˜¯==ä¸å¯å˜==çš„ã€‚ä¸€ä¸ª ==MAC åœ°å€ç”±12ä¸ª16è¿›åˆ¶æ•°ç»„æˆ==ï¼Œæ¯”å¦‚ `88-A4-C2-57-C7-F6`ã€‚å› æ­¤åœ¨==å¸§çš„å¤´éƒ¨ä¼šæœ‰12ä¸ªå­—èŠ‚åˆ†åˆ«æ ‡è¯†æ•°æ®çš„ç›®çš„åœ°å€å’Œæºåœ°å€==ã€‚

	ä½äºŽæ•°æ®é“¾è·¯å±‚çš„==äº¤æ¢æœº==æ”¶åˆ°å¸§ä¹‹åŽï¼Œå°±==æ ¹æ®ç›®çš„åœ°å€çš„ MAC åœ°å€åœ¨è‡ªå·±çš„ MAC åœ°å€è¡¨ä¸­æŸ¥æ‰¾å¯¹åº”çš„ç«¯å£==ï¼Œè¿›è¡Œæ•°æ®å¸§çš„è½¬å‘ã€‚

3. ==ç½‘ç»œå±‚==ï¼šå¦‚æžœè¯´æ•°æ®é“¾è·¯å±‚æ˜¯è¿›è¡Œå±€åŸŸç½‘å†…éƒ¨çš„æ•°æ®ä¼ è¾“çš„è¯ï¼Œé‚£ä¹ˆ==ç½‘ç»œå±‚å°±æ˜¯å°†æ•°æ®åœ¨ç½‘ç»œå’Œç½‘ç»œä¹‹é—´è¿›è¡Œä¼ è¾“==ï¼Œæ‰€ä¾èµ–çš„è®¾å¤‡æ˜¯==è·¯ç”±å™¨==ã€‚

	ç½‘ç»œå±‚è¿›è¡Œæ•°æ®ä¼ è¾“çš„åè®®æ˜¯ ==IP åè®®==ã€‚==IP åè®®çš„æ•°æ®æŠ¥ä½äºŽæ•°æ®é“¾è·¯å±‚å¸§çš„æ•°æ®éƒ¨åˆ†ä¸­==ï¼Œå¯ä»¥ç†è§£ä¸º==æ•°æ®é“¾è·¯å±‚çš„å¸§å°±æ˜¯ç½‘ç»œå±‚çš„ IP åè®®æ•°æ®æŠ¥åœ¨ä¸¤ç«¯åŠ ä¸Šå¸§é¦–éƒ¨å’Œå¸§å°¾éƒ¨==ã€‚è€Œ IP åè®®çš„æ•°æ®æŠ¥ä¸­å­˜å‚¨äº†ç›®çš„ IP åœ°å€å’Œæº IP åœ°å€ã€‚

	è·¯ç”±å™¨æ”¶åˆ° IP æ•°æ®æŠ¥åŽï¼Œ==æ ¹æ®å…¶è·¯ç”±è¡¨æ‰¾å‡ºä¸‹ä¸€è·³çš„è·¯ç”±å™¨çš„ IP åœ°å€æˆ–æ˜¯è½¬å‘ä¿¡æ¯çš„ç«¯å£==ã€‚

	å¦‚æžœ==ç›®æ ‡ IP åœ°å€å°±å¤„äºŽè¯¥è·¯ç”±å™¨æ‰€è¿žæŽ¥çš„æŸä¸ªç«¯å£ä¸‹ï¼Œè·¯ç”±å™¨åˆ™æ ¹æ®å…¶ ARP ç¼“å­˜è¡¨æŸ¥è¯¢ç›®çš„ MAC åœ°å€==ï¼Œå¹¶==å†™å…¥åˆ°æ–°æ•°æ®å¸§çš„å¸§è¡¨å¤´ä¸­==ï¼Œ==å‘é€ç»™å¯¹åº”ç«¯å£ä¸‹çš„äº¤æ¢æœº==ä»¥è¿›è¡Œè¿›ä¸€æ­¥æ•°æ®ä¼ è¾“ã€‚

4. ==ä¼ è¾“å±‚==ï¼šè´Ÿè´£==å»ºç«‹æµè§ˆå™¨è¿›ç¨‹å’ŒæœåŠ¡å™¨åŽå°è¿›ç¨‹é—´çš„é€šä¿¡==ï¼Œè€Œç”±äºŽæµè§ˆå™¨è¿›ç¨‹å’ŒæœåŠ¡å™¨åŽå°è¿›ç¨‹éƒ½å ç”¨äº†æ‰€å±žè®¾å¤‡çš„æŸä¸ªç«¯å£ï¼Œå› æ­¤ä¼ è¾“å±‚çš„å·¥ä½œä¾¿æ˜¯==å»ºç«‹ç«¯å£åˆ°ç«¯å£ä¹‹é—´çš„é€šä¿¡==ã€‚ä¼ è¾“å±‚å¸¸ç”¨çš„åè®®æ˜¯ ==TCP å’Œ UDP åè®®==ã€‚å…¶ä¸­ ==TCP åè®®==åœ¨æ•°æ®ä¼ è¾“å‰ä¼šè¿›è¡Œ==è¿žæŽ¥==ï¼Œä»¥å®žçŽ°==ç‚¹å¯¹ç‚¹çš„é€šä¿¡==ï¼Œå¹¶æä¾›==æ‹¥å¡žæŽ§åˆ¶==å’Œ==æµé‡æŽ§åˆ¶==ï¼Œå®žçŽ°äº†==å¯é çš„æ•°æ®ä¼ è¾“==ã€‚

5. ==åº”ç”¨å±‚==ï¼šè™½ç„¶æˆ‘ä»¬æ”¶åˆ°äº†ä¼ è¾“å±‚ä¼ æ¥çš„æ•°æ®ï¼Œå¯æ˜¯è¿™äº›ä¼ è¿‡æ¥çš„æ•°æ®äº”èŠ±å…«é—¨ï¼Œæœ‰htmlæ ¼å¼çš„ï¼Œæœ‰mp4æ ¼å¼çš„ï¼Œå„ç§å„æ ·ã€‚å› æ­¤==æˆ‘ä»¬éœ€è¦æŒ‡å®šè¿™äº›æ•°æ®çš„æ ¼å¼è§„åˆ™ï¼Œæ”¶åˆ°åŽæ‰å¥½è§£è¯»æ¸²æŸ“==ã€‚ä¾‹å¦‚æˆ‘ä»¬æœ€å¸¸è§çš„ Http æ•°æ®åŒ…ä¸­ï¼Œå°±ä¼šæŒ‡å®šè¯¥æ•°æ®åŒ…æ˜¯ä»€ä¹ˆæ ¼å¼çš„æ–‡ä»¶äº†ã€‚

==å‚è€ƒç­”æ¡ˆ==ï¼š

- ==ç‰©ç†å±‚==ï¼šè´Ÿè´£==æŠŠä¸¤å°è®¡ç®—æœºè¿žèµ·æ¥==ï¼Œç„¶åŽåœ¨è®¡ç®—æœºä¹‹é—´é€šè¿‡==é«˜ä½Žç”µé¢‘æ¥ä¼ é€0,1è¿™æ ·çš„ç”µä¿¡å·==ï¼Œæ¯”å¦‚é€šè¿‡ä¸€äº›==ç”µç¼†çº¿ä¼ è¾“æ¯”ç‰¹æµ==ã€‚
- ==é“¾è·¯å±‚==ï¼šé“¾è·¯å±‚æ¶‰åŠåˆ°çš„åè®®æ¯”è¾ƒå¤šï¼Œæ¯”å¦‚ Mac åœ°å€å•Šï¼ŒARP ç­‰ï¼Œè¿™ä¸€å±‚ä¸»è¦å°±æ˜¯==è´Ÿè´£æ•°æ®çš„é€šä¿¡==ï¼Œä½¿==å„èŠ‚ç‚¹ä¹‹é—´å¯ä»¥é€šä¿¡==ï¼Œæ¯”å¦‚é€šè¿‡ ==MAC åœ°å€å”¯ä¸€è¯†åˆ«ä¸åŒçš„èŠ‚ç‚¹ï¼Œé€šè¿‡ä»¥å¤ªç½‘åè®®å®šä¹‰æ•°æ®åŒ…==ç­‰ã€‚
- ==ç½‘ç»œå±‚==ï¼šç½‘ç»œå±‚è´Ÿè´£==æŠŠä¸€ä¸ªæ•°æ®ä»Žä¸€ä¸ªç½‘ç»œä¼ é€’åˆ°å¦å¤–ä¸€ä¸ªç½‘ç»œ==ï¼Œæœ€å¤§çš„åŠŸèƒ½å°±æ˜¯è¿›è¡Œ==è·¯ç”±å†³ç­–==ï¼Œæ¯”å¦‚é€šè¿‡ ==IPï¼Œå­ç½‘==ç­‰æ¦‚å¿µï¼Œä½¿æ•°æ®æ›´å¥½ç€==åœ¨ä¸åŒçš„å±€åŸŸç½‘ä¸­ä¼ é€’==ã€‚
- ==ä¼ è¾“å±‚==ï¼šä¼ è¾“å±‚çš„åŠŸèƒ½å°±æ˜¯==å»ºç«‹ç«¯å£åˆ°ç«¯å£çš„é€šä¿¡==ï¼Œåˆšæ‰è¯´çš„==ç½‘ç»œå±‚çš„åŠŸèƒ½åˆ™æ˜¯å»ºç«‹ä¸»æœºåˆ°ä¸»æœºçš„é€šä¿¡==ï¼Œæ¯”å¦‚é€šè¿‡ç½‘ç»œå±‚æˆ‘ä»¬å¯ä»¥æŠŠä¿¡æ¯ä»Ž A ä¸»æœºä¼ é€’åˆ° B ä¸»æœºï¼Œä½†æ˜¯ ==B ä¸»æœºæœ‰å¤šä¸ªç¨‹åºï¼Œæˆ‘ä»¬å…·ä½“è¦å‘ç»™å“ªä¸ªç¨‹åºï¼Œåˆ™æ˜¯é ä¼ è¾“å±‚çš„åè®®æ¥è¯†åˆ«==ï¼Œå¸¸è§åè®®æœ‰ ==UDP å’Œ TCP==ã€‚
- ==åº”ç”¨å±‚==ï¼šè™½ç„¶æˆ‘ä»¬æ”¶åˆ°äº†ä¼ è¾“å±‚ä¼ æ¥çš„æ•°æ®ï¼Œå¯æ˜¯è¿™äº›ä¼ è¿‡æ¥çš„æ•°æ®äº”èŠ±å…«é—¨ï¼Œæœ‰htmlæ ¼å¼çš„ï¼Œæœ‰mp4==æ ¼å¼çš„ï¼Œå„ç§å„æ ·==ï¼Œæˆ‘ä»¬ç”¨æˆ·ä¹Ÿçœ‹ä¸æ‡‚ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦==æŒ‡å®šè¿™äº›æ•°æ®çš„æ ¼å¼è§„åˆ™ï¼Œæ”¶åˆ°åŽæ‰å¥½è§£è¯»æ¸²æŸ“==ã€‚ä¾‹å¦‚æˆ‘ä»¬æœ€å¸¸è§çš„ Http æ•°æ®åŒ…ä¸­ï¼Œå°±ä¼šæŒ‡å®šè¯¥æ•°æ®åŒ…æ˜¯ä»€ä¹ˆæ ¼å¼çš„æ–‡ä»¶äº†ã€‚

----



### 2.ä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿä¸¤æ¬¡ä¸è¡Œï¼Ÿ

==æˆ‘çš„å›žç­”==ï¼š

1. ä¸‰æ¬¡æ¡æ‰‹æ˜¯ TCP åè®®åœ¨ä¼ è¾“å‰==å»ºç«‹ç«¯å£ä¸Žç«¯å£é—´è¿žæŽ¥çš„æ–¹æ³•==ï¼Œå®ƒå¯ä»¥==è®©å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½èƒ½ç¡®è®¤åŒæ–¹æŽ¥æ”¶å’Œå‘é€æ•°æ®çš„èƒ½åŠ›æ­£å¸¸==ï¼Œä»Žè€Œæä¾›==å¯é çš„æ•°æ®æœåŠ¡==ã€‚
2. ä¸‰æ¬¡æ¡æ‰‹çš„æµç¨‹æ˜¯é¦–å…ˆå®¢æˆ·ç«¯æƒ³è¦å’ŒæœåŠ¡ç«¯å»ºç«‹è¿žæŽ¥ï¼Œå…ˆå‘é€ä¸€ä¸ª SYN æŠ¥æ–‡ï¼Œé‡Œé¢é™„åŠ ä¸€ä¸ª==å®¢æˆ·ç«¯åŠ¨æ€ç”Ÿæˆçš„åºåˆ—å·ï¼ˆä¹‹æ‰€ä»¥åŠ¨æ€æ˜¯é˜²æ­¢è¢«ä¼ªé€ ==ï¼‰ï¼Œå‘é€åŽå®¢æˆ·ç«¯å¤„äºŽ ==SYNC-SENT== çŠ¶æ€ã€‚
3. æœåŠ¡ç«¯æŽ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„ SYN æŠ¥æ–‡åŽï¼Œéœ€è¦==å›žå¤ä¸¤ä¸ªæŠ¥æ–‡==ã€‚ä¸€ä¸ªæ˜¯ ACK æŠ¥æ–‡ï¼Œæ ‡è¯†æœåŠ¡ç«¯æˆåŠŸæŽ¥æ”¶ SYN æŠ¥æ–‡ï¼Œè¯¥ ACK æŠ¥æ–‡ä¸­ä¼ è¾“ä¸€ä¸ªåºåˆ—å·ï¼Œ==å…¶å€¼ä¸ºå®¢æˆ·ç«¯å‘æ¥çš„ SYN æŠ¥æ–‡ä¸­çš„åºåˆ—å· + 1==ï¼Œä»¥==å‘å®¢æˆ·ç«¯è¯æ˜Žè‡ªå·±çš„æŽ¥æ”¶èƒ½åŠ›æ²¡æœ‰é—®é¢˜==ã€‚åŒæ—¶ï¼Œè¿˜éœ€å‘é€ä¸€ä¸ª SYN æŠ¥æ–‡ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªåœ¨æœåŠ¡ç«¯åŠ¨æ€ç”Ÿæˆçš„åºåˆ—å·ã€‚å‘é€è¿™ä¸¤ä¸ªæŠ¥æ–‡åŽï¼ŒæœåŠ¡ç«¯å¤„äºŽ ==SYNC-RCVD== çŠ¶æ€ã€‚
4. å®¢æˆ·ç«¯æŽ¥æ”¶åˆ° ACK æŠ¥æ–‡åŽï¼Œçœ‹åˆ°é‡Œé¢çš„åºåˆ—å·çš„ç¡®æ˜¯è‡ªå·±è¿™é‡Œç”Ÿæˆçš„åºåˆ—å· + 1ï¼ŒäºŽæ˜¯å¯ä»¥ç¡®è®¤æœåŠ¡ç«¯çš„æŽ¥æ”¶èƒ½åŠ›æ²¡æœ‰é—®é¢˜ã€‚è€Œæ”¶åˆ° SYN æŠ¥æ–‡åŽï¼Œå’ŒæœåŠ¡ç«¯ç±»ä¼¼çš„è¿”å›žä¸€ä¸ªå«æœ‰ SYN ä¸­æœåŠ¡ç«¯åºåˆ—å· + 1çš„åºåˆ—å·çš„ ACK æŠ¥æ–‡ã€‚æ­¤æ—¶==å®¢æˆ·ç«¯å·²ç»å¯ä»¥ç¡®è®¤åŒæ–¹æŽ¥æ”¶å’Œå‘é€æ•°æ®çš„èƒ½åŠ›å‡æ­£å¸¸==ï¼Œè¿›å…¥ ==ESTABLISHED==ã€‚
5. æœ€åŽï¼ŒæœåŠ¡ç«¯æ”¶åˆ° ACK æŠ¥æ–‡ï¼Œä¹Ÿèƒ½ç¡®è®¤åŒæ–¹æŽ¥æ”¶å’Œå‘é€æ•°æ®çš„èƒ½åŠ›å‡æ­£å¸¸ï¼Œè¿›å…¥ ==ESTABLISHED==ã€‚
6. å¦‚æžœåªæ¡æ‰‹==ä¸¤æ¬¡çš„è¯ï¼Œåªæœ‰å®¢æˆ·ç«¯èƒ½ç¡®è®¤åŒæ–¹æŽ¥æ”¶å’Œå‘é€æ•°æ®çš„èƒ½åŠ›å‡æ­£å¸¸ï¼Œè€ŒæœåŠ¡ç«¯ä¸èƒ½==ã€‚

==å‚è€ƒç­”æ¡ˆ==ï¼š

- ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å‘é€ç½‘ç»œåŒ…ï¼ŒæœåŠ¡ç«¯æ”¶åˆ°äº†ã€‚è¿™æ ·æœåŠ¡ç«¯å°±èƒ½å¾—å‡ºç»“è®ºï¼šå®¢æˆ·ç«¯çš„å‘é€èƒ½åŠ›ã€æœåŠ¡ç«¯çš„æŽ¥æ”¶èƒ½åŠ›æ˜¯æ­£å¸¸çš„ã€‚
- ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡ç«¯å‘åŒ…ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°äº†ã€‚è¿™æ ·==å®¢æˆ·ç«¯å°±èƒ½å¾—å‡ºç»“è®ºï¼šæœåŠ¡ç«¯çš„æŽ¥æ”¶ã€å‘é€èƒ½åŠ›ï¼Œå®¢æˆ·ç«¯çš„æŽ¥æ”¶ã€å‘é€èƒ½åŠ›æ˜¯æ­£å¸¸çš„==ã€‚==ä¸è¿‡æ­¤æ—¶æœåŠ¡å™¨å¹¶ä¸èƒ½ç¡®è®¤å®¢æˆ·ç«¯çš„æŽ¥æ”¶èƒ½åŠ›æ˜¯å¦æ­£å¸¸==ã€‚
- ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å‘åŒ…ï¼ŒæœåŠ¡ç«¯æ”¶åˆ°äº†ã€‚è¿™æ ·æœåŠ¡ç«¯å°±èƒ½å¾—å‡ºç»“è®ºï¼šå®¢æˆ·ç«¯çš„æŽ¥æ”¶ã€å‘é€èƒ½åŠ›æ­£å¸¸ï¼ŒæœåŠ¡å™¨è‡ªå·±çš„å‘é€ã€æŽ¥æ”¶èƒ½åŠ›ä¹Ÿæ­£å¸¸ã€‚

----



### 3.ä¸ºä»€ä¹ˆéœ€è¦å››æ¬¡æŒ¥æ‰‹ï¼Ÿä¸‰æ¬¡ä¸è¡Œï¼Ÿ

==æˆ‘çš„å›žç­”==ï¼š

1. å››æ¬¡æŒ¥æ‰‹æ˜¯ TCP åè®®ä¸­å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éœ€è¦æ–­å¼€è¿žæŽ¥æ—¶ï¼Œ==ä¿è¯åŒæ–¹éƒ½èƒ½æŠŠå½“å‰çš„æ•°æ®å¤„ç†å®Œ==çš„æœºåˆ¶ï¼Œä¹Ÿä½“çŽ°äº† TCP çš„==å¯é æ€§ä¼ è¾“==ã€‚
2. å€¼å¾—ä¸€æçš„æ˜¯ï¼Œ==å®¢æˆ·ç«¯æˆ–æœåŠ¡ç«¯éƒ½å¯ä»¥ä¸»åŠ¨è¯·æ±‚æ–­å¼€ TCP è¿žæŽ¥==ï¼Œä¸‹é¢å‡è®¾å®¢æˆ·ç«¯ä¸»åŠ¨è¯·æ±‚æ–­å¼€è¿žæŽ¥ã€‚
3. é¦–å…ˆå®¢æˆ·ç«¯å‘é€ä¸€ä¸ª FIN æŠ¥æ–‡ï¼ŒæŠ¥æ–‡æºå¸¦ä¸€ä¸ªåœ¨å®¢æˆ·ç«¯åŠ¨æ€ç”Ÿæˆçš„åºåˆ—å·ï¼ŒéšåŽè¿›å…¥ FIN_WAIT1çŠ¶æ€ã€‚
4. æœåŠ¡ç«¯æŽ¥æ”¶åˆ° FIN æŠ¥æ–‡åŽï¼Œå›žå¤ä¸€ä¸ª ACK æŠ¥æ–‡ï¼Œä¸ºäº†å‘å®¢æˆ·ç«¯è¯æ˜Žè‡ªå·±çš„ç¡®æ”¶åˆ°äº†æ–­å¼€è¿žæŽ¥çš„è¯·æ±‚ï¼ŒACK æŠ¥æ–‡ä¸­ä¼šæºå¸¦ä¸€ä¸ªåºåˆ—å·ï¼Œå…¶å€¼ä¸ºå®¢æˆ·ç«¯å‘æ¥çš„ FIN æŠ¥æ–‡ä¸­çš„åºåˆ—å·çš„å€¼ + 1ï¼ŒéšåŽæœåŠ¡ç«¯è¿›å…¥ ==CLOSE_WAIT çŠ¶æ€ï¼Œæ­¤æ—¶æœåŠ¡ç«¯ä¼šå°½å¿«å¤„ç†å®Œè‡ªå·±å‰©ä¸‹çš„æ•°æ®ï¼Œä»¥ä¾¿éšåŽå‘èµ·æ–­å¼€è¿žæŽ¥è¯·æ±‚==ã€‚
5. è€Œå®¢æˆ·ç«¯æŽ¥æ”¶åˆ°æœåŠ¡ç«¯çš„ ACKï¼Œå¹¶é€šè¿‡éªŒè¯åºåˆ—å·ç¡®è®¤å…¶æ”¶åˆ°åŽï¼Œè¾¹è¿›å…¥ ==FIN_WAIT2 çŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡ç«¯ç¡®è®¤æœåŠ¡ç«¯å¯ä»¥ç»“æŸåŽå†å‘é€çš„ FIN æŠ¥æ–‡==ã€‚
6. æœåŠ¡ç«¯å¤„ç†å®Œæ‰€æœ‰æ•°æ®ï¼Œç¡®ä¿è‡ªå·±å¯ä»¥æ–­å¼€è¿žæŽ¥åŽï¼Œå‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª FIN æŠ¥æ–‡ï¼Œç±»ä¼¼çš„æºå¸¦ä¸€ä¸ªåœ¨æœåŠ¡ç«¯åŠ¨æ€ç”Ÿæˆçš„åºåˆ—å·ï¼ŒéšåŽè¿›å…¥ ==LACK_ACK çŠ¶æ€ï¼Œæ„ä¸ºç­‰å¾…å®¢æˆ·ç«¯æœ€åŽçš„ç¡®è®¤==ã€‚
7. å®¢æˆ·ç«¯æ”¶åˆ° FIN æŠ¥æ–‡åŽï¼Œå›žå¤ ACK æŠ¥æ–‡å¹¶æºå¸¦æ”¶åˆ°çš„åºåˆ—å· + 1ï¼Œä¹‹åŽè¿›å…¥ TIME_WAIT çŠ¶æ€ã€‚==TIME_WAIT çŠ¶æ€è‡³å°‘ç­‰å¾… 2MSL==ã€‚
8. æœåŠ¡ç«¯æ”¶åˆ° ACK æŠ¥æ–‡åŽï¼Œè¿›å…¥ CLOSED çŠ¶æ€ï¼Œæ–­å¼€ TCP è¿žæŽ¥ã€‚
9. è€Œå®¢æˆ·ç«¯åœ¨ç­‰å¾… 2MSL åŽä¹Ÿè¿›å…¥ CLOSED çŠ¶æ€ã€‚
10. ==ä¸ºä»€ä¹ˆ TIME_WAIT è‡³å°‘è¦ç­‰å¾… 2MSL==ï¼Ÿ==MSL æ˜¯ä¸€ä¸ªæŠ¥æ–‡çš„æœ€å¤§å­˜æ´»æ—¶é—´==ï¼Œå¦‚æžœæœåŠ¡ç«¯åœ¨ LACK_ACK çŠ¶æ€ä¸‹ç­‰å¾… 1MSL åŽæ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯çš„ ACK æŠ¥æ–‡ï¼Œé‚£ä¹ˆæ­¤æŠ¥æ–‡å¿…å®šå·²ç»è¿‡æœŸäº†ã€‚æœåŠ¡ç«¯æ„è¯†åˆ° ACK æŠ¥æ–‡å¯èƒ½ç”±äºŽç½‘ç»œæ‹¥å¡žç­‰åŽŸå› æ²¡èƒ½æˆåŠŸé€è¾¾ï¼Œä¾¿èµ¶ç´§==é‡æ–°å‘é€ä¸€ä¸ª FIN æŠ¥æ–‡==ï¼Œæ„ä¸ºè®©å®¢æˆ·ç«¯é‡æ–°ç¡®è®¤ã€‚==è¿™ä¸€æ¥ä¸€å›žçš„æœ€é•¿æ—¶é—´æ­£æ˜¯ä¸¤ä¸ªæŠ¥æ–‡çš„æœ€å¤§å­˜æ´»æ—¶é—´ 2MSL==ã€‚å› æ­¤ ==TIME_WAIT è‡³å°‘ç­‰å¾… 2MSL å¯ä»¥ä¿è¯æ¥å¾—åŠæŽ¥æ”¶åˆ°æœåŠ¡ç«¯å¯èƒ½å†æ¬¡å‘é€çš„ FIN æŠ¥æ–‡==ï¼Œè¿™ä¹Ÿæ˜¯ TCP å¯é ä¼ è¾“æœåŠ¡çš„ä¸€ä¸ªä½“çŽ°ã€‚
11. å››æ¬¡æŒ¥æ‰‹ä¸»è¦åŽŸå› æ˜¯ï¼Œ==å®¢æˆ·ç«¯ä¸»åŠ¨==å‘èµ·æ–­å¼€è¿žæŽ¥çš„è¯·æ±‚åŽï¼Œ==æœåŠ¡å™¨å¯èƒ½ä»æœ‰æ•°æ®éœ€è¦å¤„ç†å’Œå‘é€==ï¼Œæ‰€ä»¥==éœ€è¦ç­‰å¾…æœåŠ¡å™¨å¤„ç†å®Œæ•°æ®==åŽï¼Œä¸»åŠ¨è°ƒç”¨æ–­å¼€å‡½æ•°ï¼Œå› æ­¤==æœåŠ¡ç«¯çš„ ACK å’Œ FIN éœ€è¦åˆ†å¼€å‘é€ï¼Œå°±éœ€è¦å››æ¬¡æŒ¥æ‰‹==ã€‚

==å‚è€ƒç­”æ¡ˆ==ï¼š

- å››æ¬¡æŒ¥æ‰‹ä¸»è¦åŽŸå› æ˜¯ï¼Œ==å®¢æˆ·ç«¯ä¸»åŠ¨==å‘èµ·æ–­å¼€è¿žæŽ¥çš„è¯·æ±‚åŽï¼Œ==æœåŠ¡å™¨å¯èƒ½ä»æœ‰æ•°æ®éœ€è¦å¤„ç†å’Œå‘é€==ï¼Œæ‰€ä»¥==éœ€è¦ç­‰å¾…æœåŠ¡å™¨å¤„ç†å®Œæ•°æ®==åŽï¼Œä¸»åŠ¨è°ƒç”¨æ–­å¼€å‡½æ•°ï¼Œå› æ­¤==æœåŠ¡ç«¯çš„ ACK å’Œ FIN éœ€è¦åˆ†å¼€å‘é€ï¼Œå°±éœ€è¦å››æ¬¡æŒ¥æ‰‹==ã€‚

---



### 4.TCPä¸ŽUDPæœ‰å“ªäº›åŒºåˆ«ï¼Ÿå„è‡ªåº”ç”¨åœºæ™¯ï¼Ÿ

==æˆ‘çš„å›žç­”==ï¼š

1. TCP åè®®æ˜¯æœ‰è¿žæŽ¥çš„åè®®ï¼Œæ¯”å¦‚å†æ­£å¼ä¼ è¾“æ•°æ®ä¹‹å‰ä¼šå…ˆè¿›è¡Œä¸‰æ¬¡æ¡æ‰‹ä¿è¯åŒå‘å‘é€æŽ¥æ”¶èƒ½åŠ›æ­£å¸¸ï¼Œè€Œåœ¨æ–­å¼€è¿žæŽ¥æ—¶ä¹Ÿä¼šè¿›è¡Œå››æ¬¡æŒ¥æ‰‹ä»¥ä¿è¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ•°æ®å¤„ç†å®Œæ¯•ã€‚è€Œ UDP æ˜¯æ— è¿žæŽ¥åè®®ã€‚
2. TCP åè®®æ—¶é¢å‘å­—èŠ‚æµçš„åè®®ï¼Œå¯ä»¥å°†ä¸€ä»½æ•°æ®æ‹†åˆ†æˆå¤šä»½æ•°æ®æŠ¥è¿›è¡Œå‘é€ã€‚è€Œ UDP æ—¶é¢å‘æŠ¥æ–‡çš„åè®®ï¼Œå³ä¸ä¼šå¯¹æŠ¥æ–‡è¿›è¡Œæ‹†åˆ†æˆ–é‡ç»„ã€‚
3. TCP åè®®æ˜¯å¯é çš„ä¼ è¾“åè®®ï¼Œæä¾›ç½‘ç»œæ‹¥å¡žæŽ§åˆ¶ä»¥åŠæŽ¥æ”¶æ–¹æµé‡æŽ§åˆ¶ä»¥é˜²æ­¢ä¼ è¾“æ•°æ®è¢«é˜»å¡žæˆ–ä¸¢å¼ƒï¼Œå¹¶ä¸”èƒ½ä¿è¯æŽ¥æ”¶æ–¹èƒ½æŒ‰é¡ºåºæŽ¥æ”¶å‘é€æ–¹å‘å‡ºçš„æŠ¥æ–‡ã€‚è€Œ UDP åè®®ä¸èƒ½ä¿è¯å¯é ä¼ è¾“ï¼Œæ¯”å¦‚å‘é€æ–¹å‘å‡ºæŠ¥æ–‡å’ŒæŽ¥æ”¶æ–¹æŽ¥æ”¶æŠ¥æ–‡çš„é¡ºåºä¸ä¸€å®šç›¸åŒã€‚
4. UDP æŠ¥æ–‡çš„é¦–éƒ¨å¼€é”€å¾ˆå°ï¼Œä¼ è¾“é€Ÿåº¦å¿«ã€‚è€Œ TCP æŠ¥æ–‡é¦–éƒ¨è¾ƒå¤§ï¼Œä¼ è¾“é€Ÿåº¦ä¹Ÿä¸åŠ UDP æŠ¥æ–‡ã€‚
5. å› æ­¤ä¼ è¾“å¯¹å‡†ç¡®æ€§è¦æ±‚é«˜ï¼Œæ€§èƒ½è¦æ±‚è¾ƒå®½æ¾çš„æ•°æ®ï¼Œå¦‚ç™»å½•å‡­è¯ï¼Œé‡è¦æ–‡ä»¶ï¼Œé‚®ä»¶ä¿¡æ¯å»ºè®®ä½¿ç”¨ TCPã€‚
6. è€Œå¯¹ä¼ è¾“é€Ÿåº¦è¦æ±‚é«˜ï¼Œä½†æ˜¯å…è®¸ä¼ è¾“å¤±è´¥æˆ–å¤±è¯¯çš„æ•°æ®å¯ä»¥ä½¿ç”¨ UDPï¼Œå¦‚åœ¨çº¿èŠå¤©ï¼Œè§†é¢‘é€šè¯ï¼Œå¹¿æ’­ã€‚

==å‚è€ƒç­”æ¡ˆ==ï¼š

- (1)TCPæ˜¯==å¯é ==ä¼ è¾“,UDPæ˜¯ä¸å¯é ä¼ è¾“;

	(2)TCPé¢å‘==è¿žæŽ¥==,UDPæ— è¿žæŽ¥;

	(3)TCPä¼ è¾“æ•°æ®==æœ‰åº==,UDPä¸ä¿è¯æ•°æ®çš„æœ‰åºæ€§;

	(4)TCP==ä¸ä¿å­˜æ•°æ®è¾¹ç•Œ==,UDPä¿ç•™æ•°æ®è¾¹ç•Œ;

	(5)TCP==ä¼ è¾“é€Ÿåº¦==ç›¸å¯¹UDPè¾ƒæ…¢;

	(6)TCPæœ‰==æµé‡æŽ§åˆ¶å’Œæ‹¥å¡žæŽ§åˆ¶==,UDPæ²¡æœ‰;

	(ï¼—)TCPæ˜¯==é‡é‡çº§åè®®==,UDPæ˜¯è½»é‡çº§åè®®;

	(ï¼˜)TCP==é¦–éƒ¨è¾ƒé•¿==20å­—èŠ‚,UDPé¦–éƒ¨è¾ƒçŸ­8å­—èŠ‚;

- åŸºäºŽ TCP å’Œ UDP çš„==å¸¸ç”¨åè®®==

	==HTTPã€HTTPS==ã€FTPã€TELNETã€==SMTP==(ç®€å•é‚®ä»¶ä¼ è¾“åè®®)åè®®åŸºäºŽ==å¯é çš„TCPåè®®==ã€‚

	==DNSã€DHCP==ã€TFTPã€SNMP(ç®€å•ç½‘ç»œç®¡ç†åè®®)ã€RIPåŸºäºŽ==ä¸å¯é çš„UDPåè®®==ã€‚

- ==TCP åº”ç”¨åœºæ™¯==ï¼š

	==æ•ˆçŽ‡è¦æ±‚ç›¸å¯¹ä½Žï¼Œä½†å¯¹å‡†ç¡®æ€§è¦æ±‚ç›¸å¯¹é«˜==çš„åœºæ™¯ã€‚å› ä¸ºä¼ è¾“ä¸­éœ€è¦å¯¹æ•°æ®ç¡®è®¤ã€é‡å‘ã€æŽ’åºç­‰æ“ä½œï¼Œç›¸æ¯”ä¹‹ä¸‹æ•ˆçŽ‡æ²¡æœ‰UDPé«˜ã€‚ä¸¾å‡ ä¸ªä¾‹å­ï¼š==æ–‡ä»¶ä¼ è¾“==ï¼ˆå‡†ç¡®é«˜è¦æ±‚é«˜ã€ä½†æ˜¯é€Ÿåº¦å¯ä»¥ç›¸å¯¹æ…¢ï¼‰ã€==æŽ¥å—é‚®ä»¶ã€è¿œç¨‹ç™»å½•==ã€‚

- ==UDP åº”ç”¨åœºæ™¯==ï¼š

	==æ•ˆçŽ‡è¦æ±‚ç›¸å¯¹é«˜ï¼Œå¯¹å‡†ç¡®æ€§è¦æ±‚ç›¸å¯¹ä½Ž==çš„åœºæ™¯ã€‚ä¸¾å‡ ä¸ªä¾‹å­ï¼š==QQèŠå¤©ã€åœ¨çº¿è§†é¢‘ã€ç½‘ç»œè¯­éŸ³ç”µè¯==ï¼ˆå³æ—¶é€šè®¯ï¼Œé€Ÿåº¦è¦æ±‚é«˜ï¼Œä½†æ˜¯å‡ºçŽ°å¶å°”æ–­ç»­ä¸æ˜¯å¤ªå¤§é—®é¢˜ï¼Œå¹¶ä¸”æ­¤å¤„å®Œå…¨ä¸å¯ä»¥ä½¿ç”¨é‡å‘æœºåˆ¶ï¼‰ã€==å¹¿æ’­é€šä¿¡==ï¼ˆå¹¿æ’­ã€å¤šæ’­ï¼‰

---



### 5.HTTP1.0ï¼Œ1.1ï¼Œ2.0 çš„ç‰ˆæœ¬åŒºåˆ«

==æˆ‘çš„å›žç­”==ï¼š

1. ==HTTP1.0 æ¯ä¸ª TCP è¿žæŽ¥åªèƒ½å‘é€ä¸€ä¸ªè¯·æ±‚==ï¼Œå¦‚æžœè¿˜éœ€å‘é€å…¶å®ƒçš„è¯·æ±‚ï¼Œé‚£ä¹ˆå°±éœ€è¦é‡æ–°å»ºç«‹è¿žæŽ¥ã€‚==æ–°å»ºè¿žæŽ¥çš„æˆæœ¬è¾ƒé«˜==ï¼Œæ¯”å¦‚éœ€è¦è¿›è¡Œä¸‰æ¬¡æ¡æ‰‹ï¼Œå› æ­¤å¦‚æžœè¯·æ±‚ä¸€ä¸ªéœ€è¦å¤§é‡å¤–éƒ¨èµ„æºçš„ç½‘é¡µï¼Œé‚£ä¹ˆè¿™ä¸ªç¼ºç‚¹å°±ä¼šè¿›ä¸€æ­¥è¢«æ”¾å¤§ï¼Œå› æ­¤ HTTP1.0 çš„æ•ˆçŽ‡è¾ƒä½Žã€‚
2. HTTP1.1 æ”¯æŒæŒä¹…è¿žæŽ¥å’Œç®¡é“ï¼Œ==æŒä¹…è¿žæŽ¥æŒ‡ä¸€ä¸ª TCP è¿žæŽ¥åœ¨å‘å‡ºä¸€ä¸ªè¯·æ±‚ä¹‹åŽä¸ä¼šç«‹å³æ–­å¼€==ã€‚è€Œ==ç®¡é“åˆ™æ˜¯åœ¨åŒä¸€ä¸ªè¿žæŽ¥é‡Œï¼Œå®¢æˆ·ç«¯å¯ä»¥å‘é€å¤šä¸ªè¯·æ±‚==ï¼ŒåŒæ—¶æœåŠ¡ç«¯å¯ä»¥å‘é€å¤šä¸ªå›žåº”ã€‚ä½†æ˜¯æ—¢ç„¶å…è®¸å‘é€å¤šä¸ªè¯·æ±‚ï¼Œå°±å¿…é¡»æœ‰æ–¹æ³•å¯ä»¥åŒºåˆ†æ¯ä¸ªå›žåº”ï¼ŒHTTP1.1 ä¸­é‡‡å–çš„æ–¹å¼æ˜¯åœ¨æŠ¥æ–‡ä¸­åŠ å…¥æŠ¥æ–‡é•¿åº¦ï¼Œè¿™æ ·æµè§ˆå™¨å°±èƒ½åˆ¤æ–­å“ªä¸€ä¸²å­—èŠ‚æµæ˜¯ä¸€ä¸ªå›žåº”äº†ã€‚
3. HTTP1.1 ä¸­çš„æ•°æ®ä½“æ—¢å¯ä»¥æ˜¯äºŒè¿›åˆ¶æµï¼Œä¹Ÿå¯ä»¥æ˜¯æ–‡æœ¬ã€‚è€Œåœ¨ ==HTTP2.0 ä¸­ï¼Œæ•°æ®ä½“åªèƒ½æ˜¯äºŒè¿›åˆ¶æµ==ï¼Œè€Œè¿™å°±==æ–¹ä¾¿å°†æ•°æ®åˆ†å‰²æˆæ›´å°çš„æ¶ˆæ¯å’Œå¸§==ï¼Œå¹¶å¯¹å®ƒä»¬==è¿›è¡ŒäºŒè¿›åˆ¶ç¼–ç ==ã€‚é™¤æ­¤ä»¥å¤–ï¼ŒHTTP2.0 æ”¯æŒå¤šè·¯å¤ç”¨ï¼Œå³å†ä¸€æ¬¡è¿žæŽ¥ä¸­ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å‡å¯ä»¥å‘é€å¤šä¸ªè¯·æ±‚å’Œå›žåº”ï¼Œä¸”ä¸ç”¨æŒ‰ç…§é¡ºåºä¸€ä¸€å¯¹åº”ï¼Œè€Œ==å¤šè·¯å¤ç”¨çš„å‰æåˆ™æ˜¯ä¸Šé¢æåˆ°çš„äºŒè¿›åˆ¶åˆ†å¸§==ã€‚

==å‚è€ƒç­”æ¡ˆ==ï¼š

- ==HTTP/1.0==ï¼š==HTTP/1.0è§„å®šæµè§ˆå™¨ä¸ŽæœåŠ¡å™¨åªä¿æŒçŸ­æš‚çš„è¿žæŽ¥ï¼Œæµè§ˆå™¨çš„æ¯æ¬¡è¯·æ±‚éƒ½éœ€è¦ä¸ŽæœåŠ¡å™¨å»ºç«‹ä¸€ä¸ªTCPè¿žæŽ¥ï¼ŒæœåŠ¡å™¨å®Œæˆè¯·æ±‚å¤„ç†åŽç«‹å³æ–­å¼€TCPè¿žæŽ¥==ã€‚



æš‚æ—¶æ­¢æ­¥äºŽæ­¤ï¼Œä¸»è¦æ„Ÿè§‰æœ‰ç‚¹åŽŒå€¦äº†ï¼Œå…ˆå­¦ä¸€äº›å…¶å®ƒçš„ä¸œè¥¿è°ƒèŠ‚ä¸€ä¸‹ã€‚

---



# 6.æ“ä½œç³»ç»Ÿ

### 1.è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æœ‰å“ªäº›ï¼Ÿ

1. ==ç®¡é“==ï¼š

	> - ==åŒ¿åç®¡é“==å°±æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„ `|` ï¼Œæ„ä¸ºæŠŠå‰ä¸€æ¡å‘½ä»¤çš„è¾“å‡ºä½œä¸ºåŽä¸€æ¡å‘½ä»¤çš„è¾“å…¥ã€‚
	> - ==å‘½åç®¡é“==åˆ™æ˜¯é€šè¿‡ `>` å’Œ `<` å®žçŽ°ï¼Œä½†æ˜¯==å‘½åç®¡é“ä¸­çš„æ•°æ®æ²¡æœ‰è¢«å¦ä¸€ä¸ªè¿›ç¨‹è¯»å–ï¼Œè¿™æ¡å‘½ä»¤å°±ä¼šä¸€ç›´åœç•™åœ¨è¿™é‡Œ==ã€‚
	> - å› æ­¤==ç®¡é“å°±åƒæ˜¯ç¼“å­˜==ï¼Œä¸€ä¸ªè¿›ç¨‹å§æ•°æ®æ”¾åœ¨ä¸€ä¸ªç¼“å­˜åŒºåŸŸï¼Œç­‰å¾…å…¶å®ƒè¿›ç¨‹åŽ»æ‹¿ï¼Œä½†æ˜¯==å¿…é¡»è¦ç­‰å¾…å…¶å®ƒè¿›ç¨‹æ‹¿èµ°è¿™ä»½æ•°æ®åŽï¼ŒåŽŸè¿›ç¨‹æ‰èƒ½è¿”å›ž==ï¼Œå› æ­¤ç®¡é“çš„==æ•ˆçŽ‡è¾ƒä¸ºä½Žä¸‹==ã€‚

2. ==æ¶ˆæ¯é˜Ÿåˆ—==ï¼š

	> - è¿™ç§é€šä¿¡æ–¹å¼ä¹Ÿ==ç±»ä¼¼äºŽç¼“å­˜==ï¼Œåªä¸è¿‡æ•°æ®çš„å‘é€æ–¹==åªéœ€æŠŠæ•°æ®ç”©åˆ°æ¶ˆæ¯é˜Ÿåˆ—å°±å¯ä»¥è¿”å›ž==ã€‚
	> - ç¼ºç‚¹æ˜¯å¦‚æžœ==æ•°æ®å ç”¨çš„å†…å­˜è¾ƒå¤§==ï¼Œä¸”è¿›ç¨‹ä¹‹é—´çš„==é€šä¿¡é¢‘ç¹==çš„è¯ï¼Œ==å‘é€æ¶ˆæ¯é˜¶æ®µå°±ä¼šå ç”¨å¾ˆå¤šæ—¶é—´==ã€‚

3. ==å…±äº«å†…å­˜==ï¼š

	> - ==å…±äº«å†…å­˜==è¿™ä¸ªé€šä¿¡æ–¹å¼å°±å¯ä»¥å¾ˆå¥½ç€==è§£å†³æ‹·è´æ‰€æ¶ˆè€—çš„æ—¶é—´==ã€‚
	> - ç³»ç»ŸåŠ è½½ä¸€ä¸ªè¿›ç¨‹çš„æ—¶å€™ï¼Œåˆ†é…ç»™è¿›ç¨‹çš„å†…å­˜å¹¶ä¸æ˜¯==å®žé™…ç‰©ç†å†…å­˜==ï¼Œè€Œæ˜¯==è™šæ‹Ÿå†…å­˜ç©ºé—´==ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è®©ä¸¤ä¸ªè¿›ç¨‹==å„è‡ªæ‹¿å‡ºä¸€å—è™šæ‹Ÿåœ°å€ç©ºé—´æ¥ï¼Œç„¶åŽæ˜ å°„åˆ°ç›¸åŒçš„ç‰©ç†å†…å­˜==ä¸­ï¼Œè¿™æ ·ï¼Œ==ä¸¤ä¸ªè¿›ç¨‹è™½ç„¶æœ‰ç€ç‹¬ç«‹çš„è™šæ‹Ÿå†…å­˜ç©ºé—´ï¼Œä½†æœ‰ä¸€éƒ¨åˆ†å´æ˜¯æ˜ å°„åˆ°ç›¸åŒçš„ç‰©ç†å†…å­˜==ï¼Œå°±å®Œæˆäº†==å†…å­˜å…±äº«==æœºåˆ¶äº†ã€‚

4. ==ä¿¡å·é‡==ï¼š

	> - ä¿¡å·é‡çš„æœ¬è´¨å°±æ˜¯ä¸€ä¸ª==è®¡æ•°å™¨==ï¼Œç”¨æ¥å®žçŽ°è¿›ç¨‹ä¹‹é—´çš„äº’æ–¥ä¸ŽåŒæ­¥ï¼Œä»¥==è§£å†³å¤šä¸ªçº¿ç¨‹å¹¶å‘è®¿é—®å…±äº«å†…å­˜è€Œå¸¦æ¥çš„çº¿ç¨‹å®‰å…¨é—®é¢˜==ã€‚
	> - ä¾‹å¦‚ä¿¡å·é‡çš„åˆå§‹å€¼æ˜¯ 1ï¼Œç„¶åŽ a è¿›ç¨‹æ¥è®¿é—®==å†…å­˜1==çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±æŠŠä¿¡å·é‡çš„å€¼è®¾ä¸º 0ï¼Œç„¶åŽè¿›ç¨‹b ä¹Ÿè¦æ¥è®¿é—®==å†…å­˜1==çš„æ—¶å€™ï¼Œçœ‹åˆ°ä¿¡å·é‡çš„å€¼ä¸º 0 å°±çŸ¥é“å·²ç»æœ‰è¿›ç¨‹åœ¨è®¿é—®==å†…å­˜1==äº†ï¼Œè¿™ä¸ªæ—¶å€™è¿›ç¨‹ b å°±ä¼šè®¿é—®ä¸äº†==å†…å­˜1==ã€‚æ‰€ä»¥è¯´ï¼Œä¿¡å·é‡ä¹Ÿæ˜¯è¿›ç¨‹ä¹‹é—´çš„ä¸€ç§é€šä¿¡æ–¹å¼ã€‚

5. ==Socket==

---



### 2.è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«

1. ==è¿›ç¨‹ç›¸å½“ä¸€ä¸ªå®¹å™¨ï¼Œè€Œçº¿ç¨‹åªæ˜¯é‡Œé¢çš„ä¸€ä¸ªä¸œè¥¿==ï¼Œå¹¶ä¸”==ç¨‹åºæœ¬è´¨æ˜¯çº¿ç¨‹åœ¨æ‰§è¡Œ==ï¼ŒåŸºäºŽè¿™ä¸ªï¼Œå†åŽ»å›žç­”ä»–ä»¬çš„å…¶ä»–åŒºåˆ«ï¼Œæ¯”å¦‚é€šä¿¡ï¼Œå†…å­˜ç»“æž„ï¼Œç­‰ç­‰ã€‚

---



# 7.Linux

## 1.Linux æ€§èƒ½æŽ’æŸ¥ï¼ˆé‡ç‚¹ï¼‰

### 1.ä½ ä½¿ç”¨è¿‡ç›‘æŽ§è½¯ä»¶å—ï¼Ÿè¯´è¯´å…¶ç‰¹ç‚¹

1. ==top==

	> - å®ƒæä¾›äº†å®žæ—¶çš„ç³»ç»ŸçŠ¶æ€ï¼ŒåŒ…æ‹¬==CPUä½¿ç”¨çŽ‡ã€å†…å­˜ä½¿ç”¨ã€è¿›ç¨‹ä¿¡æ¯==ç­‰ã€‚å®ƒéžå¸¸é€‚åˆäºŽå¿«é€ŸæŸ¥çœ‹ç³»ç»Ÿçš„å½“å‰çŠ¶æ€ã€‚
	> - ![image-20240520091954865](bgwROUND1.assets/image-20240520091954865.png)

2. ==htop==

	> - ç›¸æ¯”äºŽtopï¼Œhtopæä¾›äº†ä¸€ä¸ªæ›´ä¸ºå‹å¥½çš„ç”¨æˆ·ç•Œé¢ï¼Œæ”¯æŒ==å½©è‰²æ˜¾ç¤º==ï¼Œå¯ä»¥==é€šè¿‡é”®ç›˜æ“ä½œæ¥ç®¡ç†è¿›ç¨‹ï¼ˆå¦‚æ€æ­»è¿›ç¨‹ï¼‰==ã€‚å®ƒè¿˜æ˜¾ç¤ºäº†==CPUçš„ä½¿ç”¨æƒ…å†µåˆ†å¸ƒåœ¨æ‰€æœ‰æ ¸å¿ƒä¸Šçš„è§†å›¾==ï¼Œä½¿å¾—ä¿¡æ¯çš„èŽ·å–æ›´ç›´è§‚ã€‚
	> - ![image-20240520092638325](bgwROUND1.assets/image-20240520092638325.png)

3. ==iotop==

	> - è¿™ä¸ªå·¥å…·==ä¸“æ³¨äºŽç£ç›˜I/O==ï¼Œå®ƒæ˜¾ç¤ºäº†==å“ªäº›è¿›ç¨‹æ­£åœ¨è¿›è¡Œç£ç›˜è¯»å†™æ“ä½œä»¥åŠæ“ä½œçš„å¼ºåº¦==ã€‚è¿™==å¯¹äºŽè¯†åˆ«ç£ç›˜I/Oç“¶é¢ˆéžå¸¸æœ‰ç”¨==ã€‚
	> - ![image-20240520093420901](bgwROUND1.assets/image-20240520093420901.png)

4. ==vmstat==

	> - å®ƒæä¾›äº†å…³äºŽ==è™šæ‹Ÿå†…å­˜ã€è¿›ç¨‹ã€CPUæ´»åŠ¨ä»¥åŠI/Oé˜»å¡ž==çš„ä¿¡æ¯ã€‚vmstatèƒ½å¤Ÿä»¥æ—¶é—´åºåˆ—çš„æ–¹å¼æ˜¾ç¤ºç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡ï¼Œæœ‰åŠ©äºŽè¯†åˆ«æ€§èƒ½è¶‹åŠ¿ã€‚
	> - ![image-20240520093724588](bgwROUND1.assets/image-20240520093724588.png)

5. ==dstat==

	> - dstatæ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥çœ‹ä½œæ˜¯==vmstatã€iotopå’Œifstatçš„ç»“åˆä½“==ã€‚å®ƒèƒ½å¤ŸæŠ¥å‘Šå…³äºŽ==CPUã€å†…å­˜ã€ç£ç›˜ä»¥åŠç½‘ç»œæ€§èƒ½çš„ç»¼åˆè§†å›¾==ï¼Œæ”¯æŒè‡ªå®šä¹‰è¾“å‡ºä»¥å…³æ³¨ç‰¹å®šçš„æ€§èƒ½æŒ‡æ ‡ã€‚
	> - ![image-20240520094045813](bgwROUND1.assets/image-20240520094045813.png)

6. ==Prometheuså’ŒGrafana==

	> - è¿™æ˜¯ä¸€ç§æ›´çŽ°ä»£çš„ç›‘æŽ§è§£å†³æ–¹æ¡ˆï¼ŒPrometheusè´Ÿè´£æ”¶é›†å’Œå­˜å‚¨æ€§èƒ½æ•°æ®ï¼Œè€ŒGrafanaç”¨äºŽæ•°æ®çš„å¯è§†åŒ–ã€‚è¿™ç§ç»„åˆæ”¯æŒé«˜åº¦è‡ªå®šä¹‰çš„ä»ªè¡¨æ¿ï¼Œèƒ½å¤Ÿæ˜¾ç¤ºå¤æ‚çš„æ—¶é—´åºåˆ—æ•°æ®ï¼Œé€‚ç”¨äºŽå¤§è§„æ¨¡çŽ¯å¢ƒçš„ç›‘æŽ§ã€‚

7. ==ä¾‹å­==

	> - å¦‚æžœæˆ‘ä»¬æƒ³è¦ç›‘æŽ§ä¸€ä¸ªWebæœåŠ¡å™¨çš„æ€§èƒ½ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`top`æˆ–`htop`æ¥è§‚å¯Ÿå“ªäº›è¿›ç¨‹æ¶ˆè€—äº†æœ€å¤šçš„CPUå’Œå†…å­˜èµ„æºã€‚å¦‚æžœå‘çŽ°ç£ç›˜I/Oæ˜¯æ€§èƒ½ç“¶é¢ˆï¼Œé‚£ä¹ˆ`iotop`å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç¡®å®šæ˜¯å“ªä¸ªè¿›ç¨‹å¯¼è‡´çš„ç£ç›˜åŽ‹åŠ›ã€‚è€Œå¯¹äºŽé•¿æœŸçš„æ€§èƒ½ç›‘æŽ§å’Œè¶‹åŠ¿åˆ†æžï¼Œåˆ™å¯ä»¥éƒ¨ç½²`Prometheus`å’Œ`Grafana`ï¼Œé€šè¿‡ç²¾ç¾Žçš„å›¾è¡¨æ¥ç›´è§‚å±•ç¤ºæ€§èƒ½æ•°æ®ï¼Œä»Žè€Œå¸®åŠ©æˆ‘ä»¬åšå‡ºç›¸åº”çš„ä¼˜åŒ–å†³ç­–ã€‚

---



### 2.Linux å¦‚ä½•æŸ¥çœ‹ CPU è¿è¡ŒçŠ¶æ€?

1. ==topå‘½ä»¤==ï¼š

	> - è¿™æ˜¯æœ€åŸºç¡€çš„å‘½ä»¤ä¹‹ä¸€ï¼Œå¯ä»¥å®žæ—¶æ˜¾ç¤ºç³»ç»Ÿè¿›ç¨‹çš„åŠ¨æ€è¿è¡Œæƒ…å†µï¼ŒåŒ…æ‹¬==CPUä½¿ç”¨çŽ‡ã€å†…å­˜ä½¿ç”¨ã€ä»¥åŠè¿›ç¨‹ä¿¡æ¯==ã€‚åœ¨topç•Œé¢ä¸­ï¼ŒCPUçŠ¶æ€æ˜¾ç¤ºåœ¨é¡¶éƒ¨ï¼ŒåŒ…æ‹¬å„ä¸ªæ ¸å¿ƒçš„ä½¿ç”¨æƒ…å†µã€‚

2. ==htopå‘½ä»¤==ï¼š

	> - htopæ˜¯topå‘½ä»¤çš„ä¸€ä¸ªå¢žå¼ºç‰ˆï¼Œæä¾›äº†ä¸€ä¸ªæ›´å‹å¥½çš„ç”¨æˆ·ç•Œé¢ï¼Œæ”¯æŒ==å½©è‰²æ˜¾ç¤º==ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡==é”®ç›˜ç›´æŽ¥æ“ä½œè¿›ç¨‹ï¼ˆå¦‚ç»“æŸè¿›ç¨‹ï¼‰==ã€‚å®ƒæ˜¾ç¤ºäº†æ¯ä¸ªCPUæ ¸å¿ƒçš„ä½¿ç”¨æƒ…å†µï¼Œå¹¶ä¸”æä¾›äº†æ›´å¤šçš„ä¿¡æ¯å’Œæ›´å¥½çš„è§†è§‰ä½“éªŒã€‚

3. ==vmstatå‘½ä»¤==ï¼š

	> - vmstatï¼ˆVirtual Memory Statisticsï¼‰å‘½ä»¤æŠ¥å‘Šå…³äºŽ==è™šæ‹Ÿå†…å­˜ã€è¿›ç¨‹ã€CPUæ´»åŠ¨==ç­‰çš„ä¿¡æ¯ã€‚å®ƒå¯ä»¥æ˜¾ç¤º==ç³»ç»Ÿçš„å¹³å‡è´Ÿè½½ä»¥åŠCPUçš„ç©ºé—²æ—¶é—´ã€ç”¨æˆ·æ—¶é—´ã€ç³»ç»Ÿæ—¶é—´å’Œç­‰å¾…I/Oçš„æ—¶é—´==ã€‚
	> - ![image-20240520214251288](bgwROUND1.assets/image-20240520214251288.png)

4. ==mpstatå‘½ä»¤==ï¼š

	> - ==mpstatæ˜¯sysstatåŒ…çš„ä¸€éƒ¨åˆ†==ï¼Œç”¨äºŽæ˜¾ç¤ºå„ä¸ªCPUæˆ–è€…æ ¸å¿ƒçš„æ€§èƒ½ç»Ÿè®¡ã€‚å®ƒå¯ä»¥æŠ¥å‘Š==CPUçš„ä½¿ç”¨ç»†èŠ‚==ï¼ŒåŒ…æ‹¬==æ¯ä¸ªCPUåœ¨ç”¨æˆ·æ¨¡å¼ã€ç³»ç»Ÿæ¨¡å¼ä¸‹çš„æ—¶é—´èŠ±è´¹ï¼Œä»¥åŠç©ºé—²æ—¶é—´==ç­‰ã€‚
	> - ![image-20240520214552056](bgwROUND1.assets/image-20240520214552056.png)

5. ==lscpuå‘½ä»¤==ï¼š

	> - lscpuæ˜¾ç¤ºäº†CPUæž¶æž„çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬==CPUçš„æ•°é‡ã€æ¯ä¸ªCPUçš„æ ¸æ•°ã€æ¯ä¸ªæ ¸çš„çº¿ç¨‹æ•°ã€CPUçš„å®¶æ—ã€åž‹å·==ç­‰ã€‚è¿™ä¸ªå‘½ä»¤æ›´å¤šåœ°æä¾›äº†==CPUçš„é™æ€ä¿¡æ¯==ï¼Œè€Œä¸æ˜¯åŠ¨æ€çš„æ€§èƒ½æ•°æ®ã€‚
	> - ![image-20240520214829490](bgwROUND1.assets/image-20240520214829490.png)

6. ==cat /proc/cpuinfo==ï¼š

	> - è¿™ä¸ªå‘½ä»¤ `cat /proc/cpuinfo` æä¾›äº†å…³äºŽ==CPUçš„è¯¦ç»†ä¿¡æ¯==ï¼ŒåŒ…æ‹¬==æ¯ä¸ªCPUçš„åž‹å·ã€æ ¸å¿ƒæ•°ã€é€Ÿåº¦==ç­‰ã€‚`/proc/cpuinfo`æ–‡ä»¶åŒ…å«äº†å½“å‰ç³»ç»ŸCPUçš„æ‰€æœ‰è¯¦ç»†ä¿¡æ¯ã€‚

---



### 3Linux å¦‚ä½•æŸ¥çœ‹å†…å­˜çš„ä½¿ç”¨æƒ…å†µï¼Ÿ

1. ==freeå‘½ä»¤==ï¼š

	> - `free`å‘½ä»¤æ˜¯æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µæœ€ç›´æŽ¥çš„æ–¹æ³•ã€‚å®ƒæ˜¾ç¤ºäº†==æ€»å†…å­˜ã€å·²ä½¿ç”¨å†…å­˜ã€ç©ºé—²å†…å­˜ã€ç¼“å­˜å’Œç¼“å†²åŒºä½¿ç”¨çš„å†…å­˜==ä»¥åŠ==äº¤æ¢ç©ºé—´==çš„ä½¿ç”¨æƒ…å†µã€‚é€šè¿‡`free -h`å¯ä»¥èŽ·å¾—æ˜“äºŽé˜…è¯»çš„æ ¼å¼ã€‚
	> - ![image-20240521105903943](bgwROUND1.assets/image-20240521105903943.png)

2. ==topå‘½ä»¤==ï¼š

	> - `top`å‘½ä»¤ä¸ä»…å¯ä»¥æŸ¥çœ‹CPUçš„ä½¿ç”¨æƒ…å†µï¼Œä¹Ÿèƒ½æ˜¾ç¤º==å†…å­˜çš„æ€»ä½“ä½¿ç”¨çŠ¶å†µï¼ŒåŒ…æ‹¬æ€»å†…å­˜ã€ç©ºé—²å†…å­˜ã€ç¼“å†²åŒºå’Œç¼“å­˜==çš„ä½¿ç”¨æƒ…å†µã€‚æ­¤å¤–ï¼Œå®ƒè¿˜èƒ½æ˜¾ç¤ºæ¯ä¸ª==è¿›ç¨‹çš„å†…å­˜å ç”¨==ã€‚

3. ==htopå‘½ä»¤==ï¼š

	> - ä¸Ž`top`ç±»ä¼¼ï¼Œ`htop`æä¾›äº†ä¸€ä¸ªæ›´æ˜“äºŽä½¿ç”¨çš„ç•Œé¢æ¥æ˜¾ç¤ºç³»ç»Ÿçš„==å†…å­˜ä½¿ç”¨æƒ…å†µï¼ŒåŒ…æ‹¬ç‰©ç†å†…å­˜å’Œäº¤æ¢ç©ºé—´çš„ä½¿ç”¨==ã€‚å®ƒè¿˜å…è®¸ç”¨æˆ·é€šè¿‡==å›¾å½¢ç•Œé¢==ç®¡ç†è¿›ç¨‹ï¼ŒåŒ…æ‹¬æŸ¥çœ‹==è¿›ç¨‹çš„å†…å­˜å ç”¨==ã€‚

4. ==vmstatå‘½ä»¤==ï¼š

	> - `vmstat`æŠ¥å‘Šäº†==è™šæ‹Ÿå†…å­˜==çš„ç»Ÿè®¡ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç³»ç»Ÿçš„==äº¤æ¢æ´»åŠ¨ã€ç©ºé—²å†…å­˜é‡ä»¥åŠå†…å­˜çš„ä½¿ç”¨==æƒ…å†µã€‚å®ƒå¯¹äºŽ==åˆ†æžç³»ç»Ÿçš„å†…å­˜åŽ‹åŠ›å’Œæ€§èƒ½ç“¶é¢ˆ==éžå¸¸æœ‰ç”¨ã€‚

5. ==/proc/meminfoæ–‡ä»¶==ï¼š

	> - é€šè¿‡æŸ¥çœ‹`/proc/meminfo`æ–‡ä»¶ï¼Œå¯ä»¥èŽ·å–å…³äºŽ==ç³»ç»Ÿå†…å­˜ä½¿ç”¨çš„è¯¦ç»†ä¿¡æ¯==ï¼ŒåŒ…æ‹¬==æ€»å†…å­˜ã€ç©ºé—²å†…å­˜ã€å¯ç”¨å†…å­˜ã€ç¼“å­˜ã€äº¤æ¢ç©ºé—´==ç­‰ã€‚ä½¿ç”¨`cat /proc/meminfo`å‘½ä»¤å¯ä»¥æŸ¥çœ‹è¿™äº›è¯¦ç»†æ•°æ®ã€‚

6. ==sarå‘½ä»¤==ï¼š

	> - `sar`æ˜¯ä¸€ä¸ªç³»ç»Ÿæ´»åŠ¨æŠ¥å‘Šå·¥å…·ï¼Œå®ƒå¯ä»¥æŠ¥å‘ŠåŽ†å²æ•°æ®å’Œå®žæ—¶æ•°æ®ï¼ŒåŒ…æ‹¬CPUä½¿ç”¨ã€å†…å­˜ä½¿ç”¨ã€I/Oç­‰ã€‚å¯¹äºŽå†…å­˜ä½¿ç”¨æƒ…å†µï¼Œ`sar -r`å¯ä»¥æ˜¾ç¤ºå®žæ—¶çš„å†…å­˜ä½¿ç”¨æƒ…å†µï¼ŒåŒ…æ‹¬äº¤æ¢ç©ºé—´çš„ä½¿ç”¨ã€‚
	>
	> - æ— æ³•æ‰“å¼€ /var/log/sysstat/sa21 çš„è§£å†³åŠžæ³•ï¼š
	>
	> 	- ```bash
	> 		sudo vim /etc/default/sysstat
	> 																																							
	> 		#
	> 		# Default settings for /etc/init.d/sysstat, /etc/cron.d/sysstat
	> 		# and /etc/cron.daily/sysstat files
	> 		#
	> 																																							
	> 		# Should sadc collect system activity informations? Valid values
	> 		# are "true" and "false". Please do not put other values, they
	> 		# will be overwritten by debconf!
	> 		ENABLED="true" # å°† false æ”¹ä¸º true
	> 		```
	>
	> 	- é‡å¯ sysstat æœåŠ¡ï¼š
	>
	> 		```java
	> 		sudo systemctl restart sysstat
	> 		```
	>
	> - ![image-20240521111906159](bgwROUND1.assets/image-20240521111906159.png)

7. è¿™äº›å·¥å…·å’Œå‘½ä»¤ä»Žä¸åŒçš„è§’åº¦æä¾›äº†å†…å­˜ä½¿ç”¨æƒ…å†µçš„è§†å›¾ï¼Œå¯ä»¥å¸®åŠ©ç³»ç»Ÿç®¡ç†å‘˜å’Œç”¨æˆ·ç›‘æŽ§å†…å­˜çš„ä½¿ç”¨æƒ…å†µï¼Œè¯†åˆ«å¯èƒ½çš„å†…å­˜æ³„æ¼æˆ–æ˜¯ä¸ºç³»ç»Ÿä¼˜åŒ–æä¾›æ•°æ®æ”¯æŒã€‚ä¾‹å¦‚ï¼Œ==ä½¿ç”¨`free`å‘½ä»¤å¯ä»¥å¿«é€Ÿäº†è§£ç³»ç»Ÿçš„å†…å­˜æ€»è§ˆ==ï¼Œè€Œ==`htop`æä¾›äº†ä¸€ç§äº¤äº’å¼çš„æ–¹å¼æ¥æ·±å…¥æ¯ä¸ªè¿›ç¨‹çš„å†…å­˜==ä½¿ç”¨è¯¦æƒ…ã€‚

---



### 4.Linux å¦‚ä½•æŸ¥çœ‹ç¡¬ç›˜çš„è¯»å†™æ€§èƒ½ï¼Ÿ

1. ==hdparmå‘½ä»¤==ï¼š

	> - `hdparm`æ˜¯ä¸€ä¸ªæŸ¥çœ‹å’Œè®¾ç½®SATA/IDEè®¾å¤‡æ€§èƒ½çš„å‘½ä»¤è¡Œå·¥å…·ã€‚å®ƒå¯ä»¥ç”¨æ¥è¿›è¡Œç£ç›˜çš„è¯»å–æ€§èƒ½æµ‹è¯•ã€‚ä¾‹å¦‚ï¼Œ`hdparm -Tt /dev/sda`å‘½ä»¤å¯ä»¥æµ‹è¯•è®¾å¤‡`/dev/sda`çš„==ç¼“å­˜è¯»å–æ€§èƒ½ï¼ˆ`-T`ï¼‰==å’Œ==ç£ç›˜è¯»å–æ€§èƒ½ï¼ˆ`-t`ï¼‰==ã€‚
	> - ![image-20240521113243837](bgwROUND1.assets/image-20240521113243837.png)

2. ==ddå‘½ä»¤==ï¼š

	> - `dd`å‘½ä»¤é€šå¸¸ç”¨äºŽå¤åˆ¶å’Œè½¬æ¢æ–‡ä»¶ï¼Œä½†ä¹Ÿå¯ä»¥ç”¨æ¥æµ‹è¯•ç£ç›˜çš„è¯»å†™æ€§èƒ½ã€‚é€šè¿‡å†™å…¥ä¸€ä¸ªå¤§æ–‡ä»¶åˆ°ç£ç›˜ï¼Œå¹¶è¯»å–å®ƒï¼Œå¯ä»¥ç®€å•åœ°æµ‹é‡ç£ç›˜çš„å†™å…¥å’Œè¯»å–é€ŸçŽ‡ã€‚ä¾‹å¦‚ï¼Œ==ä½¿ç”¨`dd if=/dev/zero of=testfile bs=1G count=1 oflag=dsync`å¯ä»¥æµ‹è¯•å†™é€Ÿåº¦==ï¼Œ==ä½¿ç”¨`dd if=testfile of=/dev/null bs=1G count=1`å¯ä»¥æµ‹è¯•è¯»é€Ÿåº¦==ã€‚
	>
	> - æµ‹è¯•è¯»é€Ÿåº¦
	>
	> 	![image-20240521142045917](bgwROUND1.assets/image-20240521142045917.png)
	>
	> - æµ‹è¯•å†™é€Ÿåº¦
	>
	> 	![image-20240521142134122](bgwROUND1.assets/image-20240521142134122.png)

3. ==iostatå‘½ä»¤==ï¼š

	> - `iostat`æ˜¯ä¸€ä¸ªç”¨äºŽç›‘æŽ§ç³»ç»Ÿ==è¾“å…¥/è¾“å‡ºè®¾å¤‡è´Ÿè½½==çš„å·¥å…·ã€‚å®ƒå¯ä»¥æŠ¥å‘Š==CPUç»Ÿè®¡ä¿¡æ¯å’Œæ‰€æœ‰å—è®¾å¤‡çš„I/Oç»Ÿè®¡ä¿¡æ¯==ï¼ŒåŒ…æ‹¬==æ¯ä¸ªç£ç›˜çš„è¯»å†™é€Ÿåº¦ã€æ¯æ¬¡è¯»å†™æ“ä½œçš„æ•°æ®é‡ä»¥åŠæ€»çš„è¯»å†™è¯·æ±‚==ç­‰ã€‚`iostat -dx 1`å‘½ä»¤å¯ä»¥æ¯ç§’æ›´æ–°è¿™äº›ç»Ÿè®¡ä¿¡æ¯ã€‚

4. ==iotopå‘½ä»¤==ï¼š

	> - `iotop`æ˜¯ä¸€ä¸ªå®žæ—¶çš„I/Oç›‘è§†å·¥å…·ï¼Œå®ƒå¯ä»¥æ˜¾ç¤º==å“ªäº›è¿›ç¨‹==åœ¨è¿›è¡Œ==è¯»å†™æ“ä½œä»¥åŠè¿™äº›æ“ä½œçš„é€Ÿåº¦==ã€‚è¿™å¯¹äºŽ==è¯†åˆ«å“ªä¸ªè¿›ç¨‹å¯¹ç£ç›˜æ€§èƒ½å½±å“æœ€å¤§==éžå¸¸æœ‰ç”¨ã€‚

5. ==fioå·¥å…·==ï¼š

	> - `fio`æ˜¯ä¸€ä¸ªçµæ´»çš„I/Oæµ‹è¯•å·¥å…·ï¼Œå¯ä»¥æ¨¡æ‹Ÿä¸åŒç±»åž‹çš„I/Oè´Ÿè½½ï¼ŒåŒ…æ‹¬éšæœºè¯»å†™å’Œé¡ºåºè¯»å†™ã€‚å®ƒæ”¯æŒå¤šç§I/Oå¼•æ“Žï¼Œå¦‚POSIX AIOã€libaioç­‰ï¼Œå¹¶å¯ä»¥è¯¦ç»†é…ç½®æµ‹è¯•çš„å‚æ•°ï¼Œå¦‚å—å¤§å°ã€é˜Ÿåˆ—æ·±åº¦ç­‰ã€‚`fio`èƒ½å¤Ÿæä¾›==è¯¦ç»†çš„æ€§èƒ½æµ‹è¯•æŠ¥å‘Š==ï¼ŒåŒ…æ‹¬IOPSï¼ˆ==æ¯ç§’è¾“å…¥/è¾“å‡ºæ“ä½œæ¬¡æ•°ï¼‰ã€å»¶è¿Ÿå’Œåžåé‡==ç­‰ã€‚

6. ä½¿ç”¨è¿™äº›å·¥å…·ï¼Œä½ å¯ä»¥ä»Žä¸åŒçš„è§’åº¦è¯„ä¼°ç¡¬ç›˜çš„è¯»å†™æ€§èƒ½ã€‚ä¾‹å¦‚ï¼Œ==`hdparm`å’Œ`dd`é€‚åˆå¿«é€Ÿç®€å•==çš„æ€§èƒ½æµ‹è¯•ï¼Œè€Œ==`iostat`å’Œ`iotop`åˆ™é€‚ç”¨äºŽå®žæ—¶ç›‘æŽ§==ã€‚å¯¹äºŽéœ€è¦æ·±å…¥åˆ†æžå’Œ==å®šåˆ¶æµ‹è¯•åœºæ™¯çš„æƒ…å†µï¼Œ`fio`==æ˜¯ä¸€ä¸ªéžå¸¸å¼ºå¤§çš„é€‰æ‹©ã€‚

----



### 5.Linux æœºå™¨ä¸Šè·Ÿè¸ªç³»ç»Ÿäº‹ä»¶çš„å®ˆæŠ¤è¿›ç¨‹åæ˜¯ä»€ä¹ˆï¼Ÿ

1. åœ¨Linuxæœºå™¨ä¸Šï¼Œè·Ÿè¸ªç³»ç»Ÿäº‹ä»¶çš„å®ˆæŠ¤è¿›ç¨‹é€šå¸¸æ˜¯`syslogd`æˆ–`rsyslogd`ã€‚
2. ==syslogd==ï¼šè¿™æ˜¯æœ€åŸºæœ¬çš„ç³»ç»Ÿæ—¥å¿—å®ˆæŠ¤è¿›ç¨‹ï¼Œè´Ÿè´£æ”¶é›†ç³»ç»Ÿçš„æ—¥å¿—ä¿¡æ¯å¹¶æ ¹æ®é…ç½®å†³å®šå¦‚ä½•å¤„ç†è¿™äº›æ—¥å¿—ï¼Œæ¯”å¦‚å°†å…¶å†™å…¥åˆ°ä¸åŒçš„æ—¥å¿—æ–‡ä»¶ä¸­ã€‚
3. ==rsyslogd==ï¼šæ˜¯ä¸€ä¸ªå¢žå¼ºç‰ˆçš„syslogå®ˆæŠ¤è¿›ç¨‹ï¼Œæä¾›äº†æ›´é«˜çš„æ€§èƒ½å’Œæ›´çµæ´»çš„é…ç½®é€‰é¡¹ã€‚==`rsyslog`å¯ä»¥æŽ¥æ”¶æ—¥å¿—æ•°æ®æ¥è‡ªäºŽæœ¬åœ°ç³»ç»Ÿä»¥åŠç½‘ç»œï¼Œæ”¯æŒå„ç§æ—¥å¿—æ•°æ®çš„æ ¼å¼å’Œç›®çš„åœ°==ï¼ŒåŒ…æ‹¬æ•°æ®åº“ã€ç”µå­é‚®ä»¶ä»¥åŠæ”¯æŒTCPå’ŒUDPçš„è¿œç¨‹æ—¥å¿—æœåŠ¡å™¨ã€‚==`rsyslog`ç”±äºŽå…¶å¼ºå¤§çš„åŠŸèƒ½å’Œçµæ´»æ€§ï¼Œå·²ç»æˆä¸ºè®¸å¤šçŽ°ä»£Linuxå‘è¡Œç‰ˆçš„é»˜è®¤æ—¥å¿—ç³»ç»Ÿå®ˆæŠ¤è¿›ç¨‹==ã€‚

---



### 6.CPU è´Ÿè½½å’Œ CPU åˆ©ç”¨çŽ‡çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ

1. ==CPUåˆ©ç”¨çŽ‡==

	> - ==å®šä¹‰==ï¼šCPUåˆ©ç”¨çŽ‡æŒ‡çš„æ˜¯CPUåœ¨==ä¸€æ®µæ—¶é—´==å†…å¤„äºŽ==éžç©ºé—²çŠ¶æ€çš„ç™¾åˆ†æ¯”==ã€‚å®ƒåæ˜ äº†CPUæ­£åœ¨æ‰§è¡Œè¿›ç¨‹çš„æ—¶é—´æ¯”ä¾‹ï¼ŒåŒ…æ‹¬ç”¨æˆ·ç©ºé—´ç¨‹åºå’Œå†…æ ¸ç©ºé—´ç¨‹åºçš„æ‰§è¡Œæ—¶é—´ã€‚
	> - ==è¡¨è¾¾æ–¹å¼==ï¼šé€šå¸¸ä»¥ç™¾åˆ†æ¯”è¡¨ç¤ºï¼Œä¾‹å¦‚ï¼Œå¦‚æžœCPUåˆ©ç”¨çŽ‡æ˜¯25%ï¼Œè¿™æ„å‘³ç€CPUåœ¨è¿‡åŽ»çš„æµ‹é‡å‘¨æœŸå†…æœ‰==25%çš„æ—¶é—´==ç”¨äºŽæ‰§è¡Œè¿›ç¨‹ï¼Œè€Œ==å‰©ä½™çš„75%æ—¶é—´==å¤„äºŽç©ºé—²çŠ¶æ€ã€‚
	> - ==é‡è¦æ€§==ï¼šCPUåˆ©ç”¨çŽ‡æ˜¯è¡¡é‡å•ä¸ªCPUæˆ–æ•´ä¸ªç³»ç»Ÿæ€§èƒ½çš„ä¸€ä¸ªç›´æŽ¥æŒ‡æ ‡ã€‚==é«˜CPUåˆ©ç”¨çŽ‡å¯èƒ½è¡¨ç¤ºCPUç¹å¿™ï¼Œæ­£åœ¨é¢‘ç¹åœ°å¤„ç†ä»»åŠ¡==ï¼Œä½†å¦‚æžœé•¿æ—¶é—´å¤„äºŽæžé«˜æ°´å¹³ï¼Œå¯èƒ½è¡¨ç¤ºCPUæˆä¸ºæ€§èƒ½ç“¶é¢ˆã€‚

2. ==CPUè´Ÿè½½==

	> - ==å®šä¹‰==ï¼šCPUè´Ÿè½½æŒ‡çš„æ˜¯åœ¨ç‰¹å®š==æ—¶é—´é—´éš”å†…==ï¼Œç³»ç»Ÿä¸­å¤„äºŽ==è¿è¡ŒçŠ¶æ€å’Œç­‰å¾…çŠ¶æ€çš„å¹³å‡è¿›ç¨‹æ•°==ã€‚ç­‰å¾…çŠ¶æ€æŒ‡çš„æ˜¯ç­‰å¾…CPUèµ„æºæˆ–æ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹ã€‚
	> - ==è¡¨è¾¾æ–¹å¼==ï¼šé€šå¸¸ä»¥ä¸€ç»„æ•°å­—è¡¨ç¤ºï¼Œåˆ†åˆ«å¯¹åº”è¿‡åŽ»1åˆ†é’Ÿã€5åˆ†é’Ÿå’Œ15åˆ†é’Ÿçš„å¹³å‡è´Ÿè½½å€¼ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç³»ç»Ÿçš„CPUè´Ÿè½½ä¸º==1.00, 0.50, 0.25==ï¼Œè¿™è¡¨ç¤ºåœ¨==è¿‡åŽ»1åˆ†é’Ÿå†…å¹³å‡æœ‰1ä¸ªè¿›ç¨‹å¤„äºŽè¿è¡Œæˆ–ç­‰å¾…CPUï¼Œè¿‡åŽ»5åˆ†é’Ÿå†…å¹³å‡ä¸º0.5ä¸ªï¼Œè¿‡åŽ»15åˆ†é’Ÿå†…å¹³å‡ä¸º0.25ä¸ª==ã€‚
	> - ==é‡è¦æ€§==ï¼šCPUè´Ÿè½½æä¾›äº†ç³»ç»Ÿéœ€æ±‚å¯¹CPUèµ„æºçš„æ€»ä½“è¦æ±‚çš„è§†å›¾ï¼Œå®ƒåŒ…æ‹¬äº†å½“å‰æ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹ä»¥åŠç­‰å¾…CPUèµ„æºçš„è¿›ç¨‹ã€‚==è´Ÿè½½è¿‡é«˜å¯èƒ½æ„å‘³ç€æœ‰è®¸å¤šè¿›ç¨‹ç«žäº‰CPUèµ„æº==ï¼Œè¿™å¯èƒ½å¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚

3. ==åŒºåˆ«==

	> - ==æœ¬è´¨åŒºåˆ«==ï¼š==CPUåˆ©ç”¨çŽ‡==åæ˜ äº†==CPUæ´»è·ƒçš„ç¨‹åº¦==ï¼Œè€Œ==CPUè´Ÿè½½==è¡¨ç¤ºç³»ç»Ÿå¯¹CPUèµ„æºçš„==éœ€æ±‚é‡==ã€‚
	> - ==å½±å“å› ç´ ==ï¼š==CPUåˆ©ç”¨çŽ‡==ä»…è€ƒè™‘äº†==CPUçš„æ´»åŠ¨æ—¶é—´==ï¼Œè€Œ==CPUè´Ÿè½½==åˆ™åŒ…æ‹¬äº†==æ‰€æœ‰è¯·æ±‚CPUèµ„æºçš„è¿›ç¨‹==ï¼Œæ— è®ºå®ƒä»¬æ˜¯å¦æ­£åœ¨CPUä¸Šè¿è¡Œã€‚
	> - ==ä½¿ç”¨åœºæ™¯==ï¼š==CPUåˆ©ç”¨çŽ‡==é€‚åˆè¯„ä¼°==CPUçš„å·¥ä½œå¼ºåº¦==ï¼Œ==CPUè´Ÿè½½==åˆ™æ›´é€‚åˆè¯„ä¼°ç³»ç»Ÿæ•´ä½“çš„æ€§èƒ½çŠ¶æ€å’Œ==CPUèµ„æºéœ€æ±‚==ã€‚

---



### 7.CPU è´Ÿè½½å¾ˆé«˜ï¼Œåˆ©ç”¨çŽ‡å´å¾ˆä½Žè¯¥æ€Žä¹ˆåŠžï¼Ÿ

1. å½“é‡åˆ°CPUè´Ÿè½½å¾ˆé«˜è€ŒCPUåˆ©ç”¨çŽ‡å´å¾ˆä½Žçš„æƒ…å†µæ—¶ï¼Œè¿™é€šå¸¸æŒ‡ç¤ºç³»ç»Ÿæœ‰å¾ˆå¤šè¿›ç¨‹ç­‰å¾…èµ„æºï¼ˆä¸ä¸€å®šæ˜¯CPUèµ„æºï¼‰ï¼Œä½†å®žé™…ä¸Š==CPUå¹¶æ²¡æœ‰è¢«å……åˆ†åˆ©ç”¨==ã€‚è¿™ç§æƒ…å†µå¯èƒ½æ˜¯ç”±äºŽå¤šç§åŽŸå› é€ æˆçš„ï¼Œä¾‹å¦‚==I/Oç­‰å¾…ã€ç½‘ç»œå»¶è¿Ÿæˆ–è¿›ç¨‹é—´çš„é”ç­‰å¾…==ã€‚

2. ==æ£€æŸ¥I/Oç­‰å¾…==ï¼š

	> - é«˜çš„I/Oç­‰å¾…å¯èƒ½å¯¼è‡´è¿›ç¨‹ä¸èƒ½æœ‰æ•ˆæ‰§è¡Œï¼Œå¢žåŠ äº†ç³»ç»Ÿçš„è´Ÿè½½è€Œä¸å½±å“CPUåˆ©ç”¨çŽ‡ã€‚ä½¿ç”¨`iostat`ã€`vmstat`ç­‰å·¥å…·å¯ä»¥å¸®åŠ©è¯†åˆ«æ˜¯å¦å­˜åœ¨I/Oç“¶é¢ˆã€‚

3. ==åˆ†æžè¿›ç¨‹çŠ¶æ€==ï¼š

	> - ä½¿ç”¨`top`æˆ–`htop`å‘½ä»¤æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€ï¼Œ==å…³æ³¨å¤„äºŽç­‰å¾…ï¼ˆDçŠ¶æ€ï¼‰çš„è¿›ç¨‹==ã€‚è¿™äº›è¿›ç¨‹å¯èƒ½æ­£åœ¨ç­‰å¾…I/Oæ“ä½œå®Œæˆï¼Œä»Žè€Œå½±å“äº†ç³»ç»Ÿçš„å“åº”æ—¶é—´ã€‚

4. ä¼˜åŒ–==åº”ç”¨ç¨‹åº==ï¼š

	> - æ£€æŸ¥å’Œä¼˜åŒ–åº”ç”¨ç¨‹åºçš„ä»£ç ï¼Œå‡å°‘ä¸å¿…è¦çš„I/Oæ“ä½œï¼Œæˆ–è€…æ”¹è¿›æ•°æ®åº“æŸ¥è¯¢æ•ˆçŽ‡ï¼Œå¯ä»¥å‡å°‘å¯¹èµ„æºçš„ç­‰å¾…æ—¶é—´ã€‚

5. å¢žåŠ æˆ–==ä¼˜åŒ–ç¡¬ä»¶==ï¼š

	> - å¦‚æžœç¡¬ä»¶èµ„æºç¡®å®žæ˜¯ç“¶é¢ˆï¼ˆä¾‹å¦‚ï¼Œç£ç›˜I/Oæ€§èƒ½ä½Žï¼‰ï¼Œè€ƒè™‘å‡çº§ç¡¬ä»¶æˆ–è€…ä½¿ç”¨æ›´å¿«çš„å­˜å‚¨è§£å†³æ–¹æ¡ˆï¼Œå¦‚SSDä»£æ›¿ä¼ ç»Ÿç¡¬ç›˜ã€‚

6. ä½¿ç”¨==å¹¶å‘æˆ–å¼‚æ­¥ç¼–ç¨‹==æ¨¡åž‹ï¼š

	> - å¯¹äºŽç½‘ç»œå¯†é›†æˆ–I/Oå¯†é›†çš„åº”ç”¨ï¼Œä½¿ç”¨å¹¶å‘æˆ–å¼‚æ­¥çš„ç¼–ç¨‹æ¨¡åž‹å¯ä»¥æé«˜åº”ç”¨æ€§èƒ½ï¼Œ==å‡å°‘å› ç­‰å¾…I/Oæ“ä½œ==è€Œå¯¼è‡´çš„é«˜è´Ÿè½½é—®é¢˜ã€‚

7. è°ƒæ•´==ç³»ç»Ÿé…ç½®==ï¼š

	> - æ ¹æ®åº”ç”¨çš„éœ€æ±‚è°ƒæ•´ç³»ç»Ÿé…ç½®ï¼Œæ¯”å¦‚è°ƒæ•´æ–‡ä»¶ç³»ç»Ÿçš„æŒ‚è½½é€‰é¡¹ã€ç½‘ç»œå‚æ•°æˆ–å†…æ ¸å‚æ•°ï¼Œä»¥å‡å°‘ç³»ç»Ÿçš„ç­‰å¾…æ—¶é—´ã€‚

8. åˆ†æžç½‘ç»œå»¶è¿Ÿï¼š

	> - å¯¹äºŽä¾èµ–å¤–éƒ¨æœåŠ¡çš„åº”ç”¨ï¼Œç½‘ç»œå»¶è¿Ÿä¹Ÿå¯èƒ½å¯¼è‡´é«˜è´Ÿè½½ã€‚ä½¿ç”¨ç½‘ç»œç›‘æŽ§å·¥å…·å’Œåˆ†æžæ–¹æ³•æ¥è¯†åˆ«å¹¶è§£å†³ç½‘ç»œç“¶é¢ˆé—®é¢˜ã€‚

9. æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—ï¼š

	> - ç³»ç»Ÿæ—¥å¿—ï¼ˆå¦‚`/var/log/messages`ã€`/var/log/syslog`ç­‰ï¼‰å¯èƒ½åŒ…å«æœ‰ç”¨çš„ä¿¡æ¯ï¼Œå¯ä»¥å¸®åŠ©è¯†åˆ«ç³»ç»Ÿæ€§èƒ½é—®é¢˜çš„åŽŸå› ã€‚

---



### 8.CPU è´Ÿè½½å¾ˆä½Žï¼Œåˆ©ç”¨çŽ‡å´å¾ˆé«˜è¯¥æ€Žä¹ˆåŠžï¼Ÿ

1. å½“CPUè´Ÿè½½å¾ˆä½Žè€ŒCPUåˆ©ç”¨çŽ‡å´å¾ˆé«˜çš„æƒ…å†µå‘ç”Ÿæ—¶ï¼Œè¿™é€šå¸¸æ„å‘³ç€ç³»ç»Ÿä¸­æœ‰==å°‘æ•°å‡ ä¸ªè¿›ç¨‹å ç”¨äº†å¤§é‡çš„CPUèµ„æº==ï¼Œè€Œå…¶ä»–è¿›ç¨‹å¹¶æ²¡æœ‰äº§ç”Ÿå¤ªå¤šçš„CPUè´Ÿè·ã€‚è¿™ç§æƒ…å†µå¯èƒ½å¯¼è‡´ç³»ç»Ÿå“åº”å˜æ…¢ï¼Œç‰¹åˆ«æ˜¯å½“==é«˜CPUåˆ©ç”¨çŽ‡çš„è¿›ç¨‹å ç”¨äº†å¤§éƒ¨åˆ†æˆ–å…¨éƒ¨CPUèµ„æº==æ—¶ã€‚

2. ==è¯†åˆ«é«˜CPUä½¿ç”¨çš„è¿›ç¨‹==

	> - ä½¿ç”¨`top`æˆ–==`htop`å‘½ä»¤æ¥è¯†åˆ«å“ªäº›è¿›ç¨‹æ­£åœ¨å ç”¨å¤§é‡çš„CPUèµ„æº==ã€‚è¿™å°†å¸®åŠ©ä½ äº†è§£æ˜¯å“ªä¸ªåº”ç”¨æˆ–æœåŠ¡å¯¼è‡´äº†é«˜CPUåˆ©ç”¨çŽ‡ã€‚

3. åˆ†æž==è¿›ç¨‹è¡Œä¸º==

	> - å¯¹äºŽå ç”¨CPUèµ„æºçš„è¿›ç¨‹ï¼Œè¿›è¡Œè¿›ä¸€æ­¥åˆ†æžä»¥äº†è§£å…¶è¡Œä¸ºã€‚å¦‚æžœæ˜¯ä½ çš„åº”ç”¨ç¨‹åºï¼Œæ£€æŸ¥ä»£ç ä¸­æ˜¯å¦å­˜åœ¨==æ— é™å¾ªçŽ¯ã€è¿‡åº¦çš„è®¡ç®—æˆ–å…¶ä»–æ•ˆçŽ‡ä½Žä¸‹çš„æ“ä½œ==ã€‚

4. ä¼˜åŒ–æˆ–æ›´æ–°åº”ç”¨

	> - å¦‚æžœç¡®å®šæŸä¸ªåº”ç”¨ç¨‹åºæ˜¯é—®é¢˜çš„æ ¹æºï¼Œå°è¯•ä¼˜åŒ–å…¶æ€§èƒ½ï¼Œå‡å°‘ä¸å¿…è¦çš„CPUæ¶ˆè€—ã€‚å¦‚æžœæ˜¯ç¬¬ä¸‰æ–¹åº”ç”¨ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰æ›´æ–°æˆ–è¡¥ä¸å¯ç”¨ï¼Œæˆ–è€…è”ç³»ä¾›åº”å•†å¯»æ±‚å¸®åŠ©ã€‚

5. è°ƒæ•´==ç³»ç»Ÿæˆ–åº”ç”¨é…ç½®==

	> - æŸäº›æƒ…å†µä¸‹ï¼Œè°ƒæ•´åº”ç”¨æˆ–ç³»ç»Ÿçš„é…ç½®è®¾ç½®å¯ä»¥å‡å°‘CPUçš„ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œ==å‡å°‘æ•°æ®åº“æŸ¥è¯¢çš„é¢‘çŽ‡ï¼Œè°ƒæ•´ç¼“å­˜è®¾ç½®ï¼Œæˆ–è€…æ›´æ”¹æœåŠ¡çš„å¹¶å‘è®¾ç½®==ã€‚

6. åˆ©ç”¨niceå’Œcpulimitå·¥å…·

	> - ä½¿ç”¨==`nice`å‘½ä»¤é™ä½Žè¿›ç¨‹çš„ä¼˜å…ˆçº§ï¼Œè®©å…¶ä»–æ›´é‡è¦çš„è¿›ç¨‹æœ‰æ›´å¤šçš„CPUæ—¶é—´==ã€‚==`cpulimit`å·¥å…·å¯ä»¥é™åˆ¶è¿›ç¨‹çš„CPUä½¿ç”¨çŽ‡==ï¼Œé˜²æ­¢å®ƒä»¬å ç”¨è¿‡å¤šçš„CPUæ—¶é—´ã€‚

7. ==è´Ÿè½½å‡è¡¡==

	> - å¦‚æžœè¿è¡Œåœ¨å¤šæ ¸CPUç³»ç»Ÿä¸Šï¼Œè€ƒè™‘ä½¿ç”¨ä»»åŠ¡è°ƒåº¦æˆ–è´Ÿè½½å‡è¡¡æŠ€æœ¯ï¼Œå°†==å·¥ä½œè´Ÿè½½åˆ†æ•£åˆ°ä¸åŒçš„CPUæˆ–æ ¸å¿ƒä¸Š==ï¼Œä»¥é¿å…å•ä¸ªCPUè¿‡è½½ã€‚

8. æ‰©å±•æˆ–å‡çº§ç¡¬ä»¶

	> - å¦‚æžœä¼˜åŒ–å’Œé…ç½®è°ƒæ•´ä¸èƒ½è§£å†³é—®é¢˜ï¼Œä¸”åº”ç”¨ç¡®å®žéœ€è¦æ›´å¤šçš„CPUèµ„æºï¼Œè€ƒè™‘==æ‰©å±•ç³»ç»Ÿèµ„æºæˆ–å‡çº§ç¡¬ä»¶==ä»¥æä¾›æ›´å¤šçš„å¤„ç†èƒ½åŠ›ã€‚

9. ==ç›‘æŽ§å’Œé¢„è­¦==

	> - å®žæ–½ç³»ç»Ÿç›‘æŽ§å’Œé¢„è­¦æœºåˆ¶ï¼Œä»¥ä¾¿==åœ¨CPUåˆ©ç”¨çŽ‡å¼‚å¸¸å‡é«˜æ—¶åŠæ—¶å¾—åˆ°é€šçŸ¥==ï¼Œå¯ä»¥ä½¿ç”¨å¦‚==Prometheuså’ŒGrafana==ç­‰å·¥å…·æ¥å®žçŽ°ã€‚

---



## 2.Linux å‘½ä»¤è€ƒå¯Ÿ

### 1.å¦‚ä½•æŸ¥çœ‹å ç”¨ç«¯å£8080 çš„è¿›ç¨‹ ï¼Ÿ

1. ä½¿ç”¨`netstat`å‘½ä»¤

	å¦‚æžœä½ çš„ç³»ç»Ÿä¸Šå®‰è£…äº†`netstat`ï¼Œå¯ä»¥ä½¿ç”¨ï¼š

	```bash
	sudo netstat -ltnp | grep ':8080'
	```

2. ä½¿ç”¨`lsof`å‘½ä»¤

	å¦ä¸€ä¸ªé€‰é¡¹æ˜¯ä½¿ç”¨`lsof`å‘½ä»¤ï¼š

	```bash
	sudo lsof -i :8080
	```

	- `-i :8080`é€‰é¡¹æŒ‡å®šæŸ¥æ‰¾æ‰€æœ‰ä½¿ç”¨ç«¯å£8080çš„è¿›ç¨‹ã€‚

---



### 2.Linuxå¦‚ä½•æŸ¥è¯¢ç«¯å£å ç”¨å¹¶æ€æŽ‰å ç”¨ç«¯å£çš„è¿›ç¨‹?

1. ```bash
	sudo kill PID
	```

	æˆ–è€…å¼ºåˆ¶ç»ˆæ­¢ï¼š

	```bash
	sudo kill -9 PID
	```

---



### 3.ç®€è¿°Linuxç»ˆæ­¢è¿›ç¨‹ç”¨ä»€ä¹ˆå‘½ä»¤ï¼Ÿ

1. ==ä½¿ç”¨`kill`å‘½ä»¤==

	`kill`å‘½ä»¤é€šè¿‡æŒ‡å®šè¿›ç¨‹IDï¼ˆPIDï¼‰æ¥å‘é€ä¿¡å·ç»™è¿›ç¨‹ã€‚

	- ==å‘é€SIGTERM==ï¼ˆé»˜è®¤ä¿¡å·ï¼Œå…è®¸è¿›ç¨‹ä¼˜é›…åœ°æ¸…ç†å’Œé€€å‡ºï¼‰ï¼š

	```bash
	kill PID
	```

	- ==å‘é€SIGKILL==ï¼ˆå¼ºåˆ¶ç»ˆæ­¢è¿›ç¨‹ï¼Œä¸èƒ½è¢«è¿›ç¨‹æ•èŽ·æˆ–å¿½ç•¥ï¼‰ï¼š

	```bash
	kill -9 PID
	```

2. ==ä½¿ç”¨`pkill`å‘½ä»¤==

	`pkill`å‘½ä»¤æ ¹æ®è¿›ç¨‹åæ¥å‘é€ä¿¡å·ï¼Œè¿™å¯¹äºŽä¸çŸ¥é“PIDçš„æƒ…å†µå¾ˆæœ‰ç”¨ã€‚

	- å‘é€SIGTERMç»™æŒ‡å®šåç§°çš„æ‰€æœ‰è¿›ç¨‹ï¼š

	```bash
	pkill è¿›ç¨‹å
	```

3. ==ä½¿ç”¨`killall`å‘½ä»¤==

	`killall`å‘½ä»¤ä¹Ÿæ˜¯æ ¹æ®è¿›ç¨‹åæ¥å‘é€ä¿¡å·ï¼Œä½†ä¸Ž`pkill`ä¸åŒçš„æ˜¯ï¼Œ`killall`åœ¨æŸäº›ç³»ç»Ÿä¸Šï¼ˆå¦‚Linuxï¼‰ä½œç”¨äºŽæ‰€æœ‰åŒ¹é…åç§°çš„è¿›ç¨‹ï¼Œè€Œåœ¨å…¶ä»–ç³»ç»Ÿï¼ˆå¦‚Solarisï¼‰åˆ™å®Œå…¨ä¸åŒã€‚

	- å‘é€SIGTERMç»™æŒ‡å®šåç§°çš„æ‰€æœ‰è¿›ç¨‹ï¼š

	```bash
	killall è¿›ç¨‹å
	```

---



### 4.ç®€è¿°du å’Œ df å‘½ä»¤çš„åŒºåˆ«ï¼Ÿ

1. duï¼ˆDisk Usageï¼‰
	- ==ç”¨é€”==ï¼š`du`å‘½ä»¤ç”¨äºŽè®¡ç®—æ–‡ä»¶å’Œç›®å½•æ‰€å ç”¨çš„ç£ç›˜ç©ºé—´å¤§å°ã€‚å®ƒå¯ä»¥æä¾›å…³äºŽå•ä¸ªæ–‡ä»¶ã€ç›®å½•æˆ–æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­å„ä¸ªæ–‡ä»¶å’Œç›®å½•æ‰€ä½¿ç”¨çš„ç©ºé—´é‡çš„è¯¦ç»†ä¿¡æ¯ã€‚
	- ==å·¥ä½œæ–¹å¼==ï¼š`du`é€’å½’åœ°æ£€æŸ¥æŒ‡å®šç›®å½•ï¼ˆé»˜è®¤ä¸ºå½“å‰ç›®å½•ï¼‰ï¼ŒæŠ¥å‘Šæ¯ä¸ªå­ç›®å½•å’Œæ–‡ä»¶æ‰€ä½¿ç”¨çš„ç£ç›˜ç©ºé—´ã€‚
	- ==è¾“å‡º==ï¼šæ˜¾ç¤ºçš„æ˜¯æ–‡ä»¶å’Œç›®å½•çš„ç£ç›˜ä½¿ç”¨æƒ…å†µï¼Œé€šå¸¸ä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œä½†å¯ä»¥é€šè¿‡é€‰é¡¹è°ƒæ•´ä¸ºæ›´æ˜“è¯»çš„æ ¼å¼ï¼ˆå¦‚KBã€MBã€GBï¼‰ã€‚
	- ==ç”¨ä¾‹==ï¼šæ‰¾å‡ºå ç”¨å¤§é‡ç£ç›˜ç©ºé—´çš„æ–‡ä»¶å’Œç›®å½•ï¼Œå¸®åŠ©ç”¨æˆ·ç®¡ç†å’Œæ¸…ç†ç£ç›˜ç©ºé—´ã€‚
	- ![image-20240521215247265](bgwROUND1.assets/image-20240521215247265.png)
2. dfï¼ˆDisk Freeï¼‰
	- ==ç”¨é€”==ï¼š`df`å‘½ä»¤ç”¨äºŽæ˜¾ç¤ºæ–‡ä»¶ç³»ç»Ÿçš„æ€»ç©ºé—´ã€å·²ä½¿ç”¨ç©ºé—´ã€å¯ç”¨ç©ºé—´ä»¥åŠæŒ‚è½½ç‚¹ä¿¡æ¯ã€‚å®ƒæä¾›äº†ä¸€ä¸ªé«˜å±‚æ¬¡çš„ç£ç›˜ä½¿ç”¨æ¦‚è§ˆã€‚
	- ==å·¥ä½œæ–¹å¼==ï¼š`df`æ£€æŸ¥æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„ç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µï¼ŒåŒ…æ‹¬æ‰€æœ‰æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿã€‚
	- ==è¾“å‡º==ï¼šæ˜¾ç¤ºçš„æ˜¯æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿçº§åˆ«çš„ç£ç›˜ä½¿ç”¨æƒ…å†µï¼ŒåŒ…æ‹¬æ€»å¤§å°ã€å·²ç”¨ç©ºé—´ã€å¯ç”¨ç©ºé—´å’Œä½¿ç”¨çŽ‡ï¼Œä»¥åŠæ–‡ä»¶ç³»ç»Ÿçš„æŒ‚è½½ç‚¹ã€‚
	- ==ç”¨ä¾‹==ï¼šç›‘æŽ§å’Œç®¡ç†ç³»ç»Ÿçš„æ•´ä½“ç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µï¼Œç¡®ä¿è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´ä¾›ç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºä½¿ç”¨ã€‚
	- ![image-20240521215306670](bgwROUND1.assets/image-20240521215306670.png)
3. ä¸»è¦åŒºåˆ«
	- ==ç²’åº¦==ï¼š==`du`æä¾›äº†æ›´ç»†ç²’åº¦çš„ä¿¡æ¯==ï¼Œå¯ä»¥é’ˆå¯¹å•ä¸ªæ–‡ä»¶å’Œç›®å½•ï¼›è€Œ==`df`æä¾›äº†æ–‡ä»¶ç³»ç»Ÿçº§åˆ«==çš„å®è§‚è§†å›¾ã€‚
	- ==ç›®çš„==ï¼š`du`ä¸»è¦ç”¨äºŽåˆ†æž==ç‰¹å®šæ–‡ä»¶å’Œç›®å½•==çš„ç©ºé—´å ç”¨æƒ…å†µï¼›`df`ç”¨äºŽæŸ¥çœ‹==æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿ==çš„ç©ºé—´ä½¿ç”¨æƒ…å†µã€‚
	- ==ä½¿ç”¨åœºæ™¯==ï¼šå¦‚æžœä½ æƒ³çŸ¥é“==æŸä¸ªç›®å½•æ ‘ä¸­å“ªäº›æ–‡ä»¶æˆ–å­ç›®å½•å ç”¨äº†å¤§é‡ç©ºé—´ï¼Œä½¿ç”¨`du`==ï¼›å¦‚æžœä½ æƒ³æ£€æŸ¥==ç³»ç»Ÿä¸Šæœ‰å“ªäº›æ–‡ä»¶ç³»ç»Ÿã€å®ƒä»¬å„è‡ªçš„å®¹é‡å’Œä½¿ç”¨æƒ…å†µï¼Œä½¿ç”¨`df`==ã€‚

---



### 5.è¯¯æ“ä½œï¼Œæ‰§è¡Œäº†rm -rf \* ï¼Œä¼šæœ‰å“ªäº›æƒ…å†µå‘ç”Ÿï¼Ÿè¯·ä¸¾ä¾‹ï¼Ÿ

1. ==ä¾‹å­==
	- ==ä¸ªäººæ•°æ®ä¸¢å¤±==ï¼šå¦‚æžœä½ åœ¨`~/Documents`æ‰§è¡Œäº†`rm -rf *`ï¼Œå°†ä¼šåˆ é™¤ä½ æ‰€æœ‰çš„æ–‡æ¡£ã€‚
	- ==ç³»ç»Ÿç ´å==ï¼šä»¥rootç”¨æˆ·åœ¨`/`æ‰§è¡Œè¯¥å‘½ä»¤ï¼Œå¯èƒ½å¯¼è‡´==ç³»ç»Ÿç«‹å³å´©æºƒï¼Œé‡å¯åŽæ— æ³•å†æ¬¡å¯åŠ¨==ï¼Œå› ä¸º==å…³é”®çš„å¯åŠ¨æ–‡ä»¶å’Œé…ç½®å·²è¢«åˆ é™¤==ã€‚
	- ==æœåŠ¡å¤±è´¥==ï¼šåœ¨`/var/log`æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ä¼š==åˆ é™¤æ‰€æœ‰æ—¥å¿—æ–‡ä»¶ï¼Œå¯èƒ½å¯¼è‡´æ— æ³•è·Ÿè¸ªç³»ç»Ÿé—®é¢˜æˆ–æœåŠ¡çŠ¶æ€==ã€‚
2. ==é¢„é˜²æŽªæ–½==
	- ==è°¨æ…Žä½¿ç”¨rootæƒé™==ï¼šé¿å…ä»¥rootç”¨æˆ·æ‰§è¡Œå‘½ä»¤ï¼Œé™¤éžç»å¯¹å¿…è¦ã€‚
	- ==ä½¿ç”¨ç»å¯¹è·¯å¾„==ï¼šåœ¨ä½¿ç”¨`rm`å‘½ä»¤æ—¶å°½é‡ä½¿ç”¨å®Œæ•´çš„ç»å¯¹è·¯å¾„ï¼Œå¹¶ä»”ç»†æ£€æŸ¥è·¯å¾„æ˜¯å¦æ­£ç¡®ã€‚
	- ==å¤‡ä»½==ï¼š==å®šæœŸå¤‡ä»½é‡è¦æ•°æ®å’Œé…ç½®æ–‡ä»¶==ã€‚
	- ==ä½¿ç”¨å®‰å…¨æŽªæ–½==ï¼šåœ¨åˆ é™¤å¤§é‡æ–‡ä»¶ä¹‹å‰ï¼Œå¯ä»¥å…ˆä½¿ç”¨`ls`æˆ–å…¶ä»–å‘½ä»¤ç¡®è®¤æ–‡ä»¶åˆ—è¡¨ï¼Œæˆ–è€…å…ˆç§»åŠ¨åˆ°ä¸´æ—¶ç›®å½•è€Œä¸æ˜¯ç›´æŽ¥åˆ é™¤ã€‚

----



### 6.å¦‚ä½•æŸ¥çœ‹ http çš„å¹¶å‘è¯·æ±‚æ•°ä¸Žå…¶ TCP è¿žæŽ¥çŠ¶æ€ï¼Ÿ

1. ==ä½¿ç”¨`netstat`å‘½ä»¤==

	`netstat`æ˜¯ä¸€ä¸ªéžå¸¸æœ‰ç”¨çš„å‘½ä»¤ï¼Œå¯ä»¥æ˜¾ç¤ºç½‘ç»œè¿žæŽ¥ã€è·¯ç”±è¡¨ã€æŽ¥å£ç»Ÿè®¡ç­‰ä¿¡æ¯ã€‚è¦æŸ¥çœ‹TCPè¿žæŽ¥çš„çŠ¶æ€ï¼ŒåŒ…æ‹¬ä¸ŽHTTPæœåŠ¡å™¨ç›¸å…³çš„è¿žæŽ¥ï¼Œä½ å¯ä»¥ä½¿ç”¨ï¼š

	```bash
	netstat -an | grep ':80'
	```

	- `-a`é€‰é¡¹è¡¨ç¤ºæ˜¾ç¤º==æ‰€æœ‰è¿žæŽ¥å’Œç›‘å¬ç«¯å£==ã€‚
	- `-n`é€‰é¡¹è¡¨ç¤º==ä»¥æ•°å­—å½¢å¼æ˜¾ç¤ºåœ°å€å’Œç«¯å£å·==ï¼Œä¸è¿›è¡Œåç§°è§£æžï¼ˆæ›´å¿«ï¼‰ã€‚
	- `grep`ç”¨äºŽè¿‡æ»¤å‡ºç‰¹å®šç«¯å£çš„è¿žæŽ¥ï¼ˆHTTPé»˜è®¤æ˜¯80ç«¯å£ï¼ŒHTTPSæ˜¯443ç«¯å£ï¼‰ã€‚

2. ==ä½¿ç”¨`ss`å‘½ä»¤==

	`ss`æ˜¯å¦ä¸€ä¸ªå®žç”¨å·¥å…·ï¼Œç”¨äºŽæŸ¥çœ‹å¥—æŽ¥å­—ç»Ÿè®¡ä¿¡æ¯ã€‚å®ƒè¢«è®¤ä¸ºæ˜¯`netstat`çš„çŽ°ä»£æ›¿ä»£å“ï¼Œæä¾›äº†æ›´å¤šçš„ä¿¡æ¯å’Œæ›´å¿«çš„æ‰§è¡Œé€Ÿåº¦ã€‚ç±»ä¼¼åœ°ï¼Œè¦æŸ¥çœ‹HTTPæˆ–HTTPSè¿žæŽ¥ï¼Œå¯ä»¥ä½¿ç”¨ï¼š

	```bash
	ss -tan | grep ':80'
	```

	- `-t`è¡¨ç¤ºæ˜¾ç¤º==TCPå¥—æŽ¥å­—==ã€‚
	- `-a`è¡¨ç¤ºæ˜¾ç¤º==æ‰€æœ‰å¥—æŽ¥å­—==ã€‚
	- `-n`è¡¨ç¤ºä¸è§£æžæœåŠ¡åç§°ã€‚

---



## 3.Linux æ—¥å¿—

### 1.å¦‚ä½•åŠ¨æ€ç›‘å¬ Linux æ—¥å¿— ï¼Ÿ

1. ==ä½¿ç”¨ `tail` å‘½ä»¤==

	`tail` å‘½ä»¤å¯ä»¥ç”¨æ¥æŸ¥çœ‹æ–‡ä»¶çš„æœ€åŽå‡ è¡Œå†…å®¹ã€‚å½“==ä¸Ž `-f` å‚æ•°ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œ`tail -f` ä¼šæŒç»­ç›‘è§†æŒ‡å®šçš„æ–‡ä»¶ï¼Œå½“æ–‡ä»¶å¢žé•¿æ—¶ï¼Œæ–°æ·»åŠ çš„å†…å®¹ä¼šå®žæ—¶æ˜¾ç¤ºå‡ºæ¥==ã€‚è¿™æ˜¯æœ€å¸¸è§å’Œç®€å•çš„åŠ¨æ€ç›‘å¬æ—¥å¿—æ–‡ä»¶çš„æ–¹æ³•ã€‚

	ä¾‹å¦‚ï¼ŒåŠ¨æ€ç›‘å¬ç³»ç»Ÿæ¶ˆæ¯æ—¥å¿—ï¼š

	```bash
	tail -f /var/log/messages
	```

2. ==ä½¿ç”¨ `less` å‘½ä»¤==

	`less` å‘½ä»¤ä¹Ÿå¯ä»¥ç”¨äºŽåŠ¨æ€ç›‘å¬æ—¥å¿—ã€‚é¦–å…ˆä½¿ç”¨ `less` æ‰“å¼€ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œç„¶åŽæŒ‰ä¸‹ `Shift+F`ï¼Œ`less` ä¼šè¿›å…¥ç±»ä¼¼ `tail -f` çš„ç›‘è§†æ¨¡å¼ï¼Œå®žæ—¶æ˜¾ç¤ºæ—¥å¿—æ–‡ä»¶çš„æ–°å†…å®¹ã€‚

	ä¾‹å¦‚ï¼Œä½¿ç”¨ `less` ç›‘å¬å®‰å…¨æ—¥å¿—ï¼š

	```bash
	less +F /var/log/auth.log
	```

3. ==ä½¿ç”¨ `multitail` å‘½ä»¤==

	`multitail` æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå®ƒä¸ä»…å¯ä»¥==åŠ¨æ€ç›‘å¬å¤šä¸ªæ—¥å¿—æ–‡ä»¶==ï¼Œè¿˜å¯ä»¥åœ¨ä¸€ä¸ªçª—å£ä¸­ä»¥åˆ†å±çš„å½¢å¼æ˜¾ç¤ºï¼Œè¿˜æ”¯æŒæ—¥å¿—æ–‡ä»¶çš„å½©è‰²æ˜¾ç¤ºï¼Œä½¿å¾—æ—¥å¿—çš„é˜…è¯»æ›´åŠ ç›´è§‚ã€‚

	å®‰è£… `multitail`ï¼ˆå¦‚æžœç³»ç»Ÿä¸­æ²¡æœ‰é¢„è£…çš„è¯ï¼‰ï¼š

	```bash
	sudo apt-get install multitail  # Debian/Ubuntu
	sudo yum install multitail      # CentOS/RedHat
	```

	åŠ¨æ€ç›‘å¬å¤šä¸ªæ—¥å¿—æ–‡ä»¶ï¼š

	```bash
	multitail /var/log/apache2/access.log /var/log/apache2/error.log
	```

4. ==ä½¿ç”¨ `journalctl` å‘½ä»¤==

	å¯¹äºŽä½¿ç”¨ systemd çš„ç³»ç»Ÿï¼Œ`journalctl` æ˜¯æŸ¥çœ‹å’Œç›‘æŽ§==ç³»ç»Ÿæ—¥å¿—==çš„å¼ºå¤§å·¥å…·ã€‚ä½¿ç”¨ `-f` å‚æ•°ï¼Œå¯ä»¥åŠ¨æ€ç›‘å¬ç³»ç»Ÿçš„æ—¥å¿—ã€‚

	ä¾‹å¦‚ï¼ŒåŠ¨æ€ç›‘å¬ç³»ç»Ÿæ—¥å¿—ï¼š

	```bash
	journalctl -f
	```

----



### 2.å¦‚ä½•å¸¦å…³é”®è¯æŸ¥è¯¢ Linux æ—¥å¿—æ–‡ä»¶ ï¼Ÿ

1.  ==ä½¿ç”¨ `grep` å‘½ä»¤==

	`grep` æ˜¯æœ€åŸºæœ¬ä¹Ÿæ˜¯æœ€å¼ºå¤§çš„æ–‡æœ¬æœç´¢å·¥å…·ä¹‹ä¸€ï¼Œå®ƒå¯ä»¥æœç´¢åŒ…å«æŒ‡å®šæ¨¡å¼ï¼ˆå¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–æ­£åˆ™è¡¨è¾¾å¼ï¼‰çš„è¡Œã€‚

	ä¾‹å¦‚ï¼Œæœç´¢ `/var/log/syslog` æ–‡ä»¶ä¸­åŒ…å«å…³é”®è¯ â€œerrorâ€ çš„è¡Œï¼š

	```bash
	grep "error" /var/log/syslog
	```

	å¦‚æžœä½ æƒ³åŒæ—¶æŸ¥çœ‹åŒ¹é…è¡Œçš„ä¸Šä¸‹æ–‡ï¼ˆä¾‹å¦‚ï¼Œæ˜¾ç¤º==æ¯ä¸ªåŒ¹é…è¡Œå‰åŽå„2è¡Œ==ï¼‰ï¼Œå¯ä»¥==ä½¿ç”¨ `-C`ï¼ˆä¸Šä¸‹æ–‡==ï¼‰é€‰é¡¹ï¼š

	```bash
	grep -C 2 "error" /var/log/syslog
	```

2. ==ä½¿ç”¨ `awk` å‘½ä»¤==

	```bash
	awk '/failed/' /var/log/auth.log
	```

3. ==ä½¿ç”¨ `sed` å‘½ä»¤==

	```bash
	sed -n '/usb/p' /var/log/dmesg
	```

4. ==ç»“åˆä½¿ç”¨ `zgrep` å‘½ä»¤æœç´¢åŽ‹ç¼©çš„æ—¥å¿—æ–‡ä»¶==

	è®¸å¤š Linux ç³»ç»Ÿä¼š==åŽ‹ç¼©æ—§çš„æ—¥å¿—æ–‡ä»¶ä»¥èŠ‚çœç©ºé—´ï¼Œè¿™äº›æ–‡ä»¶é€šå¸¸ä»¥ `.gz` ç»“å°¾==ã€‚`zgrep` å‘½ä»¤å¯ä»¥åœ¨è¿™äº›åŽ‹ç¼©æ–‡ä»¶ä¸­æœç´¢æ–‡æœ¬ï¼Œ==æ— éœ€å…ˆè§£åŽ‹==ã€‚

	ä¾‹å¦‚ï¼Œæœç´¢æ‰€æœ‰åŽ‹ç¼©çš„ `.log.gz` æ–‡ä»¶ä¸­åŒ…å« â€œwarningâ€ çš„è¡Œï¼š

	```bash
	sudo zgrep "warning" /var/log/*.gz
	```

---



### 3.Linux ä¸‹æ—¥å¿—æ–‡ä»¶è¿‡å¤§ï¼Œå¦‚ä½•å®žçŽ°åˆ†å‰²ï¼Œè½¬å‚¨ ï¼Ÿ

1. ==ä½¿ç”¨ `logrotate`==

	- ==é…ç½® `logrotate`==ï¼šä½ å¯ä»¥é€šè¿‡==ç¼–è¾‘ `/etc/logrotate.conf` æ–‡ä»¶æˆ–åœ¨ `/etc/logrotate.d/` ç›®å½•ä¸‹åˆ›å»ºæ–°çš„é…ç½®æ–‡ä»¶æ¥å®šåˆ¶ `logrotate` çš„è¡Œä¸º==ã€‚é…ç½®æ–‡ä»¶å…è®¸ä½ è®¾ç½®è½®è½¬å‘¨æœŸã€åŽ‹ç¼©é€‰é¡¹ã€è½®è½¬å‰åŽæ‰§è¡Œçš„è„šæœ¬ç­‰ã€‚

2. ==æ‰‹åŠ¨åˆ†å‰²æ—¥å¿—æ–‡ä»¶==

	å¦‚æžœä½ éœ€è¦ç«‹å³åˆ†å‰²ä¸€ä¸ªè¿‡å¤§çš„æ—¥å¿—æ–‡ä»¶ï¼Œè€Œä¸ç­‰å¾… `logrotate` çš„è‡ªåŠ¨æ‰§è¡Œï¼Œå¯ä»¥æ‰‹åŠ¨è¿›è¡Œã€‚ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ `split` å‘½ä»¤åˆ†å‰²æ–‡ä»¶ï¼Œå¦ä¸€ç§æ–¹æ³•æ˜¯ç›´æŽ¥ç§»åŠ¨å½“å‰æ—¥å¿—æ–‡ä»¶ç„¶åŽé€šçŸ¥ç›¸å…³æœåŠ¡åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥å¿—æ–‡ä»¶ã€‚

	- ==ç§»åŠ¨æ—¥å¿—æ–‡ä»¶==ï¼š

	```bash
	mv /var/log/large.log /var/log/large.log.old
	```

	- ==é€šçŸ¥ç›¸å…³æœåŠ¡==ï¼šå¯¹äºŽå¤§å¤šæ•°æœåŠ¡ï¼Œç‰¹åˆ«æ˜¯é‚£äº›é€šè¿‡ `systemd` ç®¡ç†çš„ï¼Œå¯ä»¥ä½¿ç”¨ `systemctl` é‡æ–°åŠ è½½æˆ–é‡å¯æœåŠ¡æ¥ä½¿å…¶å¼€å§‹å†™å…¥æ–°çš„æ—¥å¿—æ–‡ä»¶ã€‚

	```bash
	systemctl restart myservice
	```

	æˆ–è€…ï¼Œå¦‚æžœæœåŠ¡æ”¯æŒä¸é‡å¯å³å¯é‡æ–°æ‰“å¼€æ—¥å¿—æ–‡ä»¶çš„ä¿¡å·ï¼ˆä¾‹å¦‚ï¼Œ==è®¸å¤šå®ˆæŠ¤è¿›ç¨‹ä¼šåœ¨æŽ¥æ”¶åˆ° `SIGHUP` ä¿¡å·æ—¶é‡æ–°æ‰“å¼€æ—¥å¿—æ–‡ä»¶==ï¼‰ï¼Œä½ å¯ä»¥å‘é€ `SIGHUP`ï¼š

	```bash
	pkill -HUP myservice
	```

---



## 4.Linux æ¦‚å¿µåŸºç¡€

### 1.Linuxç³»ç»Ÿä¸­ç¬¦å·é“¾æŽ¥ä¸Žç¡¬é“¾æŽ¥çš„åŒºåˆ«ï¼Ÿ

1. ==ç¬¦å·é“¾æŽ¥ï¼ˆè½¯é“¾æŽ¥ï¼‰==

	> - ç¬¦å·é“¾æŽ¥ï¼Œä¹Ÿç§°ä¸ºè½¯é“¾æŽ¥ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šç±»åž‹çš„æ–‡ä»¶ï¼Œå®ƒ==åŒ…å«çš„æ˜¯å¦ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„==ã€‚å®ƒ==ä»…ä»…æ˜¯æŒ‡å‘å¦ä¸€ä¸ªæ–‡ä»¶çš„æŒ‡é’ˆ==ã€‚
	>
	> - ```bash
	> 	ln -s file1.txt link1.txt
	> 	```
	>
	> 	å¦‚æžœ`file1.txt`è¢«åˆ é™¤ï¼Œ`link1.txt`ä»ç„¶å­˜åœ¨ï¼Œä½†æ˜¯å®ƒ==ä¸å†æŒ‡å‘ä¸€ä¸ªæœ‰æ•ˆæ–‡ä»¶==ã€‚
	>
	> - ![image-20240522155609145](bgwROUND1.assets/image-20240522155609145.png)
	>
	> - ==ç‰¹ç‚¹==ï¼š
	>
	> 	- å¯ä»¥è·¨æ–‡ä»¶ç³»ç»Ÿé“¾æŽ¥ã€‚
	> 	- å¯ä»¥é“¾æŽ¥åˆ°ç›®å½•ã€‚
	> 	- å¦‚æžœ==åˆ é™¤äº†åŽŸæ–‡ä»¶ï¼Œç¬¦å·é“¾æŽ¥å°†å¤±æ•ˆï¼Œæ˜¾ç¤ºä¸ºæ‚¬ç©ºé“¾æŽ¥==ã€‚
	> 	- ==ç¬¦å·é“¾æŽ¥æ–‡ä»¶æœ¬èº«æœ‰ç‹¬ç«‹çš„inode==ï¼ˆæ–‡ä»¶ç³»ç»Ÿä¸­çš„ç´¢å¼•èŠ‚ç‚¹ï¼‰ã€‚

2. ==ç¡¬é“¾æŽ¥==

	> - ç¡¬é“¾æŽ¥æ˜¯å¦ä¸€ä¸ªæ–‡ä»¶çš„å¦ä¸€ä¸ªåç§°ï¼Œå®ƒæŒ‡å‘ç›¸åŒçš„æ–‡ä»¶å†…å®¹å’Œinodeã€‚åœ¨==æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œæ‰€æœ‰çš„æ–‡ä»¶åå®žé™…ä¸Šéƒ½æ˜¯ç¡¬é“¾æŽ¥ï¼ŒæŒ‡å‘å­˜å‚¨æ•°æ®çš„inode==ã€‚
	>
	> - ```bash
	> 	ln file2.txt link2.txt
	> 	```
	>
	> 	å¦‚æžœ`file2.txt`è¢«åˆ é™¤ï¼Œé€šè¿‡`link2.txt`ä¾ç„¶å¯ä»¥è®¿é—®åˆ°æ–‡ä»¶çš„å†…å®¹ï¼Œå› ä¸º==`link2.txt`å’Œ`file2.txt`å®žé™…ä¸ŠæŒ‡å‘åŒä¸€ä¸ªinodeå’Œæ•°æ®å—==ã€‚
	>
	> - ![image-20240522155918234](bgwROUND1.assets/image-20240522155918234.png)
	>
	> - ==ç‰¹ç‚¹==ï¼š
	>
	> 	- ä¸èƒ½è·¨æ–‡ä»¶ç³»ç»Ÿé“¾æŽ¥ã€‚
	> 	- ä¸èƒ½é“¾æŽ¥åˆ°ç›®å½•ï¼ˆä¸ºäº†é˜²æ­¢äº§ç”Ÿå¾ªçŽ¯ï¼‰ã€‚
	> 	- å¦‚æžœ==åˆ é™¤äº†åŽŸæ–‡ä»¶ï¼Œä»»ä½•ç¡¬é“¾æŽ¥éƒ½ä»ç„¶å¯ä»¥è®¿é—®æ–‡ä»¶çš„å†…å®¹==ã€‚
	> 	- ç¡¬é“¾æŽ¥å’Œå…¶åŽŸå§‹æ–‡ä»¶==å…±äº«ç›¸åŒçš„inode==ã€‚

3. æ€»ç»“

	> - ==ç¬¦å·é“¾æŽ¥ç±»ä¼¼äºŽWindowsçš„å¿«æ·æ–¹å¼==ï¼Œæ˜¯ä¸€ä¸ª==æŒ‡å‘å¦ä¸€ä¸ªæ–‡ä»¶è·¯å¾„çš„ç‰¹æ®Šæ–‡ä»¶==ã€‚
	> - ==ç¡¬é“¾æŽ¥æ˜¯æ–‡ä»¶çš„å¦ä¸€ä¸ªåç§°ï¼Œå®ƒå’ŒåŽŸå§‹æ–‡ä»¶å…±äº«ç›¸åŒçš„æ•°æ®==ã€‚
	> - ç¬¦å·é“¾æŽ¥å¯ä»¥æŒ‡å‘ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œè€Œç¡¬é“¾æŽ¥ä¿è¯äº†å³ä½¿åŽŸå§‹æ–‡ä»¶åè¢«åˆ é™¤ï¼Œæ–‡ä»¶å†…å®¹ä»ç„¶å­˜åœ¨ã€‚
	> - ç¬¦å·é“¾æŽ¥å’Œç¡¬é“¾æŽ¥åœ¨æ–‡ä»¶å¤‡ä»½ã€å¿«é€Ÿè®¿é—®ç­‰åœºæ™¯ä¸‹éžå¸¸æœ‰ç”¨ã€‚

---



### 2.å¸¸è§çš„Linuxç›®å½•ç»“æž„ï¼Ÿ

#### `/`ï¼ˆæ ¹ç›®å½•ï¼‰

- æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•åœ¨Linuxä¸­éƒ½ä»Žæ ¹ç›®å½•å¼€å§‹ã€‚

#### `/bin`ï¼ˆç”¨æˆ·äºŒè¿›åˆ¶æ–‡ä»¶ï¼‰

- åŒ…å«==ç”¨æˆ·çº§åˆ«çš„ç¨‹åºå’Œå‘½ä»¤==ï¼Œå¦‚`ls`ã€`cp`ç­‰ã€‚è¿™äº›å‘½ä»¤å¯¹æ‰€æœ‰ç”¨æˆ·éƒ½å¯ç”¨ã€‚

#### `/sbin`ï¼ˆç³»ç»ŸäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰

- å­˜æ”¾ç³»ç»Ÿç®¡==ç†å‘˜ä½¿ç”¨çš„ç³»ç»Ÿç®¡ç†å‘½ä»¤==ï¼Œå¦‚`fdisk`ã€`sysctl`ç­‰ã€‚

#### `/etc`ï¼ˆé…ç½®æ–‡ä»¶ï¼‰

- åŒ…å«==ç³»ç»Ÿçš„é…ç½®æ–‡ä»¶==ã€‚è¿™äº›æ–‡ä»¶é€šå¸¸æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œå¯ä»¥è¢«ç¼–è¾‘æ¥æ”¹å˜ç³»ç»Ÿçš„è®¾ç½®ã€‚

#### `/dev`ï¼ˆè®¾å¤‡æ–‡ä»¶ï¼‰

- åŒ…å«æ‰€æœ‰è®¾å¤‡å’Œç‰¹æ®Šæ–‡ä»¶çš„ä½ç½®ã€‚åœ¨Linuxä¸­ï¼Œ==è®¾å¤‡è¢«è§†ä¸ºæ–‡ä»¶ï¼Œå¯ä»¥åƒæ“ä½œæ–‡ä»¶ä¸€æ ·æ“ä½œè¿™äº›è®¾å¤‡==ã€‚

#### `/proc`ï¼ˆè¿›ç¨‹ä¿¡æ¯ï¼‰

- ä¸€ä¸ªè™šæ‹Ÿçš„æ–‡ä»¶ç³»ç»Ÿï¼Œ==åŒ…å«è¿è¡Œä¸­çš„ç³»ç»Ÿè¿›ç¨‹å’Œå†…æ ¸ä¿¡æ¯==ã€‚å®ƒä¸å ç”¨ç£ç›˜ç©ºé—´ï¼Œä¸»è¦ç”¨äºŽç³»ç»Ÿç›‘æŽ§ç›®çš„ã€‚

#### `/var`ï¼ˆå¯å˜æ–‡ä»¶ï¼‰

- å­˜æ”¾==ç»å¸¸å˜åŒ–çš„æ–‡ä»¶==ï¼Œå¦‚==æ—¥å¿—æ–‡ä»¶==ï¼ˆ`/var/log`ï¼‰ã€åŒ…å’Œæ•°æ®åº“æ–‡ä»¶ã€‚

#### `/tmp`ï¼ˆä¸´æ—¶æ–‡ä»¶ï¼‰

- ç”¨äºŽå­˜æ”¾ä¸´æ—¶æ–‡ä»¶ï¼Œç³»ç»Ÿé‡å¯æ—¶ï¼Œè¿™ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶å¯èƒ½ä¼šè¢«åˆ é™¤ã€‚

#### `/usr`ï¼ˆç”¨æˆ·ç¨‹åºï¼‰

- åŒ…å«ç”¨æˆ·åº”ç”¨ç¨‹åºå’Œæ–‡ä»¶ã€‚å®ƒé€šå¸¸åŒ…å«å¤šä¸ªå­ç›®å½•ï¼Œå¦‚`/usr/bin`ã€`/usr/sbin`ã€`/usr/local`ç­‰ï¼Œç”¨äºŽ==ä¸åŒç±»åž‹çš„ç”¨æˆ·çº§ç¨‹åºå’Œæ•°æ®==ã€‚

#### `/home`ï¼ˆç”¨æˆ·ä¸»ç›®å½•ï¼‰

- å­˜æ”¾==æ™®é€šç”¨æˆ·çš„ä¸ªäººæ•°æ®å’Œé…ç½®æ–‡ä»¶==ã€‚æ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªä»¥å…¶ç”¨æˆ·åå‘½åçš„ç›®å½•ã€‚

#### `/root`ï¼ˆrootç”¨æˆ·çš„ä¸»ç›®å½•ï¼‰

- `root`ç”¨æˆ·çš„ä¸ªäººä¸»ç›®å½•ï¼Œè€Œä¸æ˜¯`/home/root`ã€‚

#### `/boot`ï¼ˆå¯åŠ¨åŠ è½½å™¨æ–‡ä»¶ï¼‰

- åŒ…å«å¯åŠ¨Linuxç³»ç»Ÿæ—¶ä½¿ç”¨çš„æ–‡ä»¶ï¼Œå¦‚å†…æ ¸æ˜ åƒå’Œå¼•å¯¼åŠ è½½ç¨‹åºï¼ˆGRUBæˆ–LILOï¼‰çš„é…ç½®æ–‡ä»¶ã€‚

#### `/lib`ï¼ˆç³»ç»Ÿåº“ï¼‰

- å­˜æ”¾==ç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºä½¿ç”¨çš„å…±äº«åº“æ–‡ä»¶==ï¼Œä»¥åŠ==å†…æ ¸æ¨¡å—==ã€‚

---



### 3.æè¿°Linuxè¿è¡Œçº§åˆ«0-6çš„å„è‡ªå«ä¹‰ï¼Ÿ

#### è¿è¡Œçº§åˆ«0

- ==å…³æœº==ï¼ˆHaltï¼‰ï¼šæ­¤è¿è¡Œçº§åˆ«ä¼šå…³é—­ç³»ç»Ÿã€‚

#### è¿è¡Œçº§åˆ«1

- ==å•ç”¨æˆ·æ¨¡å¼==ï¼ˆSingle-User Modeï¼‰ï¼šè¿™æ˜¯ä¸€ç§ç»´æŠ¤æˆ–ç´§æ€¥ä¿®å¤æ¨¡å¼ï¼Œæ­¤æ—¶==åªæœ‰æ ¹ç”¨æˆ·å¯ä»¥ç™»å½•ï¼Œä¸å¯åŠ¨ç½‘ç»œæœåŠ¡==ï¼Œä¸€èˆ¬ç”¨äºŽ==ç³»ç»Ÿç»´æŠ¤==ã€‚

#### è¿è¡Œçº§åˆ«2

- ==å¤šç”¨æˆ·æ¨¡å¼ï¼Œä¸å¸¦NFS==ï¼ˆMulti-User Mode without NFSï¼‰ï¼šè¿™ä¸ªçº§åˆ«å…è®¸å¤šç”¨æˆ·ç™»å½•ä½†ä¸å¯åŠ¨ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼ˆNFSï¼‰ï¼Œåœ¨ä¸åŒçš„Linuxå‘è¡Œç‰ˆä¸­è¿™ä¸ªæ¨¡å¼çš„å…·ä½“å«ä¹‰å¯èƒ½æœ‰æ‰€ä¸åŒã€‚

#### è¿è¡Œçº§åˆ«3

- ==å®Œå…¨çš„å¤šç”¨æˆ·æ¨¡å¼==ï¼ˆFull Multi-User Modeï¼‰ï¼šè¿™æ˜¯æ ‡å‡†çš„å¤šç”¨æˆ·æ¨¡å¼ï¼Œæ”¯æŒå¤šç”¨æˆ·ç™»å½•å¹¶å¯åŠ¨ç½‘ç»œæœåŠ¡ï¼Œä½†ä¸å¯åŠ¨å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰ã€‚

#### è¿è¡Œçº§åˆ«4

- ==æœªå®šä¹‰==ï¼šä¿ç•™æœªä½¿ç”¨ï¼Œå¯ä»¥è¢«ä¸ªåˆ«==Linuxå‘è¡Œç‰ˆç‰¹å®šåœ°å®šä¹‰ç”¨é€”==ã€‚

#### è¿è¡Œçº§åˆ«5

- ==å›¾å½¢æ¨¡å¼==ï¼ˆX11ï¼‰ï¼šä¸Žè¿è¡Œçº§åˆ«3ç›¸ä¼¼ï¼Œä½†åœ¨æ­¤åŸºç¡€ä¸Šå¯åŠ¨==å›¾å½¢ç”¨æˆ·ç•Œé¢==ï¼ˆGUIï¼‰ï¼Œæ˜¯==å¤§å¤šæ•°æ¡Œé¢Linuxå‘è¡Œç‰ˆçš„é»˜è®¤è¿è¡Œçº§åˆ«==ã€‚

#### è¿è¡Œçº§åˆ«6

- ==é‡å¯==ï¼ˆRebootï¼‰ï¼šæ­¤è¿è¡Œçº§åˆ«ä¼šé‡å¯ç³»ç»Ÿã€‚

![image-20240522173145747](bgwROUND1.assets/image-20240522173145747.png)

è¦æŸ¥çœ‹æˆ–æ›´æ”¹å½“å‰è¿è¡Œçº§åˆ«ï¼Œä¼ ç»Ÿçš„æ–¹æ³•æ˜¯ä½¿ç”¨==`runlevel`å‘½ä»¤æŸ¥çœ‹==å’Œ==`init`å‘½ä»¤æ¥æ›´æ”¹è¿è¡Œçº§åˆ«==ã€‚åœ¨ä½¿ç”¨systemdçš„ç³»ç»Ÿä¸­ï¼Œå¯ä»¥ä½¿ç”¨`systemctl`å‘½ä»¤æ¥å®žçŽ°ç›¸ä¼¼çš„åŠŸèƒ½ï¼Œä¾‹å¦‚==`systemctl get-default`æŸ¥çœ‹é»˜è®¤ç›®æ ‡ï¼ˆè¿è¡Œçº§åˆ«==ï¼‰ï¼Œ==`systemctl set-default`æ¥è®¾ç½®é»˜è®¤ç›®æ ‡==ã€‚

----



### 4.ç»™å‡ºæ­£ç¡®çš„å…³æœºå’Œé‡å¯æœåŠ¡å™¨çš„å‘½ä»¤ï¼Ÿ

1. ==ä½¿ç”¨ Systemd çš„ç³»ç»Ÿï¼ˆå¤§å¤šæ•° Linux å‘è¡Œç‰ˆï¼‰==

	> - ```bash
	> 	# å…³æœº
	> 	sudo systemctl poweroff 
	> 	sudo shutdown -h now # -h è¡¨ç¤º haltï¼Œå³åœæ­¢æ‰€æœ‰ CPU åŠŸèƒ½
	> 																																				
	> 	# é‡å¯
	> 	sudo systemctl reboot
	> 	sudo shutdown -r now
	> 	```

2. ==ä½¿ç”¨ System V init çš„ç³»ç»Ÿ==

	> - ```bash
	> 	sudo shutdown -h now
	> 	sudo shutdown -r now
	> 	```

3. ==å…¶å®ƒå‘½ä»¤==

	> - ```bash
	> 	sudo poweroff
	> 	sudo halt
	> 	sudo reboot
	> 	```

4. ==`systemctl`å‘½ä»¤æ˜¯æŽ¨èçš„æ–¹å¼ï¼Œå› ä¸ºå®ƒä¸Žsystemdç³»ç»Ÿç®¡ç†å™¨ç›´æŽ¥äº¤äº’ï¼Œæä¾›äº†ä¸€è‡´çš„æŽ¥å£æ¥ç®¡ç†å¯åŠ¨è¿‡ç¨‹å’ŒæœåŠ¡==ã€‚ä¸è¿‡ï¼Œ`shutdown`ã€`poweroff`ã€`halt`ã€å’Œ`reboot`å‘½ä»¤åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä»ç„¶æœ‰æ•ˆï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸è¢«é“¾æŽ¥åˆ°systemdæä¾›çš„ç›¸åº”å‘½ä»¤ï¼Œä»¥ä¿æŒå‘åŽå…¼å®¹æ€§ã€‚

----



### 5.Linux ä¸­çš„ç”¨æˆ·æ¨¡å¼å’Œå†…æ ¸æ¨¡å¼æ˜¯ä»€ä¹ˆå«æ„ï¼Ÿ

1. ç”¨æˆ·æ¨¡å¼ï¼ˆUser Modeï¼‰å’Œå†…æ ¸æ¨¡å¼ï¼ˆKernel Modeï¼‰æ˜¯æŒ‡CPUçš„ä¸¤ç§ä¸åŒçš„è¿è¡Œçº§åˆ«æˆ–çŠ¶æ€ï¼Œè¿™ä¸¤ç§æ¨¡å¼ä¸»è¦æ˜¯ä¸ºäº†æä¾›==ç³»ç»Ÿçš„å®‰å…¨æ€§å’Œç¨³å®šæ€§==ã€‚

2. ==å†…æ ¸æ¨¡å¼ï¼ˆKernel Modeï¼‰==

	> - åœ¨å†…æ ¸æ¨¡å¼ä¸‹ï¼Œ==CPUå¯ä»¥æ‰§è¡Œä»»ä½•æŒ‡ä»¤==ï¼Œè®¿é—®ç³»ç»Ÿçš„==æ‰€æœ‰å†…å­˜åœ°å€å’Œç¡¬ä»¶èµ„æº==ã€‚æ“ä½œç³»ç»Ÿçš„æ ¸å¿ƒéƒ¨åˆ†ï¼ˆå†…æ ¸ï¼‰åœ¨è¿™ä¸ªæ¨¡å¼ä¸‹è¿è¡Œï¼Œè´Ÿè´£==ç®¡ç†ç¡¬ä»¶è®¾å¤‡ã€ç®¡ç†å†…å­˜ã€å¤„ç†ç³»ç»Ÿè°ƒç”¨==ç­‰ä½Žçº§ä»»åŠ¡ã€‚
	> - ä»»ä½•åœ¨å†…æ ¸æ¨¡å¼ä¸‹è¿è¡Œçš„é”™è¯¯ä»£ç éƒ½å¯èƒ½å¯¼è‡´ç³»ç»Ÿå´©æºƒæˆ–==å®‰å…¨æ¼æ´ž==ã€‚å› æ­¤ï¼Œ==åªæœ‰å—ä¿¡ä»»çš„æ“ä½œç³»ç»Ÿä»£ç ==åº”åœ¨å†…æ ¸æ¨¡å¼ä¸‹æ‰§è¡Œã€‚

3. ==ç”¨æˆ·æ¨¡å¼ï¼ˆUser Modeï¼‰==

	> - ç”¨æˆ·æ¨¡å¼æ˜¯ä¸€ä¸ªå—é™åˆ¶çš„æ‰§è¡Œæ¨¡å¼ï¼Œç”¨äºŽè¿è¡Œ==ç”¨æˆ·ç¨‹åºå’Œåº”ç”¨è½¯ä»¶==ã€‚åœ¨ç”¨æˆ·æ¨¡å¼ä¸‹ï¼Œç¨‹åº==ä¸èƒ½ç›´æŽ¥æ‰§è¡Œ==æŸäº›ä¿æŠ¤ç³»ç»Ÿå®‰å…¨å’Œç¨³å®šæ€§çš„æ“ä½œï¼ˆ==å¦‚ç›´æŽ¥è®¿é—®ç¡¬ä»¶èµ„æº==ï¼‰ã€‚
	> - ç”¨æˆ·æ¨¡å¼é€šè¿‡==é™åˆ¶ç¨‹åºçš„èƒ½åŠ›æ¥å¢žåŠ ç³»ç»Ÿçš„å®‰å…¨æ€§å’Œç¨³å®šæ€§==ã€‚å³ä½¿ç”¨æˆ·ç¨‹åºå´©æºƒï¼Œä¹Ÿ==ä¸ä¼šç›´æŽ¥å½±å“åˆ°ç³»ç»Ÿçš„æ ¸å¿ƒéƒ¨åˆ†==ã€‚

4. ==ç”¨æˆ·æ¨¡å¼å’Œå†…æ ¸æ¨¡å¼çš„åˆ‡æ¢==

	> - ==ç³»ç»Ÿè°ƒç”¨==ï¼šå½“ç”¨æˆ·ç¨‹åºéœ€è¦æ‰§è¡Œ==æ–‡ä»¶æ“ä½œã€ç½‘ç»œé€šä¿¡æˆ–å…¶ä»–éœ€è¦å†…æ ¸ä»‹å…¥çš„æ“ä½œæ—¶==ï¼Œå®ƒä¼šæ‰§è¡Œç³»ç»Ÿè°ƒç”¨ã€‚è¿™ä¼šå¯¼è‡´CPU==ä»Žç”¨æˆ·æ¨¡å¼åˆ‡æ¢åˆ°å†…æ ¸æ¨¡å¼==ï¼Œå¹¶æ‰§è¡Œç›¸åº”çš„å†…æ ¸å‡½æ•°ã€‚==å®ŒæˆåŽï¼ŒCPUåˆ‡æ¢å›žç”¨æˆ·æ¨¡å¼==ï¼Œç»§ç»­æ‰§è¡Œç”¨æˆ·ç¨‹åºã€‚
	> - ==ä¸­æ–­å’Œå¼‚å¸¸==ï¼šå½“å‘ç”Ÿ==ç¡¬ä»¶ä¸­æ–­æˆ–å¼‚å¸¸==æ—¶ï¼ŒCPUä¹Ÿä¼šä»Žç”¨æˆ·æ¨¡å¼==åˆ‡æ¢åˆ°å†…æ ¸æ¨¡å¼ï¼Œä»¥ä¾¿å†…æ ¸å¤„ç†è¿™äº›äº‹ä»¶==ã€‚

---



### 6.Linux è½¯ä¸­æ–­å’Œå·¥ä½œé˜Ÿåˆ—çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ

1. ==è½¯ä¸­æ–­ï¼ˆSoftirqsï¼‰==

	> - ==ä½œç”¨==ï¼šè½¯ä¸­æ–­æ˜¯ä¸€ç§ä½Žå¼€é”€çš„ä¸­æ–­æœºåˆ¶ï¼Œç”¨äºŽå¤„ç†å¯å»¶è¿Ÿçš„ä»»åŠ¡ï¼Œå¦‚ç½‘ç»œæ•°æ®åŒ…çš„æŽ¥æ”¶å’Œå‘é€ã€å®šæ—¶å™¨å¤„ç†ç­‰ã€‚å®ƒä»¬æ˜¯åœ¨ä¸­æ–­ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œçš„ï¼Œæ„å‘³ç€å®ƒä»¬ä¸èƒ½è¢«æ™®é€šçš„è¿›ç¨‹æŠ¢å ï¼Œä½†å¯ä»¥è¢«ç¡¬ä»¶ä¸­æ–­ï¼ˆHardirqsï¼‰æŠ¢å ã€‚
	> - ==è®¾è®¡ç›®çš„==ï¼šè½¯ä¸­æ–­çš„ä¸»è¦è®¾è®¡ç›®çš„æ˜¯å‡å°‘ç¡¬ä»¶ä¸­æ–­å¤„ç†ç¨‹åºï¼ˆHardirqsï¼‰çš„æ‰§è¡Œæ—¶é—´ã€‚é€šè¿‡å°†éƒ¨åˆ†å·¥ä½œå»¶è¿Ÿåˆ°è½¯ä¸­æ–­ä¸­ï¼Œç¡¬ä»¶ä¸­æ–­å¤„ç†ç¨‹åºå¯ä»¥å¿«é€Ÿè¿”å›žï¼Œä»Žè€Œå‡å°‘ç³»ç»Ÿå¯¹ç¡¬ä»¶ä¸­æ–­çš„å“åº”æ—¶é—´ã€‚
	> - ç‰¹ç‚¹ï¼š
	> 	- è½¯ä¸­æ–­å¯ä»¥å¹¶å‘è¿è¡Œåœ¨å¤šä¸ªCPUä¸Šã€‚
	> 	- è½¯ä¸­æ–­çš„æ‰§è¡Œä¸èƒ½è¢«å…¶ä»–è½¯ä¸­æ–­æˆ–ä»»åŠ¡æŠ¢å ï¼Œä½†å¯ä»¥è¢«ç¡¬ä»¶ä¸­æ–­æŠ¢å ã€‚
	> 	- é€‚ç”¨äºŽå¤„ç†==éœ€è¦å¿«é€Ÿå“åº”ä½†ä¸éœ€è¦ç«‹å³å®Œæˆ==çš„ä»»åŠ¡ã€‚

2. ==å·¥ä½œé˜Ÿåˆ—ï¼ˆWorkqueuesï¼‰==

	> - ==ä½œç”¨==ï¼šå·¥ä½œé˜Ÿåˆ—æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œå…è®¸å†…æ ¸å°†éœ€è¦åœ¨è¿›ç¨‹ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œçš„==é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡æŽ’é˜Ÿ==ã€‚è¿™äº›ä»»åŠ¡å¯èƒ½åŒ…æ‹¬è®¾å¤‡é©±åŠ¨ç¨‹åºçš„åº•å±‚ä»»åŠ¡ï¼Œå¦‚==ç£ç›˜I/Oæ“ä½œã€æ–‡ä»¶ç³»ç»Ÿçš„å»¶è¿Ÿå†™å…¥==ç­‰ã€‚
	> - ==è®¾è®¡ç›®çš„==ï¼šå·¥ä½œé˜Ÿåˆ—å…è®¸ä»»åŠ¡åœ¨è¿›ç¨‹ä¸Šä¸‹æ–‡ä¸­==å¼‚æ­¥æ‰§è¡Œ==ï¼Œè¿™æ„å‘³ç€å®ƒä»¬å¯ä»¥ç¡çœ ï¼ˆç­‰å¾…èµ„æºã€ç¡çœ é”ç­‰ï¼‰ï¼Œè¿™åœ¨ä¸­æ–­ä¸Šä¸‹æ–‡ä¸­æ˜¯ä¸å…è®¸çš„ã€‚
	> - ç‰¹ç‚¹ï¼š
	> 	- å·¥ä½œé˜Ÿåˆ—ä»»åŠ¡åœ¨ç‰¹å®šçš„å†…æ ¸çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œè¿™äº›çº¿ç¨‹å¯ä»¥è¢«æ™®é€šè¿›ç¨‹å’Œè½¯ä¸­æ–­æŠ¢å ã€‚
	> 	- é€‚ç”¨äºŽ==ä¸éœ€è¦ç«‹å³å¤„ç†çš„ä»»åŠ¡==ï¼Œç‰¹åˆ«æ˜¯é‚£äº›å¯èƒ½éœ€è¦ç¡çœ çš„ä»»åŠ¡ã€‚
	> 	- æä¾›äº†æ›´å¤§çš„çµæ´»æ€§ï¼Œå¯ä»¥å¤„ç†å¤æ‚çš„ä»»åŠ¡ï¼Œä½†ç›¸æ¯”è½¯ä¸­æ–­å’Œç¡¬ä»¶ä¸­æ–­å¤„ç†ç¨‹åºï¼Œå…¶å¼€é”€è¾ƒå¤§ã€‚

3. ==æ€»ç»“==

	> - ==è½¯ä¸­æ–­==ä¸»è¦ç”¨äºŽå¤„ç†==éœ€è¦è¾ƒå¿«å¤„ç†ä½†å¯ä»¥ç¨å¾®å»¶è¿Ÿçš„ä¸­æ–­é©±åŠ¨ä»»åŠ¡==ï¼Œä¾‹å¦‚åœ¨æŽ¥æ”¶åˆ°å¤§é‡ç½‘ç»œæ•°æ®åŒ…æ—¶å¿«é€Ÿå¤„ç†å®ƒä»¬ã€‚
	> - ==å·¥ä½œé˜Ÿåˆ—==ç”¨äºŽå¤„ç†é‚£äº›==å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ã€å¯èƒ½éœ€è¦ç¡çœ çš„ä»»åŠ¡==ï¼Œå®ƒä»¬åœ¨è¿›ç¨‹ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œæä¾›äº†æ‰§è¡Œå¤æ‚æ“ä½œçš„èƒ½åŠ›ã€‚

---



### 7.Linux ä¸­è¿›ç¨‹æœ‰å“ªå‡ ç§çŠ¶æ€ï¼Ÿåœ¨ ps æ˜¾ç¤ºå‡ºæ¥çš„ä¿¡æ¯ä¸­ï¼Œåˆ†åˆ«ç”¨ä»€ä¹ˆç¬¦å·è¡¨ç¤ºçš„ï¼Ÿ

#### 1. è¿è¡Œï¼ˆRunningï¼‰

- ==ç¬¦å·==ï¼š`R`
- ==å«ä¹‰==ï¼šè¿›ç¨‹æ­£åœ¨è¿è¡Œæˆ–åœ¨è¿è¡Œé˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚

#### 2. ç¡çœ ï¼ˆSleepingï¼‰

- ==ç¬¦å·==ï¼š`S`
- ==å«ä¹‰==ï¼šè¿›ç¨‹å¤„äºŽç¡çœ çŠ¶æ€ï¼Œç­‰å¾…æŸä¸ªäº‹ä»¶æˆ–èµ„æºã€‚
- ç‰¹å®šç±»åž‹çš„ç¡çœ çŠ¶æ€ï¼š
	- ==å¯ä¸­æ–­ç¡çœ ==ï¼š`S`ï¼Œè¿›ç¨‹ç­‰å¾…äº‹ä»¶å®Œæˆï¼Œå¯ä»¥è¢«ä¿¡å·å”¤é†’ã€‚
	- ==ä¸å¯ä¸­æ–­ç¡çœ ==ï¼š`D`ï¼Œè¿›ç¨‹åœ¨ç­‰å¾…I/Oæ“ä½œï¼Œå¦‚ç£ç›˜I/Oï¼Œä¸èƒ½è¢«ä¿¡å·å”¤é†’ã€‚

#### 3. åœæ­¢ï¼ˆStopped/Terminalï¼‰

- ==ç¬¦å·==ï¼š`T`
- ==å«ä¹‰==ï¼šè¿›ç¨‹å·²åœæ­¢æ‰§è¡Œï¼Œé€šå¸¸æ˜¯å› ä¸ºæ”¶åˆ°äº†ä¸€ä¸ª==åœæ­¢ä¿¡å·==ï¼ˆå¦‚ç”±`Ctrl+Z`ç”Ÿæˆçš„SIGSTOPï¼‰ã€‚

#### 4. åƒµå°¸ï¼ˆZombieï¼‰

- ==ç¬¦å·==ï¼š`Z`
- ==å«ä¹‰==ï¼š==è¿›ç¨‹å·²å®Œæˆæ‰§è¡Œ==ï¼Œä½†å…¶==çˆ¶è¿›ç¨‹å°šæœª==é€šè¿‡`wait()`ç³»ç»Ÿè°ƒç”¨æ¥==è¯»å–å…¶é€€å‡ºçŠ¶æ€ï¼Œé‡Šæ”¾èµ„æº==ã€‚

#### 5. è·Ÿè¸ªæˆ–è¢«è°ƒè¯•ï¼ˆTraced or Debuggedï¼‰

- ==ç¬¦å·==ï¼šé€šå¸¸ç”¨`T`è¡¨ç¤ºï¼Œä½†è¿™å¯èƒ½ä¾èµ–äºŽå…·ä½“çš„`ps`å®žçŽ°ã€‚
- ==å«ä¹‰==ï¼šè¿›ç¨‹è¢«å¦ä¸€ä¸ªè¿›ç¨‹ç›‘è§†æˆ–æŽ§åˆ¶ï¼Œå¦‚è°ƒè¯•å™¨ã€‚

#### 6. åˆ†é¡µï¼ˆPagingï¼‰

- ==ç¬¦å·==ï¼šä¸å¸¸è§ï¼ŒæŸäº›ç³»ç»Ÿå¯èƒ½ä½¿ç”¨`W`è¡¨ç¤ºï¼Œä½†è¿™åœ¨çŽ°ä»£Linuxç‰ˆæœ¬ä¸­ä¸å¸¸ç”¨ã€‚
- ==å«ä¹‰==ï¼šè¿›ç¨‹æ­£åœ¨ç­‰å¾…é¡µé¢è°ƒå…¥ï¼ˆè¾ƒæ—§çš„ç³»ç»Ÿå¯èƒ½æ˜¾ç¤ºæ­¤çŠ¶æ€ï¼‰ã€‚

#### 7. æ­»é”ï¼ˆDeadlockedï¼‰

- ==ç¬¦å·==ï¼šLinuxé€šå¸¸ä¸ç›´æŽ¥æ˜¾ç¤ºæ­»é”çŠ¶æ€ï¼Œä½†æ­»é”æƒ…å†µå¯ä»¥é€šè¿‡ç³»ç»Ÿç›‘æŽ§å’Œè°ƒè¯•å·¥å…·è¯†åˆ«ã€‚

---



### 8.å¦‚ä½•æ£€æŸ¥LinuxæŸé¡¹æœåŠ¡æ˜¯å¦åœ¨è¿è¡Œï¼Ÿ

1. ==ä½¿ç”¨`systemctl`å‘½ä»¤==ï¼š

	> - ```bash
	> 	systemctl status <æœåŠ¡å>
	> 	systemctl status nginx
	> 	systemctl is-active <æœåŠ¡å>
	> 	```

2. ==ä½¿ç”¨`service`å‘½ä»¤==ï¼š

	> - ```bash
	> 	service <æœåŠ¡å> status
	> 	service httpd status
	> 	/etc/init.d/<æœåŠ¡å> status
	> 	```

3. ==ä½¿ç”¨`ps`å‘½ä»¤==ï¼š

	> - ```bash
	> 	ps aux | grep <æœåŠ¡å>
	> 	```

4. ==ä½¿ç”¨`pgrep`å‘½ä»¤==ï¼š

	> - ```bash
	> 	pgrep <æœåŠ¡å>
	> 	```

----



### 9.å—è®¾å¤‡å’Œå­—ç¬¦è®¾å¤‡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

1. ==å—è®¾å¤‡==

	> - ==æ•°æ®å¤„ç†æ–¹å¼==ï¼šå—è®¾å¤‡ä»¥==å›ºå®šå¤§å°çš„å—==ï¼ˆé€šå¸¸ä¸º512å­—èŠ‚æˆ–æ›´å¤§ï¼‰ä¸ºå•ä½è¯»å†™æ•°æ®ã€‚è¿™æ„å‘³ç€å³ä½¿è¦==è¯»å†™çš„æ•°æ®é‡å°äºŽä¸€ä¸ªå—çš„å¤§å°ï¼Œæ“ä½œç³»ç»Ÿä¹Ÿä¼šå¤„ç†ä¸€ä¸ªå®Œæ•´çš„å—==ã€‚
	> - ==ä¾‹å­==ï¼š==ç¡¬ç›˜é©±åŠ¨å™¨ã€å›ºæ€ç¡¬ç›˜ã€USB==é—ªå­˜é©±åŠ¨å™¨ç­‰ã€‚
	> - ç‰¹ç‚¹ï¼š
	> 	- æ”¯æŒ==éšæœºè®¿é—®==ï¼šå¯ä»¥ç›´æŽ¥è¯»å†™å­˜å‚¨åœ¨ä»»ä½•ä½ç½®çš„æ•°æ®å—ã€‚
	> 	- é€šå¸¸ç”¨äºŽå­˜å‚¨æ–‡ä»¶ç³»ç»Ÿã€‚
	> 	- æ•°æ®==å¯ä»¥è¢«ç¼“å­˜==ï¼šå‡ºäºŽæ€§èƒ½è€ƒè™‘ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥ç¼“å­˜å—è®¾å¤‡çš„æ•°æ®ï¼Œå»¶è¿Ÿå†™å…¥æ“ä½œã€‚

2. ==å­—ç¬¦è®¾å¤‡==

	> - ==æ•°æ®å¤„ç†æ–¹å¼==ï¼šå­—ç¬¦è®¾å¤‡ä»¥å­—èŠ‚ä¸ºå•ä½é¡ºåºå¤„ç†æ•°æ®ï¼Œé€šå¸¸==ä¸æ”¯æŒéšæœºè®¿é—®==ã€‚==æ•°æ®æŒ‰ç…§é¡ºåºä¸€ä¸ªæŽ¥ä¸€ä¸ªåœ°ä¼ è¾“ï¼Œæ²¡æœ‰ç¼“å†²==ã€‚
	> - ==ä¾‹å­==ï¼š==é”®ç›˜ã€é¼ æ ‡ã€ä¸²å£ã€æ‰“å°æœº==ç­‰ã€‚
	> - ç‰¹ç‚¹ï¼š
	> 	- æ•°æ®ç›´æŽ¥ä»Žè®¾å¤‡è¯»å–æˆ–ç›´æŽ¥å†™å…¥è®¾å¤‡ï¼Œä¸ç»è¿‡ç¼“å†²åŒºã€‚
	> 	- ä¸»è¦ç”¨äºŽ==è¾“å…¥/è¾“å‡ºè®¾å¤‡==ï¼Œæ”¯æŒ==æµå¼æ•°æ®ä¼ è¾“==ã€‚

3. ==ä¸»è¦åŒºåˆ«==

	- ==è®¿é—®æ¨¡å¼==ï¼š==å—è®¾å¤‡æ”¯æŒéšæœºè®¿é—®==ï¼Œå…è®¸è®¿é—®ä»»æ„ä½ç½®çš„æ•°æ®å—ï¼›==å­—ç¬¦è®¾å¤‡å¤„ç†æµå¼æ•°æ®==ï¼Œé€šå¸¸ä»¥==é¡ºåº==æ–¹å¼è®¿é—®ã€‚
	- ==æ•°æ®å•ä½==ï¼šå—è®¾å¤‡==ä»¥å—ï¼ˆä¸€ç»„å­—èŠ‚ï¼‰ä¸ºå•ä½==å¤„ç†æ•°æ®ï¼›å­—ç¬¦è®¾å¤‡==ä»¥å•ä¸ªå­—ç¬¦ï¼ˆå­—èŠ‚ï¼‰ä¸ºå•ä½==å¤„ç†æ•°æ®ã€‚
	- ==ç¼“å­˜==ï¼š==å—è®¾å¤‡çš„æ•°æ®å¯ä»¥è¢«ç¼“å­˜==ï¼Œæé«˜æ•°æ®è®¿é—®æ•ˆçŽ‡ï¼›==å­—ç¬¦è®¾å¤‡çš„æ•°æ®é€šå¸¸ä¸è¢«ç¼“å­˜ï¼Œç›´æŽ¥ä¼ è¾“==ã€‚

---



### 10.Linuxç³»ç»Ÿé‡Œï¼Œæ‚¨çŸ¥é“bufferå’Œcacheå¦‚ä½•åŒºåˆ†å—ï¼Ÿ

1. åŒºåˆ†ç‚¹

	> - ==ç›®æ ‡å¯¹è±¡==ï¼š`buffer`é’ˆå¯¹çš„æ˜¯==å—è®¾å¤‡çš„åŽŸå§‹æ•°æ®å—==ï¼›è€Œ`cache`é’ˆå¯¹çš„æ˜¯æ–‡ä»¶ç³»ç»Ÿå±‚é¢çš„==æ–‡ä»¶æ•°æ®==ã€‚
	> - ==ä¼˜åŒ–ç­–ç•¥==ï¼š`buffer`é€šè¿‡==ä¼˜åŒ–å—è®¾å¤‡çš„è¯»å†™æ“ä½œ==æ¥æé«˜æ•ˆçŽ‡ï¼›`cache`é€šè¿‡==å‡å°‘å¯¹å®žé™…ç£ç›˜çš„è®¿é—®==æ¥åŠ é€Ÿæ–‡ä»¶çš„è¯»å†™æ“ä½œã€‚
	> - ==æ•°æ®å¤„ç†==ï¼šè™½ç„¶ä¸¤è€…éƒ½æ˜¯ç”¨æ¥ç¼“å­˜æ•°æ®çš„ï¼Œä½†==`buffer`æ›´å¤šå…³æ³¨äºŽç£ç›˜I/Oæ“ä½œçš„ç¼“å†²==ï¼Œè€Œ==`cache`å…³æ³¨äºŽæ–‡ä»¶å†…å®¹çš„ç¼“å­˜==ã€‚

2. éšç€Linuxå†…æ ¸çš„å‘å±•ï¼Œç‰¹åˆ«æ˜¯ä»Ž2.4ç‰ˆæœ¬å¼€å§‹ï¼Œå†…æ ¸å¼•å…¥äº†ç»Ÿä¸€çš„ç¼“å†²åŒºç®¡ç†æœºåˆ¶ï¼Œå°†`buffer`å’Œ`cache`æ›´ç´§å¯†åœ°é›†æˆåœ¨ä¸€èµ·ã€‚==åœ¨çŽ°ä»£Linuxç³»ç»Ÿä¸­ï¼Œ`buffer cache`å·²ç»è¢«é¡µç¼“å­˜æœºåˆ¶æ‰€å–ä»£ï¼Œå¯¹æ–‡ä»¶å’Œå—è®¾å¤‡çš„ç¼“å­˜éƒ½é€šè¿‡é¡µç¼“å­˜æ¥å¤„ç†==ã€‚

---



# 8.æ¶ˆæ¯é˜Ÿåˆ—

### 1.ä½“éªŒä¸€ä¸‹é¢è¯•å®˜å¯¹äºŽæ¶ˆæ¯é˜Ÿåˆ—çš„7ä¸ªè¿žçŽ¯ç‚®

1. ä»Žä¸€ä¸ªç‚¹å¼€å§‹è°ˆï¼Œç„¶åŽç”±æµ…å…¥æ·±ï¼Œæ­¥æ­¥æ·±æŒ–ã€‚

---



### 2.å¦‚ä½•è¿›è¡Œæ¶ˆæ¯é˜Ÿåˆ—çš„æŠ€æœ¯é€‰åž‹ï¼Ÿ

1. ==ä¸ºä»€ä¹ˆä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—==ï¼Ÿ

	> - é¢è¯•å®˜å¿ƒç†ï¼šçœ‹çœ‹ä½ æ˜¯ä¸æ˜¯çœŸçš„çŸ¥é“è¿™ä¸ªæŠ€æœ¯çš„è¿ç”¨åœºæ™¯ï¼Œé˜²æ­¢ä½ è¿›å…¥å›¢é˜ŸåŽä¹±ç”¨ä¸æ‡‚çš„æŠ€æœ¯ï¼Œç»™å›¢é˜ŸæŒ–å‘ã€‚
	>
	> - ==è§£è€¦==ï¼š
	>
	> 	- ==ä¸ç”¨æ¶ˆæ¯é˜Ÿåˆ—äº§ç”Ÿä¸¥é‡è€¦åˆçš„åœºæ™¯==ï¼š
	>
	> 		![image-20240524212054780](bgwROUND1.assets/image-20240524212054780.png)
	>
	> 		A ç³»ç»Ÿæœ‰ä¸€ä¸ªé‡è¦æ•°æ®ï¼Œéœ€è¦å‘ç»™å…¶å®ƒç³»ç»Ÿï¼Œä½†æ˜¯ä¸€ä¼šå„¿åˆæ¥ä¸€ä¸ªæ–°çš„ç³»ç»Ÿè¦æ±‚ A ç³»ç»ŸæŠŠæ•°æ®ç»™å®ƒä¹Ÿå‘ä¸€ä»½ï¼Œè¿™æ—¶å€™ A ç³»ç»Ÿå°±ä¸å¾—ä¸ä¿®æ”¹ä»£ç ï¼Œè°ƒç”¨ E ç³»ç»Ÿçš„æŽ¥å£ã€‚åˆå¯èƒ½è¿‡ä¸€ä¼šå„¿ D ç³»ç»Ÿåˆä¸éœ€è¦ A ç³»ç»Ÿçš„æ•°æ®äº†ï¼ŒA ç³»ç»Ÿåˆè¦åˆ é™¤å¯¹ D ç³»ç»ŸæŽ¥å£çš„è°ƒç”¨ã€‚è¿™å°±æ˜¯å› ä¸º ==A ç³»ç»Ÿå’Œå…¶å®ƒä¹±ä¸ƒå…«ç³Ÿç³»ç»Ÿä¸¥é‡è€¦åˆï¼Œå¯¼è‡´ä»£ç å†™æ­»äº†ï¼Œéš¾ä»¥ç»´æŠ¤å’Œæ‰©å±•==ã€‚
	>
	> 	- ==ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—è§£è€¦==ï¼š
	>
	> 		![image-20240524213120300](bgwROUND1.assets/image-20240524213120300.png)
	>
	> 		A ç³»ç»Ÿåªéœ€è¦æŠŠè¿™ä¸ªé‡è¦æ•°æ®æ”¾åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œè¿™æ ·å…¶å®ƒç³»ç»Ÿéœ€è¦è¿™ä¸ªæ•°æ®ï¼Œå°±ä¸è¦æ‰¾ A ç³»ç»Ÿäº†ï¼Œè€Œæ˜¯è‡ªå·±åŽ»æ¶ˆæ¯é˜Ÿåˆ—é‡Œæ‰¾ã€‚è¿™æ ·ä¸€æ¥ ==A ç³»ç»Ÿåªç”¨è°ƒç”¨æ¶ˆæ¯é˜Ÿåˆ—çš„ apiï¼Œè€Œæ— éœ€å…³æ³¨å…¶å®ƒç³»ç»ŸèŽ·å–é‡è¦æ•°æ®çš„ä¸šåŠ¡é€»è¾‘ï¼Œå®žçŽ°äº† A ç³»ç»Ÿå’Œå…¶å®ƒä¹±ä¸ƒå…«ç³Ÿçš„ç³»ç»Ÿçš„è§£è€¦==ã€‚
	>
	> 		å®žé™…ä¸Šï¼Œè¿™é‡Œçš„æ¶ˆæ¯é˜Ÿåˆ—å¯ä»¥ç†è§£ä¸ºä¸€ä¸ª==å‘å¸ƒ/è®¢é˜…æ¨¡å¼==ï¼Œå…¶å®ƒç³»ç»Ÿè®¢é˜…æ‹¥æœ‰é‡è¦æ•°æ®çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä»Žä¸­èŽ·å–æ•°æ®å³å¯ã€‚
	>
	> - ==å¼‚æ­¥==ï¼š
	>
	> 	- ==ä¸ç”¨æ¶ˆæ¯é˜Ÿåˆ—å¯¼è‡´åŒæ­¥æƒ…å†µä¸‹çš„é«˜å»¶è¿Ÿè¯·æ±‚==ï¼š
	>
	> 		![image-20240524214330890](bgwROUND1.assets/image-20240524214330890.png)
	>
	> 		æ¯”å¦‚æœ‰ä¸€ä¸ªç”¨æˆ·ï¼Œå‘èµ·äº†ä¸€ä¸ªè¯·æ±‚ï¼Œ==è¿™ä¸ªè¯·æ±‚éœ€è¦è°ƒç”¨å…¶å®ƒç³»ç»Ÿçš„æŽ¥å£ã€‚å‡å¦‚è¦è°ƒç”¨çš„å…¶å®ƒç³»ç»Ÿæ¯”è¾ƒå¤šï¼Œè€Œä¸”æ¯ä¸ªæŽ¥å£è°ƒç”¨çš„æ—¶é—´æ¯”è¾ƒé•¿==ï¼Œè¿™æ ·æœ€åŽ==æ•´ä¸ªè¯·æ±‚çš„å®Œæˆæ—¶é—´å¯èƒ½ä¼šå¾ˆé•¿==ï¼Œæ¯”å¦‚è¶…è¿‡äº†1ç§’ï¼Œè¿™å°±==ä¸¥é‡å½±å“äº†ç”¨æˆ·çš„ä½“éªŒ==ã€‚
	>
	> 	- ==å¼‚æ­¥åŒ–ä¹‹åŽå¤§å¹…æå‡è°ƒç”¨é«˜å»¶è¿ŸæŽ¥å£çš„ç”¨æˆ·ä½“éªŒ==ï¼š
	>
	> 		![image-20240524214832205](bgwROUND1.assets/image-20240524214832205.png)
	>
	> 		ç³»ç»Ÿ A åªéœ€è¦æŠŠå…¶å®ƒä¹±ä¸ƒå…«ç³Ÿçš„ç³»ç»Ÿéœ€è¦çš„æ•°æ®==ä¸¢åˆ°æ¶ˆæ¯é˜Ÿåˆ—é‡Œï¼Œç„¶åŽå°±ä¸ç®¡äº†ï¼Œç›´æŽ¥è¿”å›ž==ï¼Œè¿™æ ·å“åº”ç”¨æˆ·çš„é€Ÿåº¦å¾ˆå¿«ï¼Œç”¨æˆ·çš„ä½“éªŒå¾ˆå¥½ã€‚è€Œé‚£äº›ä¹±ä¸ƒå…«ç³Ÿçš„ç³»ç»Ÿå‘çŽ°æ¶ˆæ¯é˜Ÿåˆ—é‡Œæœ‰æ¶ˆæ¯ä¹‹åŽå–å‡ºæ¥ï¼Œè°ƒç”¨æŒ‡å®šçš„æŽ¥å£å®Œæˆè¿™äº›ä¸šåŠ¡ï¼Œè¿™æ ·å¼‚æ­¥åŽ==ç”¨æˆ·å‡ ä¹Žæ„Ÿè§‰ä¸åˆ°è°ƒç”¨é«˜å»¶è¿ŸæŽ¥å£çš„å»¶è¿Ÿ==ã€‚
	>
	> - ==æ¶ˆå³°==ï¼š
	>
	> 	- ==ä¸ç”¨æ¶ˆæ¯é˜Ÿåˆ—é«˜å³°æœŸå¤§é‡è¯·æ±‚æ¶Œå…¥ Mysql æŒ‚äº†==
	>
	> 	- ==ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œæ¶ˆå³°==ï¼š
	>
	> 		æ¯”å¦‚é«˜å³°æœŸä¸€ç§’5000ä¸ªè¯·æ±‚ï¼Œä½†æ˜¯ Mysql æ¯ç§’èƒ½å¤„ç†çš„è¯·æ±‚æžé™ä¸º2000ä¸ªï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼Œå°±å¯ä»¥åœ¨è¯·æ±‚é€åˆ° Mysql ä¹‹å‰==å…ˆå…¨éƒ¨æ”¾è¿›æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç„¶åŽè§„å®šæ¯ç§’æœ€å¤šä»Žæ¶ˆæ¯é˜Ÿåˆ—ä¸­è¯»å–2000æ¡è¯·æ±‚ï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯ Mysql è‚¯å®šä¸ä¼šæŒ‚æŽ‰==ã€‚ç„¶åŽç­‰åˆ°ä½Žå³°æœŸå†æŠŠç§¯åŽ‹çš„æ¶ˆæ¯å¤„ç†äº†ã€‚

2. ==æ¶ˆæ¯é˜Ÿåˆ—çš„ä¼˜ç‚¹å’Œç¼ºç‚¹==ï¼Ÿ

      > - é¢è¯•å®˜å¿ƒç†ï¼šé˜²æ­¢ä½ ä¸çŸ¥é“æŸä¸ªæŠ€æœ¯å¯èƒ½å¸¦æ¥çš„é£Žé™©å°±ä¹±ç”¨ï¼Œç»™å›¢é˜ŸæŒ–å‘ã€‚
      > - ==ç³»ç»Ÿå¯ç”¨æ€§é™ä½Ž==ï¼š
      > 	- æœ¬æ¥ç›´æŽ¥è°ƒç”¨æŽ¥å£æ²¡é—®é¢˜ï¼Œç»“æžœå¤šåŠ äº†ä¸€ä¸ª MQ è¿›æ¥ï¼Œå¯¼è‡´ä¸‹é¢çš„é—®é¢˜ï¼š
      > 		1. ==MQ æŒ‚æŽ‰==ï¼šA ç³»ç»Ÿæ— æ³•æŠŠé‡è¦çš„æ•°æ®æ”¾åˆ°æ¶ˆæ¯é˜Ÿåˆ—ï¼ŒåŒæ—¶ä¸‹é¢é‚£äº›==ä¹±ä¸ƒå…«ç³Ÿçš„ç³»ç»Ÿå…¨éƒ¨éƒ½æ²¡åŠžæ³•ä»Ž MQ ä¸­èŽ·å–æ•°æ®ï¼ŒæœåŠ¡å…¨å´©æºƒ==äº†ã€‚
      > 		2. ==æ¶ˆè´¹è€…æŒ‚äº†==ï¼šA ç³»ç»Ÿæ”¾åˆ° MQ ä¸­çš„æ¶ˆæ¯==è¿Ÿè¿Ÿæ²¡äººæ¶ˆè´¹ï¼Œå¯¼è‡´ MQ æ»¡äº†ï¼Œå ç”¨å¤§é‡ç£ç›˜ç©ºé—´==ã€‚
      > 		3. ==A ç³»ç»Ÿå’Œ MQ çš„è”è°ƒå‡ºäº†é—®é¢˜==ï¼šæ¯”å¦‚ A ç³»ç»Ÿåªæƒ³æ”¾ä¸€æ¡æ¶ˆæ¯ï¼Œç»“æžœæœ€ç»ˆæ”¾çš„æ—¶å€™æ”¾äº†ä¸¤æ¡ï¼Œé‚£ä¹ˆä¸‹é¢çš„ç³»ç»Ÿå°±æ¶ˆè´¹ä¸¤æ¡æ•°æ®ï¼Œå¤„ç†äº†ä¸¤æ¬¡ä¸šåŠ¡ã€‚
      > - ==ç³»ç»Ÿå¤æ‚æ€§ä¸Šå‡==ï¼š
      > 	- é‡å¤æ¶ˆè´¹ï¼Œæ¶ˆæ¯ä¸¢å¤±ï¼Œé¡ºåºæ€§é—®é¢˜ã€‚
      > - ==ä¸€è‡´æ€§é—®é¢˜==ï¼š
      > 	- æ¯”å¦‚æœ¬æ¥æ˜¯æ‰€æœ‰ç³»ç»Ÿéƒ½æ‰§è¡ŒæˆåŠŸï¼Œæ‰ç»™ç”¨æˆ·è¿”å›žã€‚ä½†==ç»“æžœå…¶ä¸­ä¸€ä¸ªæ¶ˆè´¹è€…æ‰§è¡Œå¤±è´¥==äº†ï¼Œä½†æ˜¯==æ­¤æ—¶ A ç³»ç»Ÿæ—©å°±å·²ç»ç»™ç”¨æˆ·è¿”å›žæ‰§è¡ŒæˆåŠŸäº†ï¼Œè¿™å°±å¯¼è‡´ç”¨æˆ·æ”¶åˆ°çš„ä¿¡æ¯å’ŒåŽå°å®žé™…æƒ…å†µä¸ä¸€è‡´==ã€‚

---



### 3.å¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—ä¹‹åŽè¯¥å¦‚ä½•ä¿è¯å…¶é«˜å¯ç”¨æ€§

1. ==RabbitMQ çš„é«˜å¯ç”¨ï¼ˆéžåˆ†å¸ƒå¼ï¼‰==ï¼š

	> - ==é•œåƒé›†ç¾¤æ¨¡å¼å®žçŽ°é«˜å¯ç”¨æ€§==ï¼š
	>
	> 	![image-20240525210104608](bgwROUND1.assets/image-20240525210104608.png)
	>
	> - ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹æŒ‚äº†ï¼Œ==å…¶å®ƒèŠ‚ç‚¹ä¸Šè¿˜æœ‰è¿™ä¸ª queue çš„å®Œæ•´æ•°æ®==ï¼Œè¿™æ ·ä¿è¯çš„å¯ç”¨æ€§ã€‚
	>
	> - ==ç¼ºç‚¹ï¼šä»»ç„¶ä¸æ˜¯åˆ†å¸ƒå¼çš„ç³»ç»Ÿ==ã€‚

2. ==Kafka çš„é«˜å¯ç”¨æ€§ï¼ˆåˆ†å¸ƒå¼ï¼‰==ï¼š

	> - ![image-20240525211531362](bgwROUND1.assets/image-20240525211531362.png)
	> - æŠŠ==ä¸€ä¸ª topic é‡Œçš„æ•°æ®åˆ†æ•£åˆ°å¤šä¸ª partition ä¸­==ï¼Œé˜²æ­¢å‡ºçŽ°ä¸€å°æœºå™¨å­˜å‚¨ä¸äº†å¤§é‡çš„æ•°æ®ã€‚
	> - ä½†æ˜¯å¦‚æžœåªæ˜¯åˆ†æ•£åˆ°å¤šä¸ª partition ä¸­ï¼Œå¹¶ä¸èƒ½å®žçŽ°é«˜å¯ç”¨ï¼Œå› ä¸º==ä¸€æ—¦æŸä¸€ä¸ª partition æŒ‚äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¼šæŸå¤±ä¸€éƒ¨åˆ† MQ çš„æ•°æ®==ï¼Œè¿™æ˜¯æˆ‘ä»¬æ— æ³•æŽ¥æ”¶çš„ã€‚
	> - é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥==å¯¹æ¯ä¸€ä¸ª partition åˆ†åˆ«å®žçŽ°ä¸»ä»Žé›†ç¾¤==ï¼Œå³==ç”Ÿäº§è€…å†™æ•°æ®åªå¾€æ¯ä¸€ä¸ª partition çš„ä¸»èŠ‚ç‚¹ä¸­å†™æ•°æ®ï¼Œç„¶åŽå†åŒæ­¥åˆ°ä»ŽèŠ‚ç‚¹==ã€‚å¦‚æžœ==ä¸»èŠ‚ç‚¹æŒ‚äº†ï¼Œå°±ä¼šé€‰ä¸¾æ–°çš„ä»ŽèŠ‚ç‚¹==ã€‚

---



### 4.æˆ‘ä¸ºä»€ä¹ˆåœ¨æ¶ˆæ¯é˜Ÿåˆ—é‡Œæ¶ˆè´¹åˆ°äº†é‡å¤çš„æ•°æ®

1. Kafka ç»™==æ¯ä¸€ä¸ªæ¶ˆæ¯ä¸€ä¸ª offerï¼Œè¡¨ç¤ºåºå·==ã€‚æ¶ˆè´¹è€…åœ¨==å®Œæˆæ¶ˆè´¹åŽï¼Œå°†è‡ªå·±æ‰€æœŸå¾…çš„ä¸‹ä¸€ä¸ªæ¶ˆæ¯çš„ç¼–å·å‘ç»™ zookeeperï¼Œç”± zookeeper å‘Šè¯‰ Kafka æ¶ˆè´¹è€…æœŸå¾…çš„ä¸‹ä¸€æ¡æ¶ˆæ¯çš„åºå·==ã€‚
2. å½“ç„¶ï¼Œå¦‚æžœå‡ºçŽ°æ¶ˆè´¹è€…==å‡†å¤‡æäº¤ä¸‹ä¸€ä¸ªç¼–å·ï¼Œä½†æ˜¯é‡å¯äº†ï¼Œæäº¤å¤±è´¥==çš„æƒ…å†µï¼Œé‚£ä¹ˆå¦‚æžœè¿™æ—¶ ==Kafka æ°å¥½å‡ºçŽ°äº†é‡ä¼ ï¼Œé‚£ä¹ˆè¿˜æ˜¯ä¼šæŠŠé‡å¤çš„æ¶ˆæ¯ä¼ ç»™æ¶ˆè´¹è€…==ã€‚
3. å› æ­¤ä¸€ç§å¯è¡Œçš„æ–¹å¼æ˜¯åœ¨==æ¶ˆè´¹è€…æ¶ˆè´¹ä¸€æ¡æ•°æ®åŽï¼Œåœ¨å†…å­˜æˆ– Redis ä¸­é‡‡ç”¨ set è®°å½•è‡ªå·±æ¶ˆè´¹è¿‡çš„æ¶ˆæ¯çš„åºå·==ï¼Œåœ¨æ¶ˆè´¹ä¸€æ¡æ–°çš„æ¶ˆæ¯æ—¶==å…ˆåŽ» set ä¸­æŸ¥æ‰¾åˆ¤æ–­æ˜¯å¦é‡å¤æ¶ˆè´¹==ã€‚
4. å¦ä¸€ç§å¯è¡Œæ–¹æ³•æ˜¯==åˆ©ç”¨æ•°æ®åº“çš„å”¯ä¸€é”®æ¥é™åˆ¶ä¸èƒ½æ’å…¥å¤šæ¬¡==ã€‚æ¯”å¦‚==æ¶ˆè´¹è€…å‡ºçŽ°æ„å¤–ä»»ç„¶åƒæ•°æ®åº“æ’å…¥ä¸¤æ¡æ•°æ®ï¼Œè¿™æ—¶ç”±äºŽæœ‰å”¯ä¸€é”®çº¦æŸï¼Œå°±ä¸ä¼šæ’å…¥æˆåŠŸ==ã€‚

---



### 5.å•¥ï¼Ÿæˆ‘å‘åˆ°æ¶ˆæ¯é˜Ÿåˆ—é‡Œé¢çš„æ•°æ®æ€Žä¹ˆä¸è§äº†ï¼Ÿ

1. ==rabbitMQ å¼„ä¸¢æ¶ˆæ¯æœ‰ä¸‰ç§æƒ…å†µ==ï¼šç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯ç”±äºŽç½‘ç»œé˜»å¡žæˆ–ä¸¢åŒ…æ²¡èƒ½åˆ°è¾¾ MQï¼›MQ å°†æ¶ˆæ¯å­˜åœ¨å†…å­˜ä¸­ï¼Œé‡å¯æ—¶ä¸¢å¤±è¿™éƒ¨åˆ†æ•°æ®ï¼›æ¶ˆè´¹è€…å°†æ¶ˆæ¯å­˜åœ¨å†…å­˜ä¸­ï¼Œé‡å¯æ—¶ä¸¢å¤±è¿™éƒ¨åˆ†æ•°æ®ã€‚

2. ==rabbitMQ çš„ç”Ÿäº§è€…æ²¡èƒ½å‘é€åˆ° MQ==ï¼š

	> 1. é‡‡ç”¨==äº‹åŠ¡æœºåˆ¶==ã€‚åœ¨äº‹åŠ¡ä¸­å‘é€æ¶ˆæ¯åˆ° MQï¼Œå¦‚æžœ MQ æ²¡æ”¶åˆ°æˆ–å†…éƒ¨å‡ºäº†ä¸€äº›é—®é¢˜ï¼Œå°±èƒ½åœ¨==äº‹åŠ¡ä¸­æ•èŽ·åˆ°å¼‚å¸¸ï¼Œå¹¶é‡‡å–å›žæ»šé‡å‘çš„æ–¹æ³•==ã€‚
	>
	> 	è¿™æ ·åšæœ€å¤§çš„ç¼ºç‚¹æ˜¯é‡‡å–==åŒæ­¥ç­‰å¾…==çš„æ–¹å¼ï¼Œç­‰å¾… MQ çš„ acknowledge æ¶ˆæ¯ï¼Œ==é™ä½Žåžåé‡==ã€‚
	>
	> 2. é‡‡å– ==comfirm æœºåˆ¶==ã€‚==å°† MQ çš„æŸä¸€ä¸ª channel è®¾ç½®ä¸º comfirm==ã€‚å‘é€æ¶ˆæ¯åŽï¼Œå¦‚æžœ MQ æ”¶åˆ°ï¼Œåˆ™==å›žè°ƒç”Ÿäº§è€…çš„ä¸€ä¸ªæ–¹æ³•å‘Šè¯‰å…¶æ”¶åˆ°==ï¼ŒåŒç†æ²¡æ”¶åˆ°ä¹Ÿä¼š==å›žè°ƒå¹¶è¦æ±‚ç”Ÿäº§è€…é‡å‘==ã€‚
	>
	> 	è¿™æ ·åšæœ€å¤§çš„å¥½å¤„æ˜¯==å¼‚æ­¥ç¡®è®¤==ã€‚ç”Ÿäº§è€…åªéœ€å°†æ¶ˆæ¯å¡žåˆ° MQ ä¸­å³å¯ç»§ç»­å‘é€ä¸‹ä¸€æ¡æ¶ˆæ¯ï¼Œä¸ä¼šè¢«é˜»å¡žåœ¨æ­¤ï¼Œå› æ­¤è¿™ä¹Ÿæ˜¯å¸¸ç”¨çš„æ–¹æ³•ã€‚

3. ==rabbitMQ è‡ªå·±å¼„ä¸¢æ•°æ®==ï¼š

	> - é¦–å…ˆ==åˆ›å»º queue æ—¶å°† queue è®¾ç½®ä¸ºæŒä¹…åŒ–==ï¼Œè¿™æ ·å¯ä»¥==æŒä¹…åŒ– queue çš„å…ƒæ•°æ®==ã€‚
	> - ç„¶åŽå°†å‘é€çš„==æ¶ˆæ¯çš„ deliveryMode è®¾ç½®ä¸º2==ï¼Œè¿™æ · MQ æ”¶åˆ°æ¶ˆæ¯åŽä¼š==å°†æ¶ˆæ¯æŒä¹…åŒ–åˆ°ç£ç›˜ä¸Š==ã€‚
	> - è¿™æ ·å°±ç®—æ˜¯é‡å¯ï¼ŒMQ å¯ä»¥==ä»Žç£ç›˜ä¸Šçš„æŒä¹…åŒ–æ–‡ä»¶ä¸­èŽ·å– queue çš„å…ƒæ•°æ®åŠå…¶å­˜å‚¨çš„æ•°æ®==ï¼Œå¯ä»¥ä¿è¯é‡å¯æ—¶æ•°æ®ä¸ä¸¢å¤±ã€‚
	> - ç„¶è€Œ==è¿™æ ·ä¹Ÿä¸æ˜¯ä¸‡æ— ä¸€å¤±çš„==ï¼Œå¦‚æžœæŸä¸ª MQ ä¸Šçš„==æ•°æ®åœ¨æŒä¹…åŒ–åˆ°ç£ç›˜ä¸Šä¹‹å‰ï¼ŒMQ æŒ‚äº†==ï¼Œé‚£ä¹ˆè¿™éƒ¨åˆ†æ•°æ®å°±çœŸçš„ä¸¢äº†ã€‚

4. ==rabbitMQ æ¶ˆè´¹è€…æŠŠæ•°æ®ä¸¢äº†==ï¼š

  > - æ¶ˆè´¹è€…å¼„ä¸¢æ•°æ®==åªæœ‰ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯æ¶ˆè´¹è€…å¼€å¯äº† autoACK æœºåˆ¶==ã€‚autoACK æœºåˆ¶æŒ‡çš„æ˜¯ï¼š==åªè¦æ¶ˆè´¹è€…æ”¶åˆ°äº† MQ çš„æ¶ˆæ¯ï¼Œå°±é©¬ä¸Šé€šçŸ¥å…¶è‡ªå·± ACK äº†ï¼Œå³æ—¶æ­¤æ—¶è¿˜æ²¡æœ‰æ¶ˆè´¹å®Œè¿™æ¡æ•°æ®==ã€‚è¿™æ—¶å®•æœºäº†è¯ï¼ŒMQ è¯¯ä»¥ä¸ºæ¶ˆè´¹è€…æ¶ˆè´¹å®Œäº†è¿™æ¡æ•°æ®ï¼Œå°±ç›´æŽ¥å‘é€ä¸‹ä¸€æ¡æ•°æ®äº†ã€‚
  > - è§£å†³æ–¹å¼å°±æ˜¯==å…³é—­æ¶ˆè´¹è€…çš„ autoACK æœºåˆ¶==ï¼Œè¿™æ ·ä½ å¯ä»¥åœ¨ä¸šåŠ¡ä»£ç ä¸­==è‡ªå®šä¹‰ä»€ä¹ˆæ—¶å€™å‘Šè¯‰ MQ æ¶ˆè´¹è€…æ¶ˆæ¯æ¶ˆè´¹å®Œæˆ==ã€‚å¦‚æžœå‡ºçŽ°å®•æœºæ—¶æ¶ˆè´¹è€…æ²¡æœ‰æ¶ˆè´¹å®Œçš„æƒ…å†µï¼Œ==MQ å‘çŽ°è‡ªå·±æ²¡æœ‰æ”¶åˆ° ACKï¼Œå°±ä¼šæŠŠè¿™æ¡æ¶ˆæ¯å†å‘ç»™å…¶å®ƒæ¶ˆè´¹è€…è¿›è¡Œæ¶ˆè´¹==ã€‚

7. ==Kafka çš„ç”Ÿäº§è€…å¼„ä¸¢æ•°æ®==ï¼š

	> - ç”Ÿäº§è€…å¿…é¡»ä¿è¯==ä¸€æ¡æ•°æ®æˆåŠŸå†™å…¥ patition çš„ leader åŠå…¶æ‰€æœ‰ follower ä¹‹åŽï¼Œè¿™æ¡æ¶ˆæ¯æ‰ç®—å‘é€æˆåŠŸ==ï¼Œå¦åˆ™å°±ä¼š==æ— é™æ¬¡åœ°é‡å¤å‘é€æ¶ˆæ¯ï¼Œç›´åˆ°å…¨éƒ¨ replicaï¼ˆå‰¯æœ¬ï¼‰ æ”¶åˆ°æ¶ˆæ¯==ã€‚
	
6. ==Kafka è‡ªå·±å¼„ä¸¢æ•°æ®==ï¼š

  > - ![image-20240526150348473](bgwROUND1.assets/image-20240526150348473.png)
  > - è®¾ç½®==æ¯ä¸ª patition è‡³å°‘æœ‰ä¸¤ä¸ª follower==ï¼Œå¹¶ä¸”è¦æ±‚ ==leader èƒ½æ„ŸçŸ¥åˆ°è‡³å°‘æœ‰ä¸€ä¸ª follower è¿˜èƒ½æ­£å¸¸åŒæ­¥æ•°æ®==ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯ leader æŒ‚äº†ä¹‹åŽè‡³å°‘è¿˜æœ‰ä¸€ä¸ªå‰¯æœ¬å­˜å‚¨äº†æ•°æ®ï¼Œæ•°æ®ä¸ä¸¢ã€‚

7. ==Kafka çš„æ¶ˆè´¹è€…ä¸¢å¤±æ•°æ®==ï¼š

  > - ç±»ä¼¼äºŽ rabbitMQ çš„æ¶ˆè´¹è€…å¼„ä¸¢æ•°æ®çš„æƒ…å†µï¼Œå°±æ˜¯ ==auto æäº¤ offset ç»™ Kafkaï¼Œè®© Kafka è¯¯ä»¥ä¸ºä½ å·²ç»å®Œæˆæäº¤äº†==ã€‚ä¹Ÿæ˜¯å…³é—­è‡ªåŠ¨æäº¤ offset çš„æœºåˆ¶ï¼Œè®©æ¶ˆè´¹è€…æ¶ˆè´¹å®Œæ•°æ®ä¹‹åŽå†æäº¤ offset åˆ° Kafka ä¸­ã€‚

---



### 6.æˆ‘è¯¥æ€Žä¹ˆä¿è¯ä»Žæ¶ˆæ¯é˜Ÿåˆ—é‡Œæ‹¿åˆ°çš„æ•°æ®æŒ‰é¡ºåºæ‰§è¡Œï¼Ÿ

1. ==RabbitMQ ä¿è¯é¡ºåºæ€§==ï¼š

	> - ![image-20240526214332658](bgwROUND1.assets/image-20240526214332658.png)
	> - ç»™æ¯ä¸€ä¸ªæ¶ˆè´¹è€…å•ç‹¬å¼€ä¸€ä¸ª queueï¼ŒæŠŠéœ€è¦ä¿è¯é¡ºåºçš„æ•°æ®å…¨éƒ¨æ”¾åœ¨åŒä¸€ä¸ª queue ä¸­ï¼Œè¿™æ ·ä¸€ä¸ªæ¶ˆè´¹è€…ä¼šé¡ºåºè¯»å–è¿™äº›æ•°æ®ï¼Œè¿™æ ·å°±ä¿è¯äº†æ•°æ®çš„é¡ºåºæ€§ã€‚

2. ==Kafka ä¿è¯é¡ºåºæ€§==ï¼š

	> - ![image-20240526214939202](bgwROUND1.assets/image-20240526214939202.png)
	>
	> - è§£å†³æ–¹æ³•ï¼Œ==ä¸€ä¸ªçº¿ç¨‹é¡ºåºåœ°ä»Žä¸€ä¸ªå†…å­˜é˜Ÿåˆ—ä¸­å–æ•°æ®æ¥è¯»==ï¼Œå› æ­¤åªéœ€==å°†éœ€è¦ä¿è¯é¡ºåºçš„æ•°æ®æ ¹æ®å®ƒä»¬ç›¸åŒçš„ key å€¼å…¨éƒ¨åˆ†å‘åˆ°åŒä¸€ä¸ªå†…å­˜é˜Ÿåˆ—==ä¸­ï¼Œè¢«==åŒä¸€ä¸ªçº¿ç¨‹é¡ºåºæ‰§è¡Œ==ã€‚
	>
	> 	![image-20240526215251458](bgwROUND1.assets/image-20240526215251458.png)

---



### 7.ç”Ÿäº§äº‹æ•…ï¼å‡ ç™¾ä¸‡æ¶ˆæ¯åœ¨æ¶ˆæ¯é˜Ÿåˆ—é‡Œç§¯åŽ‹äº†å‡ ä¸ªå°æ—¶ï¼

1. ==é—®é¢˜è§£é‡Š==ï¼šæ¶ˆè´¹è€…æŒ‚äº†ï¼Œå¯¼è‡´ç§¯åŽ‹å¤§é‡æ•°æ®ï¼Œéœ€è¦æ¶ˆè´¹è€…æ¢å¤åŽå¿«é€Ÿå¤„ç†å®Œæˆã€‚
2. ==æ–¹æ³•==ï¼šå‡å¦‚åŽŸæ¥åªæœ‰ä¸‰ä¸ªæ¶ˆè´¹è€…ï¼Œå®ƒä»¬æŠŠç§¯åŽ‹çš„æ•°æ®å†™å…¥æ•°æ®è¦1ä¸ªå°æ—¶ï¼Œå¤ªæ…¢äº†ã€‚æˆ‘ä»¬å¯ä»¥è®©è¿™ä¸‰ä¸ªæ¶ˆè´¹è€…è¯»å–åˆ°æ•°æ®ä¹‹åŽä¸å†™å…¥æ•°æ®åº“ï¼Œè€Œæ˜¯é‡æ–°å¼€ä¸€ä¸ª topicï¼Œå®ƒçš„ä¸‹é¢æœ‰ 30 ä¸ª patitionï¼Œ==è®©åŽŸæ¥çš„ä¸‰ä¸ªæ¶ˆè´¹è€…å°†æ•°æ®å†™åˆ°è¿™æ–°å¼€çš„ 30 ä¸ª patition ä¸­==ï¼Œç„¶åŽ==é‡æ–°éƒ¨ç½²ä¸€å°æœºå™¨==ï¼Œè®©å®ƒ==èµ· 30 ä¸ªçº¿ç¨‹æ¶ˆè´¹è¿™ 30 ä¸ªpatition ä¸­çš„æ•°æ®ï¼ˆå³å†™å…¥æ•°æ®åº“ï¼‰==ï¼Œè¿™æ ·å°±èƒ½ä»¥åŽŸæ¥ ==10 å€çš„é€Ÿåº¦==æ¶ˆè´¹ç§¯åŽ‹æ•°æ®ã€‚
3. ==ç£ç›˜éƒ½ç§¯åŽ‹æ»¡äº†æ€Žä¹ˆåŠž==ï¼Ÿä¸ºäº†é¿å…ç£ç›˜æ»¡å¯¼è‡´æœºå™¨æŒ‚æŽ‰ï¼Œè®©==åŽŸæ¥çš„æ¶ˆè´¹è€…è¯»å–åˆ°æ•°æ®åŽç›´æŽ¥æ‰”æŽ‰ï¼Œå¿«é€Ÿæ¸…ç†æŽ‰æ•°æ®==ã€‚==ä¹‹åŽå•ç‹¬å†™ç¨‹åºæŸ¥å‡ºè¢«æ‰”æŽ‰çš„æ•°æ®ï¼Œå†æ‰‹åŠ¨å†™åˆ° MQ ä¸­å¤„ç†==ã€‚

---



### 8.å¦‚æžœè®©ä½ æ¥å¼€å‘ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ä¸­é—´ä»¶ï¼Œä½ ä¼šæ€Žä¹ˆè®¾è®¡æž¶æž„ï¼Ÿ

1. > ![image-20240526221644391](bgwROUND1.assets/image-20240526221644391.png)

---



